!function(c,b,d){function e(d,c){var e=b(d);e.data(f,this);this._container=e;this.data=[];this.fields=[];this._sortField=this._editingRow=null;this._sortOrder=g;this._firstDisplayingPage=1;this._init(c);this.render()}var f="JSGrid",g="asc",h=function(d,c){return b.isFunction(d)?d.apply(c,b.makeArray(arguments).slice(2)):d},k=function(d){var c=b.Deferred();return d&&d.then?d.then(function(){c.resolve.apply(c,arguments)},function(){c.reject.apply(c,arguments)}):c.resolve(d),c.promise()},l={loadData:b.noop,
insertItem:b.noop,updateItem:b.noop,deleteItem:b.noop};e.prototype={width:"auto",height:"auto",updateOnResize:!0,rowClass:b.noop,rowRenderer:null,rowClick:function(d){this.editing&&this.editItem(b(d.event.target).closest("tr"))},rowDoubleClick:b.noop,noDataContent:"Not found",noDataRowClass:"jsgrid-nodata-row",heading:!0,headerRowRenderer:null,headerRowClass:"jsgrid-header-row",headerCellClass:"jsgrid-header-cell",filtering:!1,filterRowRenderer:null,filterRowClass:"jsgrid-filter-row",inserting:!1,
insertRowRenderer:null,insertRowClass:"jsgrid-insert-row",editing:!1,editRowRenderer:null,editRowClass:"jsgrid-edit-row",confirmDeleting:!0,deleteConfirm:"Are you sure?",selecting:!0,selectedRowClass:"jsgrid-selected-row",oddRowClass:"jsgrid-row",evenRowClass:"jsgrid-alt-row",cellClass:"jsgrid-cell",sorting:!1,sortableClass:"jsgrid-header-sortable",sortAscClass:"jsgrid-header-sort jsgrid-header-sort-asc",sortDescClass:"jsgrid-header-sort jsgrid-header-sort-desc",paging:!1,pagerContainer:null,pageIndex:1,
pageSize:20,pageButtonCount:15,pagerFormat:"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}",pagePrevText:"Prev",pageNextText:"Next",pageFirstText:"First",pageLastText:"Last",pageNavigatorNextText:"...",pageNavigatorPrevText:"...",pagerContainerClass:"jsgrid-pager-container",pagerClass:"jsgrid-pager",pagerNavButtonClass:"jsgrid-pager-nav-button",pagerNavButtonInactiveClass:"jsgrid-pager-nav-inactive-button",pageClass:"jsgrid-pager-page",currentPageClass:"jsgrid-pager-current-page",
customLoading:!1,pageLoading:!1,autoload:!1,controller:l,loadIndication:!0,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:!0,invalidMessage:"Invalid data entered!",invalidNotify:function(d){d=b.map(d.errors,function(b){return b.message||null});c.alert([this.invalidMessage].concat(d).join("\n"))},onInit:b.noop,onRefreshing:b.noop,onRefreshed:b.noop,onPageChanged:b.noop,onItemDeleting:b.noop,onItemDeleted:b.noop,onItemInserting:b.noop,onItemInserted:b.noop,onItemEditing:b.noop,onItemUpdating:b.noop,
onItemUpdated:b.noop,onItemInvalid:b.noop,onDataLoading:b.noop,onDataLoaded:b.noop,onOptionChanging:b.noop,onOptionChanged:b.noop,onError:b.noop,invalidClass:"jsgrid-invalid",containerClass:"jsgrid",tableClass:"jsgrid-table",gridHeaderClass:"jsgrid-grid-header",gridBodyClass:"jsgrid-grid-body",_init:function(d){b.extend(this,d);this._initLoadStrategy();this._initController();this._initFields();this._attachWindowLoadResize();this._attachWindowResizeCallback();this._callEventHandler(this.onInit)},loadStrategy:function(){return this.pageLoading?
new jsGrid.loadStrategies.PageLoadingStrategy(this):new jsGrid.loadStrategies.DirectLoadingStrategy(this)},_initLoadStrategy:function(){this._loadStrategy=h(this.loadStrategy,this)},_initController:function(){this._controller=b.extend({},l,h(this.controller,this))},renderTemplate:function(b,c,e){args=[];for(var f in e)args.push(e[f]);return args.unshift(b,c),b=h.apply(null,args),b===d||null===b?"":b},loadIndicator:function(b){return new jsGrid.LoadIndicator(b)},validation:function(b){return jsGrid.Validation&&
new jsGrid.Validation(b)},_initFields:function(){var d=this;d.fields=b.map(d.fields,function(c){b.isPlainObject(c)&&(c=new (c.type&&jsGrid.fields[c.type]||jsGrid.Field)(c));return c._grid=d,c})},_attachWindowLoadResize:function(){b(c).on("load",b.proxy(this._refreshSize,this))},_attachWindowResizeCallback:function(){this.updateOnResize&&b(c).on("resize",b.proxy(this._refreshSize,this))},_detachWindowResizeCallback:function(){b(c).off("resize",this._refreshSize)},option:function(b,d){var c,e;return 1===
arguments.length?this[b]:(c={option:b,oldValue:this[b],newValue:d},this._callEventHandler(this.onOptionChanging,c),this._handleOptionChange(c.option,c.newValue),e={option:c.option,value:c.newValue},void this._callEventHandler(this.onOptionChanged,e))},fieldOption:function(b,d,c){return b=this._normalizeField(b),2===arguments.length?b[d]:(b[d]=c,void this._renderGrid())},_handleOptionChange:function(b,d){switch(this[b]=d,b){case "width":case "height":this._refreshSize();break;case "rowClass":case "rowRenderer":case "rowClick":case "rowDoubleClick":case "noDataRowClass":case "noDataContent":case "selecting":case "selectedRowClass":case "oddRowClass":case "evenRowClass":this._refreshContent();
break;case "pageButtonCount":case "pagerFormat":case "pagePrevText":case "pageNextText":case "pageFirstText":case "pageLastText":case "pageNavigatorNextText":case "pageNavigatorPrevText":case "pagerClass":case "pagerNavButtonClass":case "pageClass":case "currentPageClass":case "pagerRenderer":this._refreshPager();break;case "fields":this._initFields();this.render();break;case "data":case "editing":case "heading":case "filtering":case "inserting":case "paging":this.refresh();break;case "loadStrategy":case "pageLoading":this._initLoadStrategy();
this.search();break;case "pageIndex":this.openPage(d);break;case "pageSize":this.refresh();this.search();break;case "editRowRenderer":case "editRowClass":this.cancelEdit();break;case "updateOnResize":this._detachWindowResizeCallback();this._attachWindowResizeCallback();break;case "invalidNotify":case "invalidMessage":break;default:this.render()}},destroy:function(){this._detachWindowResizeCallback();this._clear();this._container.removeData(f)},render:function(){return this._renderGrid(),this.autoload?
this.loadData():b.Deferred().resolve().promise()},_renderGrid:function(){this._clear();this._container.addClass(this.containerClass).css("position","relative").append(this._createHeader()).append(this._createBody());this._pagerContainer=this._createPagerContainer();this._loadIndicator=this._createLoadIndicator();this._validation=this._createValidation();this.refresh()},_createLoadIndicator:function(){return h(this.loadIndicator,this,{message:this.loadMessage,shading:this.loadShading,container:this._container})},
_createValidation:function(){return h(this.validation,this)},_clear:function(){this.cancelEdit();clearTimeout(this._loadingTimer);this._pagerContainer&&this._pagerContainer.empty();this._container.empty().css({position:"",width:"",height:""})},_createHeader:function(){var d=this._headerRow=this._createHeaderRow(),c=this._filterRow=this._createFilterRow(),e=this._insertRow=this._createInsertRow(),d=this._headerGrid=b("<table>").addClass(this.tableClass).append(d).append(c).append(e);return this._header=
b("<div>").addClass(this.gridHeaderClass).addClass(this._scrollBarWidth()?"jsgrid-header-scrollbar":"").append(d)},_createBody:function(){var d=this._content=b("<tbody>"),d=this._bodyGrid=b("<table>").addClass(this.tableClass).append(d);return this._body=b("<div>").addClass(this.gridBodyClass).append(d).on("scroll",b.proxy(function(b){this._header.scrollLeft(b.target.scrollLeft)},this))},_createPagerContainer:function(){var d=this.pagerContainer||b("<div>").appendTo(this._container);return b(d).addClass(this.pagerContainerClass)},
_eachField:function(d){var c=this;b.each(this.fields,function(b,e){e.visible&&d.call(c,e,b)})},_createHeaderRow:function(){if(b.isFunction(this.headerRowRenderer))return b(this.renderTemplate(this.headerRowRenderer,this));var d=b("<tr>").addClass(this.headerRowClass);return this._eachField(function(c,e){var f=this._prepareCell("<th>",c,"headercss",this.headerCellClass).append(this.renderTemplate(c.headerTemplate,c)).appendTo(d);this.sorting&&c.sorting&&f.addClass(this.sortableClass).on("click",b.proxy(function(){this.sort(e)},
this))}),d},_prepareCell:function(d,c,e,f){return b(d).css("width",c.width).addClass(f||this.cellClass).addClass(e&&c[e]||c.css).addClass(c.align?"jsgrid-align-"+c.align:"")},_createFilterRow:function(){if(b.isFunction(this.filterRowRenderer))return b(this.renderTemplate(this.filterRowRenderer,this));var d=b("<tr>").addClass(this.filterRowClass);return this._eachField(function(b){this._prepareCell("<td>",b,"filtercss").append(this.renderTemplate(b.filterTemplate,b)).appendTo(d)}),d},_createInsertRow:function(){if(b.isFunction(this.insertRowRenderer))return b(this.renderTemplate(this.insertRowRenderer,
this));var d=b("<tr>").addClass(this.insertRowClass);return this._eachField(function(b){this._prepareCell("<td>",b,"insertcss").append(this.renderTemplate(b.insertTemplate,b)).appendTo(d)}),d},_callEventHandler:function(d,c){return d.call(this,b.extend(c,{grid:this})),c},reset:function(){return this._resetSorting(),this._resetPager(),this._loadStrategy.reset()},_resetPager:function(){this._firstDisplayingPage=1;this._setPage(1)},_resetSorting:function(){this._sortField=null;this._sortOrder=g;this._clearSortingCss()},
refresh:function(){this._callEventHandler(this.onRefreshing);this.cancelEdit();this._refreshHeading();this._refreshFiltering();this._refreshInserting();this._refreshContent();this._refreshPager();this._refreshSize();this._callEventHandler(this.onRefreshed)},_refreshHeading:function(){this._headerRow.toggle(this.heading)},_refreshFiltering:function(){this._filterRow.toggle(this.filtering)},_refreshInserting:function(){this._insertRow.toggle(this.inserting)},_refreshContent:function(){var b=this._content;
if(b.empty(),!this.data.length)return b.append(this._createNoDataRow()),this;for(var d=this._loadStrategy.firstDisplayIndex(),c=this._loadStrategy.lastDisplayIndex();c>d;d++)b.append(this._createRow(this.data[d],d))},_createNoDataRow:function(){var d=0;return this._eachField(function(){d++}),b("<tr>").addClass(this.noDataRowClass).append(b("<td>").addClass(this.cellClass).attr("colspan",d).append(this.renderTemplate(this.noDataContent,this)))},_createRow:function(d,c){var e;return b.isFunction(this.rowRenderer)?
e=this.renderTemplate(this.rowRenderer,this,{item:d,itemIndex:c}):(e=b("<tr>"),this._renderCells(e,d)),e.addClass(this._getRowClasses(d,c)).data("JSGridItem",d).on("click",b.proxy(function(b){this.rowClick({item:d,itemIndex:c,event:b})},this)).on("dblclick",b.proxy(function(b){this.rowDoubleClick({item:d,itemIndex:c,event:b})},this)),this.selecting&&this._attachRowHover(e),e},_getRowClasses:function(b,d){var c=[];return c.push((d+1)%2?this.oddRowClass:this.evenRowClass),c.push(h(this.rowClass,this,
b,d)),c.join(" ")},_attachRowHover:function(d){var c=this.selectedRowClass;d.hover(function(){b(this).addClass(c)},function(){b(this).removeClass(c)})},_renderCells:function(b,d){return this._eachField(function(c){b.append(this._createCell(d,c))}),this},_createCell:function(d,c){var e,f=this._getItemFieldValue(d,c),g={value:f,item:d};return e=b.isFunction(c.cellRenderer)?this.renderTemplate(c.cellRenderer,c,g):b("<td>").append(this.renderTemplate(c.itemTemplate||f,c,g)),this._prepareCell(e,c)},_getItemFieldValue:function(b,
d){for(var c=d.name.split("."),e=b[c.shift()];e&&c.length;)e=e[c.shift()];return e},_setItemFieldValue:function(b,d,c){d=d.name.split(".");for(var e=b,f=d[0];e&&d.length;)b=e,f=d.shift(),e=b[f];if(!e)for(;d.length;)b=b[f]={},f=d.shift();b[f]=c},sort:function(d,c){return b.isPlainObject(d)&&(c=d.order,d=d.field),this._clearSortingCss(),this._setSortingParams(d,c),this._setSortingCss(),this._loadStrategy.sort()},_clearSortingCss:function(){this._headerRow.find("th").removeClass(this.sortAscClass).removeClass(this.sortDescClass)},
_setSortingParams:function(b,d){b=this._normalizeField(b);d=d||(this._sortField===b?this._reversedSortOrder(this._sortOrder):g);this._sortField=b;this._sortOrder=d},_normalizeField:function(d){return b.isNumeric(d)?this.fields[d]:"string"==typeof d?b.grep(this.fields,function(b){return b.name===d})[0]:d},_reversedSortOrder:function(b){return b===g?"desc":g},_setSortingCss:function(){var b=this._visibleFieldIndex(this._sortField);this._headerRow.find("th").eq(b).addClass(this._sortOrder===g?this.sortAscClass:
this.sortDescClass)},_visibleFieldIndex:function(d){return b.inArray(d,b.grep(this.fields,function(b){return b.visible}))},_sortData:function(){var b=this._sortFactor(),d=this._sortField;d&&this.data.sort(function(c,e){return b*d.sortingFunc(c[d.name],e[d.name])})},_sortFactor:function(){return this._sortOrder===g?1:-1},_itemsCount:function(){return this._loadStrategy.itemsCount()},_pagesCount:function(){var b=this._itemsCount(),d=this.pageSize;return Math.floor(b/d)+(b%d?1:0)},_refreshPager:function(){var b=
this._pagerContainer;b.empty();this.paging&&b.append(this._createPager());var d=this.paging&&1<this._pagesCount();b.toggle(d)},_createPager:function(){var d;return d=b.isFunction(this.pagerRenderer)?b(this.pagerRenderer({pageIndex:this.pageIndex,pageCount:this._pagesCount()})):b("<div>").append(this._createPagerByFormat()),d.addClass(this.pagerClass),d},_createPagerByFormat:function(){var d=this.pageIndex,c=this._pagesCount(),e=this._itemsCount(),f=this.pagerFormat.split(" ");return b.map(f,b.proxy(function(f){var g=
f;return"{pages}"===f?g=this._createPages():"{first}"===f?g=this._createPagerNavButton(this.pageFirstText,1,1<d):"{prev}"===f?g=this._createPagerNavButton(this.pagePrevText,d-1,1<d):"{next}"===f?g=this._createPagerNavButton(this.pageNextText,d+1,c>d):"{last}"===f?g=this._createPagerNavButton(this.pageLastText,c,c>d):"{pageIndex}"===f?g=d:"{pageCount}"===f?g=c:"{itemCount}"===f&&(g=e),b.isArray(g)?g.concat([" "]):[g," "]},this))},_createPages:function(){var b=this._pagesCount(),d=this.pageButtonCount,
c=this._firstDisplayingPage,e=[];1<c&&e.push(this._createPagerPageNavButton(this.pageNavigatorPrevText,this.showPrevPages));for(var f=0,g=c;d>f&&b>=g;f++,g++)e.push(g===this.pageIndex?this._createPagerCurrentPage():this._createPagerPage(g));return b>c+d-1&&e.push(this._createPagerPageNavButton(this.pageNavigatorNextText,this.showNextPages)),e},_createPagerNavButton:function(d,c,e){return this._createPagerButton(d,this.pagerNavButtonClass+(e?"":" "+this.pagerNavButtonInactiveClass),e?function(){this.openPage(c)}:
b.noop)},_createPagerPageNavButton:function(b,d){return this._createPagerButton(b,this.pagerNavButtonClass,d)},_createPagerPage:function(b){return this._createPagerButton(b,this.pageClass,function(){this.openPage(b)})},_createPagerButton:function(d,c,e){d=b("<a>").attr("href","javascript:void(0);").html(d).on("click",b.proxy(e,this));return b("<span>").addClass(c).append(d)},_createPagerCurrentPage:function(){return b("<span>").addClass(this.pageClass).addClass(this.currentPageClass).text(this.pageIndex)},
_refreshSize:function(){this._refreshHeight();this._refreshWidth()},_refreshWidth:function(){var b=this._headerGrid,d=this._bodyGrid,c=this.width;"auto"===c&&(b.width("auto"),c=b.outerWidth());b.width("");d.width("");this._container.width(c);c=b.outerWidth();d.width(c)},_scrollBarWidth:function(){var c;return function(){if(c===d){var e=b("<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'></div>"),f=b("<div style='height:100px;'></div>");e.append(f).appendTo("body");
var g=f.innerWidth();e.css("overflow-y","auto");f=f.innerWidth();e.remove();c=g-f}return c}}(),_refreshHeight:function(){var b,d=this._container,c=this._pagerContainer,e=this.height;d.height(e);"auto"!==e&&(e=d.height(),b=this._header.outerHeight(!0),c.parents(d).length&&(b+=c.outerHeight(!0)),this._body.outerHeight(e-b))},showPrevPages:function(){var b=this._firstDisplayingPage,d=this.pageButtonCount;this._firstDisplayingPage=b>d?b-d:1;this._refreshPager()},showNextPages:function(){var b=this._firstDisplayingPage,
d=this.pageButtonCount,c=this._pagesCount();this._firstDisplayingPage=b+2*d>c?c-d+1:b+d;this._refreshPager()},openPage:function(b){1>b||b>this._pagesCount()||(this._setPage(b),this._loadStrategy.openPage(b))},_setPage:function(b){var d=this._firstDisplayingPage,c=this.pageButtonCount;this.pageIndex=b;d>b&&(this._firstDisplayingPage=b);b>d+c-1&&(this._firstDisplayingPage=b-c+1);this._callEventHandler(this.onPageChanged,{pageIndex:b})},_controllerCall:function(d,c,e,f){if(e)return b.Deferred().reject().promise();
this._showLoading();e=this._controller;if(!e||!e[d])throw Error("controller has no method '"+d+"'");return k(e[d](c)).done(b.proxy(f,this)).fail(b.proxy(this._errorHandler,this)).always(b.proxy(this._hideLoading,this))},_errorHandler:function(){this._callEventHandler(this.onError,{args:b.makeArray(arguments)})},_showLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadingTimer=setTimeout(b.proxy(function(){this._loadIndicator.show()},this),this.loadIndicationDelay))},
_hideLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadIndicator.hide())},search:function(b){return this._resetSorting(),this._resetPager(),this.loadData(b)},loadData:function(d){d=d||(this.filtering?this.getFilter():{});b.extend(d,this._loadStrategy.loadParams(),this._sortingParams());var c=this._callEventHandler(this.onDataLoading,{filter:d});return this._controllerCall("loadData",d,c.cancel,function(b){b&&(this._loadStrategy.finishLoad(b),this._callEventHandler(this.onDataLoaded,
{data:b}))})},getFilter:function(){var b={};return this._eachField(function(d){d.filtering&&this._setItemFieldValue(b,d,d.filterValue())}),b},_sortingParams:function(){return this.sorting&&this._sortField?{sortField:this._sortField.name,sortOrder:this._sortOrder}:{}},getSorting:function(){var b=this._sortingParams();return{field:b.sortField,order:b.sortOrder}},clearFilter:function(){var b=this._createFilterRow();return this._filterRow.replaceWith(b),this._filterRow=b,this.search()},insertItem:function(d){var c=
d||this._getValidatedInsertItem();if(!c)return b.Deferred().reject().promise();d=this._callEventHandler(this.onItemInserting,{item:c});return this._controllerCall("insertItem",c,d.cancel,function(b){b=b||c;this._loadStrategy.finishInsert(b);this._callEventHandler(this.onItemInserted,{item:b})})},_getValidatedInsertItem:function(){var b=this._getInsertItem();return this._validateItem(b,this._insertRow)?b:null},_getInsertItem:function(){var b={};return this._eachField(function(d){d.inserting&&this._setItemFieldValue(b,
d,d.insertValue())}),b},_validateItem:function(c,e){var f=[],g={item:c,itemIndex:this._rowIndex(e),row:e};if(this._eachField(function(h){if(h.validate){var k=this._getItemFieldValue(c,h);k!==d&&(k=this._validation.validate(b.extend({value:k,rules:h.validate},g)),this._setCellValidity(e.children().eq(this._visibleFieldIndex(h)),k),k.length&&f.push.apply(f,b.map(k,function(b){return{field:h,message:b}})))}}),!f.length)return!0;var h=b.extend({errors:f},g);return this._callEventHandler(this.onItemInvalid,
h),this.invalidNotify(h),!1},_setCellValidity:function(b,d){b.toggleClass(this.invalidClass,!!d.length).attr("title",d.join("\n"))},clearInsert:function(){var b=this._createInsertRow();this._insertRow.replaceWith(b);this._insertRow=b;this.refresh()},editItem:function(b){b=this.rowByItem(b);b.length&&this._editRow(b)},rowByItem:function(d){return d.jquery||d.nodeType?b(d):this._content.find("tr").filter(function(){return b.data(this,"JSGridItem")===d})},_editRow:function(b){if(this.editing){var d=
b.data("JSGridItem");this._callEventHandler(this.onItemEditing,{row:b,item:d,itemIndex:this._itemIndex(d)}).cancel||(this._editingRow&&this.cancelEdit(),d=this._createEditRow(d),this._editingRow=b,b.hide(),d.insertBefore(b),b.data("JSGridEditRow",d))}},_createEditRow:function(d){if(b.isFunction(this.editRowRenderer))return b(this.renderTemplate(field.editRowRenderer,field,{item:d,itemIndex:this._itemIndex(d)}));var c=b("<tr>").addClass(this.editRowClass);return this._eachField(function(b){var e=this._getItemFieldValue(d,
b);this._prepareCell("<td>",b,"editcss").append(this.renderTemplate(b.editTemplate||"",b,{value:e,item:d})).appendTo(c)}),c},updateItem:function(b,d){1===arguments.length&&(d=b);var c=b?this.rowByItem(b):this._editingRow;return(d=d||this._getValidatedEditedItem())?this._updateRow(c,d):void 0},_getValidatedEditedItem:function(){var b=this._getEditedItem();return this._validateItem(b,this._getEditRow())?b:null},_updateRow:function(d,c){var e=d.data("JSGridItem"),f=this._itemIndex(e),g=b.extend(!0,{},
e);b.extend(!0,e,c);var h=this._callEventHandler(this.onItemUpdating,{row:d,item:e,itemIndex:f,previousItem:g});return this._controllerCall("updateItem",e,h.cancel,function(b){b=b||e;var c=this._finishUpdate(d,b,f);this._callEventHandler(this.onItemUpdated,{row:c,item:b,itemIndex:f,previousItem:g})})},_rowIndex:function(d){return this._content.children().index(b(d))},_itemIndex:function(d){return b.inArray(d,this.data)},_finishUpdate:function(b,d,c){this.cancelEdit();this.data[c]=d;d=this._createRow(d,
c);return b.replaceWith(d),d},_getEditedItem:function(){var b={};return this._eachField(function(d){d.editing&&this._setItemFieldValue(b,d,d.editValue())}),b},cancelEdit:function(){this._editingRow&&(this._getEditRow().remove(),this._editingRow.show(),this._editingRow=null)},_getEditRow:function(){return this._editingRow.data("JSGridEditRow")},deleteItem:function(b){b=this.rowByItem(b);if(b.length&&(!this.confirmDeleting||c.confirm(h(this.deleteConfirm,this,b.data("JSGridItem")))))return this._deleteRow(b)},
_deleteRow:function(b){var d=b.data("JSGridItem"),c=this._itemIndex(d),e=this._callEventHandler(this.onItemDeleting,{row:b,item:d,itemIndex:c});return this._controllerCall("deleteItem",d,e.cancel,function(){this._loadStrategy.finishDelete(d,c);this._callEventHandler(this.onItemDeleted,{row:b,item:d,itemIndex:c})})}};b.fn.jsGrid=function(c){var g=b.makeArray(arguments).slice(1),h=this;return this.each(function(){var k,l=b(this),m=l.data(f);if(m)if("string"==typeof c){if(k=m[c].apply(m,g),k!==d&&k!==
m)return h=k,!1}else m._detachWindowResizeCallback(),m._init(c),m.render();else new e(l,c)}),h};var m={},p={},r=function(d,c){b.each(c,function(c,e){return b.isPlainObject(e)?void r(d[c]||d[c[0].toUpperCase()+c.slice(1)],e):void(d.hasOwnProperty(c)?d[c]=e:d.prototype[c]=e)})};c.jsGrid={Grid:e,fields:m,setDefaults:function(d,c){var f;b.isPlainObject(d)?f=e.prototype:(f=m[d].prototype,d=c||{});b.extend(f,d)},locales:p,locale:function(d){var c=b.isPlainObject(d)?d:p[d];if(!c)throw Error("unknown locale "+
d);r(jsGrid,c)},version:"1.5.2"}}(window,jQuery);
(function(c,b){function d(b){this._init(b)}d.prototype={container:"body",message:"Loading...",shading:!0,zIndex:1E3,shaderClass:"jsgrid-load-shader",loadPanelClass:"jsgrid-load-panel",_init:function(d){b.extend(!0,this,d);this._initContainer();this._initShader();this._initLoadPanel()},_initContainer:function(){this._container=b(this.container)},_initShader:function(){this.shading&&(this._shader=b("<div>").addClass(this.shaderClass).hide().css({position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:this.zIndex}).appendTo(this._container))},
_initLoadPanel:function(){this._loadPanel=b("<div>").addClass(this.loadPanelClass).text(this.message).hide().css({position:"absolute",top:"50%",left:"50%",zIndex:this.zIndex}).appendTo(this._container)},show:function(){var b=this._loadPanel.show(),d=b.outerWidth(),c=b.outerHeight();b.css({marginTop:-c/2,marginLeft:-d/2});this._shader.show()},hide:function(){this._loadPanel.hide();this._shader.hide()}};c.LoadIndicator=d})(jsGrid,jQuery);
(function(c,b){function d(b){this._grid=b}function e(b){this._grid=b;this._itemsCount=0}d.prototype={firstDisplayIndex:function(){var b=this._grid;return b.option("paging")?(b.option("pageIndex")-1)*b.option("pageSize"):0},lastDisplayIndex:function(){var b=this._grid,d=b.option("data").length;return b.option("paging")?Math.min(b.option("pageIndex")*b.option("pageSize"),d):d},itemsCount:function(){return this._grid.option("data").length},openPage:function(){this._grid.refresh()},loadParams:function(){return{}},
sort:function(){return this._grid._sortData(),this._grid.refresh(),b.Deferred().resolve().promise()},reset:function(){return this._grid.refresh(),b.Deferred().resolve().promise()},finishLoad:function(b){this._grid.option("data",b)},finishInsert:function(b){var d=this._grid;d.option("data").push(b);d.refresh()},finishDelete:function(b,d){var c=this._grid;c.option("data").splice(d,1);c.reset()}};e.prototype={firstDisplayIndex:function(){return 0},lastDisplayIndex:function(){return this._grid.option("data").length},
itemsCount:function(){return this._itemsCount},openPage:function(){this._grid.loadData()},loadParams:function(){var b=this._grid;return{pageIndex:b.option("pageIndex"),pageSize:b.option("pageSize")}},reset:function(){return this._grid.loadData()},sort:function(){return this._grid.loadData()},finishLoad:function(b){this._itemsCount=b.itemsCount;this._grid.option("data",b.data)},finishInsert:function(){this._grid.search()},finishDelete:function(){this._grid.search()}};c.loadStrategies={DirectLoadingStrategy:d,
PageLoadingStrategy:e}})(jsGrid,jQuery);(function(c){var b=function(b){return"undefined"!=typeof b&&null!==b};c.sortStrategies={string:function(d,c){return b(d)||b(c)?b(d)?b(c)?(""+d).localeCompare(""+c):1:-1:0},number:function(b,c){return b-c},date:function(b,c){return b-c},numberAsString:function(b,c){return parseFloat(b)-parseFloat(c)}}})(jsGrid,jQuery);
(function(c,b,d){function e(b){this._init(b)}e.prototype={_init:function(d){b.extend(!0,this,d)},validate:function(d){var c=[];return b.each(this._normalizeRules(d.rules),function(e,f){if(!f.validator(d.value,d.item,f.param)){var m=b.isFunction(f.message)?f.message(d.value,d.item):f.message;c.push(m)}}),c},_normalizeRules:function(d){return b.isArray(d)||(d=[d]),b.map(d,b.proxy(function(b){return this._normalizeRule(b)},this))},_normalizeRule:function(d){if("string"==typeof d&&(d={validator:d}),b.isFunction(d)&&
(d={validator:d}),!b.isPlainObject(d))throw Error("wrong validation config specified");return d=b.extend({},d),b.isFunction(d.validator)?d:this._applyNamedValidator(d,d.validator)},_applyNamedValidator:function(d,c){delete d.validator;var e=f[c];if(!e)throw Error('unknown validator "'+c+'"');return b.isFunction(e)&&(e={validator:e}),b.extend({},e,d)}};c.Validation=e;var f={required:{message:"Field is required",validator:function(b){return b!==d&&null!==b&&""!==b}},rangeLength:{message:"Field value length is out of the defined range",
validator:function(b,d,c){return b.length>=c[0]&&b.length<=c[1]}},minLength:{message:"Field value is too short",validator:function(b,d,c){return b.length>=c}},maxLength:{message:"Field value is too long",validator:function(b,d,c){return b.length<=c}},pattern:{message:"Field value is not matching the defined pattern",validator:function(b,d,c){return"string"==typeof c&&(c=new RegExp("^(?:"+c+")$")),c.test(b)}},range:{message:"Field value is out of the defined range",validator:function(b,d,c){return b>=
c[0]&&b<=c[1]}},min:{message:"Field value is too small",validator:function(b,d,c){return b>=c}},max:{message:"Field value is too large",validator:function(b,d,c){return c>=b}}};c.validators=f})(jsGrid,jQuery);
(function(c,b,d){function e(d){b.extend(!0,this,d);this.sortingFunc=this._getSortingFunc()}e.prototype={name:"",title:null,css:"",align:"",width:100,visible:!0,filtering:!0,inserting:!0,editing:!0,sorting:!0,sorter:"string",headerTemplate:function(){return this.title===d||null===this.title?this.name:this.title},itemTemplate:function(b){return b},filterTemplate:function(){return""},insertTemplate:function(){return""},editTemplate:function(b,d){return this._value=b,this.itemTemplate(b,d)},filterValue:function(){return""},
insertValue:function(){return""},editValue:function(){return this._value},_getSortingFunc:function(){var d=this.sorter;if(b.isFunction(d))return d;if("string"==typeof d)return c.sortStrategies[d];throw Error('wrong sorter for the field "'+this.name+'"!');}};c.Field=e})(jsGrid,jQuery);
(function(c,b){function d(b){e.call(this,b)}var e=c.Field;d.prototype=new e({autosearch:!0,readOnly:!1,filterTemplate:function(){if(!this.filtering)return"";var b=this._grid,d=this.filterControl=this._createTextBox();return this.autosearch&&d.on("keypress",function(d){13===d.which&&(b.search(),d.preventDefault())}),d},insertTemplate:function(){return this.inserting?this.insertControl=this._createTextBox():""},editTemplate:function(b){if(!this.editing)return this.itemTemplate(b);var d=this.editControl=
this._createTextBox();return d.val(b),d},filterValue:function(){return this.filterControl.val()},insertValue:function(){return this.insertControl.val()},editValue:function(){return this.editControl.val()},_createTextBox:function(){return b("<input>").attr("type","text").prop("readonly",!!this.readOnly)}});c.fields.text=c.TextField=d})(jsGrid,jQuery);
(function(c,b){function d(b){e.call(this,b)}var e=c.TextField;d.prototype=new e({sorter:"number",align:"right",readOnly:!1,filterValue:function(){return parseInt(this.filterControl.val()||0,10)},insertValue:function(){return parseInt(this.insertControl.val()||0,10)},editValue:function(){return parseInt(this.editControl.val()||0,10)},_createTextBox:function(){return b("<input>").attr("type","number").prop("readonly",!!this.readOnly)}});c.fields.number=c.NumberField=d})(jsGrid,jQuery);
(function(c,b){function d(b){e.call(this,b)}var e=c.TextField;d.prototype=new e({insertTemplate:function(){return this.inserting?this.insertControl=this._createTextArea():""},editTemplate:function(b){if(!this.editing)return this.itemTemplate(b);var d=this.editControl=this._createTextArea();return d.val(b),d},_createTextArea:function(){return b("<textarea>").prop("readonly",!!this.readOnly)}});c.fields.textarea=c.TextAreaField=d})(jsGrid,jQuery);
(function(c,b,d){function e(b){if(this.items=[],this.selectedIndex=-1,this.valueField="",this.textField="",b.valueField&&b.items.length)this.valueType=typeof b.items[0][b.valueField]===g?g:h;this.sorter=this.valueType;f.call(this,b)}var f=c.NumberField,g="number",h="string";e.prototype=new f({align:"center",valueType:g,itemTemplate:function(c){var e;e=this.items;var f=this.valueField,g=this.textField;e=f?b.grep(e,function(b){return b[f]===c})[0]||{}:e[c];g=g?e[g]:e;return g===d||null===g?"":g},filterTemplate:function(){if(!this.filtering)return"";
var b=this._grid,d=this.filterControl=this._createSelect();return this.autosearch&&d.on("change",function(){b.search()}),d},insertTemplate:function(){return this.inserting?this.insertControl=this._createSelect():""},editTemplate:function(b){if(!this.editing)return this.itemTemplate(b);var c=this.editControl=this._createSelect();return b!==d&&c.val(b),c},filterValue:function(){var b=this.filterControl.val();return this.valueType===g?parseInt(b||0,10):b},insertValue:function(){var b=this.insertControl.val();
return this.valueType===g?parseInt(b||0,10):b},editValue:function(){var b=this.editControl.val();return this.valueType===g?parseInt(b||0,10):b},_createSelect:function(){var d=b("<select>"),c=this.valueField,e=this.textField,f=this.selectedIndex;return b.each(this.items,function(g,h){var q=c?h[c]:g,t=e?h[e]:h;b("<option>").attr("value",q).text(t).appendTo(d).prop("selected",f===g)}),d.prop("disabled",!!this.readOnly),d}});c.fields.select=c.SelectField=e})(jsGrid,jQuery);
(function(c,b,d){function e(b){f.call(this,b)}var f=c.Field;e.prototype=new f({sorter:"number",align:"center",autosearch:!0,itemTemplate:function(b){return this._createCheckbox().prop({checked:b,disabled:!0})},filterTemplate:function(){if(!this.filtering)return"";var d=this._grid,c=this.filterControl=this._createCheckbox();return c.prop({readOnly:!0,indeterminate:!0}),c.on("click",function(){var d=b(this);d.prop("readOnly")?d.prop({checked:!1,readOnly:!1}):d.prop("checked")||d.prop({readOnly:!0,indeterminate:!0})}),
this.autosearch&&c.on("click",function(){d.search()}),c},insertTemplate:function(){return this.inserting?this.insertControl=this._createCheckbox():""},editTemplate:function(b){if(!this.editing)return this.itemTemplate(b);var d=this.editControl=this._createCheckbox();return d.prop("checked",b),d},filterValue:function(){return this.filterControl.get(0).indeterminate?d:this.filterControl.is(":checked")},insertValue:function(){return this.insertControl.is(":checked")},editValue:function(){return this.editControl.is(":checked")},
_createCheckbox:function(){return b("<input>").attr("type","checkbox")}});c.fields.checkbox=c.CheckboxField=e})(jsGrid,jQuery);
(function(c,b){function d(b){e.call(this,b);this._configInitialized=!1}var e=c.Field;d.prototype=new e({css:"jsgrid-control-field",align:"center",width:50,filtering:!1,inserting:!1,editing:!1,sorting:!1,buttonClass:"jsgrid-button",modeButtonClass:"jsgrid-mode-button",modeOnButtonClass:"jsgrid-mode-on-button",searchModeButtonClass:"jsgrid-search-mode-button",insertModeButtonClass:"jsgrid-insert-mode-button",editButtonClass:"jsgrid-edit-button",deleteButtonClass:"jsgrid-delete-button",searchButtonClass:"jsgrid-search-button",
clearFilterButtonClass:"jsgrid-clear-filter-button",insertButtonClass:"jsgrid-insert-button",updateButtonClass:"jsgrid-update-button",cancelEditButtonClass:"jsgrid-cancel-edit-button",searchModeButtonTooltip:"Switch to searching",insertModeButtonTooltip:"Switch to inserting",editButtonTooltip:"Edit",deleteButtonTooltip:"Delete",searchButtonTooltip:"Search",clearFilterButtonTooltip:"Clear filter",insertButtonTooltip:"Insert",updateButtonTooltip:"Update",cancelEditButtonTooltip:"Cancel edit",editButton:!0,
deleteButton:!0,clearFilterButton:!0,modeSwitchButton:!0,_initConfig:function(){this._hasFiltering=this._grid.filtering;(this._hasInserting=this._grid.inserting)&&this.modeSwitchButton&&(this._grid.inserting=!1);this._configInitialized=!0},headerTemplate:function(){this._configInitialized||this._initConfig();var b=this._hasFiltering,d=this._hasInserting;return this.modeSwitchButton&&(b||d)?b&&!d?this._createFilterSwitchButton():d&&!b?this._createInsertSwitchButton():this._createModeSwitchButton():
""},itemTemplate:function(d,c){var e=b([]);return this.editButton&&(e=e.add(this._createEditButton(c))),this.deleteButton&&(e=e.add(this._createDeleteButton(c))),e},filterTemplate:function(){var b=this._createSearchButton();return this.clearFilterButton?b.add(this._createClearFilterButton()):b},insertTemplate:function(){return this._createInsertButton()},editTemplate:function(){return this._createUpdateButton().add(this._createCancelEditButton())},_createFilterSwitchButton:function(){return this._createOnOffSwitchButton("filtering",
this.searchModeButtonClass,!0)},_createInsertSwitchButton:function(){return this._createOnOffSwitchButton("inserting",this.insertModeButtonClass,!1)},_createOnOffSwitchButton:function(d,c,e){var k=e,l=b.proxy(function(){m.toggleClass(this.modeOnButtonClass,k)},this),m=this._createGridButton(this.modeButtonClass+" "+c,"",function(b){k=!k;b.option(d,k);l()});return l(),m},_createModeSwitchButton:function(){var d=!1,c=b.proxy(function(){e.attr("title",d?this.searchModeButtonTooltip:this.insertModeButtonTooltip).toggleClass(this.insertModeButtonClass,
!d).toggleClass(this.searchModeButtonClass,d)},this),e=this._createGridButton(this.modeButtonClass,"",function(b){d=!d;b.option("inserting",d);b.option("filtering",!d);c()});return c(),e},_createEditButton:function(b){return this._createGridButton(this.editButtonClass,this.editButtonTooltip,function(d,c){d.editItem(b);c.stopPropagation()})},_createDeleteButton:function(b){return this._createGridButton(this.deleteButtonClass,this.deleteButtonTooltip,function(d,c){d.deleteItem(b);c.stopPropagation()})},
_createSearchButton:function(){return this._createGridButton(this.searchButtonClass,this.searchButtonTooltip,function(b){b.search()})},_createClearFilterButton:function(){return this._createGridButton(this.clearFilterButtonClass,this.clearFilterButtonTooltip,function(b){b.clearFilter()})},_createInsertButton:function(){return this._createGridButton(this.insertButtonClass,this.insertButtonTooltip,function(b){b.insertItem().done(function(){b.clearInsert()})})},_createUpdateButton:function(){return this._createGridButton(this.updateButtonClass,
this.updateButtonTooltip,function(b,d){b.updateItem();d.stopPropagation()})},_createCancelEditButton:function(){return this._createGridButton(this.cancelEditButtonClass,this.cancelEditButtonTooltip,function(b,d){b.cancelEdit();d.stopPropagation()})},_createGridButton:function(d,c,e){var k=this._grid;return b("<input>").addClass(this.buttonClass).addClass(d).attr({type:"button",title:c}).on("click",function(b){e(k,b)})},editValue:function(){return""}});c.fields.control=c.ControlField=d})(jsGrid,jQuery);
var oldBrowser=document.all&&!document.addEventListener;
oldBrowser||function(c,b){function d(b){var d=Ca[b]={};return n.each(b.split(da),function(b,c){d[c]=!0}),d}function e(d,c,e){if(e===b&&1===d.nodeType)if(e="data-"+c.replace(Ya,"-$1").toLowerCase(),"string"==typeof(e=d.getAttribute(e))){try{e="true"===e||"false"!==e&&("null"===e?null:+e+""===e?+e:Za.test(e)?n.parseJSON(e):e)}catch(f){}n.data(d,c,e)}else e=b;return e}function f(b){for(var d in b)if(("data"!==d||!n.isEmptyObject(b[d]))&&"toJSON"!==d)return!1;return!0}function g(){return!1}function h(){return!0}
function k(b){return!b||!b.parentNode||11===b.parentNode.nodeType}function l(b,d){do b=b[d];while(b&&1!==b.nodeType);return b}function m(b,d,c){if(d=d||0,n.isFunction(d))return n.grep(b,function(b,e){return!!d.call(b,e,b)===c});if(d.nodeType)return n.grep(b,function(b,e){return b===d===c});if("string"==typeof d){var e=n.grep(b,function(b){return 1===b.nodeType});if($a.test(d))return n.filter(d,e,!c);d=n.filter(d,e)}return n.grep(b,function(b,e){return 0<=n.inArray(b,d)===c})}function p(b){var d=Da.split("|");
b=b.createDocumentFragment();if(b.createElement)for(;d.length;)b.createElement(d.pop());return b}function r(b,d){return b.getElementsByTagName(d)[0]||b.appendChild(b.ownerDocument.createElement(d))}function u(b,d){if(1===d.nodeType&&n.hasData(b)){var c,e,f;e=n._data(b);var g=n._data(d,e),h=e.events;if(h)for(c in delete g.handle,g.events={},h)for(e=0,f=h[c].length;e<f;e++)n.event.add(d,c,h[c][e]);g.data&&(g.data=n.extend({},g.data))}}function q(b,d){var c;1===d.nodeType&&(d.clearAttributes&&d.clearAttributes(),
d.mergeAttributes&&d.mergeAttributes(b),c=d.nodeName.toLowerCase(),"object"===c?(d.parentNode&&(d.outerHTML=b.outerHTML),n.support.html5Clone&&b.innerHTML&&!n.trim(d.innerHTML)&&(d.innerHTML=b.innerHTML)):"input"===c&&Ea.test(b.type)?(d.defaultChecked=d.checked=b.checked,d.value!==b.value&&(d.value=b.value)):"option"===c?d.selected=b.defaultSelected:"input"===c||"textarea"===c?d.defaultValue=b.defaultValue:"script"===c&&d.text!==b.text&&(d.text=b.text),d.removeAttribute(n.expando))}function t(b){return void 0!==
b.getElementsByTagName?b.getElementsByTagName("*"):void 0!==b.querySelectorAll?b.querySelectorAll("*"):[]}function v(b){Ea.test(b.type)&&(b.defaultChecked=b.checked)}function w(b,d){if(d in b)return d;for(var c=d.charAt(0).toUpperCase()+d.slice(1),e=d,f=Fa.length;f--;)if((d=Fa[f]+c)in b)return d;return e}function y(b,d){return b=d||b,"none"===n.css(b,"display")||!n.contains(b.ownerDocument,b)}function A(b,d){for(var c,e,f=[],g=0,h=b.length;g<h;g++)c=b[g],c.style&&(f[g]=n._data(c,"olddisplay"),d?(f[g]||
"none"!==c.style.display||(c.style.display=""),""===c.style.display&&y(c)&&(f[g]=n._data(c,"olddisplay",H(c.nodeName)))):(e=M(c,"display"),f[g]||"none"===e||n._data(c,"olddisplay",e)));for(g=0;g<h;g++)c=b[g],c.style&&(d&&"none"!==c.style.display&&""!==c.style.display||(c.style.display=d?f[g]||"":"none"));return b}function F(b,d,c){return(b=ab.exec(d))?Math.max(0,b[1]-(c||0))+(b[2]||"px"):d}function C(b,d,c,e){d=c===(e?"border":"content")?4:"width"===d?1:0;for(var f=0;4>d;d+=2)"margin"===c&&(f+=n.css(b,
c+aa[d],!0)),e?("content"===c&&(f-=parseFloat(M(b,"padding"+aa[d]))||0),"margin"!==c&&(f-=parseFloat(M(b,"border"+aa[d]+"Width"))||0)):(f+=parseFloat(M(b,"padding"+aa[d]))||0,"padding"!==c&&(f+=parseFloat(M(b,"border"+aa[d]+"Width"))||0));return f}function G(b,d,c){var e="width"===d?b.offsetWidth:b.offsetHeight,f=!0,g=n.support.boxSizing&&"border-box"===n.css(b,"boxSizing");if(0>=e||null==e){if(e=M(b,d),(0>e||null==e)&&(e=b.style[d]),oa.test(e))return e;f=g&&(n.support.boxSizingReliable||e===b.style[d]);
e=parseFloat(e)||0}return e+C(b,d,c||(g?"border":"content"),f)+"px"}function H(b){if(va[b])return va[b];var d=n("<"+b+">").appendTo(z.body),c=d.css("display");return d.remove(),"none"!==c&&""!==c||(ia=z.body.appendChild(ia||n.extend(z.createElement("iframe"),{frameBorder:0,width:0,height:0})),ja&&ia.createElement||(ja=(ia.contentWindow||ia.contentDocument).document,ja.write("<!doctype html><html><body>"),ja.close()),d=ja.body.appendChild(ja.createElement(b)),c=M(d,"display"),z.body.removeChild(ia)),
va[b]=c,c}function E(b,d,c,e){var f;if(n.isArray(d))n.each(d,function(d,f){c||bb.test(b)?e(b,f):E(b+"["+("object"==typeof f?d:"")+"]",f,c,e)});else if(c||"object"!==n.type(d))e(b,d);else for(f in d)E(b+"["+f+"]",d[f],c,e)}function B(){return setTimeout(function(){ka=b},0),ka=n.now()}function T(b,d){n.each(d,function(d,c){for(var e=(ma[d]||[]).concat(ma["*"]),f=0,g=e.length;f<g&&!e[f].call(b,d,c);f++);})}function S(b,d,c){var e=0,f=pa.length,g=n.Deferred().always(function(){delete h.elem}),h=function(){for(var d=
ka||B(),d=Math.max(0,q.startTime+q.duration-d),c=1-(d/q.duration||0),e=0,f=q.tweens.length;e<f;e++)q.tweens[e].run(c);return g.notifyWith(b,[q,c,d]),1>c&&f?d:(g.resolveWith(b,[q]),!1)},q=g.promise({elem:b,props:n.extend({},d),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:d,originalOptions:c,startTime:ka||B(),duration:c.duration,tweens:[],createTween:function(d,c,e){d=n.Tween(b,q.opts,d,c,q.opts.specialEasing[d]||q.opts.easing);return q.tweens.push(d),d},stop:function(d){for(var c=0,e=
d?q.tweens.length:0;c<e;c++)q.tweens[c].run(1);return d?g.resolveWith(b,[q,d]):g.rejectWith(b,[q,d]),this}});c=q.props;for(X(c,q.opts.specialEasing);e<f;e++)if(d=pa[e].call(q,b,c,q.opts))return d;return T(q,c),n.isFunction(q.opts.start)&&q.opts.start.call(b,q),n.fx.timer(n.extend(h,{anim:q,queue:q.opts.queue,elem:b})),q.progress(q.opts.progress).done(q.opts.done,q.opts.complete).fail(q.opts.fail).always(q.opts.always)}function X(b,d){var c,e,f,g,h;for(c in b)if(e=n.camelCase(c),f=d[e],g=b[c],n.isArray(g)&&
(f=g[1],g=b[c]=g[0]),c!==e&&(b[e]=g,delete b[c]),(h=n.cssHooks[e])&&"expand"in h)for(c in g=h.expand(g),delete b[e],g)c in b||(b[c]=g[c],d[c]=f);else d[e]=f}function D(b,d,c,e,f){return new D.prototype.init(b,d,c,e,f)}function R(b,d){var c,e={height:b},f=0;for(d=d?1:0;4>f;f+=2-d)c=aa[f],e["margin"+c]=e["padding"+c]=b;return d&&(e.opacity=e.width=b),e}function Y(b){return n.isWindow(b)?b:9===b.nodeType&&(b.defaultView||b.parentWindow)}var V,N,z=c.document,W=(c.location,c.navigator),K=c.JQXLite,L=c.$,
O=Array.prototype.push,I=Array.prototype.slice,Z=Array.prototype.indexOf,ea=Object.prototype.toString,U=Object.prototype.hasOwnProperty,la=String.prototype.trim,n=function(b,d){return new n.fn.init(b,d,V)},fa=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,ha=/\S/,da=/\s+/,J=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,qa=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,P=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,wa=/^[\],:{}\s]*$/,na=/(?:^|:|,)(?:\s*\[)+/g,ra=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,xa=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,
sa=/^-ms-/,ba=/-([\da-z])/gi,cb=function(b,d){return(d+"").toUpperCase()},ta=function(){z.addEventListener?(z.removeEventListener("DOMContentLoaded",ta,!1),n.ready()):"complete"===z.readyState&&(z.detachEvent("onreadystatechange",ta),n.ready())},Ga={};n.fn=n.prototype={constructor:n,init:function(d,c,e){var f,g,h;if(!d)return this;if(d.nodeType)return this.context=this[0]=d,this.length=1,this;if("string"==typeof d){if(!(f="<"===d.charAt(0)&&">"===d.charAt(d.length-1)&&3<=d.length?[null,d,null]:qa.exec(d))||
!f[1]&&c)return!c||c.jqx?(c||e).find(d):this.constructor(c).find(d);if(f[1])return c=c instanceof n?c[0]:c,h=c&&c.nodeType?c.ownerDocument||c:z,d=n.parseHTML(f[1],h,!0),P.test(f[1])&&n.isPlainObject(c)&&this.attr.call(d,c,!0),n.merge(this,d);if((g=z.getElementById(f[2]))&&g.parentNode){if(g.id!==f[2])return e.find(d);this.length=1;this[0]=g}return this.context=z,this.selector=d,this}return n.isFunction(d)?e.ready(d):(d.selector!==b&&(this.selector=d.selector,this.context=d.context),n.makeArray(d,
this))},selector:"",jqx:"4.5.0",length:0,size:function(){return this.length},toArray:function(){return I.call(this)},get:function(b){return null==b?this.toArray():0>b?this[this.length+b]:this[b]},pushStack:function(b,d,c){b=n.merge(this.constructor(),b);return b.prevObject=this,b.context=this.context,"find"===d?b.selector=this.selector+(this.selector?" ":"")+c:d&&(b.selector=this.selector+"."+d+"("+c+")"),b},each:function(b,d){return n.each(this,b,d)},ready:function(b){return n.ready.promise().done(b),
this},eq:function(b){return b=+b,-1===b?this.slice(b):this.slice(b,b+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(I.apply(this,arguments),"slice",I.call(arguments).join(","))},map:function(b){return this.pushStack(n.map(this,function(d,c){return b.call(d,c,d)}))},end:function(){return this.prevObject||this.constructor(null)},push:O,sort:[].sort,splice:[].splice};n.fn.init.prototype=n.fn;n.extend=n.fn.extend=function(){var d,c,e,
f,g,h,q=arguments[0]||{},k=1,t=arguments.length,l=!1;"boolean"==typeof q&&(l=q,q=arguments[1]||{},k=2);"object"==typeof q||n.isFunction(q)||(q={});for(t===k&&(q=this,--k);k<t;k++)if(null!=(d=arguments[k]))for(c in d)e=q[c],f=d[c],q!==f&&(l&&f&&(n.isPlainObject(f)||(g=n.isArray(f)))?(g?(g=!1,h=e&&n.isArray(e)?e:[]):h=e&&n.isPlainObject(e)?e:{},q[c]=n.extend(l,h,f)):f!==b&&(q[c]=f));return q};n.extend({noConflict:function(b){return c.$===n&&(c.$=L),b&&c.JQXLite===n&&(c.JQXLite=K),n},isReady:!1,readyWait:1,
holdReady:function(b){b?n.readyWait++:n.ready(!0)},ready:function(b){if(!0===b?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready,1);n.isReady=!0;!0!==b&&0<--n.readyWait||(N.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger("ready").off("ready"))}},isFunction:function(b){return"function"===n.type(b)},isArray:Array.isArray||function(b){return"array"===n.type(b)},isWindow:function(b){return null!=b&&b==b.window},isNumeric:function(b){return!isNaN(parseFloat(b))&&isFinite(b)},type:function(b){return null==
b?String(b):Ga[ea.call(b)]||"object"},isPlainObject:function(d){if(!d||"object"!==n.type(d)||d.nodeType||n.isWindow(d))return!1;try{if(d.constructor&&!U.call(d,"constructor")&&!U.call(d.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var e in d);return e===b||U.call(d,e)},isEmptyObject:function(b){for(var d in b)return!1;return!0},error:function(b){throw Error(b);},parseHTML:function(b,d,c){var e;return b&&"string"==typeof b?("boolean"==typeof d&&(c=d,d=0),d=d||z,(e=P.exec(b))?
[d.createElement(e[1])]:(e=n.buildFragment([b],d,c?null:[]),n.merge([],(e.cacheable?n.clone(e.fragment):e.fragment).childNodes))):null},parseJSON:function(b){return b&&"string"==typeof b?(b=n.trim(b),c.JSON&&c.JSON.parse?c.JSON.parse(b):wa.test(b.replace(ra,"@").replace(xa,"]").replace(na,""))?(new Function("return "+b))():void n.error("Invalid JSON: "+b)):null},parseXML:function(d){var e,f;if(!d||"string"!=typeof d)return null;try{c.DOMParser?(f=new DOMParser,e=f.parseFromString(d,"text/xml")):(e=
new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(d))}catch(g){e=b}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+d),e},noop:function(){},globalEval:function(b){b&&ha.test(b)&&(c.execScript||function(b){c.eval.call(c,b)})(b)},camelCase:function(b){return b.replace(sa,"ms-").replace(ba,cb)},nodeName:function(b,d){return b.nodeName&&b.nodeName.toLowerCase()===d.toLowerCase()},each:function(d,c,e){var f,g=0,h=d.length,q=h===b||n.isFunction(d);
if(e)if(q)for(f in d){if(!1===c.apply(d[f],e))break}else for(;g<h&&!1!==c.apply(d[g++],e););else if(q)for(f in d){if(!1===c.call(d[f],f,d[f]))break}else for(;g<h&&!1!==c.call(d[g],g,d[g++]););return d},trim:la&&!la.call("\ufeff\u00a0")?function(b){return null==b?"":la.call(b)}:function(b){return null==b?"":(b+"").replace(J,"")},makeArray:function(b,d){var c,e=d||[];return null!=b&&(c=n.type(b),null==b.length||"string"===c||"function"===c||"regexp"===c||n.isWindow(b)?O.call(e,b):n.merge(e,b)),e},inArray:function(b,
d,c){var e;if(d){if(Z)return Z.call(d,b,c);e=d.length;for(c=c?0>c?Math.max(0,e+c):c:0;c<e;c++)if(c in d&&d[c]===b)return c}return-1},merge:function(d,c){var e=c.length,f=d.length,g=0;if("number"==typeof e)for(;g<e;g++)d[f++]=c[g];else for(;c[g]!==b;)d[f++]=c[g++];return d.length=f,d},grep:function(b,d,c){var e,f=[],g=0,h=b.length;for(c=!!c;g<h;g++)e=!!d(b[g],g),c!==e&&f.push(b[g]);return f},map:function(d,c,e){var f,g,h=[],q=0,k=d.length;if(d instanceof n||k!==b&&"number"==typeof k&&(0<k&&d[0]&&d[k-
1]||0===k||n.isArray(d)))for(;q<k;q++)null!=(f=c(d[q],q,e))&&(h[h.length]=f);else for(g in d)null!=(f=c(d[g],g,e))&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(d,c){var e,f,g;return"string"==typeof c&&(e=d[c],c=d,d=e),n.isFunction(d)?(f=I.call(arguments,2),g=function(){return d.apply(c,f.concat(I.call(arguments)))},g.guid=d.guid=d.guid||n.guid++,g):b},access:function(d,c,e,f,g,h,q){var k,t=null==e,l=0,v=d.length;if(e&&"object"==typeof e){for(l in e)n.access(d,c,l,e[l],1,h,f);
g=1}else if(f!==b){if(k=q===b&&n.isFunction(f),t&&(k?(k=c,c=function(b,d,c){return k.call(n(b),c)}):(c.call(d,f),c=null)),c)for(;l<v;l++)c(d[l],e,k?f.call(d[l],l,c(d[l],e)):f,q);g=1}return g?d:t?c.call(d):v?c(d[0],e):h},now:function(){return(new Date).getTime()}});n.ready.promise=function(b){if(!N)if(N=n.Deferred(),"complete"===z.readyState)setTimeout(n.ready,1);else if(z.addEventListener)z.addEventListener("DOMContentLoaded",ta,!1),c.addEventListener("load",n.ready,!1);else{z.attachEvent("onreadystatechange",
ta);c.attachEvent("onload",n.ready);var d=!1;try{d=null==c.frameElement&&z.documentElement}catch(e){}d&&d.doScroll&&function Xa(){if(!n.isReady){try{d.doScroll("left")}catch(b){return setTimeout(Xa,50)}n.ready()}}()}return N.promise(b)};n.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b,d){Ga["[object "+d+"]"]=d.toLowerCase()});V=n(z);var Ca={};n.Callbacks=function(c){c="string"==typeof c?Ca[c]||d(c):n.extend({},c);var e,f,g,h,q,k,t=[],l=!c.once&&[],v=function(b){e=
c.memory&&b;f=!0;k=h||0;h=0;q=t.length;for(g=!0;t&&k<q;k++)if(!1===t[k].apply(b[0],b[1])&&c.stopOnFalse){e=!1;break}g=!1;t&&(l?l.length&&v(l.shift()):e?t=[]:m.disable())},m={add:function(){if(t){var b=t.length;!function db(b){n.each(b,function(b,d){var e=n.type(d);"function"===e?c.unique&&m.has(d)||t.push(d):d&&d.length&&"string"!==e&&db(d)})}(arguments);g?q=t.length:e&&(h=b,v(e))}return this},remove:function(){return t&&n.each(arguments,function(b,d){for(var c;-1<(c=n.inArray(d,t,c));)t.splice(c,
1),g&&(c<=q&&q--,c<=k&&k--)}),this},has:function(b){return-1<n.inArray(b,t)},empty:function(){return t=[],this},disable:function(){return t=l=e=b,this},disabled:function(){return!t},lock:function(){return l=b,e||m.disable(),this},locked:function(){return!l},fireWith:function(b,d){return d=d||[],d=[b,d.slice?d.slice():d],!t||f&&!l||(g?l.push(d):v(d)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!f}};return m};n.extend({Deferred:function(b){var d=[["resolve",
"done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",e={state:function(){return c},always:function(){return f.done(arguments).fail(arguments),this},then:function(){var b=arguments;return n.Deferred(function(c){n.each(d,function(d,e){var g=e[0],h=b[d];f[e[1]](n.isFunction(h)?function(){var b=h.apply(this,arguments);b&&n.isFunction(b.promise)?b.promise().done(c.resolve).fail(c.reject).progress(c.notify):
c[g+"With"](this===f?c:this,[b])}:c[g])});b=null}).promise()},promise:function(b){return null!=b?n.extend(b,e):e}},f={};return e.pipe=e.then,n.each(d,function(b,g){var h=g[2],q=g[3];e[g[1]]=h.add;q&&h.add(function(){c=q},d[1^b][2].disable,d[2][2].lock);f[g[0]]=h.fire;f[g[0]+"With"]=h.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(b){var d,c,e,f=0,g=I.call(arguments),h=g.length,q=1!==h||b&&n.isFunction(b.promise)?h:0,k=1===q?b:n.Deferred(),t=function(b,c,e){return function(f){c[b]=this;e[b]=
1<arguments.length?I.call(arguments):f;e===d?k.notifyWith(c,e):--q||k.resolveWith(c,e)}};if(1<h)for(d=Array(h),c=Array(h),e=Array(h);f<h;f++)g[f]&&n.isFunction(g[f].promise)?g[f].promise().done(t(f,e,g)).fail(k.reject).progress(t(f,c,d)):--q;return q||k.resolveWith(e,g),k.promise()}});n.support=function(){var b,d,e,f,g,h,q,k,t,l=z.createElement("div");if(l.setAttribute("className","t"),l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=l.getElementsByTagName("*"),e=
l.getElementsByTagName("a")[0],!d||!e||!d.length)return{};d=z.createElement("select");f=d.appendChild(z.createElement("option"));g=l.getElementsByTagName("input")[0];e.style.cssText="top:1px;float:left;opacity:.5";b={leadingWhitespace:3===l.firstChild.nodeType,tbody:!l.getElementsByTagName("tbody").length,htmlSerialize:!!l.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:"/a"===e.getAttribute("href"),opacity:/^0.5/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,
checkOn:"on"===g.value,optSelected:f.selected,getSetAttribute:"t"!==l.className,enctype:!!z.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==z.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===z.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1};g.checked=!0;b.noCloneChecked=g.cloneNode(!0).checked;d.disabled=!0;b.optDisabled=
!f.disabled;try{delete l.test}catch(v){b.deleteExpando=!1}if(!l.addEventListener&&l.attachEvent&&l.fireEvent&&(l.attachEvent("onclick",t=function(){b.noCloneEvent=!1}),l.cloneNode(!0).fireEvent("onclick"),l.detachEvent("onclick",t)),g=z.createElement("input"),g.value="t",g.setAttribute("type","radio"),b.radioValue="t"===g.value,g.setAttribute("checked","checked"),g.setAttribute("name","t"),l.appendChild(g),h=z.createDocumentFragment(),h.appendChild(l.lastChild),b.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked,
b.appendChecked=g.checked,h.removeChild(g),h.appendChild(l),l.attachEvent)for(q in{submit:!0,change:!0,focusin:!0})e="on"+q,(k=e in l)||(l.setAttribute(e,"return;"),k="function"==typeof l[e]),b[q+"Bubbles"]=k;return n(function(){var d,e,f,g,h=z.getElementsByTagName("body")[0];h&&(d=z.createElement("div"),d.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",h.insertBefore(d,h.firstChild),e=z.createElement("div"),d.appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",
f=e.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",k=0===f[0].offsetHeight,f[0].style.display="",f[1].style.display="none",b.reliableHiddenOffsets=k&&0===f[0].offsetHeight,e.innerHTML="",e.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=4===e.offsetWidth,b.doesNotIncludeMarginInBodyOffset=1!==h.offsetTop,c.getComputedStyle&&
(b.pixelPosition="1%"!==(c.getComputedStyle(e,null)||{}).top,b.boxSizingReliable="4px"===(c.getComputedStyle(e,null)||{width:"4px"}).width,g=z.createElement("div"),g.style.cssText=e.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;",g.style.marginRight=g.style.width="0",e.style.width="1px",e.appendChild(g),b.reliableMarginRight=!parseFloat((c.getComputedStyle(g,null)||{}).marginRight)),void 0!==e.style.zoom&&(e.innerHTML="",e.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;width:1px;padding:1px;display:inline;zoom:1",
b.inlineBlockNeedsLayout=3===e.offsetWidth,e.style.display="block",e.style.overflow="visible",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==e.offsetWidth,d.style.zoom=1),h.removeChild(d))}),h.removeChild(l),d=e=d=f=g=h=l=null,b}();var Za=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ya=/([A-Z])/g;n.extend({cache:{},deletedIds:[],uuid:0,expando:"JQXLite"+(n.fn.jqx+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(b){return!!(b=
b.nodeType?n.cache[b[n.expando]]:b[n.expando])&&!f(b)},data:function(d,c,e,f){if(n.acceptData(d)){var g,h,q=n.expando,k="string"==typeof c,t=d.nodeType,l=t?n.cache:d,v=t?d[q]:d[q]&&q;if(v&&l[v]&&(f||l[v].data)||!k||e!==b)return v||(t?d[q]=v=n.deletedIds.pop()||n.guid++:v=q),l[v]||(l[v]={},t||(l[v].toJSON=n.noop)),"object"!=typeof c&&"function"!=typeof c||(f?l[v]=n.extend(l[v],c):l[v].data=n.extend(l[v].data,c)),g=l[v],f||(g.data||(g.data={}),g=g.data),e!==b&&(g[n.camelCase(c)]=e),k?null==(h=g[c])&&
(h=g[n.camelCase(c)]):h=g,h}},removeData:function(b,d,c){if(n.acceptData(b)){var e,g,h,q=b.nodeType,k=q?n.cache:b,t=q?b[n.expando]:n.expando;if(k[t]){if(d&&(e=c?k[t]:k[t].data)){n.isArray(d)||(d in e?d=[d]:(d=n.camelCase(d),d=d in e?[d]:d.split(" ")));g=0;for(h=d.length;g<h;g++)delete e[d[g]];if(!(c?f:n.isEmptyObject)(e))return}(c||(delete k[t].data,f(k[t])))&&(q?n.cleanData([b],!0):n.support.deleteExpando||k!=k.window?delete k[t]:k[t]=null)}}},_data:function(b,d,c){return n.data(b,d,c,!0)},acceptData:function(b){var d=
b.nodeName&&n.noData[b.nodeName.toLowerCase()];return!d||!0!==d&&b.getAttribute("classid")===d}});n.fn.extend({data:function(d,c){var f,g,h,q,k,t=this[0],l=0,v=null;if(d===b){if(this.length&&(v=n.data(t),1===t.nodeType&&!n._data(t,"parsedAttrs"))){h=t.attributes;for(k=h.length;l<k;l++)q=h[l].name,q.indexOf("data-")||(q=n.camelCase(q.substring(5)),e(t,q,v[q]));n._data(t,"parsedAttrs",!0)}return v}return"object"==typeof d?this.each(function(){n.data(this,d)}):(f=d.split(".",2),f[1]=f[1]?"."+f[1]:"",
g=f[1]+"!",n.access(this,function(c){if(c===b)return v=this.triggerHandler("getData"+g,[f[0]]),v===b&&t&&(v=n.data(t,d),v=e(t,d,v)),v===b&&f[1]?this.data(f[0]):v;f[1]=c;this.each(function(){var b=n(this);b.triggerHandler("setData"+g,f);n.data(this,d,c);b.triggerHandler("changeData"+g,f)})},null,c,1<arguments.length,null,!1))},removeData:function(b){return this.each(function(){n.removeData(this,b)})}});n.extend({queue:function(b,d,c){var e;if(b)return d=(d||"fx")+"queue",e=n._data(b,d),c&&(!e||n.isArray(c)?
e=n._data(b,d,n.makeArray(c)):e.push(c)),e||[]},dequeue:function(b,d){d=d||"fx";var c=n.queue(b,d),e=c.length,f=c.shift(),g=n._queueHooks(b,d),h=function(){n.dequeue(b,d)};"inprogress"===f&&(f=c.shift(),e--);f&&("fx"===d&&c.unshift("inprogress"),delete g.stop,f.call(b,h,g));!e&&g&&g.empty.fire()},_queueHooks:function(b,d){var c=d+"queueHooks";return n._data(b,c)||n._data(b,c,{empty:n.Callbacks("once memory").add(function(){n.removeData(b,d+"queue",!0);n.removeData(b,c,!0)})})}});n.fn.extend({queue:function(d,
c){var e=2;return"string"!=typeof d&&(c=d,d="fx",e--),arguments.length<e?n.queue(this[0],d):c===b?this:this.each(function(){var b=n.queue(this,d,c);n._queueHooks(this,d);"fx"===d&&"inprogress"!==b[0]&&n.dequeue(this,d)})},dequeue:function(b){return this.each(function(){n.dequeue(this,b)})},delay:function(b,d){return b=n.fx?n.fx.speeds[b]||b:b,d=d||"fx",this.queue(d,function(d,c){var e=setTimeout(d,b);c.stop=function(){clearTimeout(e)}})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(d,
c){var e,f=1,g=n.Deferred(),h=this,q=this.length,k=function(){--f||g.resolveWith(h,[h])};"string"!=typeof d&&(c=d,d=b);for(d=d||"fx";q--;)(e=n._data(h[q],d+"queueHooks"))&&e.empty&&(f++,e.empty.add(k));return k(),g.promise(c)}});var Ha,Ia=/[\t\r\n]/g,eb=/\r/g,fb=/^(?:button|input)$/i,gb=/^(?:button|input|object|select|textarea)$/i,hb=/^a(?:rea|)$/i,Ja=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ib=n.support.getSetAttribute;
n.fn.extend({attr:function(b,d){return n.access(this,n.attr,b,d,1<arguments.length)},removeAttr:function(b){return this.each(function(){n.removeAttr(this,b)})},prop:function(b,d){return n.access(this,n.prop,b,d,1<arguments.length)},removeProp:function(d){return d=n.propFix[d]||d,this.each(function(){try{this[d]=b,delete this[d]}catch(c){}})},addClass:function(b){var d,c,e,f,g,h,q;if(n.isFunction(b))return this.each(function(d){n(this).addClass(b.call(this,d,this.className))});if(b&&"string"==typeof b)for(d=
b.split(da),c=0,e=this.length;c<e;c++)if(f=this[c],1===f.nodeType)if(f.className||1!==d.length){g=" "+f.className+" ";h=0;for(q=d.length;h<q;h++)0>g.indexOf(" "+d[h]+" ")&&(g+=d[h]+" ");f.className=n.trim(g)}else f.className=b;return this},removeClass:function(d){var c,e,f,g,h,q,k;if(n.isFunction(d))return this.each(function(b){n(this).removeClass(d.call(this,b,this.className))});if(d&&"string"==typeof d||d===b)for(c=(d||"").split(da),q=0,k=this.length;q<k;q++)if(f=this[q],1===f.nodeType&&f.className){e=
(" "+f.className+" ").replace(Ia," ");g=0;for(h=c.length;g<h;g++)for(;0<=e.indexOf(" "+c[g]+" ");)e=e.replace(" "+c[g]+" "," ");f.className=d?n.trim(e):""}return this},toggleClass:function(b,d){var c=typeof b,e="boolean"==typeof d;return n.isFunction(b)?this.each(function(c){n(this).toggleClass(b.call(this,c,this.className,d),d)}):this.each(function(){if("string"===c)for(var f,g=0,h=n(this),q=d,k=b.split(da);f=k[g++];)q=e?q:!h.hasClass(f),h[q?"addClass":"removeClass"](f);else"undefined"!==c&&"boolean"!==
c||(this.className&&n._data(this,"__className__",this.className),this.className=this.className||!1===b?"":n._data(this,"__className__")||"")})},hasClass:function(b){b=" "+b+" ";for(var d=0,c=this.length;d<c;d++)if(1===this[d].nodeType&&0<=(" "+this[d].className+" ").replace(Ia," ").indexOf(b))return!0;return!1},val:function(d){var c,e,f,g=this[0];if(arguments.length)return f=n.isFunction(d),this.each(function(e){var g,h=n(this);1===this.nodeType&&(g=f?d.call(this,e,h.val()):d,null==g?g="":"number"==
typeof g?g+="":n.isArray(g)&&(g=n.map(g,function(b){return null==b?"":b+""})),(c=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()])&&"set"in c&&c.set(this,g,"value")!==b||(this.value=g))});if(g)return(c=n.valHooks[g.type]||n.valHooks[g.nodeName.toLowerCase()])&&"get"in c&&(e=c.get(g,"value"))!==b?e:(e=g.value,"string"==typeof e?e.replace(eb,""):null==e?"":e)}});n.extend({valHooks:{option:{get:function(b){var d=b.attributes.value;return!d||d.specified?b.value:b.text}},select:{get:function(b){for(var d,
c=b.options,e=b.selectedIndex,f="select-one"===b.type||0>e,g=f?null:[],h=f?e+1:c.length,q=0>e?h:f?e:0;q<h;q++)if(d=c[q],!(!d.selected&&q!==e||(n.support.optDisabled?d.disabled:null!==d.getAttribute("disabled"))||d.parentNode.disabled&&n.nodeName(d.parentNode,"optgroup"))){if(b=n(d).val(),f)return b;g.push(b)}return g},set:function(b,d){var c=n.makeArray(d);return n(b).find("option").each(function(){this.selected=0<=n.inArray(n(this).val(),c)}),c.length||(b.selectedIndex=-1),c}}},attrFn:{},attr:function(d,
c,e,f){var g,h,q,k=d.nodeType;if(d&&3!==k&&8!==k&&2!==k)return f&&n.isFunction(n.fn[c])?n(d)[c](e):void 0===d.getAttribute?n.prop(d,c,e):(q=1!==k||!n.isXMLDoc(d),q&&(c=c.toLowerCase(),h=n.attrHooks[c]||(Ja.test(c)?Ha:void 0)),e!==b?null===e?void n.removeAttr(d,c):h&&"set"in h&&q&&(g=h.set(d,e,c))!==b?g:(d.setAttribute(c,e+""),e):h&&"get"in h&&q&&null!==(g=h.get(d,c))?g:(g=d.getAttribute(c),null===g?b:g))},removeAttr:function(b,d){var c,e,f,g,h=0;if(d&&1===b.nodeType)for(e=d.split(da);h<e.length;h++)(f=
e[h])&&(c=n.propFix[f]||f,g=Ja.test(f),g||n.attr(b,f,""),b.removeAttribute(ib?f:c),g&&c in b&&(b[c]=!1))},attrHooks:{type:{set:function(b,d){if(fb.test(b.nodeName)&&b.parentNode)n.error("type property can't be changed");else if(!n.support.radioValue&&"radio"===d&&n.nodeName(b,"input")){var c=b.value;return b.setAttribute("type",d),c&&(b.value=c),d}}},value:{get:function(b,d){return d in b?b.value:null},set:function(b,d,c){b.value=d}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",maxlength:"maxLength",
cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(d,c,e){var f,g,h,q=d.nodeType;if(d&&3!==q&&8!==q&&2!==q)return h=1!==q||!n.isXMLDoc(d),h&&(c=n.propFix[c]||c,g=n.propHooks[c]),e!==b?g&&"set"in g&&(f=g.set(d,e,c))!==b?f:d[c]=e:g&&"get"in g&&null!==(f=g.get(d,c))?f:d[c]},propHooks:{tabIndex:{get:function(d){var c=d.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,
10):gb.test(d.nodeName)||hb.test(d.nodeName)&&d.href?0:b}}}});Ha={get:function(d,c){var e,f=n.prop(d,c);return!0===f||"boolean"!=typeof f&&(e=d.getAttributeNode(c))&&!1!==e.nodeValue?c.toLowerCase():b},set:function(b,d,c){var e;return!1===d?n.removeAttr(b,c):(e=n.propFix[c]||c,e in b&&(b[e]=!0),b.setAttribute(c,c.toLowerCase())),c}};n.support.enctype||(n.propFix.enctype="encoding");var Ka=/^([^\.]*|)(?:\.(.+)|)$/,jb=/(?:^|\s)hover(\.\S+|)\b/,kb=/^key/,lb=/^(?:mouse|contextmenu)|click/,La=/^(?:focusinfocus|focusoutblur)$/,
Ma=function(b){return n.event.special.hover?b:b.replace(jb,"mouseenter$1 mouseleave$1")};n.event={add:function(d,c,e,f,g){var h,q,k,t,l,v,m,p,w;if(3!==d.nodeType&&8!==d.nodeType&&c&&e&&(h=n._data(d))){e.handler&&(m=e,e=m.handler,g=m.selector);e.guid||(e.guid=n.guid++);(k=h.events)||(h.events=k={});(q=h.handle)||(h.handle=q=function(d){return void 0===n||d&&n.event.triggered===d.type?b:n.event.dispatch.apply(q.elem,arguments)},q.elem=d);c=n.trim(Ma(c)).split(" ");for(h=0;h<c.length;h++)t=Ka.exec(c[h])||
[],l=t[1],v=(t[2]||"").split(".").sort(),w=n.event.special[l]||{},l=(g?w.delegateType:w.bindType)||l,w=n.event.special[l]||{},t=n.extend({type:l,origType:t[1],data:f,handler:e,guid:e.guid,selector:g,needsContext:g&&n.expr.match.needsContext.test(g),namespace:v.join(".")},m),(p=k[l])||(p=k[l]=[],p.delegateCount=0,w.setup&&!1!==w.setup.call(d,f,v,q)||(d.addEventListener?d.addEventListener(l,q,!1):d.attachEvent&&d.attachEvent("on"+l,q))),w.add&&(w.add.call(d,t),t.handler.guid||(t.handler.guid=e.guid)),
g?p.splice(p.delegateCount++,0,t):p.push(t),n.event.global[l]=!0;d=null}},global:{},remove:function(b,d,c,e,f){var g,h,q,k,t,l,v,m,p,w,u,r=n.hasData(b)&&n._data(b);if(r&&(m=r.events)){d=n.trim(Ma(d||"")).split(" ");for(g=0;g<d.length;g++)if(h=Ka.exec(d[g])||[],q=k=h[1],t=h[2],q){p=n.event.special[q]||{};q=(e?p.delegateType:p.bindType)||q;w=m[q]||[];l=w.length;t=t?new RegExp("(^|\\.)"+t.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(v=0;v<w.length;v++)u=w[v],!f&&k!==u.origType||c&&c.guid!==
u.guid||t&&!t.test(u.namespace)||e&&e!==u.selector&&("**"!==e||!u.selector)||(w.splice(v--,1),u.selector&&w.delegateCount--,p.remove&&p.remove.call(b,u));0===w.length&&l!==w.length&&(p.teardown&&!1!==p.teardown.call(b,t,r.handle)||n.removeEvent(b,q,r.handle),delete m[q])}else for(q in m)n.event.remove(b,q+d[g],c,e,!0);n.isEmptyObject(m)&&(delete r.handle,n.removeData(b,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(d,e,f,g){if(!f||3!==f.nodeType&&8!==f.nodeType){var h,
q,k,t,l,v,m,p=d.type||d;t=[];if(!La.test(p+n.event.triggered)&&(0<=p.indexOf("!")&&(p=p.slice(0,-1),h=!0),0<=p.indexOf(".")&&(t=p.split("."),p=t.shift(),t.sort()),f&&!n.event.customEvent[p]||n.event.global[p]))if(d="object"==typeof d?d[n.expando]?d:new n.Event(p,d):new n.Event(p),d.type=p,d.isTrigger=!0,d.exclusive=h,d.namespace=t.join("."),d.namespace_re=d.namespace?new RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t=0>p.indexOf(":")?"on"+p:"",f){if(d.result=b,d.target||(d.target=f),e=
null!=e?n.makeArray(e):[],e.unshift(d),l=n.event.special[p]||{},!l.trigger||!1!==l.trigger.apply(f,e)){if(m=[[f,l.bindType||p]],!g&&!l.noBubble&&!n.isWindow(f)){q=l.delegateType||p;h=La.test(q+p)?f:f.parentNode;for(k=f;h;h=h.parentNode)m.push([h,q]),k=h;k===(f.ownerDocument||z)&&m.push([k.defaultView||k.parentWindow||c,q])}for(q=0;q<m.length&&!d.isPropagationStopped();q++)h=m[q][0],d.type=m[q][1],(v=(n._data(h,"events")||{})[d.type]&&n._data(h,"handle"))&&v.apply(h,e),(v=t&&h[t])&&n.acceptData(h)&&
v.apply&&!1===v.apply(h,e)&&d.preventDefault();return d.type=p,g||d.isDefaultPrevented()||l._default&&!1!==l._default.apply(f.ownerDocument,e)||"click"===p&&n.nodeName(f,"a")||!n.acceptData(f)||t&&f[p]&&("focus"!==p&&"blur"!==p||0!==d.target.offsetWidth)&&!n.isWindow(f)&&(k=f[t],k&&(f[t]=null),n.event.triggered=p,f[p](),n.event.triggered=b,k&&(f[t]=k)),d.result}}else for(q in f=n.cache,f)f[q].events&&f[q].events[p]&&n.event.trigger(d,e,f[q].handle.elem,!0)}},dispatch:function(d){d=n.event.fix(d||
c.event);var e,f,g,h,q,k,t,l=(n._data(this,"events")||{})[d.type]||[],v=l.delegateCount,m=I.call(arguments),p=!d.exclusive&&!d.namespace,w=n.event.special[d.type]||{},u=[];if(m[0]=d,d.delegateTarget=this,!w.preDispatch||!1!==w.preDispatch.call(this,d)){if(v&&(!d.button||"click"!==d.type))for(f=d.target;f!=this;f=f.parentNode||this)if(!0!==f.disabled||"click"!==d.type){h={};q=[];for(e=0;e<v;e++)k=l[e],t=k.selector,h[t]===b&&(h[t]=k.needsContext?0<=n(t,this).index(f):n.find(t,this,null,[f]).length),
h[t]&&q.push(k);q.length&&u.push({elem:f,matches:q})}l.length>v&&u.push({elem:this,matches:l.slice(v)});for(e=0;e<u.length&&!d.isPropagationStopped();e++)for(h=u[e],d.currentTarget=h.elem,f=0;f<h.matches.length&&!d.isImmediatePropagationStopped();f++)k=h.matches[f],(p||!d.namespace&&!k.namespace||d.namespace_re&&d.namespace_re.test(k.namespace))&&(d.data=k.data,d.handleObj=k,(g=((n.event.special[k.origType]||{}).handle||k.handler).apply(h.elem,m))!==b&&(d.result=g,!1===g&&(d.preventDefault(),d.stopPropagation())));
return w.postDispatch&&w.postDispatch.call(this,d),d.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(b,d){return null==b.which&&(b.which=null!=d.charCode?d.charCode:d.keyCode),b}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(d,c){var e,f,g,h=c.button,q=c.fromElement;return null==d.pageX&&null!=c.clientX&&(e=d.target.ownerDocument||z,f=e.documentElement,g=e.body,d.pageX=c.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),d.pageY=c.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!d.relatedTarget&&q&&(d.relatedTarget=q===d.target?c.toElement:q),d.which||h===b||(d.which=1&h?1:2&h?3:4&h?2:0),d}},fix:function(b){if(b[n.expando])return b;var d,
c,e=b,f=n.event.fixHooks[b.type]||{},g=f.props?this.props.concat(f.props):this.props;b=n.Event(e);for(d=g.length;d;)c=g[--d],b[c]=e[c];return b.target||(b.target=e.srcElement||z),3===b.target.nodeType&&(b.target=b.target.parentNode),b.metaKey=!!b.metaKey,f.filter?f.filter(b,e):b},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(b,d,c){n.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(b,d){this.onbeforeunload===d&&(this.onbeforeunload=
null)}}},simulate:function(b,d,c,e){b=n.extend(new n.Event,c,{type:b,isSimulated:!0,originalEvent:{}});e?n.event.trigger(b,null,d):n.event.dispatch.call(d,b);b.isDefaultPrevented()&&c.preventDefault()}};n.event.handle=n.event.dispatch;n.removeEvent=z.removeEventListener?function(b,d,c){b.removeEventListener&&b.removeEventListener(d,c,!1)}:function(b,d,c){d="on"+d;b.detachEvent&&(void 0===b[d]&&(b[d]=null),b.detachEvent(d,c))};n.Event=function(b,d){if(!(this instanceof n.Event))return new n.Event(b,
d);b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||!1===b.returnValue||b.getPreventDefault&&b.getPreventDefault()?h:g):this.type=b;d&&n.extend(this,d);this.timeStamp=b&&b.timeStamp||n.now();this[n.expando]=!0};n.Event.prototype={preventDefault:function(){this.isDefaultPrevented=h;var b=this.originalEvent;b&&(b.preventDefault?b.preventDefault():b.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=h;var b=this.originalEvent;b&&(b.stopPropagation&&
b.stopPropagation(),b.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h;this.stopPropagation()},isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g};n.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b,d){n.event.special[b]={delegateType:d,bindType:d,handle:function(b){var c,e=b.relatedTarget,f=b.handleObj;f.selector;return e&&(e===this||n.contains(this,e))||(b.type=f.origType,c=f.handler.apply(this,arguments),b.type=d),
c}}});n.fn.extend({on:function(d,c,e,f,h){var q,k;if("object"==typeof d){"string"!=typeof c&&(e=e||c,c=b);for(k in d)this.on(k,c,e,d[k],h);return this}if(null==e&&null==f?(f=c,e=c=b):null==f&&("string"==typeof c?(f=e,e=b):(f=e,e=c,c=b)),!1===f)f=g;else if(!f)return this;return 1===h&&(q=f,f=function(b){return n().off(b),q.apply(this,arguments)},f.guid=q.guid||(q.guid=n.guid++)),this.each(function(){n.event.add(this,d,f,e,c)})},off:function(d,c,e){var f,h;if(d&&d.preventDefault&&d.handleObj)return f=
d.handleObj,n(d.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if("object"==typeof d){for(h in d)this.off(h,c,d[h]);return this}return!1!==c&&"function"!=typeof c||(e=c,c=b),!1===e&&(e=g),this.each(function(){n.event.remove(this,d,e,c)})},delegate:function(b,d,c,e){return this.on(d,b,c,e)},undelegate:function(b,d,c){return 1===arguments.length?this.off(b,"**"):this.off(d,b||"**",c)},trigger:function(b,d){return this.each(function(){n.event.trigger(b,
d,this)})},triggerHandler:function(b,d){if(this[0])return n.event.trigger(b,d,this[0],!0)},toggle:function(b){var d=arguments,c=b.guid||n.guid++,e=0,f=function(c){var f=(n._data(this,"lastToggle"+b.guid)||0)%e;return n._data(this,"lastToggle"+b.guid,f+1),c.preventDefault(),d[f].apply(this,arguments)||!1};for(f.guid=c;e<d.length;)d[e++].guid=c;return this.click(f)},hover:function(b,d){return this.mouseenter(b).mouseleave(d||b)}});n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(b,d){n.fn[d]=function(b,c){return null==c&&(c=b,b=null),0<arguments.length?this.on(d,null,b,c):this.trigger(d)};kb.test(d)&&(n.event.fixHooks[d]=n.event.keyHooks);lb.test(d)&&(n.event.fixHooks[d]=n.event.mouseHooks)});(function(b,d){function c(b,d,e,f){e=e||[];d=d||O;var g,h,q,k,t=d.nodeType;if(!b||"string"!=typeof b)return e;if(1!==t&&9!==t)return[];if(!(q=U(d))&&!f&&(g=M.exec(b)))if(k=g[1])if(9===t){if(!(h=d.getElementById(k))||!h.parentNode)return e;if(h.id===k)return e.push(h),e}else{if(d.ownerDocument&&
(h=d.ownerDocument.getElementById(k))&&la(d,h)&&h.id===k)return e.push(h),e}else{if(g[2])return I.apply(e,z.call(d.getElementsByTagName(b),0)),e;if((k=g[3])&&sa&&d.getElementsByClassName)return I.apply(e,z.call(d.getElementsByClassName(k),0)),e}return w(b.replace(S,"$1"),d,e,f,q)}function e(b){return function(d){return"input"===d.nodeName.toLowerCase()&&d.type===b}}function f(b){return function(d){var c=d.nodeName.toLowerCase();return("input"===c||"button"===c)&&d.type===b}}function g(b){return E(function(d){return d=
+d,E(function(c,e){for(var f,g=b([],c.length,d),h=g.length;h--;)c[f=g[h]]&&(c[f]=!(e[f]=c[f]))})})}function h(b,d,c){if(b===d)return c;for(b=b.nextSibling;b;){if(b===d)return-1;b=b.nextSibling}return 1}function q(b,d){var e,f,g,h,k,t,l;if(k=T[J][b+" "])return d?0:k.slice(0);k=b;t=[];for(l=A.preFilter;k;){e&&!(f=K.exec(k))||(f&&(k=k.slice(f[0].length)||k),t.push(g=[]));e=!1;(f=Z.exec(k))&&(g.push(e=new qa(f.shift())),k=k.slice(e.length),e.type=f[0].replace(S," "));for(h in A.filter)!(f=N[h].exec(k))||
l[h]&&!(f=l[h](f))||(g.push(e=new qa(f.shift())),k=k.slice(e.length),e.type=h,e.matches=f);if(!e)break}return d?k.length:k?c.error(b):T(b,t).slice(0)}function k(b,d,c){var e=d.dir,f=c&&"parentNode"===d.dir,g=B++;return d.first?function(d,c,g){for(;d=d[e];)if(f||1===d.nodeType)return b(d,c,g)}:function(d,c,h){if(h)for(;d=d[e];){if((f||1===d.nodeType)&&b(d,c,h))return d}else for(var q,k=H+" "+g+" ",t=k+r;d=d[e];)if(f||1===d.nodeType){if((q=d[J])===t)return d.sizset;if("string"==typeof q&&0===q.indexOf(k)){if(d.sizset)return d}else{if(d[J]=
t,b(d,c,h))return d.sizset=!0,d;d.sizset=!1}}}}function t(b){return 1<b.length?function(d,c,e){for(var f=b.length;f--;)if(!b[f](d,c,e))return!1;return!0}:b[0]}function l(b,d,c,e,f){for(var g,h=[],q=0,k=b.length,t=null!=d;q<k;q++)(g=b[q])&&(c&&!c(g,e,f)||(h.push(g),t&&d.push(q)));return h}function v(b,d,e,f,g,h){return f&&!f[J]&&(f=v(f)),g&&!g[J]&&(g=v(g,h)),E(function(h,q,k,t){var v,n,m=[],p=[],w=q.length,u;if(!(u=h)){u=d||"*";for(var r=k.nodeType?[k]:k,y=[],ca=0,A=r.length;ca<A;ca++)c(u,r[ca],y);
u=y}u=!b||!h&&d?u:l(u,m,b,k,t);r=e?g||(h?b:w||f)?[]:q:u;if(e&&e(u,r,k,t),f)for(v=l(r,p),f(v,[],k,t),k=v.length;k--;)(n=v[k])&&(r[p[k]]=!(u[p[k]]=n));if(h){if(g||b){if(g){v=[];for(k=r.length;k--;)(n=r[k])&&v.push(u[k]=n);g(null,r=[],v,t)}for(k=r.length;k--;)(n=r[k])&&-1<(v=g?na.call(h,n):m[k])&&(h[v]=!(q[v]=n))}}else r=l(r===q?r.splice(w,r.length):r),g?g(null,q,r,t):I.apply(q,r)})}function m(b){var d,c,e,f=b.length,g=A.relative[b[0].type];c=g||A.relative[" "];for(var h=g?1:0,q=k(function(b){return b===
d},c,!0),l=k(function(b){return-1<na.call(d,b)},c,!0),n=[function(b,c,e){return!g&&(e||c!==G)||((d=c).nodeType?q(b,c,e):l(b,c,e))}];h<f;h++)if(c=A.relative[b[h].type])n=[k(t(n),c)];else{if(c=A.filter[b[h].type].apply(null,b[h].matches),c[J]){for(e=++h;e<f&&!A.relative[b[e].type];e++);return v(1<h&&t(n),1<h&&b.slice(0,h-1).join("").replace(S,"$1"),c,h<e&&m(b.slice(h,e)),e<f&&m(b=b.slice(e)),e<f&&b.join(""))}n.push(c)}return t(n)}function p(b,d){var e=0<d.length,f=0<b.length,g=function(h,q,k,t,v){var n,
m,p=[],w=0,u="0",y=h&&[],ca=null!=v,F=G,Wa=h||f&&A.find.TAG("*",v&&q.parentNode||q),U=H+=null==F?1:Math.E;for(ca&&(G=q!==O&&q,r=g.el);null!=(v=Wa[u]);u++){if(f&&v){for(n=0;m=b[n];n++)if(m(v,q,k)){t.push(v);break}ca&&(H=U,r=++g.el)}e&&((v=!m&&v)&&w--,h&&y.push(v))}if(w+=u,e&&u!==w){for(n=0;m=d[n];n++)m(y,p,q,k);if(h){if(0<w)for(;u--;)y[u]||p[u]||(p[u]=wa.call(t));p=l(p)}I.apply(t,p);ca&&!h&&0<p.length&&1<w+d.length&&c.uniqueSort(t)}return ca&&(H=U,G=F),y};return g.el=0,e?E(g):g}function w(b,d,c,e,
f){var g,h,k,t,l,v=q(b);v.length;if(!e&&1===v.length){if(h=v[0]=v[0].slice(0),2<h.length&&"ID"===(k=h[0]).type&&9===d.nodeType&&!f&&A.relative[h[1].type]){if(!(d=A.find.ID(k.matches[0].replace(ba,""),d,f)[0]))return c;b=b.slice(h.shift().length)}for(g=N.POS.test(b)?-1:h.length-1;0<=g&&(k=h[g],!A.relative[t=k.type]);g--)if((l=A.find[t])&&(e=l(k.matches[0].replace(ba,""),ea.test(h[0].type)&&d.parentNode||d,f))){if(h.splice(g,1),!(b=e.length&&h.join("")))return I.apply(c,z.call(e,0)),c;break}}return C(b,
v)(e,d,f,c,ea.test(b)),c}function u(){}var r,y,A,F,U,la,C,fa,ha,G,da=!0,J=("sizcache"+Math.random()).replace(".",""),qa=String,O=b.document,P=O.documentElement,H=0,B=0,wa=[].pop,I=[].push,z=[].slice,na=[].indexOf||function(b){for(var d=0,c=this.length;d<c;d++)if(this[d]===b)return d;return-1},E=function(b,d){return b[J]=null==d||d,b},D=function(){var b={},d=[];return E(function(c,e){return d.push(c)>A.cacheLength&&delete b[d.shift()],b[c+" "]=e},b)},ra=D(),T=D(),X=D(),D="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+
"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w#")+")|)|)[\\x20\\t\\r\\n\\f]*\\]",R=":((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+D+")|[^:]|\\\\.)*|.*))\\)|)",S=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),K=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Z=/^[\x20\t\r\n\f]*([\x20\t\r\n\f>+~])[\x20\t\r\n\f]*/,xa=new RegExp(R),M=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,ea=/[\x20\t\r\n\f]*[+~]/,Q=/h\d/i,Y=/input|select|textarea|button/i,
ba=/\\(?!\\)/g,N={ID:/^#((?:\\.|[-\w]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[-\w]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[-\w]|[^\x00-\xa0])+)['"]?\]/,TAG:new RegExp("^("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+D),PSEUDO:new RegExp("^"+R),POS:/:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i,CHILD:/^:(only|nth|first|last)-child(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},L=function(b){var d=O.createElement("div");try{return b(d)}catch(c){return!1}finally{}},D=L(function(b){return b.appendChild(O.createComment("")),!b.getElementsByTagName("*").length}),V=L(function(b){return b.innerHTML="<a href='#'></a>",b.firstChild&&void 0!==b.firstChild.getAttribute&&"#"===b.firstChild.getAttribute("href")}),W=L(function(b){b.innerHTML="<select></select>";
b=typeof b.lastChild.getAttribute("multiple");return"boolean"!==b&&"string"!==b}),sa=L(function(b){return b.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!(!b.getElementsByClassName||!b.getElementsByClassName("e").length)&&(b.lastChild.className="e",2===b.getElementsByClassName("e").length)}),aa=L(function(b){b.id=J+0;b.innerHTML="<a name='"+J+"'></a><div name='"+J+"'></div>";P.insertBefore(b,P.firstChild);var d=O.getElementsByName&&O.getElementsByName(J).length===2+O.getElementsByName(J+
0).length;return y=!O.getElementById(J),P.removeChild(b),d});try{z.call(P.childNodes,0)[0].nodeType}catch(Ib){z=function(b){for(var d,c=[];d=this[b];b++)c.push(d);return c}}c.matches=function(b,d){return c(b,null,null,d)};c.matchesSelector=function(b,d){return 0<c(d,null,null,[b]).length};F=c.getText=function(b){var d,c="",e=0;if(d=b.nodeType)if(1===d||9===d||11===d){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=b.nextSibling)c+=F(b)}else{if(3===d||4===d)return b.nodeValue}else for(;d=
b[e];e++)c+=F(d);return c};U=c.isXML=function(b){b=b&&(b.ownerDocument||b).documentElement;return!!b&&"HTML"!==b.nodeName};la=c.contains=P.contains?function(b,d){var c=9===b.nodeType?b.documentElement:b,e=d&&d.parentNode;return b===e||!!(e&&1===e.nodeType&&c.contains&&c.contains(e))}:P.compareDocumentPosition?function(b,d){return d&&!!(16&b.compareDocumentPosition(d))}:function(b,d){for(;d=d.parentNode;)if(d===b)return!0;return!1};c.attr=function(b,d){var c,e=U(b);return e||(d=d.toLowerCase()),(c=
A.attrHandle[d])?c(b):e||W?b.getAttribute(d):(c=b.getAttributeNode(d),c?"boolean"==typeof b[d]?b[d]?d:null:c.specified?c.value:null:null)};A=c.selectors={cacheLength:50,createPseudo:E,match:N,attrHandle:V?{}:{href:function(b){return b.getAttribute("href",2)},type:function(b){return b.getAttribute("type")}},find:{ID:y?function(b,d,c){if(void 0!==d.getElementById&&!c)return(b=d.getElementById(b))&&b.parentNode?[b]:[]}:function(b,d,c){if(void 0!==d.getElementById&&!c)return(d=d.getElementById(b))?d.id===
b||void 0!==d.getAttributeNode&&d.getAttributeNode("id").value===b?[d]:void 0:[]},TAG:D?function(b,d){if(void 0!==d.getElementsByTagName)return d.getElementsByTagName(b)}:function(b,d){var c=d.getElementsByTagName(b);if("*"===b){for(var e,f=[],g=0;e=c[g];g++)1===e.nodeType&&f.push(e);return f}return c},NAME:aa&&function(b,d){if(void 0!==d.getElementsByName)return d.getElementsByName(name)},CLASS:sa&&function(b,d,c){if(void 0!==d.getElementsByClassName&&!c)return d.getElementsByClassName(b)}},relative:{">":{dir:"parentNode",
first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(ba,""),b[3]=(b[4]||b[5]||"").replace(ba,""),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1]?(b[2]||c.error(b[0]),b[3]=+(b[3]?b[4]+(b[5]||1):2*("even"===b[2]||"odd"===b[2])),b[4]=+(b[6]+b[7]||"odd"===b[2])):b[2]&&c.error(b[0]),b},PSEUDO:function(b){var d,c;return N.CHILD.test(b[0])?null:(b[3]?
b[2]=b[3]:(d=b[4])&&(xa.test(d)&&(c=q(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(d=d.slice(0,c),b[0]=b[0].slice(0,c)),b[2]=d),b.slice(0,3))}},filter:{ID:y?function(b){return b=b.replace(ba,""),function(d){return d.getAttribute("id")===b}}:function(b){return b=b.replace(ba,""),function(d){return(d=void 0!==d.getAttributeNode&&d.getAttributeNode("id"))&&d.value===b}},TAG:function(b){return"*"===b?function(){return!0}:(b=b.replace(ba,"").toLowerCase(),function(d){return d.nodeName&&d.nodeName.toLowerCase()===
b})},CLASS:function(b){var d=ra[J][b+" "];return d||(d=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"),ra(b,function(b){return d.test(b.className||void 0!==b.getAttribute&&b.getAttribute("class")||"")}))},ATTR:function(b,d,e){return function(f,g){var h=c.attr(f,b);return null==h?"!="===d:!d||(h+="","="===d?h===e:"!="===d?h!==e:"^="===d?e&&0===h.indexOf(e):"*="===d?e&&-1<h.indexOf(e):"$="===d?e&&h.substr(h.length-e.length)===e:"~="===d?-1<(" "+h+" ").indexOf(e):"|="===d&&(h===e||
h.substr(0,e.length+1)===e+"-"))}},CHILD:function(b,d,c,e){return"nth"===b?function(b){var d,f;d=b.parentNode;if(1===c&&0===e)return!0;if(d)for(f=0,d=d.firstChild;d&&(1!==d.nodeType||(f++,b!==d));d=d.nextSibling);return(f-=e)===c||0==f%c&&0<=f/c}:function(d){var c=d;switch(b){case "only":case "first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===b)return!0;c=d;case "last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(b,d){var e,f=A.pseudos[b]||A.setFilters[b.toLowerCase()]||
c.error("unsupported pseudo: "+b);return f[J]?f(d):1<f.length?(e=[b,b,"",d],A.setFilters.hasOwnProperty(b.toLowerCase())?E(function(b,c){for(var e,g=f(b,d),h=g.length;h--;)e=na.call(b,g[h]),b[e]=!(c[e]=g[h])}):function(b){return f(b,0,e)}):f}},pseudos:{not:E(function(b){var d=[],c=[],e=C(b.replace(S,"$1"));return e[J]?E(function(b,d,c,f){var g;c=e(b,null,f,[]);for(f=b.length;f--;)(g=c[f])&&(b[f]=!(d[f]=g))}):function(b,f,g){return d[0]=b,e(d,null,g,c),!c.pop()}}),has:E(function(b){return function(d){return 0<
c(b,d).length}}),contains:E(function(b){return function(d){return-1<(d.textContent||d.innerText||F(d)).indexOf(b)}}),enabled:function(b){return!1===b.disabled},disabled:function(b){return!0===b.disabled},checked:function(b){var d=b.nodeName.toLowerCase();return"input"===d&&!!b.checked||"option"===d&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},parent:function(b){return!A.pseudos.empty(b)},empty:function(b){var d;for(b=b.firstChild;b;){if("@"<
b.nodeName||3===(d=b.nodeType)||4===d)return!1;b=b.nextSibling}return!0},header:function(b){return Q.test(b.nodeName)},text:function(b){var d,c;return"input"===b.nodeName.toLowerCase()&&"text"===(d=b.type)&&(null==(c=b.getAttribute("type"))||c.toLowerCase()===d)},radio:e("radio"),checkbox:e("checkbox"),file:e("file"),password:e("password"),image:e("image"),submit:f("submit"),reset:f("reset"),button:function(b){var d=b.nodeName.toLowerCase();return"input"===d&&"button"===b.type||"button"===d},input:function(b){return Y.test(b.nodeName)},
focus:function(b){var d=b.ownerDocument;return b===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(b.type||b.href||~b.tabIndex)},active:function(b){return b===b.ownerDocument.activeElement},first:g(function(){return[0]}),last:g(function(b,d){return[d-1]}),eq:g(function(b,d,c){return[0>c?c+d:c]}),even:g(function(b,d){for(var c=0;c<d;c+=2)b.push(c);return b}),odd:g(function(b,d){for(var c=1;c<d;c+=2)b.push(c);return b}),lt:g(function(b,d,c){for(d=0>c?c+d:c;0<=--d;)b.push(d);return b}),gt:g(function(b,
d,c){for(c=0>c?c+d:c;++c<d;)b.push(c);return b})}};fa=P.compareDocumentPosition?function(b,d){return b===d?(ha=!0,0):(b.compareDocumentPosition&&d.compareDocumentPosition?4&b.compareDocumentPosition(d):b.compareDocumentPosition)?-1:1}:function(b,d){if(b===d)return ha=!0,0;if(b.sourceIndex&&d.sourceIndex)return b.sourceIndex-d.sourceIndex;var c,e,f=[],g=[];c=b.parentNode;e=d.parentNode;var q=c;if(c===e)return h(b,d);if(!c)return-1;if(!e)return 1;for(;q;)f.unshift(q),q=q.parentNode;for(q=e;q;)g.unshift(q),
q=q.parentNode;c=f.length;e=g.length;for(q=0;q<c&&q<e;q++)if(f[q]!==g[q])return h(f[q],g[q]);return q===c?h(b,g[q],-1):h(f[q],d,1)};[0,0].sort(fa);da=!ha;c.uniqueSort=function(b){var d,c=[],e=1,f=0;if(ha=da,b.sort(fa),ha){for(;d=b[e];e++)d===b[e-1]&&(f=c.push(e));for(;f--;)b.splice(c[f],1)}return b};c.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);};C=c.compile=function(b,d){var c,e=[],f=[],g=X[J][b+" "];if(!g){d||(d=q(b));for(c=d.length;c--;)g=m(d[c]),g[J]?e.push(g):f.push(g);
g=X(b,p(f,e))}return g};O.querySelectorAll&&function(){var b,d=w,e=/'|\\/g,f=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,g=[":focus"],h=[":active"],k=P.matchesSelector||P.mozMatchesSelector||P.webkitMatchesSelector||P.oMatchesSelector||P.msMatchesSelector;L(function(b){b.innerHTML="<select><option selected=''></option></select>";b.querySelectorAll("[selected]").length||g.push("\\[[\\x20\\t\\r\\n\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)");b.querySelectorAll(":checked").length||
g.push(":checked")});L(function(b){b.innerHTML="<p test=''></p>";b.querySelectorAll("[test^='']").length&&g.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:\"\"|'')");b.innerHTML="<input type='hidden'/>";b.querySelectorAll(":enabled").length||g.push(":enabled",":disabled")});g=new RegExp(g.join("|"));w=function(b,c,f,h,k){if(!h&&!k&&!g.test(b)){var t,l,v=!0,n=J;l=c;t=9===c.nodeType&&b;if(1===c.nodeType&&"object"!==c.nodeName.toLowerCase()){t=q(b);(v=c.getAttribute("id"))?n=v.replace(e,"\\$&"):c.setAttribute("id",
n);n="[id='"+n+"'] ";for(l=t.length;l--;)t[l]=n+t[l].join("");l=ea.test(b)&&c.parentNode||c;t=t.join(",")}if(t)try{return I.apply(f,z.call(l.querySelectorAll(t),0)),f}catch(m){}finally{v||c.removeAttribute("id")}}return d(b,c,f,h,k)};k&&(L(function(d){b=k.call(d,"div");try{k.call(d,"[test!='']:sizzle"),h.push("!=",R)}catch(c){}}),h=new RegExp(h.join("|")),c.matchesSelector=function(d,e){if(e=e.replace(f,"='$1']"),!U(d)&&!h.test(e)&&!g.test(e))try{var q=k.call(d,e);if(q||b||d.document&&11!==d.document.nodeType)return q}catch(t){}return 0<
c(e,null,null,[d]).length})}();A.pseudos.nth=A.pseudos.eq;A.filters=u.prototype=A.pseudos;A.setFilters=new u;c.attr=n.attr;n.find=c;n.expr=c.selectors;n.expr[":"]=n.expr.pseudos;n.unique=c.uniqueSort;n.text=c.getText;n.isXMLDoc=c.isXML;n.contains=c.contains})(c);var mb=/Until$/,nb=/^(?:parents|prev(?:Until|All))/,$a=/^.[^:#\[\.,]*$/,Na=n.expr.match.needsContext,ob={children:!0,contents:!0,next:!0,prev:!0};n.fn.extend({find:function(b){var d,c,e,f,g,h,q=this;if("string"!=typeof b)return n(b).filter(function(){d=
0;for(c=q.length;d<c;d++)if(n.contains(q[d],this))return!0});h=this.pushStack("","find",b);d=0;for(c=this.length;d<c;d++)if(e=h.length,n.find(b,this[d],h),0<d)for(f=e;f<h.length;f++)for(g=0;g<e;g++)if(h[g]===h[f]){h.splice(f--,1);break}return h},has:function(b){var d,c=n(b,this),e=c.length;return this.filter(function(){for(d=0;d<e;d++)if(n.contains(this,c[d]))return!0})},not:function(b){return this.pushStack(m(this,b,!1),"not",b)},filter:function(b){return this.pushStack(m(this,b,!0),"filter",b)},
is:function(b){return!!b&&("string"==typeof b?Na.test(b)?0<=n(b,this.context).index(this[0]):0<n.filter(b,this).length:0<this.filter(b).length)},closest:function(b,d){for(var c,e=0,f=this.length,g=[],h=Na.test(b)||"string"!=typeof b?n(b,d||this.context):0;e<f;e++)for(c=this[e];c&&c.ownerDocument&&c!==d&&11!==c.nodeType;){if(h?-1<h.index(c):n.find.matchesSelector(c,b)){g.push(c);break}c=c.parentNode}return g=1<g.length?n.unique(g):g,this.pushStack(g,"closest",b)},index:function(b){return b?"string"==
typeof b?n.inArray(this[0],n(b)):n.inArray(b.jqx?b[0]:b,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(b,d){var c="string"==typeof b?n(b,d):n.makeArray(b&&b.nodeType?[b]:b),e=n.merge(this.get(),c);return this.pushStack(k(c[0])||k(e[0])?e:n.unique(e))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});n.fn.andSelf=n.fn.addBack;n.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return n.dir(b,
"parentNode")},parentsUntil:function(b,d,c){return n.dir(b,"parentNode",c)},next:function(b){return l(b,"nextSibling")},prev:function(b){return l(b,"previousSibling")},nextAll:function(b){return n.dir(b,"nextSibling")},prevAll:function(b){return n.dir(b,"previousSibling")},nextUntil:function(b,d,c){return n.dir(b,"nextSibling",c)},prevUntil:function(b,d,c){return n.dir(b,"previousSibling",c)},siblings:function(b){return n.sibling((b.parentNode||{}).firstChild,b)},children:function(b){return n.sibling(b.firstChild)},
contents:function(b){return n.nodeName(b,"iframe")?b.contentDocument||b.contentWindow.document:n.merge([],b.childNodes)}},function(b,d){n.fn[b]=function(c,e){var f=n.map(this,d,c);return mb.test(b)||(e=c),e&&"string"==typeof e&&(f=n.filter(e,f)),f=1<this.length&&!ob[b]?n.unique(f):f,1<this.length&&nb.test(b)&&(f=f.reverse()),this.pushStack(f,b,I.call(arguments).join(","))}});n.extend({filter:function(b,d,c){return c&&(b=":not("+b+")"),1===d.length?n.find.matchesSelector(d[0],b)?[d[0]]:[]:n.find.matches(b,
d)},dir:function(d,c,e){var f=[];for(d=d[c];d&&9!==d.nodeType&&(e===b||1!==d.nodeType||!n(d).is(e));)1===d.nodeType&&f.push(d),d=d[c];return f},sibling:function(b,d){for(var c=[];b;b=b.nextSibling)1===b.nodeType&&b!==d&&c.push(b);return c}});var Da="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",pb=/ JQXLite\d+="(?:null|\d+)"/g,ya=/^\s+/,Oa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
Pa=/<([\w:]+)/,qb=/<tbody/i,rb=/<|&#?\w+;/,sb=/<(?:script|style|link)/i,tb=/<(?:script|object|embed|option|style)/i,za=new RegExp("<(?:"+Da+")[\\s/>]","i"),Ea=/^(?:checkbox|radio)$/,Qa=/checked\s*(?:[^=]|=\s*.checked.)/i,ub=/\/(java|ecma)script/i,vb=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Q={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],
col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ra=p(z),Aa=Ra.appendChild(z.createElement("div"));Q.optgroup=Q.option;Q.tbody=Q.tfoot=Q.colgroup=Q.caption=Q.thead;Q.th=Q.td;n.support.htmlSerialize||(Q._default=[1,"X<div>","</div>"]);n.fn.extend({text:function(d){return n.access(this,function(d){return d===b?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(d))},null,d,arguments.length)},wrapAll:function(b){if(n.isFunction(b))return this.each(function(d){n(this).wrapAll(b.call(this,
d))});if(this[0]){var d=n(b,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&d.insertBefore(this[0]);d.map(function(){for(var b=this;b.firstChild&&1===b.firstChild.nodeType;)b=b.firstChild;return b}).append(this)}return this},wrapInner:function(b){return n.isFunction(b)?this.each(function(d){n(this).wrapInner(b.call(this,d))}):this.each(function(){var d=n(this),c=d.contents();c.length?c.wrapAll(b):d.append(b)})},wrap:function(b){var d=n.isFunction(b);return this.each(function(c){n(this).wrapAll(d?
b.call(this,c):b)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(b){1!==this.nodeType&&11!==this.nodeType||this.appendChild(b)})},prepend:function(){return this.domManip(arguments,!0,function(b){1!==this.nodeType&&11!==this.nodeType||this.insertBefore(b,this.firstChild)})},before:function(){if(!k(this[0]))return this.domManip(arguments,!1,function(b){this.parentNode.insertBefore(b,
this)});if(arguments.length){var b=n.clean(arguments);return this.pushStack(n.merge(b,this),"before",this.selector)}},after:function(){if(!k(this[0]))return this.domManip(arguments,!1,function(b){this.parentNode.insertBefore(b,this.nextSibling)});if(arguments.length){var b=n.clean(arguments);return this.pushStack(n.merge(this,b),"after",this.selector)}},remove:function(b,d){for(var c,e=0;null!=(c=this[e]);e++)b&&!n.filter(b,[c]).length||(d||1!==c.nodeType||(n.cleanData(c.getElementsByTagName("*")),
n.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c));return this},empty:function(){for(var b,d=0;null!=(b=this[d]);d++)for(1===b.nodeType&&n.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(b,d){return b=null!=b&&b,d=null==d?b:d,this.map(function(){return n.clone(this,b,d)})},html:function(d){return n.access(this,function(d){var c=this[0]||{},e=0,f=this.length;if(d===b)return 1===c.nodeType?c.innerHTML.replace(pb,""):b;if(!("string"!=
typeof d||sb.test(d)||!n.support.htmlSerialize&&za.test(d)||!n.support.leadingWhitespace&&ya.test(d)||Q[(Pa.exec(d)||["",""])[1].toLowerCase()])){d=d.replace(Oa,"<$1></$2>");try{for(;e<f;e++)c=this[e]||{},1===c.nodeType&&(n.cleanData(c.getElementsByTagName("*")),c.innerHTML=d);c=0}catch(g){}}c&&this.empty().append(d)},null,d,arguments.length)},replaceWith:function(b){return k(this[0])?this.length?this.pushStack(n(n.isFunction(b)?b():b),"replaceWith",b):this:n.isFunction(b)?this.each(function(d){var c=
n(this),e=c.html();c.replaceWith(b.call(this,d,e))}):("string"!=typeof b&&(b=n(b).detach()),this.each(function(){var d=this.nextSibling,c=this.parentNode;n(this).remove();d?n(d).before(b):n(c).append(b)}))},detach:function(b){return this.remove(b,!0)},domManip:function(d,c,e){d=[].concat.apply([],d);var f,g,h,q=0,k=d[0],t=[],l=this.length;if(!n.support.checkClone&&1<l&&"string"==typeof k&&Qa.test(k))return this.each(function(){n(this).domManip(d,c,e)});if(n.isFunction(k))return this.each(function(f){var g=
n(this);d[0]=k.call(this,f,c?g.html():b);g.domManip(d,c,e)});if(this[0]){if(f=n.buildFragment(d,this,t),h=f.fragment,g=h.firstChild,1===h.childNodes.length&&(h=g),g)for(c=c&&n.nodeName(g,"tr"),f=f.cacheable||l-1;q<l;q++)e.call(c&&n.nodeName(this[q],"table")?r(this[q],"tbody"):this[q],q===f?h:n.clone(h,!0,!0));h=g=null;t.length&&n.each(t,function(b,d){d.src?n.ajax?n.ajax({url:d.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):n.error("no ajax"):n.globalEval((d.text||d.textContent||
d.innerHTML||"").replace(vb,""));d.parentNode&&d.parentNode.removeChild(d)})}return this}});n.buildFragment=function(d,c,e){var f,g,h,q=d[0];return c=c||z,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,!(1===d.length&&"string"==typeof q&&512>q.length&&c===z&&"<"===q.charAt(0))||tb.test(q)||!n.support.checkClone&&Qa.test(q)||!n.support.html5Clone&&za.test(q)||(g=!0,f=n.fragments[q],h=f!==b),f||(f=c.createDocumentFragment(),n.clean(d,c,f,e),g&&(n.fragments[q]=h&&f)),{fragment:f,cacheable:g}};n.fragments=
{};n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,d){n.fn[b]=function(c){var e,f=0,g=[];c=n(c);var h=c.length;e=1===this.length&&this[0].parentNode;if((null==e||e&&11===e.nodeType&&1===e.childNodes.length)&&1===h)return c[d](this[0]),this;for(;f<h;f++)e=(0<f?this.clone(!0):this).get(),n(c[f])[d](e),g=g.concat(e);return this.pushStack(g,b,c.selector)}});n.extend({clone:function(b,d,c){var e,f,g,h;if(n.support.html5Clone||
n.isXMLDoc(b)||!za.test("<"+b.nodeName+">")?h=b.cloneNode(!0):(Aa.innerHTML=b.outerHTML,Aa.removeChild(h=Aa.firstChild)),!(n.support.noCloneEvent&&n.support.noCloneChecked||1!==b.nodeType&&11!==b.nodeType||n.isXMLDoc(b)))for(q(b,h),e=t(b),f=t(h),g=0;e[g];++g)f[g]&&q(e[g],f[g]);if(d&&(u(b,h),c))for(e=t(b),f=t(h),g=0;e[g];++g)u(e[g],f[g]);return h},clean:function(b,d,c,e){var f,g,h,q,k,t,l,m=d===z&&Ra,w=[];d&&void 0!==d.createDocumentFragment||(d=z);for(f=0;null!=(h=b[f]);f++)if("number"==typeof h&&
(h+=""),h){if("string"==typeof h)if(rb.test(h)){m=m||p(d);t=d.createElement("div");m.appendChild(t);h=h.replace(Oa,"<$1></$2>");g=(Pa.exec(h)||["",""])[1].toLowerCase();q=Q[g]||Q._default;k=q[0];for(t.innerHTML=q[1]+h+q[2];k--;)t=t.lastChild;if(!n.support.tbody)for(k=qb.test(h),q="table"!==g||k?"<table>"!==q[1]||k?[]:t.childNodes:t.firstChild&&t.firstChild.childNodes,g=q.length-1;0<=g;--g)n.nodeName(q[g],"tbody")&&!q[g].childNodes.length&&q[g].parentNode.removeChild(q[g]);!n.support.leadingWhitespace&&
ya.test(h)&&t.insertBefore(d.createTextNode(ya.exec(h)[0]),t.firstChild);h=t.childNodes;t.parentNode.removeChild(t)}else h=d.createTextNode(h);h.nodeType?w.push(h):n.merge(w,h)}if(t&&(h=t=m=null),!n.support.appendChecked)for(f=0;null!=(h=w[f]);f++)n.nodeName(h,"input")?v(h):void 0!==h.getElementsByTagName&&n.grep(h.getElementsByTagName("input"),v);if(c)for(b=function(b){if(!b.type||ub.test(b.type))return e?e.push(b.parentNode?b.parentNode.removeChild(b):b):c.appendChild(b)},f=0;null!=(h=w[f]);f++)n.nodeName(h,
"script")&&b(h)||(c.appendChild(h),void 0!==h.getElementsByTagName&&(l=n.grep(n.merge([],h.getElementsByTagName("script")),b),w.splice.apply(w,[f+1,0].concat(l)),f+=l.length));return w},cleanData:function(b,d){for(var c,e,f,g,h=0,q=n.expando,k=n.cache,t=n.support.deleteExpando,l=n.event.special;null!=(f=b[h]);h++)if((d||n.acceptData(f))&&(e=f[q],c=e&&k[e])){if(c.events)for(g in c.events)l[g]?n.event.remove(f,g):n.removeEvent(f,g,c.handle);k[e]&&(delete k[e],t?delete f[q]:f.removeAttribute?f.removeAttribute(q):
f[q]=null,n.deletedIds.push(e))}}});(function(){var b,d;n.uaMatch=function(b){b=b.toLowerCase();b=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||0>b.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return{browser:b[1]||"",version:b[2]||"0"}};b=n.uaMatch(W.userAgent);d={};b.browser&&(d[b.browser]=!0,d.version=b.version);d.chrome?d.webkit=!0:d.webkit&&(d.safari=!0);n.browser=d;n.sub=function(){function b(d,
c){return new b.fn.init(d,c)}n.extend(!0,b,this);b.superclass=this;b.fn=b.prototype=this();b.fn.constructor=b;b.sub=this.sub;b.fn.init=function(c,e){return e&&e instanceof n&&!(e instanceof b)&&(e=b(e)),n.fn.init.call(this,c,e,d)};b.fn.init.prototype=b.fn;var d=b(z);return b}})();var M,ia,ja,Ba=/alpha\([^)]*\)/i,wb=/opacity=([^)]*)/,xb=/^(top|right|bottom|left)$/,yb=/^(none|table(?!-c[ea]).+)/,Sa=/^margin/,ab=new RegExp("^("+fa+")(.*)$","i"),oa=new RegExp("^("+fa+")(?!px)[a-z%]+$","i"),zb=new RegExp("^([-+])=("+
fa+")","i"),va={BODY:"block"},Ab={position:"absolute",visibility:"hidden",display:"block"},Ta={letterSpacing:0,fontWeight:400},aa=["Top","Right","Bottom","Left"],Fa=["Webkit","O","Moz","ms"],Bb=n.fn.toggle;n.fn.extend({css:function(d,c){return n.access(this,function(d,c,e){return e!==b?n.style(d,c,e):n.css(d,c)},d,c,1<arguments.length)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(b,d){var c="boolean"==typeof b;return n.isFunction(b)&&n.isFunction(d)?Bb.apply(this,
arguments):this.each(function(){(c?b:y(this))?n(this).show():n(this).hide()})}});n.extend({cssHooks:{opacity:{get:function(b,d){if(d){var c=M(b,"opacity");return""===c?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":n.support.cssFloat?"cssFloat":"styleFloat"},style:function(d,c,e,f){if(d&&3!==d.nodeType&&8!==d.nodeType&&d.style){var g,h,q,k=n.camelCase(c),t=d.style;if(c=n.cssProps[k]||(n.cssProps[k]=w(t,k)),q=n.cssHooks[c]||
n.cssHooks[k],e===b)return q&&"get"in q&&(g=q.get(d,!1,f))!==b?g:t[c];if(!(h=typeof e,"string"===h&&(g=zb.exec(e))&&(e=(g[1]+1)*g[2]+parseFloat(n.css(d,c)),h="number"),null==e||"number"===h&&isNaN(e)||("number"!==h||n.cssNumber[k]||(e+="px"),q&&"set"in q&&(e=q.set(d,e,f))===b)))try{t[c]=e}catch(l){}}},css:function(d,c,e,f){var g,h,q,k=n.camelCase(c);return c=n.cssProps[k]||(n.cssProps[k]=w(d.style,k)),q=n.cssHooks[c]||n.cssHooks[k],q&&"get"in q&&(g=q.get(d,!0,f)),g===b&&(g=M(d,c)),"normal"===g&&c in
Ta&&(g=Ta[c]),e||f!==b?(h=parseFloat(g),e||n.isNumeric(h)?h||0:g):g},swap:function(b,d,c){var e,f={};for(e in d)f[e]=b.style[e],b.style[e]=d[e];c=c.call(b);for(e in d)b.style[e]=f[e];return c}});c.getComputedStyle?M=function(b,d){var e,f,g,h,q=c.getComputedStyle(b,null),k=b.style;return q&&(e=q.getPropertyValue(d)||q[d],""!==e||n.contains(b.ownerDocument,b)||(e=n.style(b,d)),oa.test(e)&&Sa.test(d)&&(f=k.width,g=k.minWidth,h=k.maxWidth,k.minWidth=k.maxWidth=k.width=e,e=q.width,k.width=f,k.minWidth=
g,k.maxWidth=h)),e}:z.documentElement.currentStyle&&(M=function(b,d){var c,e,f=b.currentStyle&&b.currentStyle[d],g=b.style;return null==f&&g&&g[d]&&(f=g[d]),oa.test(f)&&!xb.test(d)&&(c=g.left,e=b.runtimeStyle&&b.runtimeStyle.left,e&&(b.runtimeStyle.left=b.currentStyle.left),g.left="fontSize"===d?"1em":f,f=g.pixelLeft+"px",g.left=c,e&&(b.runtimeStyle.left=e)),""===f?"auto":f});n.each(["height","width"],function(b,d){n.cssHooks[d]={get:function(b,c,e){if(c)return 0===b.offsetWidth&&yb.test(M(b,"display"))?
n.swap(b,Ab,function(){return G(b,d,e)}):G(b,d,e)},set:function(b,c,e){return F(b,c,e?C(b,d,e,n.support.boxSizing&&"border-box"===n.css(b,"boxSizing")):0)}}});n.support.opacity||(n.cssHooks.opacity={get:function(b,d){return wb.test((d&&b.currentStyle?b.currentStyle.filter:b.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":d?"1":""},set:function(b,d){var c=b.style,e=b.currentStyle,f=n.isNumeric(d)?"alpha(opacity="+100*d+")":"",g=e&&e.filter||c.filter||"";c.zoom=1;1<=d&&""===n.trim(g.replace(Ba,""))&&
c.removeAttribute&&(c.removeAttribute("filter"),e&&!e.filter)||(c.filter=Ba.test(g)?g.replace(Ba,f):g+" "+f)}});n(function(){n.support.reliableMarginRight||(n.cssHooks.marginRight={get:function(b,d){return n.swap(b,{display:"inline-block"},function(){if(d)return M(b,"marginRight")})}});!n.support.pixelPosition&&n.fn.position&&n.each(["top","left"],function(b,d){n.cssHooks[d]={get:function(b,c){if(c){var e=M(b,d);return oa.test(e)?n(b).position()[d]+"px":e}}}})});n.expr&&n.expr.filters&&(n.expr.filters.hidden=
function(b){return 0===b.offsetWidth&&0===b.offsetHeight||!n.support.reliableHiddenOffsets&&"none"===(b.style&&b.style.display||M(b,"display"))},n.expr.filters.visible=function(b){return!n.expr.filters.hidden(b)});n.each({margin:"",padding:"",border:"Width"},function(b,d){n.cssHooks[b+d]={expand:function(c){var e="string"==typeof c?c.split(" "):[c],f={};for(c=0;4>c;c++)f[b+aa[c]+d]=e[c]||e[c-2]||e[0];return f}};Sa.test(b)||(n.cssHooks[b+d].set=F)});var Cb=/%20/g,bb=/\[\]$/,Ua=/\r?\n/g,Db=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
Eb=/^(?:select|textarea)/i;n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?n.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Eb.test(this.nodeName)||Db.test(this.type))}).map(function(b,d){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(b,c){return{name:d.name,value:b.replace(Ua,"\r\n")}}):{name:d.name,value:c.replace(Ua,"\r\n")}}).get()}});
n.param=function(d,c){var e,f=[],g=function(b,d){d=n.isFunction(d)?d():null==d?"":d;f[f.length]=encodeURIComponent(b)+"="+encodeURIComponent(d)};if(c===b&&(c=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(d)||d.jqx&&!n.isPlainObject(d))n.each(d,function(){g(this.name,this.value)});else for(e in d)E(e,d[e],c,g);return f.join("&").replace(Cb,"+")};n.support.ajax&&n.ajaxTransport(function(d){if(!d.crossDomain||n.support.cors){var e;return{send:function(f,g){var h,q,k=d.xhr();if(d.username?k.open(d.type,
d.url,d.async,d.username,d.password):k.open(d.type,d.url,d.async),d.xhrFields)for(q in d.xhrFields)k[q]=d.xhrFields[q];d.mimeType&&k.overrideMimeType&&k.overrideMimeType(d.mimeType);d.crossDomain||f["X-Requested-With"]||(f["X-Requested-With"]="XMLHttpRequest");try{for(q in f)k.setRequestHeader(q,f[q])}catch(t){}k.send(d.hasContent&&d.data||null);e=function(c,f){var q,t,l,v,m;try{if(e&&(f||4===k.readyState))if(e=b,h&&(k.onreadystatechange=n.noop,xhrOnUnloadAbort&&delete xhrCallbacks[h]),f)4!==k.readyState&&
k.abort();else{q=k.status;l=k.getAllResponseHeaders();v={};(m=k.responseXML)&&m.documentElement&&(v.xml=m);try{v.text=k.responseText}catch(p){}try{t=k.statusText}catch(p){t=""}q||!d.isLocal||d.crossDomain?1223===q&&(q=204):q=v.text?200:404}}catch(p){f||g(-1,p)}v&&g(q,t,v,l)};d.async?4===k.readyState?setTimeout(e,0):(h=++xhrId,xhrOnUnloadAbort&&(xhrCallbacks||(xhrCallbacks={},n(c).unload(xhrOnUnloadAbort)),xhrCallbacks[h]=e),k.onreadystatechange=e):e()},abort:function(){e&&e(0,1)}}}});var ka,ua,Fb=
/^(?:toggle|show|hide)$/,Gb=new RegExp("^(?:([-+])=|)("+fa+")([a-z%]*)$","i"),Hb=/queueHooks$/,pa=[function(b,d,c){var e,f,g,h,q,k,t=this,l=b.style,v={},m=[],p=b.nodeType&&y(b);c.queue||(q=n._queueHooks(b,"fx"),null==q.unqueued&&(q.unqueued=0,k=q.empty.fire,q.empty.fire=function(){q.unqueued||k()}),q.unqueued++,t.always(function(){t.always(function(){q.unqueued--;n.queue(b,"fx").length||q.empty.fire()})}));1===b.nodeType&&("height"in d||"width"in d)&&(c.overflow=[l.overflow,l.overflowX,l.overflowY],
"inline"===n.css(b,"display")&&"none"===n.css(b,"float")&&(n.support.inlineBlockNeedsLayout&&"inline"!==H(b.nodeName)?l.zoom=1:l.display="inline-block"));c.overflow&&(l.overflow="hidden",n.support.shrinkWrapBlocks||t.done(function(){l.overflow=c.overflow[0];l.overflowX=c.overflow[1];l.overflowY=c.overflow[2]}));for(e in d)(g=d[e],Fb.exec(g))&&(delete d[e],f=f||"toggle"===g,g!==(p?"hide":"show"))&&m.push(e);if(d=m.length)for(g=n._data(b,"fxshow")||n._data(b,"fxshow",{}),("hidden"in g)&&(p=g.hidden),
f&&(g.hidden=!p),p?n(b).show():t.done(function(){n(b).hide()}),t.done(function(){var d;n.removeData(b,"fxshow",!0);for(d in v)n.style(b,d,v[d])}),e=0;e<d;e++)f=m[e],h=t.createTween(f,p?g[f]:0),v[f]=g[f]||n.style(b,f),f in g||(g[f]=h.start,p&&(h.end=h.start,h.start="width"===f||"height"===f?1:0))}],ma={"*":[function(b,d){var c,e,f=this.createTween(b,d),g=Gb.exec(d),h=f.cur(),q=+h||0,k=1,t=20;if(g){if(c=+g[2],"px"!==(e=g[3]||(n.cssNumber[b]?"":"px"))&&q){q=n.css(f.elem,b,!0)||c||1;do k=k||".5",q/=k,
n.style(f.elem,b,q+e);while(k!==(k=f.cur()/h)&&1!==k&&--t)}f.unit=e;f.start=q;f.end=g[1]?q+(g[1]+1)*c:c}return f}]};n.Animation=n.extend(S,{tweener:function(b,d){n.isFunction(b)?(d=b,b=["*"]):b=b.split(" ");for(var c,e=0,f=b.length;e<f;e++)c=b[e],ma[c]=ma[c]||[],ma[c].unshift(d)},prefilter:function(b,d){d?pa.unshift(b):pa.push(b)}});n.Tween=D;D.prototype={constructor:D,init:function(b,d,c,e,f,g){this.elem=b;this.prop=c;this.easing=f||"swing";this.options=d;this.start=this.now=this.cur();this.end=
e;this.unit=g||(n.cssNumber[c]?"":"px")},cur:function(){var b=D.propHooks[this.prop];return b&&b.get?b.get(this):D.propHooks._default.get(this)},run:function(b){var d,c=D.propHooks[this.prop];return this.options.duration?this.pos=d=n.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):this.pos=d=b,this.now=(this.end-this.start)*d+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):D.propHooks._default.set(this),this}};D.prototype.init.prototype=
D.prototype;D.propHooks={_default:{get:function(b){var d;return null==b.elem[b.prop]||b.elem.style&&null!=b.elem.style[b.prop]?(d=n.css(b.elem,b.prop,!1,""),d&&"auto"!==d?d:0):b.elem[b.prop]},set:function(b){n.fx.step[b.prop]?n.fx.step[b.prop](b):b.elem.style&&(null!=b.elem.style[n.cssProps[b.prop]]||n.cssHooks[b.prop])?n.style(b.elem,b.prop,b.now+b.unit):b.elem[b.prop]=b.now}}};D.propHooks.scrollTop=D.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};
n.each(["toggle","show","hide"],function(b,d){var c=n.fn[d];n.fn[d]=function(e,f,g){return null==e||"boolean"==typeof e||!b&&n.isFunction(e)&&n.isFunction(f)?c.apply(this,arguments):this.animate(R(d,!0),e,f,g)}});n.fn.extend({fadeTo:function(b,d,c,e){return this.filter(y).css("opacity",0).show().end().animate({opacity:d},b,c,e)},animate:function(b,d,c,e){var f=n.isEmptyObject(b),g=n.speed(d,c,e);d=function(){var d=S(this,n.extend({},b),g);f&&d.stop(!0)};return f||!1===g.queue?this.each(d):this.queue(g.queue,
d)},stop:function(d,c,e){var f=function(b){var d=b.stop;delete b.stop;d(e)};return"string"!=typeof d&&(e=c,c=d,d=b),c&&!1!==d&&this.queue(d||"fx",[]),this.each(function(){var b=!0,c=null!=d&&d+"queueHooks",g=n.timers,h=n._data(this);if(c)h[c]&&h[c].stop&&f(h[c]);else for(c in h)h[c]&&h[c].stop&&Hb.test(c)&&f(h[c]);for(c=g.length;c--;)g[c].elem!==this||null!=d&&g[c].queue!==d||(g[c].anim.stop(e),b=!1,g.splice(c,1));!b&&e||n.dequeue(this,d)})}});n.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),
fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,d){n.fn[b]=function(b,c,e){return this.animate(d,b,c,e)}});n.speed=function(b,d,c){var e=b&&"object"==typeof b?n.extend({},b):{complete:c||!c&&d||n.isFunction(b)&&b,duration:b,easing:c&&d||d&&!n.isFunction(d)&&d};return e.duration=n.fx.off?0:"number"==typeof e.duration?e.duration:e.duration in n.fx.speeds?n.fx.speeds[e.duration]:n.fx.speeds._default,null!=e.queue&&!0!==e.queue||(e.queue="fx"),e.old=e.complete,
e.complete=function(){n.isFunction(e.old)&&e.old.call(this);e.queue&&n.dequeue(this,e.queue)},e};n.easing={linear:function(b){return b},swing:function(b){return.5-Math.cos(b*Math.PI)/2}};n.timers=[];n.fx=D.prototype.init;n.fx.tick=function(){var d,c=n.timers,e=0;for(ka=n.now();e<c.length;e++)(d=c[e])()||c[e]!==d||c.splice(e--,1);c.length||n.fx.stop();ka=b};n.fx.timer=function(b){b()&&n.timers.push(b)&&!ua&&(ua=setInterval(n.fx.tick,n.fx.interval))};n.fx.interval=13;n.fx.stop=function(){clearInterval(ua);
ua=null};n.fx.speeds={slow:600,fast:200,_default:400};n.fx.step={};n.expr&&n.expr.filters&&(n.expr.filters.animated=function(b){return n.grep(n.timers,function(d){return b===d.elem}).length});var Va=/^(?:body|html)$/i;n.fn.offset=function(d){if(arguments.length)return d===b?this:this.each(function(b){n.offset.setOffset(this,d,b)});var c,e,f,g,h,q,k,t={top:0,left:0},l=this[0],v=l&&l.ownerDocument;if(v)return(e=v.body)===l?n.offset.bodyOffset(l):(c=v.documentElement,n.contains(c,l)?(void 0!==l.getBoundingClientRect&&
(t=l.getBoundingClientRect()),f=Y(v),g=c.clientTop||e.clientTop||0,h=c.clientLeft||e.clientLeft||0,q=f.pageYOffset||c.scrollTop,k=f.pageXOffset||c.scrollLeft,{top:t.top+q-g,left:t.left+k-h}):t)};n.offset={bodyOffset:function(b){var d=b.offsetTop,c=b.offsetLeft;return n.support.doesNotIncludeMarginInBodyOffset&&(d+=parseFloat(n.css(b,"marginTop"))||0,c+=parseFloat(n.css(b,"marginLeft"))||0),{top:d,left:c}},setOffset:function(b,d,c){var e=n.css(b,"position");"static"===e&&(b.style.position="relative");
var f,g,h=n(b),q=h.offset(),k=n.css(b,"top"),t=n.css(b,"left"),l={},v={};("absolute"===e||"fixed"===e)&&-1<n.inArray("auto",[k,t])?(v=h.position(),f=v.top,g=v.left):(f=parseFloat(k)||0,g=parseFloat(t)||0);n.isFunction(d)&&(d=d.call(b,c,q));null!=d.top&&(l.top=d.top-q.top+f);null!=d.left&&(l.left=d.left-q.left+g);"using"in d?d.using.call(b,l):h.css(l)}};n.fn.extend({isRendered:function(){var b=this[0];return null!=b.parentNode&&0!==b.offsetWidth&&0!==b.offsetHeight},getSizeFromStyle:function(){var b,
d=null,e=null,f=this[0];return f.style.width&&(d=f.style.width),f.style.height&&(e=f.style.height),b=c.getComputedStyle?getComputedStyle(f,null):f.currentStyle,b&&(b.width&&(d=b.width),b.height&&(e=b.height)),"0px"===d&&(d=0),"0px"===e&&(e=0),null===d&&(d=0),null===e&&(e=0),{width:d,height:e}},initAnimate:function(){},sizeStyleChanged:function(b){var d,c=this,e=function(b){var e=d;b&&b[0]&&"style"===b[0].attributeName&&"attributes"===b[0].type&&(e.element.offsetWidth===e.offsetWidth&&e.element.offsetHeight===
e.offsetHeight||(e.offsetWidth=e.element.offsetWidth,e.offsetHeight=e.element.offsetHeight,c.isRendered()&&e.callback()))};d={element:c[0],offsetWidth:c[0].offsetWidth,offsetHeight:c[0].offsetHeight,callback:b};try{c.elementStyleObserver||(c.elementStyleObserver=new MutationObserver(e),c.elementStyleObserver.observe(c[0],{attributes:!0,childList:!1,characterData:!1}))}catch(f){}},position:function(){if(this[0]){var b=this[0],d=this.offsetParent(),c=this.offset(),e=Va.test(d[0].nodeName)?{top:0,left:0}:
d.offset();return c.top-=parseFloat(n.css(b,"marginTop"))||0,c.left-=parseFloat(n.css(b,"marginLeft"))||0,e.top+=parseFloat(n.css(d[0],"borderTopWidth"))||0,e.left+=parseFloat(n.css(d[0],"borderLeftWidth"))||0,{top:c.top-e.top,left:c.left-e.left}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent||z.body;b&&!Va.test(b.nodeName)&&"static"===n.css(b,"position");)b=b.offsetParent;return b||z.body})}});n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(d,
c){var e=/Y/.test(c);n.fn[d]=function(f){return n.access(this,function(d,f,g){var h=Y(d);if(g===b)return h?c in h?h[c]:h.document.documentElement[f]:d[f];h?h.scrollTo(e?n(h).scrollLeft():g,e?g:n(h).scrollTop()):d[f]=g},d,f,arguments.length,null)}});n.each({Height:"height",Width:"width"},function(d,c){n.each({padding:"inner"+d,content:c,"":"outer"+d},function(e,f){n.fn[f]=function(f,g){var h=arguments.length&&(e||"boolean"!=typeof f),q=e||(!0===f||!0===g?"margin":"border");return n.access(this,function(c,
e,f){var g;return n.isWindow(c)?c.document.documentElement["client"+d]:9===c.nodeType?(g=c.documentElement,Math.max(c.body["scroll"+d],g["scroll"+d],c.body["offset"+d],g["offset"+d],g["client"+d])):f===b?n.css(c,e,f,q):n.style(c,e,f,q)},c,h?f:b,h,null)}})});c.JQXLite=c.jqxHelper=n;"function"==typeof define&&define.amd&&define.amd.JQXLite&&define("jqx",[],function(){return n})}(window);(function(c){if(c.jQuery)return void(c.minQuery=c.JQXLite=c.jQuery);c.$?c.minQuery=c.JQXLite=c.$:c.$=c.minQuery=c.JQXLite})(window);
var jqxBaseFramework=window.minQuery||window.jQuery;
!function(c){c.jqx=c.jqx||{};jqwidgets={createInstance:function(b,d,e){return"jqxDataAdapter"==d?new c.jqx.dataAdapter(e[0],e[1]||{}):(c(b)[d](e||{}),c(b)[d]("getInstance"))}};c.jqx.define=function(b,d,c){b[d]=function(){this.baseType&&(this.base=new b[this.baseType],this.base.defineInstance());this.defineInstance();this.metaInfo()};b[d].prototype.defineInstance=function(){};b[d].prototype.metaInfo=function(){};b[d].prototype.base=null;b[d].prototype.baseType=void 0;c&&b[c]&&(b[d].prototype.baseType=
c)};c.jqx.invoke=function(b,d){if(0!=d.length){for(var e=typeof d==Array||0<d.length?d[0]:d,f=typeof d==Array||1<d.length?Array.prototype.slice.call(d,1):c({}).toArray();void 0==b[e]&&null!=b.base;){if(void 0!=b[e]&&c.isFunction(b[e]))return b[e].apply(b,f);if("string"==typeof e){var g=e.toLowerCase();if(void 0!=b[g]&&c.isFunction(b[g]))return b[g].apply(b,f)}b=b.base}if(void 0!=b[e]&&c.isFunction(b[e]))return b[e].apply(b,f);if("string"==typeof e&&(g=e.toLowerCase(),void 0!=b[g]&&c.isFunction(b[g])))return b[g].apply(b,
f)}};c.jqx.hasProperty=function(b,d){if("object"==typeof d)for(var c in d){for(var f=b;f;){if(f.hasOwnProperty(c)||f.hasOwnProperty(c.toLowerCase()))return!0;f=f.base}break}else for(;b;){if(b.hasOwnProperty(d)||b.hasOwnProperty(d.toLowerCase()))return!0;b=b.base}return!1};c.jqx.hasFunction=function(b,d){if(0==d.length||void 0==b)return!1;var e=typeof d==Array||0<d.length?d[0]:d;for((typeof d==Array||1<d.length)&&Array.prototype.slice.call(d,1);void 0==b[e]&&null!=b.base;){if(b[e]&&c.isFunction(b[e]))return!0;
if("string"==typeof e){var f=e.toLowerCase();if(b[f]&&c.isFunction(b[f]))return!0}b=b.base}return b[e]&&c.isFunction(b[e])||"string"==typeof e&&(f=e.toLowerCase(),b[f]&&c.isFunction(b[f]))?!0:!1};c.jqx.isPropertySetter=function(b,d){return 1==d.length&&"object"==typeof d[0]||2==d.length&&"string"==typeof d[0]&&!c.jqx.hasFunction(b,d)};c.jqx.validatePropertySetter=function(b,d,e){if(!c.jqx.propertySetterValidation)return!0;if(1==d.length&&"object"==typeof d[0]){for(var f in d[0]){for(d=b;!d.hasOwnProperty(f)&&
d.base;)d=d.base;if(!d||!d.hasOwnProperty(f)){if(!e){if(d.hasOwnProperty(f.toString().toLowerCase()))break;throw"Invalid property: "+f;}return!1}}return!0}if(2!=d.length){if(!e)throw 0<="Invalid property: "+d.length?d[0]:"";return!1}for(;!b.hasOwnProperty(d[0])&&b.base;)b=b.base;if(!b||!b.hasOwnProperty(d[0])){if(!e)throw"Invalid property: "+d[0];return!1}return!0};Object.keys||(Object.keys=function(){var b=Object.prototype.hasOwnProperty,d=!{toString:null}.propertyIsEnumerable("toString"),c="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),
f=c.length;return function(g){if("object"!=typeof g&&("function"!=typeof g||null===g))throw new TypeError("Object.keys called on non-object");var h,k=[];for(h in g)b.call(g,h)&&k.push(h);if(d)for(h=0;h<f;h++)b.call(g,c[h])&&k.push(c[h]);return k}}());c.jqx.set=function(b,d){var e=0;if(1==d.length&&"object"==typeof d[0]){if(b.isInitialized&&Object.keys&&1<Object.keys(d[0]).length){var f=c.data(b.base?b.base.element:b.element,b.widgetName).initArgs;if(f&&JSON&&JSON.stringify&&d[0]&&f[0])try{if(JSON.stringify(d[0])==
JSON.stringify(f[0])){var g=!0;if(c.each(d[0],function(d,c){if(b[d]!=c)return g=!1,!1}),g)return}}catch(l){}b.batchUpdate=d[0];var h={},k={};c.each(d[0],function(d,c){for(var f=b;!f.hasOwnProperty(d)&&null!=f.base;)f=f.base;f.hasOwnProperty(d)?b[d]!=c&&(h[d]=b[d],k[d]=c,e++):f.hasOwnProperty(d.toLowerCase())&&b[d.toLowerCase()]!=c&&(h[d.toLowerCase()]=b[d.toLowerCase()],k[d.toLowerCase()]=c,e++)});2>e&&(b.batchUpdate=null)}c.each(d[0],function(d,e){for(var f=b;!f.hasOwnProperty(d)&&null!=f.base;)f=
f.base;if(f.hasOwnProperty(d))c.jqx.setvalueraiseevent(f,d,e);else if(f.hasOwnProperty(d.toLowerCase()))c.jqx.setvalueraiseevent(f,d.toLowerCase(),e);else if(c.jqx.propertySetterValidation)throw"jqxCore: invalid property '"+d+"'";});null!=b.batchUpdate&&(b.batchUpdate=null,b.propertiesChangedHandler&&1<e&&b.propertiesChangedHandler(b,h,k))}else if(2==d.length){for(;!b.hasOwnProperty(d[0])&&b.base;)b=b.base;if(b.hasOwnProperty(d[0]))c.jqx.setvalueraiseevent(b,d[0],d[1]);else if(b.hasOwnProperty(d[0].toLowerCase()))c.jqx.setvalueraiseevent(b,
d[0].toLowerCase(),d[1]);else if(c.jqx.propertySetterValidation)throw"jqxCore: invalid property '"+d[0]+"'";}};c.jqx.setvalueraiseevent=function(b,d,c){var f=b[d];b[d]=c;b.isInitialized&&(void 0!=b.propertyChangedHandler&&b.propertyChangedHandler(b,d,f,c),void 0!=b.propertyChangeMap&&void 0!=b.propertyChangeMap[d]&&b.propertyChangeMap[d](b,d,f,c))};c.jqx.get=function(b,d){if(void 0!=d&&null!=d){if(b.propertyMap){var c=b.propertyMap(d);if(null!=c)return c}if(b.hasOwnProperty(d))return b[d];if(b.hasOwnProperty(d.toLowerCase()))return b[d.toLowerCase()];
c=void 0;if(typeof d==Array){if(1!=d.length)return;c=d[0]}else"string"==typeof d&&(c=d);for(;!b.hasOwnProperty(c)&&b.base;)b=b.base;return b?b[c]:void 0}};c.jqx.serialize=function(b){var d;if(c.isArray(b)){d="[";for(var e=0;e<b.length;e++)0<e&&(d+=", "),d+=c.jqx.serialize(b[e]);d+="]"}else if("object"==typeof b){d="{";var f=0;for(e in b)0<f++&&(d+=", "),d+=e+": "+c.jqx.serialize(b[e]);d+="}"}else d=b.toString();return d};c.jqx.propertySetterValidation=!0;c.jqx.jqxWidgetProxy=function(b,d,e){b=(c(d),
c.data(d,b));if(void 0!=b){b=b.instance;if(c.jqx.hasFunction(b,e))return c.jqx.invoke(b,e);if(c.jqx.isPropertySetter(b,e)){if(c.jqx.validatePropertySetter(b,e))return void c.jqx.set(b,e)}else{if("object"==typeof e&&0==e.length)return;if("object"==typeof e&&1==e.length&&c.jqx.hasProperty(b,e[0]))return c.jqx.get(b,e[0]);if("string"==typeof e&&c.jqx.hasProperty(b,e[0]))return c.jqx.get(b,e)}throw"jqxCore: Invalid parameter '"+c.jqx.serialize(e)+"' does not exist.";}};c.jqx.applyWidget=function(b,d,
e,f){var g=!1;try{g=void 0!=window.MSApp}catch(p){}var h=c(b);f?(f.host=h,f.element=b):f=new c.jqx["_"+d];""==b.id&&(b.id=c.jqx.utilities.createId());var k={host:h,element:b,instance:f,initArgs:e};f.widgetName=d;c.data(b,d,k);c.data(b,"jqxWidget",k.instance);var l=[];for(f=k.instance;f;)f.isInitialized=!1,l.push(f),f=f.base;l.reverse();l[0].theme=c.jqx.theme||"";c.jqx.jqxWidgetProxy(d,b,e);for(var m in l)f=l[m],0==m&&(f.host=h,f.element=b,f.WinJS=g),void 0!=f&&(f.definedInstance&&f.definedInstance(),
null!=f.createInstance&&(g?MSApp.execUnsafeLocalFunction(function(){f.createInstance(e)}):f.createInstance(e)));for(m in l)void 0!=l[m]&&(l[m].isInitialized=!0);g?MSApp.execUnsafeLocalFunction(function(){k.instance.refresh(!0)}):k.instance.refresh(!0)};c.jqx.jqxWidget=function(b,d,e){try{jqxArgs=Array.prototype.slice.call(e,0)}catch(k){jqxArgs=""}try{void 0!=window.MSApp}catch(k){}var f="";d&&(f="_"+d);c.jqx.define(c.jqx,"_"+b,f);var g=[];if(!window[b]){var h=function(b){if(null==b)return"";switch(c.type(b)){case "string":case "number":case "date":case "boolean":case "bool":return null===
b?"":b.toString()}var d="";return c.each(b,function(b,e){0<b&&(d+=", ");d+="[";var f=0;if("object"==c.type(e))for(var g in e)0<f&&(d+=", "),d+="{"+g+":"+e[g]+"}",f++;else 0<f&&(d+=", "),d+="{"+b+":"+e+"}";d+="]"}),d};jqwidgets[b]=window[b]=function(d,e){var f=[];e||(e={});f.push(e);var p=d;if("object"===c.type(p)&&d[0]?""===(p=d[0].id)&&(p=d[0].id=c.jqx.utilities.createId()):"object"===c.type(d)&&d&&d.nodeName&&""===(p=d.id)&&(p=d.id=c.jqx.utilities.createId()),window.jqxWidgets&&window.jqxWidgets[p]){if(e&&
c.each(window.jqxWidgets[p],function(d){(d=c(this.element).data())&&d.jqxWidget&&c(this.element)[b](e)}),1==window.jqxWidgets[p].length){var r=c(window.jqxWidgets[p][0].widgetInstance.element).data();if(r&&r.jqxWidget)return window.jqxWidgets[p][0]}if((r=c(window.jqxWidgets[p][0].widgetInstance.element).data())&&r.jqxWidget)return window.jqxWidgets[p]}var u=c(d);0===u.length&&(u=c("<div></div>"),"jqxInput"!==b&&"jqxPasswordInput"!==b&&"jqxMaskedInput"!==b||(u=c("<input/>")),"jqxTextArea"===b&&(u=
c("<textarea></textarea>")),"jqxButton"!==b&&"jqxRepeatButton"!==b&&"jqxToggleButton"!==b||(u=c("<button/>")),"jqxSplitter"===b&&(u=c("<div><div>Panel 1</div><div>Panel 2</div></div>")),"jqxTabs"===b&&(u=c("<div><ul><li>Tab 1</li><li>Tab 2</li></ul><div>Content 1</div><div>Content 2</div></div>")),"jqxRibbon"===b&&(u=c("<div><ul><li>Tab 1</li><li>Tab 2</li></ul><div><div>Content 1</div><div>Content 2</div></div></div>")),"jqxDocking"===b&&(u=c("<div><div><div><div>Title 1</div><div>Content 1</div></div></div></div>")),
"jqxWindow"===b&&(u=c("<div><div>Title 1</div><div>Content 1</div></div>")));var q=[];return c.each(u,function(d){d=u[d];if(c.jqx.applyWidget(d,b,f,void 0),!g[b]){var e=c.data(d,"jqxWidget"),e=c.jqx["_"+b].prototype.defineInstance();c.jqx["_"+b].prototype.metaInfo&&c.jqx["_"+b].prototype.metaInfo();"jqxDockingLayout"==b&&(e=c.extend(e,c.jqx._jqxLayout.prototype.defineInstance()));"jqxToggleButton"!=b&&"jqxRepeatButton"!=b||(e=c.extend(e,c.jqx._jqxButton.prototype.defineInstance()));"jqxTreeGrid"==
b&&(e=c.extend(e,c.jqx._jqxDataTable.prototype.defineInstance()));var k=function(b){this.widgetInstance=b=c.data(b,"jqxWidget");var d=c.extend(this,b);d.on=d.addEventListener=function(b,c){d.addHandler(d.base?d.base.host:d.host,b,c)};d.off=d.removeEventListener=function(b){d.removeHandler(d.base?d.base.host:d.host,b)};for(var e in b)"function"==c.type(b[e])&&(d[e]=c.proxy(b[e],b));return d};g[b]=k;c.each(e,function(d,e){Object.defineProperty(k.prototype,d,{get:function(){return this.widgetInstance?
this.widgetInstance[d]:e},set:function(e){if(this.widgetInstance&&(this.widgetInstance[d]!=e||"width"===d||"height"===d)){var f=this.widgetInstance[d],g=c.type(f),q=c.type(e),k=!1;if(g==q&&"source"!==d&&"width"!==d&&"height"!==d||(k=!0),k||h(f)!=h(e))g={},g[d]=e,this.widgetInstance.host?this.widgetInstance.host[b](g):this.widgetInstance.base.host[b](g),this.widgetInstance[d]=e,this.widgetInstance.propertyUpdated&&this.widgetInstance.propertyUpdated(d,f,e)}}})})}e=new g[b](d);q.push(e);window.jqxWidgets||
(window.jqxWidgets=[]);window.jqxWidgets[p]||(window.jqxWidgets[p]=[]);window.jqxWidgets[p].push(e)}),1===q.length?q[0]:q}}c.fn[b]=function(){var d=Array.prototype.slice.call(arguments,0);if(0==d.length||1==d.length&&"object"==typeof d[0]){if(0==this.length)throw this.selector?Error("Invalid Selector - "+this.selector+"! Please, check whether the used ID or CSS Class name is correct."):Error("Invalid Selector! Please, check whether the used ID or CSS Class name is correct.");return this.each(function(){var e=
(c(this),this);null==c.data(e,b)?c.jqx.applyWidget(e,b,d,void 0):c.jqx.jqxWidgetProxy(b,this,d)})}if(0==this.length)throw this.selector?Error("Invalid Selector - "+this.selector+"! Please, check whether the used ID or CSS Class name is correct."):Error("Invalid Selector! Please, check whether the used ID or CSS Class name is correct.");var e=null,f=0;return this.each(function(){var g=c.jqx.jqxWidgetProxy(b,this,d);if(0==f)e=g,f++;else{if(1==f){var h=[];h.push(e);e=h}e.push(g)}}),e};try{c.extend(c.jqx["_"+
b].prototype,Array.prototype.slice.call(e,0)[0])}catch(k){}c.extend(c.jqx["_"+b].prototype,{toThemeProperty:function(b,d){return c.jqx.toThemeProperty(this,b,d)}});c.jqx["_"+b].prototype.refresh=function(){this.base&&this.base.refresh(!0)};c.jqx["_"+b].prototype.createInstance=function(){};c.jqx["_"+b].prototype.addEventHandler=function(b,d){this.host.bind(b,d)};c.jqx["_"+b].prototype.removeEventHandler=function(b,d){this.host.unbind(b)};c.jqx["_"+b].prototype.applyTo=function(d,e){if(!(e instanceof
Array)){var f=[];f.push(e);e=f}c.jqx.applyWidget(d,b,e,this)};c.jqx["_"+b].prototype.getInstance=function(){return this};c.jqx["_"+b].prototype.propertyChangeMap={};c.jqx["_"+b].prototype.addHandler=function(b,d,e,f){c.jqx.addHandler(c(b),d,e,f)};c.jqx["_"+b].prototype.removeHandler=function(b,d,e){c.jqx.removeHandler(c(b),d,e)};c.jqx["_"+b].prototype.setOptions=function(){if(this.host&&this.host.length&&1==this.host.length)return c.jqx.jqxWidgetProxy(b,this.host[0],arguments)}};c.jqx.toThemeProperty=
function(b,d,c){if(""==b.theme)return d;d=d.split(" ");for(var f="",g=0;g<d.length;g++){0<g&&(f+=" ");var h=d[g],f=f+(null!=c&&c?h+"-"+b.theme:h+" "+h+"-"+b.theme)}return f};c.jqx.addHandler=function(b,d,e,f){d=d.split(" ");for(var g=0;g<d.length;g++){var h=d[g];if(window.addEventListener)switch(h){case "mousewheel":c.jqx.browser.mozilla?b[0].addEventListener("DOMMouseScroll",e,!1):b[0].addEventListener("mousewheel",e,!1);continue;case "mousemove":if(!f){b[0].addEventListener("mousemove",e,!1);continue}}void 0==
f||null==f?b.on?b.on(h,e):b.bind(h,e):b.on?b.on(h,f,e):b.bind(h,f,e)}};c.jqx.removeHandler=function(b,d,e){if(!d)return void(b.off?b.off():b.unbind());d=d.split(" ");for(var f=0;f<d.length;f++){var g=d[f];if(window.removeEventListener)switch(g){case "mousewheel":c.jqx.browser.mozilla?b[0].removeEventListener("DOMMouseScroll",e,!1):b[0].removeEventListener("mousewheel",e,!1);continue;case "mousemove":if(e){b[0].removeEventListener("mousemove",e,!1);continue}}void 0!=g?void 0==e?b.off?b.off(g):b.unbind(g):
b.off?b.off(g,e):b.unbind(g,e):b.off?b.off():b.unbind()}};c.jqx.theme=c.jqx.theme||"";c.jqx.scrollAnimation=c.jqx.scrollAnimation||!1;c.jqx.resizeDelay=c.jqx.resizeDelay||10;c.jqx.ready=function(){c(window).trigger("jqxReady")};c.jqx.init=function(b){c.each(b,function(b,e){"theme"==b&&(c.jqx.theme=e);"scrollBarSize"==b&&(c.jqx.utilities.scrollBarSize=e);"touchScrollBarSize"==b&&(c.jqx.utilities.touchScrollBarSize=e);"scrollBarButtonsVisibility"==b&&(c.jqx.utilities.scrollBarButtonsVisibility=e)})};
c.jqx.utilities=c.jqx.utilities||{};c.extend(c.jqx.utilities,{scrollBarSize:13,touchScrollBarSize:0,scrollBarButtonsVisibility:"visible",createId:function(){return"jqxWidget"+(65536*(1+Math.random())|0).toString(16).substring(1)+(65536*(1+Math.random())|0).toString(16).substring(1)},setTheme:function(b,d,e){if(void 0!==e&&e[0].className.split){for(var f=e[0].className.split(" "),g=[],h=[],k=e.children(),l=0;l<f.length;l+=1)0<=f[l].indexOf(b)&&(0<b.length?(g.push(f[l]),h.push(f[l].replace(b,d))):h.push(f[l].replace("-"+
d,"")+"-"+d));this._removeOldClasses(g,e);this._addNewClasses(h,e);for(l=0;l<k.length;l+=1)this.setTheme(b,d,c(k[l]))}},_removeOldClasses:function(b,d){for(var c=0;c<b.length;c+=1)d.removeClass(b[c])},_addNewClasses:function(b,d){for(var c=0;c<b.length;c+=1)d.addClass(b[c])},getOffset:function(b){var d=c.jqx.mobile.getLeftPos(b[0]);return{top:c.jqx.mobile.getTopPos(b[0]),left:d}},resize:function(b,d,e,f){void 0===f&&(f=!0);var g=-1,h=this,k=function(b){if(!h.hiddenWidgets)return-1;for(var d=-1,c=
0;c<h.hiddenWidgets.length;c++)if(b.id){if(h.hiddenWidgets[c].id==b.id){d=c;break}}else if(h.hiddenWidgets[c].id==b[0].id){d=c;break}return d};if(this.resizeHandlers){for(var l=0;l<this.resizeHandlers.length;l++)if(b.id){if(this.resizeHandlers[l].id==b.id){g=l;break}}else if(this.resizeHandlers[l].id==b[0].id){g=l;break}if(!0===e){if(-1!=g&&this.resizeHandlers.splice(g,1),0==this.resizeHandlers.length)e=c(window),e.off?(e.off("resize.jqx"),e.off("orientationchange.jqx"),e.off("orientationchanged.jqx")):
(e.unbind("resize.jqx"),e.unbind("orientationchange.jqx"),e.unbind("orientationchanged.jqx")),this.resizeHandlers=null;b=k(b);return void(-1!=b&&this.hiddenWidgets&&this.hiddenWidgets.splice(b,1))}}else if(!0===e)return b=k(b),void(-1!=b&&this.hiddenWidgets&&this.hiddenWidgets.splice(b,1));var h=this,m=function(b,d){if(h.resizeHandlers){var e=function(b){var d=-1;for(b=b.parentNode;b;)d++,b=b.parentNode;return d},f=function(b,d){if(!b.widget||!d.widget)return 0;var c=e(b.widget[0]),f=e(d.widget[0]);
return c<f?-1:c>f?1:0},g=function(b){if(0<h.hiddenWidgets.length){h.hiddenWidgets.sort(f);var e=function(){for(var b=!1,e=[],f=0;f<h.hiddenWidgets.length;f++){var g=h.hiddenWidgets[f];c.jqx.isHidden(g.widget)?(b=!0,e.push(g)):g.callback&&g.callback(d)}h.hiddenWidgets=e;b||clearInterval(h.__resizeInterval)};if(0==b)return e(),void(h.__resizeInterval&&clearInterval(h.__resizeInterval));h.__resizeInterval&&clearInterval(h.__resizeInterval);h.__resizeInterval=setInterval(function(){e()},100)}};h.hiddenWidgets&&
0<h.hiddenWidgets.length&&g(!1);h.hiddenWidgets=[];h.resizeHandlers.sort(f);for(var l=0;l<h.resizeHandlers.length;l++){var m=h.resizeHandlers[l],p=m.widget,r=m.data;if(r&&r.jqxWidget){var G=r.jqxWidget.width,H=r.jqxWidget.height;r.jqxWidget.base&&(void 0==G&&(G=r.jqxWidget.base.width),void 0==H&&(H=r.jqxWidget.base.height));void 0===G&&void 0===H&&(G=r.jqxWidget.element.style.width,H=r.jqxWidget.element.style.height);var E=!1;if(null!=G&&-1!=G.toString().indexOf("%")&&(E=!0),null!=H&&-1!=H.toString().indexOf("%")&&
(E=!0),c.jqx.isHidden(p))-1===k(p)&&(E||!0===b)&&!0!==m.data.nestedWidget&&h.hiddenWidgets.push(m);else if(void 0===b||!0!==b){if(E){if(m.callback(d),h.watchedElementData)for(p=0;p<h.watchedElementData.length;p++)if(h.watchedElementData[p].element==r.jqxWidget.element){h.watchedElementData[p].offsetWidth=r.jqxWidget.element.offsetWidth;h.watchedElementData[p].offsetHeight=r.jqxWidget.element.offsetHeight;break}0<=h.hiddenWidgets.indexOf(m)&&h.hiddenWidgets.splice(h.hiddenWidgets.indexOf(m),1)}r.jqxWidget.element&&
(m=r.jqxWidget.element.className,!(0<=m.indexOf("dropdownlist")||0<=m.indexOf("datetimeinput")||0<=m.indexOf("combobox")||0<=m.indexOf("menu"))||!r.jqxWidget.isOpened||!r.jqxWidget.isOpened()||d&&"resize"==d&&c.jqx.mobile.isTouchDevice()||r.jqxWidget.close())}}}g()}};this.resizeHandlers||(this.resizeHandlers=[],e=c(window),e.on?(this._resizeTimer=null,this._initResize=null,e.on("resize.jqx",function(b){void 0!=h._resizeTimer&&clearTimeout(h._resizeTimer);h._initResize?h._resizeTimer=setTimeout(function(){m(null,
"resize")},c.jqx.resizeDelay):(h._initResize=!0,m(null,"resize"))}),e.on("orientationchange.jqx",function(b){m(null,"orientationchange")}),e.on("orientationchanged.jqx",function(b){m(null,"orientationchange")})):(e.bind("resize.jqx",function(b){m(null,"orientationchange")}),e.bind("orientationchange.jqx",function(b){m(null,"orientationchange")}),e.bind("orientationchanged.jqx",function(b){m(null,"orientationchange")})));e=b.data();f&&-1===g&&this.resizeHandlers.push({id:b[0].id,widget:b,callback:d,
data:e});try{var p=e.jqxWidget.width,r=e.jqxWidget.height;e.jqxWidget.base&&(void 0==p&&(p=e.jqxWidget.base.width),void 0==r&&(r=e.jqxWidget.base.height));void 0===p&&void 0===r&&(p=e.jqxWidget.element.style.width,r=e.jqxWidget.element.style.height);g=!1;if(null!=p&&-1!=p.toString().indexOf("%")&&(g=!0),null!=r&&-1!=r.toString().indexOf("%")&&(g=!0),g)this.watchedElementData||(this.watchedElementData=[]),h=this,p=function(b){h.watchedElementData.forEach&&h.watchedElementData.forEach(function(b){b.element.offsetWidth===
b.offsetWidth&&b.element.offsetHeight===b.offsetHeight||(b.offsetWidth=b.element.offsetWidth,b.offsetHeight=b.element.offsetHeight,b.timer&&clearTimeout(b.timer),b.timer=setTimeout(function(){c.jqx.isHidden(c(b.element))?b.timer=setInterval(function(){c.jqx.isHidden(c(b.element))||(clearInterval(b.timer),b.callback())},100):b.callback()}))})},h.watchedElementData.push({element:b[0],offsetWidth:b[0].offsetWidth,offsetHeight:b[0].offsetHeight,callback:d}),h.observer||(h.observer=new MutationObserver(p),
h.observer.observe(document.body,{attributes:!0,childList:!0,characterData:!0}))}catch(u){}c.jqx.isHidden(b)&&!0===f&&m(!0);c.jqx.resize=function(){m(null,"resize")}},parseJSON:function(b){if(!b||"string"!=typeof b)return null;if(b=c.trim(b),window.JSON&&window.JSON.parse)return window.JSON.parse(b);if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,"@").replace(/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return(new Function("return "+
b))();throw Error("Invalid JSON: "+b);},html:function(b,d){if(!c(b).on)return c(b).html(d);try{return c.access(b,function(d){var f=b[0]||{},g=0,h=b.length;if(void 0===d)return 1===f.nodeType?f.innerHTML.replace(rinlinejQuery,""):void 0;var k=/<(?:script|style|link)/i,l=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,m=/<([\w:]+)/,p=/<(?:abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video)[\s/>]/i,
r=/^\s+/,u={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};if(!("string"!=typeof d||k.test(d)||!c.support.htmlSerialize&&p.test(d)||!c.support.leadingWhitespace&&r.test(d)||u[(m.exec(d)||["",""])[1].toLowerCase()])){d=d.replace(l,
"<$1></$2>");try{for(;g<h;g++)f=this[g]||{},1===f.nodeType&&(c.cleanData(f.getElementsByTagName("*")),f.innerHTML=d);f=0}catch(q){}}f&&b.empty().append(d)},null,d,arguments.length)}catch(e){return c(b).html(d)}},hasTransform:function(b){var d="";if(""==(d=b.css("transform"))||"none"==d){if(""!=(d=b.parents().css("transform"))&&"none"!=d)return""!=d&&"none"!=d;var e=c.jqx.utilities.getBrowser();"msie"==e.browser?""!=(d=b.css("-ms-transform"))&&"none"!=d||(d=b.parents().css("-ms-transform")):"chrome"==
e.browser?""!=(d=b.css("-webkit-transform"))&&"none"!=d||(d=b.parents().css("-webkit-transform")):"opera"==e.browser?""!=(d=b.css("-o-transform"))&&"none"!=d||(d=b.parents().css("-o-transform")):"mozilla"==e.browser&&(""!=(d=b.css("-moz-transform"))&&"none"!=d||(d=b.parents().css("-moz-transform")))}return""!=d&&"none"!=d||(d=c(document.body).css("transform")),""!=d&&"none"!=d&&null!=d},getBrowser:function(){var b=navigator.userAgent.toLowerCase(),d=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||
/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||0>b.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[],c={browser:d[1]||"",version:d[2]||"0"};return 0<=b.indexOf("rv:11.0")&&0<=b.indexOf(".net4.0c")&&(c.browser="msie",c.version="11",d[1]="msie"),0<=b.indexOf("edge")&&(c.browser="msie",c.version="12",d[1]="msie"),c[d[1]]=d[1],c}});c.jqx.browser=c.jqx.utilities.getBrowser();c.jqx.isHidden=function(b){if(!b||!b[0])return!1;var d=b[0].offsetHeight;return 0===b[0].offsetWidth||
0===d};c.jqx.ariaEnabled=!0;c.jqx.aria=function(b,d,e){if(c.jqx.ariaEnabled)if(void 0==d)c.each(b.aria,function(d,e){var h=b.base?b.base.host.attr(d):b.host.attr(d);if(void 0==h||c.isFunction(h)){h=b[e.name];c.isFunction(h)&&(h=b[e.name]());void 0==h&&(h="");try{b.base?b.base.host.attr(d,h.toString()):b.host.attr(d,h.toString())}catch(l){}}else{var k=h;switch(e.type){case "number":k=new Number(h);isNaN(k)&&(k=h);break;case "boolean":k="true"==h;break;case "date":k=new Date(h),("Invalid Date"==k||
isNaN(k))&&(k=h)}b[e.name]=k}});else try{b.host?b.base?b.base.host?b.base.host.attr(d,e.toString()):b.attr(d,e.toString()):b.host?b.element.setAttribute?b.element.setAttribute(d,e.toString()):b.host.attr(d,e.toString()):b.attr(d,e.toString()):b.setAttribute&&b.setAttribute(d,e.toString())}catch(f){}};Array.prototype.indexOf||(Array.prototype.indexOf=function(b,d){var c=this.length,f=Number(d)||0,f=0>f?Math.ceil(f):Math.floor(f);for(0>f&&(f+=c);f<c;f++)if(f in this&&this[f]===b)return f;return-1});
c.jqx.mobile=c.jqx.mobile||{};c.jqx.position=function(b){var d=parseInt(b.pageX),e=parseInt(b.pageY);c.jqx.mobile.isTouchDevice()&&(b=c.jqx.mobile.getTouches(b)[0],d=parseInt(b.pageX),e=parseInt(b.pageY));return{left:d,top:e}};c.extend(c.jqx.mobile,{_touchListener:function(b,d){var c={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},f;f=c[b.type];var g=document.createEvent("MouseEvents");f=(g.initMouseEvent(f,b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,
b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget),g._pageX=b.pageX,g._pageY=b.pageY,g);b.target.dispatchEvent(f);c=b.target["on"+c[b.type]];"function"==typeof c&&c(b)},setMobileSimulator:function(b,d){if(!this.isTouchDevice()){this.simulatetouches=!0;0==d&&(this.simulatetouches=!1);var e={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};if(window.addEventListener){c.jqx.browser.msie;for(var f in e)b.addEventListener&&(b.removeEventListener(f,this._touchListener),b.addEventListener(f,
this._touchListener,!1))}}},isTouchDevice:function(){if(void 0!=this.touchDevice)return this.touchDevice;var b="Browser CodeName: "+navigator.appCodeName;if((b+="Browser Name: "+navigator.appName,b+="Browser Version: "+navigator.appVersion,b+="Platform: "+navigator.platform,b+="User-agent header: "+navigator.userAgent,-1!=b.indexOf("Android"))||-1!=b.indexOf("IEMobile")||-1!=b.indexOf("Windows Phone")||-1!=b.indexOf("WPDesktop")||-1!=b.indexOf("ZuneWP7")||-1!=b.indexOf("BlackBerry")&&-1!=b.indexOf("Mobile Safari")||
-1!=b.indexOf("ipod")||-1!=b.indexOf("nokia")||-1!=b.indexOf("Nokia"))return!0;if(-1!=b.indexOf("Chrome/17")||-1!=b.indexOf("CrOS")||-1!=b.indexOf("Opera")&&-1==b.indexOf("Mobi")&&-1==b.indexOf("Mini")&&-1!=b.indexOf("Platform: Win"))return!1;if(-1!=b.indexOf("Opera")&&-1!=b.indexOf("Mobi")&&-1!=b.indexOf("Opera Mobi"))return!0;var d={ios:"i(?:Pad|Phone|Pod)(?:.*)CPU(?: iPhone)? OS ",android:"(Android |HTC_|Silk/)",blackberry:"BlackBerry(?:.*)Version/",rimTablet:"RIM Tablet OS ",webos:"(?:webOS|hpwOS)/",
bada:"Bada/"};try{if(void 0!=this.touchDevice)return this.touchDevice;this.touchDevice=!1;for(i in d)if(d.hasOwnProperty(i)&&(prefix=d[i],match=b.match(new RegExp("(?:"+prefix+")([^\\s;]+)")),match))return"blackberry"==i.toString()?(this.touchDevice=!1,!1):(this.touchDevice=!0,!0);var c=navigator.userAgent;if(-1!=navigator.platform.toLowerCase().indexOf("win")){if(0<=c.indexOf("Windows Phone")||0<=c.indexOf("WPDesktop")||0<=c.indexOf("IEMobile")||0<=c.indexOf("ZuneWP7"))return this.touchDevice=!0,
!0;if(0<=c.indexOf("Touch"))return"MSPointerDown"in window||"pointerdown"in window?(this.touchDevice=!0,!0):0<=c.indexOf("ARM")?(this.touchDevice=!0,!0):(this.touchDevice=!1,!1)}return-1!=navigator.platform.toLowerCase().indexOf("win")?(this.touchDevice=!1,!1):(("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)&&(this.touchDevice=!0),this.touchDevice)}catch(f){return this.touchDevice=!1,!1}},getLeftPos:function(b){for(var d=b.offsetLeft;null!=(b=b.offsetParent);)"HTML"!=
b.tagName&&(d+=b.offsetLeft,document.all&&(d+=b.clientLeft));return d},getTopPos:function(b){for(var d=b.offsetTop,e=c(b).coord();null!=(b=b.offsetParent);)"HTML"!=b.tagName&&(d+=b.offsetTop-b.scrollTop,document.all&&(d+=b.clientTop));b=navigator.userAgent.toLowerCase();return-1==b.indexOf("windows phone")&&-1==b.indexOf("WPDesktop")&&-1==b.indexOf("ZuneWP7")&&-1==b.indexOf("msie 9")&&-1==b.indexOf("msie 11")&&-1==b.indexOf("msie 10")||-1==b.indexOf("touch")?this.isSafariMobileBrowser()?this.isSafari4MobileBrowser()&&
this.isIPadSafariMobileBrowser()?d:-1!=b.indexOf("version/7")?e.top:(-1==b.indexOf("version/6")&&-1==b.indexOf("version/5")||(d+=c(window).scrollTop()),/(Android.*Chrome\/[.0-9]* (!?Mobile))/.exec(navigator.userAgent)?d+c(window).scrollTop():/(Android.*Chrome\/[.0-9]* Mobile)/.exec(navigator.userAgent)?d+c(window).scrollTop():e.top):d:e.top},isChromeMobileBrowser:function(){return-1!=navigator.userAgent.toLowerCase().indexOf("android")},isOperaMiniMobileBrowser:function(){var b=navigator.userAgent.toLowerCase();
return-1!=b.indexOf("opera mini")||-1!=b.indexOf("opera mobi")},isOperaMiniBrowser:function(){return-1!=navigator.userAgent.toLowerCase().indexOf("opera mini")},isNewSafariMobileBrowser:function(){var b=navigator.userAgent.toLowerCase();return(-1!=b.indexOf("ipad")||-1!=b.indexOf("iphone")||-1!=b.indexOf("ipod"))&&-1!=b.indexOf("version/5")},isSafari4MobileBrowser:function(){var b=navigator.userAgent.toLowerCase();return(-1!=b.indexOf("ipad")||-1!=b.indexOf("iphone")||-1!=b.indexOf("ipod"))&&-1!=
b.indexOf("version/4")},isWindowsPhone:function(){var b=navigator.userAgent.toLowerCase();return-1!=b.indexOf("windows phone")||-1!=b.indexOf("WPDesktop")||-1!=b.indexOf("ZuneWP7")||-1!=b.indexOf("msie 9")||-1!=b.indexOf("msie 11")||-1!=b.indexOf("msie 10")&&-1!=b.indexOf("touch")},isSafariMobileBrowser:function(){var b=navigator.userAgent.toLowerCase();return!!/(Android.*Chrome\/[.0-9]* (!?Mobile))/.exec(navigator.userAgent)||!!/(Android.*Chrome\/[.0-9]* Mobile)/.exec(navigator.userAgent)||-1!=b.indexOf("ipad")||
-1!=b.indexOf("iphone")||-1!=b.indexOf("ipod")||-1!=b.indexOf("mobile safari")},isIPadSafariMobileBrowser:function(){return-1!=navigator.userAgent.toLowerCase().indexOf("ipad")},isMobileBrowser:function(){var b=navigator.userAgent.toLowerCase();return-1!=b.indexOf("ipad")||-1!=b.indexOf("iphone")||-1!=b.indexOf("android")},getTouches:function(b){if(b.originalEvent){if(b.originalEvent.touches&&b.originalEvent.touches.length)return b.originalEvent.touches;if(b.originalEvent.changedTouches&&b.originalEvent.changedTouches.length)return b.originalEvent.changedTouches}return b.touches||
(b.touches=[],b.touches[0]=void 0!=b.originalEvent?b.originalEvent:b,void 0!=b.originalEvent&&b.pageX&&(b.touches[0]=b),"mousemove"==b.type&&(b.touches[0]=b)),b.touches},getTouchEventName:function(b){if(!this.isWindowsPhone())return b;if(-1!=navigator.userAgent.toLowerCase().indexOf("windows phone 7")){if(-1!=b.toLowerCase().indexOf("start"))return"MSPointerDown";if(-1!=b.toLowerCase().indexOf("move"))return"MSPointerMove";if(-1!=b.toLowerCase().indexOf("end"))return"MSPointerUp"}return-1!=b.toLowerCase().indexOf("start")?
"pointerdown":-1!=b.toLowerCase().indexOf("move")?"pointermove":-1!=b.toLowerCase().indexOf("end")?"pointerup":void 0},dispatchMouseEvent:function(b,d,c){if(!this.simulatetouches){var f=document.createEvent("MouseEvent");f.initMouseEvent(b,!0,!0,d.view,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);null!=c&&c.dispatchEvent(f)}},getRootNode:function(b){for(;1!==b.nodeType;)b=b.parentNode;return b},setTouchScroll:function(b,d){this.enableScrolling||(this.enableScrolling=[]);this.enableScrolling[d]=
b},touchScroll:function(b,d,e,f,g,h){function k(b){return b.targetTouches&&1<=b.targetTouches.length?b.targetTouches[0].clientY:b.originalEvent&&void 0!==b.originalEvent.clientY?b.originalEvent.clientY:r.getTouches(b)[0].clientY}function l(b){return b.targetTouches&&1<=b.targetTouches.length?b.targetTouches[0].clientX:b.originalEvent&&void 0!==b.originalEvent.clientX?b.originalEvent.clientX:r.getTouches(b)[0].clientX}function m(){var b,d;B&&(b=Date.now()-H,d=-B*Math.exp(-b/D),.5<d||-.5>d?(W(T+d),
requestAnimationFrame(m)):(W(T),h.fadeOut("fast")))}function p(){var b,d;B&&(b=Date.now()-H,d=-B*Math.exp(-b/D),.5<d||-.5>d?(K(S+d),requestAnimationFrame(p)):(K(S),g.fadeOut("fast")))}if(null!=b){var r=this;this.scrolling||(this.scrolling=[]);var u=this.scrolling[f]=!1;b=c(b);var q=["select","input","textarea"],t=0;this.enableScrolling||(this.enableScrolling=[]);this.enableScrolling[f]=!0;var v,w,y,A,F,C,G,H,E,B,T,S,X,D,R=this.getTouchEventName("touchstart")+".touchScroll",Y=this.getTouchEventName("touchend")+
".touchScroll",V=this.getTouchEventName("touchmove")+".touchScroll";w=d;initialXOffset=initialOffset=xoffset=y=0;v=g.jqxScrollBar("max");D=325;var N=function(){var b,d;b=Date.now();d=b-H;H=b;b=y-G;xdelta=xoffset-xframe;G=y;xframe=xoffset;F=!0;xv=1E3*xdelta/(1+d);C=1E3*b/(1+d)*.8+.2*C;xjqxAnimations=.8*xv+.2*xjqxAnimations},z=!1,t=function(b){if(!r.enableScrolling[f])return!0;if(-1===c.inArray(b.target.tagName.toLowerCase(),q)){y=h.jqxScrollBar("value");xoffset=g.jqxScrollBar("value");var d=r.getTouches(b),
e=d[0];1==d.length&&r.dispatchMouseEvent("mousedown",e,r.getRootNode(e.target));v=g.jqxScrollBar("max");w=h.jqxScrollBar("max");z=!1;F=!0;A=k(b);X=l(b);C=B=xjqxAnimations=0;G=y;xframe=xoffset;H=Date.now();clearInterval(E);E=setInterval(N,100);initialOffset=y;initialXOffset=xoffset;0<y&&y<w&&h[0].style.visibility;return u=!1,r.scrolling[f]=!0,!0}};b.on?b.on(R,t):b.bind(R,t);var W=function(b,d){return y=b>w?w:0>b?0:b,e(null,b,0,0,d),b>w?"max":0>b?"min":"value"},K=function(b,d){return xoffset=b>v?v:
0>b?0:b,e(b,null,0,0,d),b>v?"max":0>b?"min":"value"};d=function(b){if(!r.enableScrolling[f]||!r.scrolling[f])return!0;z&&(b.preventDefault(),b.stopPropagation());var d=r.getTouches(b);if(1<d.length)return!0;var c=d[0].pageX;r.simulatetouches&&void 0!=d[0]._pageY&&(c=d[0]._pageX);touchHorizontalEnd=c;u=!0;d=null==g||"hidden"!=g[0].style.visibility;c=null==h||"hidden"!=h[0].style.visibility;if((d||c)&&(d||c)){var e,q,t;F&&(e=k(b),t=l(b),q=A-e,xdelta=X-t,2<q||-2>q?(A=e,e=W(y+q,b),N(),"min"==e&&0===initialOffset||
"max"==e&&initialOffset===w||!c||(b.preventDefault(),b.stopPropagation(),z=!0)):2<xdelta||-2>xdelta?(X=t,e=K(xoffset+xdelta,b),N(),"min"==e&&0===initialXOffset||"max"==e&&initialXOffset===v||!d||(z=!0,b.preventDefault(),b.stopPropagation())):b.preventDefault())}};b.on?b.on(V,d):b.bind(V,d);var L=function(b){if(!r.enableScrolling[f])return!0;var d=r.getTouches(b)[0];if(!r.scrolling[f])return!0;if(F=!1,clearInterval(E),10<C||-10>C?(B=.8*C,T=Math.round(y+B),H=Date.now(),requestAnimationFrame(m),h.fadeIn(100)):
10<xjqxAnimations||-10>xjqxAnimations?(B=.8*xjqxAnimations,S=Math.round(xoffset+B),H=Date.now(),requestAnimationFrame(p),g.fadeIn(100)):(g.fadeOut(100),h.fadeOut(100)),r.scrolling[f]=!1,!u)return d=r.getTouches(b)[0],b=r.getRootNode(d.target),r.dispatchMouseEvent("mouseup",d,b),r.dispatchMouseEvent("click",d,b),!0;r.dispatchMouseEvent("mouseup",d,b.target)};if(this.simulatetouches){d=(void 0!=c(window).on||c(window).bind,function(b){try{L(b)}catch(d){}r.scrolling[f]=!1});if(void 0!=c(window).on?c(document).on("mouseup.touchScroll",
d):c(document).bind("mouseup.touchScroll",d),window.frameElement&&null!=window.top)d=function(b){try{L(b)}catch(d){}r.scrolling[f]=!1},window.top.document&&(c(window.top.document).on?c(window.top.document).on("mouseup",d):c(window.top.document).bind("mouseup",d));d=(void 0!=c(document).on||c(document).bind,function(b){if(!r.scrolling[f])return!0;r.scrolling[f]=!1;b=r.getTouches(b)[0];var d=r.getRootNode(b.target);r.dispatchMouseEvent("mouseup",b,d);r.dispatchMouseEvent("click",b,d)});void 0!=c(document).on?
c(document).on("touchend",d):c(document).bind("touchend",d)}b.on&&(b.on("dragstart",function(b){b.preventDefault()}),b.on("selectstart",function(b){b.preventDefault()}));b.on?b.on(Y+" touchcancel.touchScroll",L):b.bind(Y+" touchcancel.touchScroll",L)}}});c.jqx.cookie=c.jqx.cookie||{};c.extend(c.jqx.cookie,{cookie:function(b,d,e){if(1<arguments.length&&"[object Object]"!==String(d)){if(e=c.extend({},e),null!==d&&void 0!==d||(e.expires=-1),"number"==typeof e.expires){var f=e.expires,g=e.expires=new Date;
g.setDate(g.getDate()+f)}return d=String(d),document.cookie=[encodeURIComponent(b),"=",e.raw?d:encodeURIComponent(d),e.expires?"; expires="+e.expires.toUTCString():"",e.path?"; path="+e.path:"",e.domain?"; domain="+e.domain:"",e.secure?"; secure":""].join("")}e=d||{};g=e.raw?function(b){return b}:decodeURIComponent;return(f=(new RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)")).exec(document.cookie))?g(f[1]):null}});c.jqx.string=c.jqx.string||{};c.extend(c.jqx.string,{replace:function(b,d,c){if(d===
c)return this;for(var f=b.indexOf(d);-1!=f;)b=b.replace(d,c),f=b.indexOf(d);return b},contains:function(b,d){return null!=b&&null!=d&&-1!=b.indexOf(d)},containsIgnoreCase:function(b,d){return null!=b&&null!=d&&-1!=b.toString().toUpperCase().indexOf(d.toString().toUpperCase())},equals:function(b,d){return null!=b&&null!=d&&(b=this.normalize(b),d.length==b.length&&b.slice(0,d.length)==d)},equalsIgnoreCase:function(b,d){return null!=b&&null!=d&&(b=this.normalize(b),d.length==b.length&&b.toUpperCase().slice(0,
d.length)==d.toUpperCase())},startsWith:function(b,d){return null!=b&&null!=d&&b.slice(0,d.length)==d},startsWithIgnoreCase:function(b,d){return null!=b&&null!=d&&b.toUpperCase().slice(0,d.length)==d.toUpperCase()},normalize:function(b){return 65279==b.charCodeAt(b.length-1)&&(b=b.substring(0,b.length-1)),b},endsWith:function(b,d){return null!=b&&null!=d&&(b=this.normalize(b),b.slice(-d.length)==d)},endsWithIgnoreCase:function(b,d){return null!=b&&null!=d&&(b=this.normalize(b),b.toUpperCase().slice(-d.length)==
d.toUpperCase())}});c.extend(c.easing,{easeOutBack:function(b,d,c,f,g,h){return void 0==h&&(h=1.70158),f*((d=d/g-1)*d*((h+1)*d+h)+1)+c},easeInQuad:function(b,d,c,f,g){return f*(d/=g)*d+c},easeInOutCirc:function(b,d,c,f,g){return 1>(d/=g/2)?-f/2*(Math.sqrt(1-d*d)-1)+c:f/2*(Math.sqrt(1-(d-=2)*d)+1)+c},easeInOutSine:function(b,d,c,f,g){return-f/2*(Math.cos(Math.PI*d/g)-1)+c},easeInCubic:function(b,d,c,f,g){return f*(d/=g)*d*d+c},easeOutCubic:function(b,d,c,f,g){return f*((d=d/g-1)*d*d+1)+c},easeInOutCubic:function(b,
d,c,f,g){return 1>(d/=g/2)?f/2*d*d*d+c:f/2*((d-=2)*d*d+2)+c},easeInSine:function(b,d,c,f,g){return-f*Math.cos(d/g*(Math.PI/2))+f+c},easeOutSine:function(b,d,c,f,g){return f*Math.sin(d/g*(Math.PI/2))+c},easeInOutSine:function(b,d,c,f,g){return-f/2*(Math.cos(Math.PI*d/g)-1)+c}})}(jqxBaseFramework);
(function(c){c.event&&c.event.special&&c.extend(c.event.special,{close:{noBubble:!0},open:{noBubble:!0},cellclick:{noBubble:!0},rowclick:{noBubble:!0},tabclick:{noBubble:!0},selected:{noBubble:!0},expanded:{noBubble:!0},collapsed:{noBubble:!0},valuechanged:{noBubble:!0},expandedItem:{noBubble:!0},collapsedItem:{noBubble:!0},expandingItem:{noBubble:!0},collapsingItem:{noBubble:!0}});c.fn.extend&&c.fn.extend({ischildof:function(b){if(!c(this).parents)return b.element.contains(this.element);for(var e=
c(this).parents().get(),f=0;f<e.length;f++)if("string"!=typeof b){var g=e[f];if(void 0!==b&&g==b[0])return!0}else if(void 0!==b&&c(e[f]).is(b))return!0;return!1}});c.fn.jqxProxy=function(){var b=c(this).data().jqxWidget,e=Array.prototype.slice.call(arguments,0),f=b.element;return f||(f=b.base.element),c.jqx.jqxWidgetProxy(b.widgetName,f,e)};var b=this.originalVal=c.fn.val;c.fn.val=function(d){if(void 0===d){if(c(this).hasClass("jqx-widget")){var e=c(this).data().jqxWidget;if(e&&e.val)return e.val()}return this[0]&&
0<=this[0].tagName.toLowerCase().indexOf("angular")&&(e=c(this).find(".jqx-widget").data().jqxWidget)&&e.val?e.val():b.call(this)}return c(this).hasClass("jqx-widget")&&(e=c(this).data().jqxWidget)&&e.val||this[0]&&0<=this[0].tagName.toLowerCase().indexOf("angular")&&(e=c(this).find(".jqx-widget").data().jqxWidget)&&e.val?2!=arguments.length?e.val(d):e.val(d,arguments[1]):b.call(this,d)};c.fn.modal&&c.fn.modal.Constructor&&(c.fn.modal.Constructor.prototype.enforceFocus=function(){c(document).off("focusin.bs.modal").on("focusin.bs.modal",
c.proxy(function(b){if(this.$element[0]!==b.target&&!this.$element.has(b.target).length){if(c(b.target).parents().hasClass("jqx-popup"))return!0;this.$element.trigger("focus")}},this))});c.fn.coord=function(b){var e,f,g={top:0,left:0},h=(f=this[0])&&f.ownerDocument;if(h){if(e=h.documentElement,!c.contains(e,f))return g;g=f.getBoundingClientRect();f=c.isWindow(h)?h:9===h.nodeType&&(h.defaultView||h.parentWindow);var k=h=0,l=navigator.userAgent.toLowerCase();if((-1!=l.indexOf("ipad")||-1!=l.indexOf("iphone"))&&
(h=2),1==b&&"static"!=document.body.style.position&&""!=document.body.style.position)b=c(document.body).coord(),h=-b.left,k=-b.top;return{top:k+g.top+(f.pageYOffset||e.scrollTop)-(e.clientTop||0),left:h+g.left+(f.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}}}})(jqxBaseFramework);
!function(c){c.jqx.cssroundedcorners=function(b){var d={all:"jqx-rc-all",top:"jqx-rc-t",bottom:"jqx-rc-b",left:"jqx-rc-l",right:"jqx-rc-r","top-right":"jqx-rc-tr","top-left":"jqx-rc-tl","bottom-right":"jqx-rc-br","bottom-left":"jqx-rc-bl"};for(prop in d)if(d.hasOwnProperty(prop)&&b==prop)return d[prop]};c.jqx.jqxWidget("jqxButton","",{});c.extend(c.jqx._jqxButton.prototype,{defineInstance:function(){var b={type:"",cursor:"arrow",roundedCorners:"all",disabled:!1,height:null,width:null,overrideTheme:!1,
enableHover:!0,enableDefault:!0,enablePressed:!0,imgPosition:"center",imgSrc:"",imgWidth:16,imgHeight:16,value:null,textPosition:"",textImageRelation:"overlay",rtl:!1,_ariaDisabled:!1,_scrollAreaButton:!1,template:"default",aria:{"aria-disabled":{name:"disabled",type:"boolean"}}};return this===c.jqx._jqxButton.prototype?b:(c.extend(!0,this,b),b)},_addImage:function(b){if("input"==this.element.nodeName.toLowerCase()||"button"==this.element.nodeName.toLowerCase()||"div"==this.element.nodeName.toLowerCase()){if(this._img)this._img.setAttribute("src",
this.imgSrc),this._img.setAttribute("width",this.imgWidth),this._img.setAttribute("height",this.imgHeight),this._text.innerHTML=this.value;else{this.field=this.element;this.field.className&&(this._className=this.field.className);var d=this.field.title,e,f=null;this.field.getAttribute("value")?f=this.field.getAttribute("value"):"input"!=this.element.nodeName.toLowerCase()&&(f=this.element.innerHTML);this.value&&(f=this.value);this.field.id.length?e=this.field.id.replace(/[^\w]/g,"_")+"_"+b:e=c.jqx.utilities.createId()+
"_"+b;b=document.createElement("div");b.id=e;b.title=d;b.style.cssText=this.field.style.cssText;b.style.boxSizing="border-box";d=document.createElement("img");d.setAttribute("src",this.imgSrc);d.setAttribute("width",this.imgWidth);d.setAttribute("height",this.imgHeight);b.appendChild(d);this._img=d;d=document.createElement("span");f&&(d.innerHTML=f,this.value=f);b.appendChild(d);this._text=d;this.field.style.display="none";this.field.parentNode&&this.field.parentNode.insertBefore(b,this.field.nextSibling);
f=this.host.data();this.host=c(b);this.host.data(f);this.element=b;this.element.id=this.field.id;this.field.id=e;e=new c(this.element);f=new c(this.field);if(this._className&&(e.addClass(this._className),f.removeClass(this._className)),this.field.tabIndex)e=this.field.tabIndex,this.field.tabIndex=-1,this.element.tabIndex=e}this.imgSrc?this._img.style.display="inline":this._img.style.display="none";this.value?this._text.style.display="inline":this._text.style.display="none";this._positionTextAndImage()}},
_positionTextAndImage:function(){var b=this.element.offsetWidth,d=this.element.offsetHeight,c=this.imgWidth,f=this.imgHeight;""==this.imgSrc&&(c=0,f=0);var g=this._text.offsetWidth,h=this._text.offsetHeight,k=0,l=0;switch(this.textImageRelation){case "imageBeforeText":case "textBeforeImage":k=c+g+8+4+8;l=Math.max(f,h)+8+4+8;break;case "imageAboveText":case "textAboveImage":k=Math.max(c,g)+8;l=f+h+4+8+8;break;case "overlay":k=Math.max(c,g)+8,l=Math.max(f,h)+8}this.width||(this.element.style.width=
k+"px",b=k);this.height||(this.element.style.height=l+"px",d=l);this._img.style.position="absolute";this._text.style.position="absolute";this.element.style.position="relative";this.element.style.overflow="hidden";var k={},l={},m=function(b,d,c,e,f){switch(d.width<e&&(d.width=e),d.height<f&&(d.height=f),c){case "left":b.style.left=d.left+"px";b.style.top=d.top+d.height/2-f/2+"px";break;case "topLeft":b.style.left=d.left+"px";b.style.top=d.top+"px";break;case "bottomLeft":b.style.left=d.left+"px";b.style.top=
d.top+d.height-f+"px";break;default:case "center":b.style.left=d.left+d.width/2-e/2+"px";b.style.top=d.top+d.height/2-f/2+"px";break;case "top":b.style.left=d.left+d.width/2-e/2+"px";b.style.top=d.top+"px";break;case "bottom":b.style.left=d.left+d.width/2-e/2+"px";b.style.top=d.top+d.height-f+"px";break;case "right":b.style.left=d.left+d.width-e+"px";b.style.top=d.top+d.height/2-f/2+"px";break;case "topRight":b.style.left=d.left+d.width-e+"px";b.style.top=d.top+"px";break;case "bottomRight":b.style.left=
d.left+d.width-e+"px",b.style.top=d.top+d.height-f+"px"}},p=0,r=0,u=(b-p)/2,q=(d-r)/2,t=this._img,v=this._text,w=d-r,y=b-p;switch(p+=4,r+=4,b=b-4-2,y=y-8-2,w=w-8-2,this.textImageRelation){case "imageBeforeText":switch(this.imgPosition){case "left":case "topLeft":case "bottomLeft":l={left:p,top:r,width:p+c,height:w};k={left:p+c+4,top:r,width:y-c-4,height:w};break;case "center":case "top":case "bottom":l={left:u-g/2-c/2-2,top:r,width:c,height:w};k={left:l.left+c+4,top:r,width:b-l.left-c-4,height:w};
break;case "right":case "topRight":case "bottomRight":l={left:b-g-c-4,top:r,width:c,height:w},k={left:l.left+c+4,top:r,width:b-l.left-c-4,height:w}}m(t,l,this.imgPosition,c,f);m(v,k,this.textPosition,g,h);break;case "textBeforeImage":switch(this.textPosition){case "left":case "topLeft":case "bottomLeft":k={left:p,top:r,width:p+g,height:w};l={left:p+g+4,top:r,width:y-g-4,height:w};break;case "center":case "top":case "bottom":k={left:u-g/2-c/2-2,top:r,width:g,height:w};l={left:k.left+g+4,top:r,width:b-
k.left-g-4,height:w};break;case "right":case "topRight":case "bottomRight":k={left:b-g-c-4,top:r,width:g,height:w},l={left:k.left+g+4,top:r,width:b-k.left-g-4,height:w}}m(t,l,this.imgPosition,c,f);m(v,k,this.textPosition,g,h);break;case "imageAboveText":switch(this.imgPosition){case "topRight":case "top":case "topLeft":l={left:p,top:r,width:y,height:f};k={left:p,top:r+f+4,width:y,height:w-f-4};break;case "left":case "center":case "right":l={left:p,top:q-f/2-h/2-2,width:y,height:f};k={left:p,top:l.top+
4+f,width:y,height:w-l.top-4-f};break;case "bottomLeft":case "bottom":case "bottomRight":l={left:p,top:d-f-h-4,width:y,height:f},k={left:p,top:l.top+4+f,width:y,height:h}}m(t,l,this.imgPosition,c,f);m(v,k,this.textPosition,g,h);break;case "textAboveImage":switch(this.textPosition){case "topRight":case "top":case "topLeft":k={left:p,top:r,width:y,height:h};l={left:p,top:r+h+4,width:y,height:w-h-4};break;case "left":case "center":case "right":k={left:p,top:q-f/2-h/2-2,width:y,height:h};l={left:p,top:k.top+
4+h,width:y,height:w-k.top-4-h};break;case "bottomLeft":case "bottom":case "bottomRight":k={left:p,top:d-f-h-4,width:y,height:h},l={left:p,top:k.top+4+h,width:y,height:f}}m(t,l,this.imgPosition,c,f);m(v,k,this.textPosition,g,h);break;default:k={left:p,top:r,width:y,height:w},l={left:p,top:r,width:y,height:w},m(t,l,this.imgPosition,c,f),m(v,k,this.textPosition,g,h)}},createInstance:function(b){var d=this;d._setSize();d.buttonObj=new c(d.element);(""!=d.imgSrc||""!=d.textPosition||d.element.value&&
0<=d.element.value.indexOf("<")||null!=d.value)&&(d.refresh(),d._addImage("jqxButton"),d.buttonObj=new c(d.element));d._ariaDisabled||d.element.setAttribute("role","button");""!==d.type&&d.element.setAttribute("type",d.type);d.overrideTheme||(d.buttonObj.addClass(d.toThemeProperty(c.jqx.cssroundedcorners(d.roundedCorners))),d.enableDefault&&d.buttonObj.addClass(d.toThemeProperty("jqx-button")),d.buttonObj.addClass(d.toThemeProperty("jqx-widget")));d.isTouchDevice=c.jqx.mobile.isTouchDevice();d._ariaDisabled||
c.jqx.aria(this);"arrow"!=d.cursor&&(d.disabled?d.element.style.cursor="arrow":d.element.style.cursor=d.cursor);b="mouseenter mouseleave mousedown focus blur";d._scrollAreaButton&&(b="mousedown");d.isTouchDevice&&(d.addHandler(d.host,c.jqx.mobile.getTouchEventName("touchstart"),function(b){d.isPressed=!0;d.refresh()}),d.addHandler(c(document),c.jqx.mobile.getTouchEventName("touchend")+"."+d.element.id,function(b){d.isPressed=!1;d.refresh()}));d.addHandler(d.host,b,function(b){switch(b.type){case "mouseenter":d.isTouchDevice||
!d.disabled&&d.enableHover&&(d.isMouseOver=!0,d.refresh());break;case "mouseleave":d.isTouchDevice||!d.disabled&&d.enableHover&&(d.isMouseOver=!1,d.refresh());break;case "mousedown":d.disabled||(d.isPressed=!0,d.refresh());break;case "focus":d.disabled||(d.isFocused=!0,d.refresh());break;case "blur":d.disabled||(d.isFocused=!1,d.refresh())}});d.mouseupfunc=function(b){d.disabled||(d.isPressed||d.isMouseOver)&&(d.isPressed=!1,d.refresh())};d.addHandler(document,"mouseup.button"+d.element.id,d.mouseupfunc);
try{""==document.referrer&&!window.frameElement||null==window.top||window.top==window.that||(b="",window.parent&&document.referrer&&(b=document.referrer),-1==b.indexOf(document.location.host))||(b=function(b){d.isPressed=!1;d.refresh()},window.top.document&&d.addHandler(c(window.top.document),"mouseup",b))}catch(e){}d.propertyChangeMap.roundedCorners=function(b,d,g,h){b.buttonObj.removeClass(b.toThemeProperty(c.jqx.cssroundedcorners(g)));b.buttonObj.addClass(b.toThemeProperty(c.jqx.cssroundedcorners(h)))};
d.propertyChangeMap.disabled=function(b,d,g,h){g!=h&&(b.refresh(),b.element.setAttribute("disabled",h),b.element.disabled=h,b.element.style.cursor=h?"default":b.cursor,c.jqx.aria(b,"aria-disabled",b.disabled))};d.propertyChangeMap.rtl=function(b,d,c,h){c!=h&&b.refresh()};d.propertyChangeMap.template=function(b,d,c,h){c!=h&&(b.buttonObj.removeClass(b.toThemeProperty("jqx-"+c)),b.refresh())};d.propertyChangeMap.theme=function(b,d,g,h){b.buttonObj.removeClass(b.element);b.enableDefault&&b.buttonObj.addClass(b.toThemeProperty("jqx-button"));
b.buttonObj.addClass(b.toThemeProperty("jqx-widget"));b.overrideTheme||b.buttonObj.addClass(b.toThemeProperty(c.jqx.cssroundedcorners(b.roundedCorners)));b._oldCSSCurrent=null;b.refresh()};d.disabled&&(d.element.disabled=!0,d.element.setAttribute("disabled","true"))},resize:function(b,d){this.width=b;this.height=d;this._setSize()},val:function(){var b=this.host.find("input");return 0<b.length?0==arguments.length||"object"==typeof value?b.val():(b.val(value),this.refresh(),b.val()):0==arguments.length||
"object"==typeof value?"button"==this.element.nodeName.toLowerCase()?c(this.element).text():this.element.value:(this.element.value=arguments[0],"button"==this.element.nodeName.toLowerCase()&&c(this.element).text(arguments[0]),void this.refresh())},_setSize:function(){var b=this.height,d=this.width;b&&(isNaN(b)||(b+="px"),this.element.style.height=b);d&&(isNaN(d)||(d+="px"),this.element.style.width=d)},_removeHandlers:function(){this.removeHandler(this.host,"selectstart");this.removeHandler(this.host,
"click");this.removeHandler(this.host,"focus");this.removeHandler(this.host,"blur");this.removeHandler(this.host,"mouseenter");this.removeHandler(this.host,"mouseleave");this.removeHandler(this.host,"mousedown");this.removeHandler(c(document),"mouseup.button"+this.element.id,this.mouseupfunc);this.isTouchDevice&&(this.removeHandler(this.host,c.jqx.mobile.getTouchEventName("touchstart")),this.removeHandler(c(document),c.jqx.mobile.getTouchEventName("touchend")+"."+this.element.id));this.mouseupfunc=
null;delete this.mouseupfunc},focus:function(){this.host.focus()},destroy:function(){this._removeHandlers();var b=c.data(this.element,"jqxButton");b&&delete b.instance;this.host.removeClass();this.host.removeData();this.host.remove();delete this.set;delete this.get;delete this.call;delete this.element;delete this.host},render:function(){this.refresh()},propertiesChangedHandler:function(b,d,c){c&&c.width&&c.height&&2==Object.keys(c).length&&(b._setSize(),b.refresh())},propertyChangedHandler:function(b,
d,c,f){void 0!=this.isInitialized&&0!=this.isInitialized&&f!=c&&(b.batchUpdate&&b.batchUpdate.width&&b.batchUpdate.height&&2==Object.keys(b.batchUpdate).length||("type"===d&&b.element.setAttribute("type",f),"textImageRelation"!=d&&"textPosition"!=d&&"imgPosition"!=d||(b._img?b._positionTextAndImage():b._addImage("jqxButton")),"imgSrc"!=d&&"imgWidth"!=d&&"imgHeight"!=d&&"value"!=d||b._addImage("jqxButton"),"width"!=d&&"height"!=d||(b._setSize(),b.refresh())))},refresh:function(){if(!this.overrideTheme){var b=
this.toThemeProperty("jqx-fill-state-focus"),d=this.toThemeProperty("jqx-fill-state-disabled"),c=this.toThemeProperty("jqx-fill-state-normal");this.enableDefault||(c="");var f=this.toThemeProperty("jqx-fill-state-hover"),g=this.toThemeProperty("jqx-fill-state-pressed"),h=this.toThemeProperty("jqx-fill-state-pressed");this.enablePressed||(g="");var k="";if(this.host){if(this.element.disabled=this.disabled,this.disabled)return this._oldCSSCurrent&&this.buttonObj.removeClass(this._oldCSSCurrent),k=c+
" "+d,"default"!==this.template&&""!==this.template&&(k+=" jqx-"+this.template,""!=this.theme&&(k+=" jqx-"+this.template+"-"+this.theme)),this.buttonObj.addClass(k),void(this._oldCSSCurrent=k);k=this.isMouseOver&&!this.isTouchDevice?this.isPressed?h:f:this.isPressed?g:c;this.isFocused&&(k+=" "+b);"default"!==this.template&&""!==this.template&&(k+=" jqx-"+this.template,""!=this.theme&&(k+=" jqx-"+this.template+"-"+this.theme));k!=this._oldCSSCurrent&&(this._oldCSSCurrent&&this.buttonObj.removeClass(this._oldCSSCurrent),
this.buttonObj.addClass(k),this._oldCSSCurrent=k);this.rtl&&(this.buttonObj.addClass(this.toThemeProperty("jqx-rtl")),this.element.style.direction="rtl")}}}});c.jqx.jqxWidget("jqxLinkButton","",{});c.extend(c.jqx._jqxLinkButton.prototype,{defineInstance:function(){this.disabled=!1;this.width=this.height=null;this.rtl=!1;this.href=null},createInstance:function(b){var d=this;this.host.onselectstart=function(){return!1};this.host.attr("role","button");var e=this.height||this.element.offsetHeight,f=this.width||
this.element.offsetWidth;this.href=this.element.getAttribute("href");this.target=this.element.getAttribute("target");this.content=this.host.text();this.element.innerHTML="";var g=document.createElement("input");g.type="button";g.className="jqx-wrapper "+this.toThemeProperty("jqx-reset");this._setSize(g,f,e);g.value=this.content;(new c(this.element)).addClass(this.toThemeProperty("jqx-link"));this.element.style.color="inherit";this.element.appendChild(g);this._setSize(g,f,e);b=void 0==b?{}:b[0]||{};
c(g).jqxButton(b);this.wrapElement=g;this.disabled&&(this.element.disabled=!0);this.propertyChangeMap.disabled=function(b,d,c,e){b.element.disabled=e;b.wrapElement.jqxButton({disabled:e})};this.addHandler(c(g),"click",function(b){return this.disabled||d.onclick(b),!1})},_setSize:function(b,d,c){c&&(isNaN(c)||(c+="px"),b.style.height=c);d&&(isNaN(d)||(d+="px"),b.style.width=d)},onclick:function(b){null!=this.target?window.open(this.href,this.target):window.location=this.href}});c.jqx.jqxWidget("jqxRepeatButton",
"jqxButton",{});c.extend(c.jqx._jqxRepeatButton.prototype,{defineInstance:function(){this.delay=50},createInstance:function(b){var d=this,e=c.jqx.mobile.isTouchDevice();b=e?"touchend."+this.base.element.id:"mouseup."+this.base.element.id;var f=e?"touchstart."+this.base.element.id:"mousedown."+this.base.element.id;this.addHandler(c(document),b,function(b){null!=d.timeout&&(clearTimeout(d.timeout),d.timeout=null,d.refresh());void 0!=d.timer&&(clearInterval(d.timer),d.timer=null,d.refresh())});this.addHandler(this.base.host,
f,function(b){null!=d.timer&&clearInterval(d.timer);d.timeout=setTimeout(function(){clearInterval(d.timer);d.timer=setInterval(function(b){d.ontimer(b)},d.delay)},150)});this.mousemovefunc=function(b){e||0==b.which&&null!=d.timer&&(clearInterval(d.timer),d.timer=null)};this.addHandler(this.base.host,"mousemove",this.mousemovefunc)},destroy:function(){var b=c.jqx.mobile.isTouchDevice(),d=b?"touchend."+this.base.element.id:"mouseup."+this.base.element.id,b=b?"touchstart."+this.base.element.id:"mousedown."+
this.base.element.id;this.removeHandler(this.base.host,"mousemove",this.mousemovefunc);this.removeHandler(this.base.host,b);this.removeHandler(c(document),d);this.timer=null;delete this.mousemovefunc;delete this.timer;(d=c.data(this.base.element,"jqxRepeatButton"))&&delete d.instance;c(this.base.element).removeData();this.base.destroy();delete this.base},stop:function(){clearInterval(this.timer);this.timer=null},ontimer:function(b){b=new c.Event("click");null!=this.base&&null!=this.base.host&&this.base.host.trigger(b)}});
c.jqx.jqxWidget("jqxToggleButton","jqxButton",{});c.extend(c.jqx._jqxToggleButton.prototype,{defineInstance:function(){this.toggled=!1;this.uiToggle=!0;this.aria={"aria-checked":{name:"toggled",type:"boolean"},"aria-disabled":{name:"disabled",type:"boolean"}}},createInstance:function(b){var d=this;d.base.overrideTheme=!0;d.isTouchDevice=c.jqx.mobile.isTouchDevice();c.jqx.aria(this);d.propertyChangeMap.roundedCorners=function(b,d,g,h){b.base.buttonObj.removeClass(b.toThemeProperty(c.jqx.cssroundedcorners(g)));
b.base.buttonObj.addClass(b.toThemeProperty(c.jqx.cssroundedcorners(h)))};d.propertyChangeMap.toggled=function(b,d,c,h){b.refresh()};d.propertyChangeMap.disabled=function(b,d,c,h){b.base.disabled=h;b.refresh()};d.addHandler(d.base.host,"click",function(b){!d.base.disabled&&d.uiToggle&&d.toggle()});d.isTouchDevice||(d.addHandler(d.base.host,"mouseenter",function(b){d.base.disabled||d.refresh()}),d.addHandler(d.base.host,"mouseleave",function(b){d.base.disabled||d.refresh()}));d.addHandler(d.base.host,
"mousedown",function(b){d.base.disabled||d.refresh()});d.addHandler(c(document),"mouseup.togglebutton"+d.base.element.id,function(b){d.base.disabled||d.refresh()})},destroy:function(){this._removeHandlers();this.base.destroy()},_removeHandlers:function(){this.removeHandler(this.base.host,"click");this.removeHandler(this.base.host,"mouseenter");this.removeHandler(this.base.host,"mouseleave");this.removeHandler(this.base.host,"mousedown");this.removeHandler(c(document),"mouseup.togglebutton"+this.base.element.id)},
toggle:function(){this.toggled=!this.toggled;this.refresh();c.jqx.aria(this,"aria-checked",this.toggled)},unCheck:function(){this.toggled=!1;this.refresh()},check:function(){this.toggled=!0;this.refresh()},refresh:function(){var b=this.base.toThemeProperty("jqx-fill-state-disabled"),d=this.base.toThemeProperty("jqx-fill-state-normal");this.base.enableDefault||(d="");var c=this.base.toThemeProperty("jqx-fill-state-hover"),f=this.base.toThemeProperty("jqx-fill-state-pressed"),g=this.base.toThemeProperty("jqx-fill-state-pressed"),
h="";if(this.base.element.disabled=this.base.disabled,this.base.disabled)return h=d+" "+b,void this.base.buttonObj.addClass(h);h=this.base.isMouseOver&&!this.isTouchDevice?this.base.isPressed||this.toggled?g:c:this.base.isPressed||this.toggled?f:d;"default"!==this.base.template&&""!==this.base.template&&(h+=" jqx-"+this.base.template,""!=this.base.theme&&(h+=" jqx-"+this.template+"-"+this.base.theme));this.base.buttonObj.hasClass(b)&&b!=h&&this.base.buttonObj.removeClass(b);this.base.buttonObj.hasClass(d)&&
d!=h&&this.base.buttonObj.removeClass(d);this.base.buttonObj.hasClass(c)&&c!=h&&this.base.buttonObj.removeClass(c);this.base.buttonObj.hasClass(f)&&f!=h&&this.base.buttonObj.removeClass(f);this.base.buttonObj.hasClass(g)&&g!=h&&this.base.buttonObj.removeClass(g);this.base.buttonObj.hasClass(h)||this.base.buttonObj.addClass(h)}})}(jqxBaseFramework);
!function(c){c.jqx.jqxWidget("jqxSplitter","",{});c.extend(c.jqx._jqxSplitter.prototype,{defineInstance:function(){var b={width:300,height:300,panels:[],orientation:"vertical",disabled:!1,splitBarSize:5,touchSplitBarSize:15,panel1:null,panel2:null,_eventsMap:{mousedown:c.jqx.mobile.getTouchEventName("touchstart"),mouseup:c.jqx.mobile.getTouchEventName("touchend"),mousemove:c.jqx.mobile.getTouchEventName("touchmove"),mouseenter:"mouseenter",mouseleave:"mouseleave"},_isTouchDevice:!1,_isNested:!1,resizable:!0,
touchMode:"auto",showSplitBar:!0,initContent:null,_events:["resize","expanded","collapsed","resizeStart","layout"]};return this===c.jqx._jqxSplitter.prototype?b:(c.extend(!0,this,b),b)},createInstance:function(){this.render()},_initOverlay:function(b){this.overlay||"undefined"==b?(this.overlay.remove(),this.overlay=null):1==b&&(this.overlay=c("<div style='z-index: 100; background: #fff;'></div>"),this.overlay.css("opacity",.01),this.overlay.css("position","absolute"),this.overlay.appendTo(c(document.body)),
this.host.coord(),this.overlay.css("left","0px"),this.overlay.css("top","0px"),this.overlay.width(c(window).width()),this.overlay.height(c(window).height()),this.overlay.addClass("jqx-disableselect"),"horizontal"==this.orientation?this.overlay.css("cursor","row-resize"):this.overlay.css("cursor","col-resize"))},_startDrag:function(b){return!(b.target!=this.splitBarButton[0]&&!this.disabled)||!(!this.panels[0].collapsed&&!this.panels[1].collapsed&&this.resizable)||null!=this.overlay||(this._dragging=
!0,this._initOverlay(!0),this._dragStart=c.jqx.position(b),!1)},_drag:function(b){if(this.panels[0].collapsed||this.panels[1].collapsed||this.disabled||!this._dragging)return!0;var d="horizontal"==this.orientation?"top":"left",e="vertical"==this.orientation?"width":"height";if(this._position=c.jqx.position(b),this.overlay&&!this._splitBarClone&&3<=Math.abs(this._position[d]-this._dragStart[d]))return b=this.splitBar.coord(),this._cloneStart={left:b.left,top:b.top},this._splitBarClone=this._createSplitBarClone(),
void this._raiseEvent(3,{panels:this.panels});if(this._splitBarClone){var f,g,h=this.host[e](),k=h/100,e=this._splitBarClone[e]()+2,l=parseInt(this.host.coord()[d]),l=this._position[d]-this._dragStart[d]+this._cloneStart[d]-l;return 0>l&&(l=0),l>h+0-e&&(l=h+0-e),f=this.panels[0].min,g=this.panels[1].min,-1!=g.toString().indexOf("%")&&(g=parseFloat(g)*k),-1!=f.toString().indexOf("%")&&(f=parseFloat(f)*k),this._splitBarClone.removeClass(this.toThemeProperty("jqx-splitter-splitbar-invalid")),l<f&&(this._splitBarClone.addClass(this.toThemeProperty("jqx-splitter-splitbar-invalid")),
l=f),l>h+0-e-g&&(this._splitBarClone.addClass(this.toThemeProperty("jqx-splitter-splitbar-invalid")),l=h+0-e-g),this._splitBarClone.css(d,l),b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),!1}return!0},resize:function(b,d){this.width=b;this.height=d;this._arrange()},_resize:function(){var b="horizontal"==this.orientation?"height":"width",d=this._splitBarClone.css("horizontal"==this.orientation?"top":"left"),b=this.host[b](),c=1/(b/100);-1!=this.panels[0].size.toString().indexOf("%")?
(this.panels[0].size=parseFloat(d)*c+"%",this.panels[1].size=100-parseFloat(d)*c+"%"):(this.panels[0].size=parseFloat(d),this.panels[1].size=b-parseFloat(d));this._layoutPanels();this._raiseEvent(0,{panels:this.panels})},_stopDrag:function(){if(this._dragging&&this._initOverlay(),this._dragging=!1,this._splitBarClone){if(this.panels[0].collapsed||this.panels[1].collapsed||this.disabled)return!0;this._resize();this._splitBarClone.remove();this._splitBarClone=null}},_createSplitBarClone:function(){var b=
this.splitBar.clone();return b.fadeTo(0,.7),b.css("z-index",99999),"vertical"==this.orientation?b.css("cursor","col-resize"):b.css("cursor","row-resize"),this.host.append(b),b},_eventName:function(b){return this._isTouchDevice?this._eventsMap[b]:b},_addHandlers:function(){var b=this;if(c.jqx.utilities.resize(this.host,function(){b._layoutPanels()}),this.addHandler(this.splitBar,"dragstart."+this.element.id,function(b){return!1}),this.splitBarButton&&(this.addHandler(this.splitBarButton,"click."+this.element.id,
function(){b.panels[0].collapsible?b.panels[0].collapsed?b.expand():b.collapse():b.panels[1].collapsible&&(b.panels[1].collapsed?b.expand():b.collapse())}),this.addHandler(this.splitBarButton,this._eventName("mouseenter"),function(){b.splitBarButton.addClass(b.toThemeProperty("jqx-splitter-collapse-button-hover"));b.splitBarButton.addClass(b.toThemeProperty("jqx-fill-state-hover"))}),this.addHandler(this.splitBarButton,this._eventName("mouseleave"),function(){b.splitBarButton.removeClass(b.toThemeProperty("jqx-splitter-collapse-button-hover"));
b.splitBarButton.removeClass(b.toThemeProperty("jqx-fill-state-hover"))})),this.addHandler(c(document),this._eventName("mousemove")+"."+this.element.id,function(d){return b._drag(d)}),this.addHandler(c(document),this._eventName("mouseup")+"."+this.element.id,function(){return b._stopDrag()}),this.addHandler(this.splitBar,this._eventName("mousedown"),function(d){return b._startDrag(d)}),this.addHandler(this.splitBar,this._eventName("mouseenter"),function(){b.resizable&&!b.disabled&&(b.splitBar.addClass(b.toThemeProperty("jqx-splitter-splitbar-hover")),
b.splitBar.addClass(b.toThemeProperty("jqx-fill-state-hover")))}),this.addHandler(this.splitBar,this._eventName("mouseleave"),function(){b.resizable&&!b.disabled&&(b.splitBar.removeClass(b.toThemeProperty("jqx-splitter-splitbar-hover")),b.splitBar.removeClass(b.toThemeProperty("jqx-fill-state-hover")))}),(""!=document.referrer||window.frameElement)&&null!=window.top&&window.top!=window.self){var d=null;if(window.parent&&document.referrer&&(d=document.referrer),d&&-1!=d.indexOf(document.location.host))d=
function(d){b._stopDrag()},window.top.document.addEventListener?window.top.document.addEventListener("mouseup",d,!1):window.top.document.attachEvent&&window.top.document.attachEvent("onmouseup",d)}},_removeHandlers:function(){this.removeHandler(c(window),"resize."+this.element.id);this.splitBarButton&&(this.removeHandler(this.splitBarButton,"click."+this.element.id),this.removeHandler(this.splitBarButton,this._eventName("mouseenter")),this.removeHandler(this.splitBarButton,this._eventName("mouseleave")));
this.removeHandler(c(document),this._eventName("mousemove")+"."+this.element.id);this.removeHandler(c(document),this._eventName("mouseup")+"."+this.element.id);this.splitBar&&(this.removeHandler(this.splitBar,"dragstart."+this.element.id),this.removeHandler(this.splitBar,this._eventName("mousedown")),this.removeHandler(this.splitBar,this._eventName("mouseenter")),this.removeHandler(this.splitBar,this._eventName("mouseleave")))},render:function(){this.splitBar&&this.splitBar.remove();var b=this.host.children();
if(2!=b.length)throw"Invalid HTML Structure! jqxSplitter requires 1 container DIV tag and 2 nested DIV tags.";if(2==b.length){var d=b[0].className.split(" "),b=b[1].className.split(" ");if(-1!=d.indexOf("jqx-reset")&&-1!=d.indexOf("jqx-splitter")&&-1!=d.indexOf("jqx-widget"))throw"Invalid HTML Structure! Nested jqxSplitter cannot be initialized from a Splitter Panel. You need to add a new DIV tag inside the Splitter Panel and initialize the nested jqxSplitter from it!";if(-1!=b.indexOf("jqx-reset")&&
-1!=b.indexOf("jqx-splitter")&&-1!=b.indexOf("jqx-widget"))throw"Invalid HTML Structure! Nested jqxSplitter cannot be initialized from a Splitter Panel. You need to add a new DIV tag inside the Splitter Panel and initialize the nested jqxSplitter from it!";}if(0<this.host.parent().length&&-1!=this.host.parent()[0].className.indexOf("jqx-splitter")){if(-1!=this.element.className.indexOf("jqx-splitter-panel"))throw"Invalid HTML Structure! Nested jqxSplitter cannot be initialized from a Splitter Panel. You need to add a new DIV tag inside the Splitter Panel and initialize the nested jqxSplitter from it!";
this._isNested=!0;300==this.width&&(this.width="100%");300==this.height&&(this.height="100%");"100%"==this.width&&"100%"==this.height&&(this.host.addClass("jqx-splitter-nested"),-1!=this.host.parent()[0].className.indexOf("jqx-splitter-panel")&&this.host.parent().addClass("jqx-splitter-panel-nested"))}this._hasBorder=0==this.host.hasClass("jqx-hideborder")||""!=this.element.style.borderTopWidth;this._removeHandlers();this._isTouchDevice=c.jqx.mobile.isTouchDevice();this._validate();this.panel1.css("left",
"0px");this.panel1.css("top","0px");this.panel2.css("left","0px");this.panel2.css("top","0px");this.splitBar=c("<div><div></div></div>");this.resizable||this.splitBar.css("cursor","default");this.splitBarButton=this.splitBar.find("div:last");this._setTheme();this.splitBar.insertAfter(this.panel1);this._arrange();0==this.panels[0].collapsible&&0==this.panels[1].collapsible&&this.splitBarButton.hide();this._addHandlers();this.initContent&&this.initContent();this.disabled&&this.disable()},_hiddenParent:function(){return c.jqx.isHidden(this.host)},
_setTheme:function(){this.panel1.addClass(this.toThemeProperty("jqx-widget-content"));this.panel2.addClass(this.toThemeProperty("jqx-widget-content"));this.panel1.addClass(this.toThemeProperty("jqx-splitter-panel"));this.panel2.addClass(this.toThemeProperty("jqx-splitter-panel"));this.panel1.addClass(this.toThemeProperty("jqx-reset"));this.panel2.addClass(this.toThemeProperty("jqx-reset"));this.host.addClass(this.toThemeProperty("jqx-reset"));this.host.addClass(this.toThemeProperty("jqx-splitter"));
this.host.addClass(this.toThemeProperty("jqx-widget"));this.host.addClass(this.toThemeProperty("jqx-widget-content"));this.splitBar.addClass(this.toThemeProperty("jqx-splitter-splitbar-"+this.orientation));this.splitBar.addClass(this.toThemeProperty("jqx-fill-state-normal"));this.splitBarButton.addClass(this.toThemeProperty("jqx-splitter-collapse-button-"+this.orientation));this.splitBarButton.addClass(this.toThemeProperty("jqx-fill-state-pressed"))},_validate:function(){var b=this.host.children();
if(2!=b.length)throw"Invalid HTML Structure! jqxSplitter requires two nested DIV tags!";this.panels&&!this.panels[1]?this.panels[0]?this.panels[1]={}:this.panels=[{size:"50%"},{size:"50%"}]:void 0==this.panels&&(this.panels=[{size:"50%"},{size:"50%"}]);b=this.host.children();this.panel1=this.panels[0].element=c(b[0]);this.panel2=this.panels[1].element=c(b[1]);this.panel1[0].style.minWidth="";this.panel1[0].style.maxWidth="";this.panel2[0].style.minWidth="";this.panel2[0].style.maxWidth="";c.each(this.panels,
function(){void 0==this.min&&(this.min=0);void 0==this.size&&(this.size=0);0>this.size&&(this.size=0);0>this.min&&(this.min=0);void 0==this.collapsible&&(this.collapsible=!0);void 0==this.collapsed&&(this.collapsed=!1);0!=this.size&&(-1!=this.size.toString().indexOf("px")&&(this.size=parseInt(this.size)),-1==this.size.toString().indexOf("%")?parseInt(this.min)>parseInt(this.size)&&(this.min=this.size):-1!=this.min.toString().indexOf("%")&&parseInt(this.min)>parseInt(this.size)&&(this.min=this.size))})},
_arrange:function(){if(null!=this.width){var b=this.width;"string"!=typeof b&&(b=parseInt(this.width)+"px");this.host.css("width",b)}null!=this.height&&(b=this.height,"string"!=typeof b&&(b=parseInt(this.height)+"px"),this.host.css("height",b));this._splitBarSize=this._isTouchDevice?this.touchSplitBarSize:this.splitBarSize;this.showSplitBar||(this._splitBarSize=0,this.splitBar.hide());b="horizontal"==this.orientation?"width":"height";this.splitBar.css(b,"100%");this.panel1.css(b,"100%");this.panel2.css(b,
"100%");"horizontal"==this.orientation?this.splitBar.height(this._splitBarSize):this.splitBar.width(this._splitBarSize);"vertical"===this.orientation?(this.splitBarButton.width(this._splitBarSize),this.splitBarButton.height(45)):(this.splitBarButton.height(this._splitBarSize),this.splitBarButton.width(45));this.splitBarButton.css("position","relative");"vertical"===this.orientation?(this.splitBarButton.css("top","50%"),this.splitBarButton.css("left","0"),this.splitBarButton.css("margin-top","-23px"),
this.splitBarButton.css("margin-left","-0px")):(this.splitBarButton.css("left","50%"),this.splitBarButton.css("top","0"),this.splitBarButton.css("margin-left","-23px"),this.splitBarButton.css("margin-top","-0px"));this._layoutPanels()},collapse:function(){if(!this.disabled){var b=-1;this.panels[0].collapsed=this.panels[1].collapsed=!1;this.panels[0].element[0].style.visibility="inherit";this.panels[1].element[0].style.visibility="inherit";this.panels[0].collapsible?b=0:this.panels[1].collapsible&&
(b=1);-1!=b&&(this.panels[b].collapsed=!0,this.panels[b].element[0].style.visibility="hidden",this.splitBar.addClass(this.toThemeProperty("jqx-splitter-splitbar-collapsed")),this._layoutPanels(),this._raiseEvent(2,{index:b,panels:this.panels}),this._raiseEvent(0,{panels:this.panels}))}},expand:function(){if(!this.disabled){var b=-1;this.panels[0].collapsed=this.panels[1].collapsed=!1;this.panels[0].element[0].style.visibility="inherit";this.panels[1].element[0].style.visibility="inherit";this.panels[0].collapsible?
b=0:this.panels[1].collapsible&&(b=1);-1!=b&&(this.panels[b].collapsed=!1,this.panels[b].element[0].style.visibility="inherit",this.splitBar.removeClass(this.toThemeProperty("jqx-splitter-splitbar-collapsed")),this._layoutPanels(),this._raiseEvent(1,{index:b,panels:this.panels}),this._raiseEvent(0,{panels:this.panels}))}},disable:function(){this.disabled=!0;this.host.addClass(this.toThemeProperty("jqx-fill-state-disabled"));this.splitBar.addClass(this.toThemeProperty("jqx-splitter-splitbar-collapsed"));
this.splitBarButton.addClass(this.toThemeProperty("jqx-splitter-splitbar-collapsed"))},enable:function(){this.disabled=!1;this.host.removeClass(this.toThemeProperty("jqx-fill-state-disabled"));this.splitBar.removeClass(this.toThemeProperty("jqx-splitter-splitbar-collapsed"));this.splitBarButton.removeClass(this.toThemeProperty("jqx-splitter-splitbar-collapsed"))},refresh:function(b){1!=b&&this._arrange()},propertyChangedHandler:function(b,d,e,f){if("panels"===d||"orientation"===d||"showSplitBar"===
d)return void b.render();"touchMode"===d&&(b._isTouchDevice=f);"disabled"===d?f?b.disable():b.enable():"theme"===d?c.jqx.utilities.setTheme(e,f,b.host):b.refresh()},_layoutPanels:function(){var b,d,c,f,g="horizontal"==this.orientation?"height":"width",h="horizontal"==this.orientation?"top":"left",k=parseInt(this._splitBarSize)+2;this.showSplitBar||(k=0);var l=this.host[g](),m=l/100,p=1/m,r=p*k,u=this.panel1,q=this.panel2,t=this.panels[0].size;this.panels[0].collapsed&&(c=!0);this.panels[1].collapsed&&
(f=!0);b=this.panels[0].min;d=this.panels[1].min;-1!=d.toString().indexOf("%")&&(d=parseFloat(d)*m);-1!=b.toString().indexOf("%")&&(b=parseFloat(b)*m);this._isNested&&this._isTouchDevice&&("horizontal"==this.orientation?(u.width(this.host.width()),q.width(this.host.width())):(u.height(this.host.height()),q.height(this.host.height())));c?(b=Math.max(d,l-k),u[g](0),q[g](b)):f?(b=Math.max(b,l-k),q[g](0),u[g](b)):-1!=t.toString().indexOf("%")?(c=100-parseFloat(t),u.css(g,parseFloat(t)+"%"),q.css(g,c-
r+"%"),c=q[g](),c<d&&(d=(c-d)*p,t=parseFloat(t)+parseFloat(d),c=100-parseFloat(t),u.css(g,parseFloat(t)+"%"),q.css(g,c-r+"%")),u[g]()<b&&u.css(g,parseFloat(b*p)+"%")):(c=l-t-k,u[0].style[g]!=t+"px"&&u[g](t),q[0].style[g]!=c+"px"&&q[g](c),c<d&&(t+=c-d,q[g](d),u[g](t)),t<b&&u[g](b));g=this.panel1[g]();this.splitBar[0].style[h]!=g+"px"&&("vertical"==this.orientation?(this.splitBar[0].style.borderLeftColor="",this.splitBar[0].style.borderRightColor="",this.splitBarButton[0].style.width=parseInt(this._splitBarSize)+
"px",this.splitBarButton[0].style.left="0px"):(this.splitBar[0].style.borderTopColor="",this.splitBar[0].style.borderBottomColor="",this.splitBarButton[0].style.height=parseInt(this._splitBarSize)+"px",this.splitBarButton[0].style.top="0px"),this._hasBorder&&(l-k==g?"vertical"==this.orientation?(this.splitBar[0].style.borderRightColor="transparent",this.splitBarButton[0].style.width=parseInt(this._splitBarSize+1)+"px"):(this.splitBar[0].style.borderBottomColor="transparent",this.splitBarButton[0].style.height=
parseInt(this._splitBarSize+1)+"px"):0==g&&("vertical"==this.orientation?(this.splitBar[0].style.borderLeftColor="transparent",this.splitBarButton[0].style.width=parseInt(this._splitBarSize+1)+"px",this.splitBarButton[0].style.left="-1px"):(this.splitBar[0].style.borderTopColor="transparent",this.splitBarButton[0].style.height=parseInt(this._splitBarSize+1)+"px",this.splitBarButton[0].style.top="-1px"))),this.splitBar[0].style[h]=g+"px");this.panel2[0].style[h]!=g+k+"px"&&(this.panel2[0].style[h]=
g+k+"px");!0;this._raiseEvent(4,{panels:this.panels})},destroy:function(){this._removeHandlers();c.jqx.utilities.resize(this.host,null,!0);this.host.remove()},_raiseEvent:function(b,d){var e=new c.Event(this._events[b]);e.owner=this;e.args=d;var f=(this.orientation,[]);return f[0]={},f[1]={},f[0].size="vertical"==this.orientation?this.panel1[0].offsetWidth:this.panel1[0].offsetHeight,f[1].size="vertical"==this.orientation?this.panel2[0].offsetWidth:this.panel2[0].offsetHeight,f[0].min=this.panels[0].min,
f[1].min=this.panels[1].min,f[0].collapsible=this.panels[0].collapsible,f[1].collapsible=this.panels[1].collapsible,f[0].collapsed=this.panels[0].collapsed,f[1].collapsed=this.panels[1].collapsed,e.args.panels=f,this.host.trigger(e)}})}(jqxBaseFramework);
!function(c){c.jqx.jqxWidget("jqxRibbon","",{});c.extend(c.jqx._jqxRibbon.prototype,{defineInstance:function(){var b={width:null,height:"auto",mode:"default",position:"top",selectedIndex:-1,selectionMode:"click",popupCloseMode:"click",animationType:"fade",animationDelay:400,scrollPosition:"both",disabled:!1,rtl:!1,scrollStep:10,scrollDelay:30,reorder:!1,initContent:null,_roundedCorners:!0,_removeByDrag:!1,_suppressReorder:!0,events:["select","unselect","change","_removeByDrag","reorder"]};return this===
c.jqx._jqxRibbon.prototype?b:(c.extend(!0,this,b),b)},createInstance:function(){"none"!==this.host.css("display")&&!1!==document.body.contains(this.element)||(this._initiallyHidden=!0);this._browser=c.jqx.browser;"popup"!==this.mode&&-1===this.selectedIndex&&(this.selectedIndex=0);this._originalHTML=this.element.innerHTML;this._render(!0)},render:function(){this._render()},refresh:function(b){!0!==b&&this._render()},destroy:function(){this._removeHandlers();this.host.remove()},selectAt:function(b){this._selectAt(b)},
clearSelection:function(){-1!==this.selectedIndex&&this._clearSelection()},disableAt:function(b){this._items[b]._disabled=!0;c(this._items[b]).addClass(this.toThemeProperty("jqx-fill-state-disabled"));b===this.selectedIndex&&this._clearSelection()},enableAt:function(b){this._items[b]._disabled=!1;c(this._items[b]).removeClass(this.toThemeProperty("jqx-fill-state-disabled"))},hideAt:function(b){this._items[b].style.display="none";this._checkScrollButtons();b===this.selectedIndex?this._clearSelection():
this._updatePositions()},showAt:function(b){"horizontal"===this._orientation?this._items[b].style.display="inline-block":this._items[b].style.display="inherit";this._checkScrollButtons();this._updatePositions()},val:function(b){if(!b)return this.selectedIndex;this._selectAt(b)},addAt:function(b,d){var e="jqx-ribbon-item jqx-ribbon-item-"+this.position,f="jqx-widget-content jqx-ribbon-content-section jqx-ribbon-content-section-"+this.position;this._removeHandlers();var g=document.createElement("li");
g.innerHTML=d.title;var h=document.createElement("div");if("string"==typeof d.content)h.innerHTML=d.content;else if(void 0!==d.content.length)try{if(void 0!==jQuery&&d.content instanceof jQuery)c(h).append(d.content);else if(c.isArray(d.content))for(var k=0;k<d.content.length;k++)d.content[k].appendTo(h);else for(;0<d.content.length;)h.appendChild(d.content[0])}catch(l){}else h.appendChild(d.content);switch(this.position){case "top":e+=" jqx-rc-t";f+=" jqx-rc-b";break;case "bottom":e+=" jqx-rc-b";
f+=" jqx-rc-t";break;case "left":e+=" jqx-rc-l";f+=" jqx-rc-r";break;case "right":e+=" jqx-rc-r",f+=" jqx-rc-l"}"popup"===this.mode&&(f+=" jqx-ribbon-content-section-popup jqx-ribbon-content-section-"+this._orientation+"-popup");!0===this.rtl&&(e+=" jqx-ribbon-item-rtl");g.className=this.toThemeProperty(e);h.className=this.toThemeProperty(f);this._items.length-1>=b?(this._headerElement.insertBefore(g,this._items[b]),this._contentElement.insertBefore(h,this._contentSections[b])):(this._headerElement.appendChild(g),
this._contentElement.appendChild(h));this._updateItems();this._addHandlers();this._checkScrollButtons();b<=this.selectedIndex&&this.selectedIndex<this._items.length-1&&this.selectedIndex++;this._updatePositions();0>this.selectedIndex||(this._suppressSelectionEvents=!0,this._selectAt(this.selectedIndex,this.selectedIndex,!0))},removeAt:function(b){b===this.selectedIndex&&this._clearSelection();c(this._items[b]).remove();c(this._contentSections[b]).remove();this._updateItems(!0);this._updatePositions();
this._checkScrollButtons()},updateAt:function(b,d){var c=this._items[b];c.innerHTML=d.newTitle;this._contentSections[b].innerHTML=d.newContent;c._isInitialized=!1;this.initContent&&b===this.selectedIndex&&(this.initContent(b),c._isInitialized=!0);this._updatePositions()},setPopupLayout:function(b,d,c,f){var g=this._contentSections[b];"popup"===this.mode&&(g.getAttribute("data-width")||(g.style.width&&g.setAttribute("data-width",g.style.width),g.style.height&&g.setAttribute("data-height",g.style.height)),
c&&(g.style.width=this._toPx(c)),f&&(g.style.height=this._toPx(f)),g._layout=d,this._positionContent(b))},propertiesChangedHandler:function(b,d,c){c&&c.width&&c.height&&2===Object.keys(c).length&&(b.element.style.width=b._toPx(b.width),b.element.style.height=b._toPx(b.height),b._updateSize())},propertyChangedHandler:function(b,d,e,f){if(!(b.batchUpdate&&b.batchUpdate.width&&b.batchUpdate.height&&2===Object.keys(b.batchUpdate).length)&&f!==e)switch(d){case "width":case "height":b.element.style[d]=
b._toPx(f);b._updateSize();break;case "position":b._render();break;case "mode":b._contentElement.style.width="auto";b._removeHandlers(null,e);b._render();break;case "selectedIndex":b._selectAt(f,e);break;case "selectionMode":b._removeHandlers(e);b._addHandlers();break;case "scrollPosition":d=b._scrollButtonNear;var g=b._scrollButtonFar;c(d).removeClass(b.toThemeProperty("jqx-ribbon-scrollbutton-"+e+" jqx-rc-tr jqx-rc-bl jqx-rc-tl"));c(g).removeClass(b.toThemeProperty("jqx-ribbon-scrollbutton-"+e+
" jqx-rc-tr jqx-rc-bl jqx-rc-br"));d.className+=" "+b.toThemeProperty("jqx-ribbon-scrollbutton-"+f);g.className+=" "+b.toThemeProperty("jqx-ribbon-scrollbutton-"+f);b._scrollButtonRc(d,g);b._checkScrollButtons();b._updatePositions();break;case "disabled":!0===f?(b._removeHandlers(),b.element.className+=" "+b.toThemeProperty("jqx-fill-state-disabled")):(b.host.removeClass(b.toThemeProperty("jqx-fill-state-disabled")),b._addHandlers());break;case "theme":c.jqx.utilities.setTheme(e,f,b.host);break;case "rtl":if(!0===
f)for(b._headerElement.className+=" "+b.toThemeProperty("jqx-ribbon-header-rtl"),e=0;e<b._items.length;e++)b._items[e].className+=" "+b.toThemeProperty("jqx-ribbon-item-rtl");else for(b._header.removeClass(b.toThemeProperty("jqx-ribbon-header-rtl")),e=0;e<b._items.length;e++)c(b._items[e]).removeClass(b.toThemeProperty("jqx-ribbon-item-rtl"));b._positionSelectionToken(b.selectedIndex)}},_raiseEvent:function(b,d){var e=new c.Event(this.events[b]);e.owner=this;e.args=d;var f;try{f=this.host.trigger(e)}catch(g){}return f},
_render:function(b){var d=this;switch(!0!==b&&d._removeHandlers(),d._selectionTokenOffsetY=0,d._browser.browser){case "mozilla":d._browserWidthRtlFlag=0;d._browserScrollRtlFlag=1;d._selectionTokenOffsetX=1;break;case "msie":d._browserWidthRtlFlag=0;d._browserScrollRtlFlag=-1;"8.0"===d._browser.version?d._selectionTokenOffsetX=1:"7.0"===d._browser.version?(d._selectionTokenOffsetX=0,"popup"!==d.mode||"bottom"!==d.position&&"right"!==d.position||(d._selectionTokenOffsetY=2)):d._selectionTokenOffsetX=
0;break;default:d._browserWidthRtlFlag=1,d._browserScrollRtlFlag=1,d._selectionTokenOffsetX=0}if(!0===b){var e=d.host.children();d._headerElement=e[0];d._header=c(e[0]);d._contentElement=e[1];d._content=c(e[1]);d._checkStructure(e)}d._headerElement.style["float"]="none";d._contentElement.style.padding="0px";d.element.style.width=d._toPx(d.width);d.element.style.height=d._toPx(d.height);"bottom"!==d.position&&"right"!==d.position||d.element.insertBefore(d._contentElement,d._headerElement);"top"===
d.position||"bottom"===d.position?d._orientation="horizontal":d._orientation="vertical";"right"===d.position?d._headerElement.style["float"]="right":"left"===d.position&&(d._headerElement.style["float"]="left");d._contentSections=d._content.children();c.each(d._contentSections,function(){this.getAttribute("data-width")&&(this.style.width=this.getAttribute("data-width"),this.style.height=this.getAttribute("data-height"),this.removeAttribute("data-width"),this.removeAttribute("data-height"))});!0===
b&&(d._selectionToken=document.createElement("div"),d._selectionToken.className=d.toThemeProperty("jqx-widget-content jqx-ribbon-selection-token jqx-ribbon-selection-token-"+d.position),d.element.appendChild(d._selectionToken));d._updateItems();!0!==d._initiallyHidden&&d._addClasses();!0===b&&(d._appendScrollButtons(),d._checkScrollButtons());d._allowSelection=!0;-1!==d.selectedIndex&&(d._items[d.selectedIndex].className+=" "+d.toThemeProperty("jqx-widget-content jqx-ribbon-item-selected"),d._positionSelectionToken(d.selectedIndex),
d._contentSections[d.selectedIndex].style.display="block",d.initContent&&(d.initContent(d.selectedIndex),d._items[d.selectedIndex]._isInitialized=!0));d.disabled?d.element.className+=" "+d.toThemeProperty("jqx-fill-state-disabled"):d._addHandlers();c.jqx.utilities.resize(d.host,function(){d._initiallyHidden&&(d._initiallyHidden=!1,d._addClasses(),-1!==d.selectedIndex&&(d._items[d.selectedIndex].className+=" "+d.toThemeProperty("jqx-widget-content jqx-ribbon-item-selected")));d._updateSize(!0)})},
_updateSize:function(b){if("7.0"===this._browser.version&&"msie"===this._browser.browser)if("horizontal"===this._orientation)this._header.css("width",this.host.width()-parseInt(this._header.css("padding-left"),10)-parseInt(this._header.css("padding-right"),10)-parseInt(this._header.css("border-left-width"),10)-parseInt(this._header.css("border-right-width"),10)),this._contentSections.width(this._content.width()-parseInt(this._contentSections.css("border-left-width"),10)-parseInt(this._contentSections.css("border-right-width"),
10)-parseInt(this._contentSections.css("padding-left"),10)-parseInt(this._contentSections.css("padding-right"),10)),"default"===this.mode&&"string"==typeof this.height&&-1!==this.height.indexOf("%")&&this._contentSections.height(this._content.height()-this._header.height()-parseInt(this._contentSections.css("border-bottom-width"),10)-parseInt(this._contentSections.css("border-top-width"),10)-1);else if(this._header.css("height",this.host.height()-parseInt(this._header.css("padding-top"),10)-parseInt(this._header.css("padding-bottom"),
10)-parseInt(this._header.css("border-top-width"),10)-parseInt(this._header.css("border-bottom-width"),10)),this._contentSections.height(this._content.height()-parseInt(this._contentSections.css("border-top-width"),10)-parseInt(this._contentSections.css("border-bottom-width"),10)-parseInt(this._contentSections.css("padding-top"),10)-parseInt(this._contentSections.css("padding-bottom"),10)),"default"===this.mode&&"string"==typeof this.width&&-1!==this.height.indexOf("%")){var d="left"===this.position?
parseInt(this._contentSections.css("border-left-width"),10)+parseInt(this._contentSections.css("border-right-width"),10)+1:0;this._contentSections.width(this._content.width()-this._header.width()-d)}this._checkScrollButtons(!0);this._updatePositions(void 0,b);"popup"===this.mode&&this._positionPopup()},_stopAnimation:function(){if(!this._allowSelection){this.selectedIndex=this._animatingIndex;var b=c(this._contentSections[this._animatingIndex]);this._initAnimate(b);b.animate("finish");this._clearSelection(!0,
this._animatingIndex);this._allowSelection=!0}},_selectAt:function(b,d,e){var f=this;if(void 0===d&&(d=f.selectedIndex),(b!==d||!0===e)&&(f._stopAnimation(),f._allowSelection)){if(f._animatingIndex=b,-1!==f.selectedIndex&&f._clearSelection(!0,d),f._allowSelection=!1,f._selecting=b,"click"===f.selectionMode&&c(f._items[b]).removeClass(f.toThemeProperty("jqx-fill-state-hover jqx-ribbon-item-hover")),"popup"===f.mode&&f._roundedCorners){f._header.removeClass(f.toThemeProperty("jqx-rc-all"));var g,h;
switch(f.position){case "top":g="jqx-rc-t";h="jqx-rc-b";break;case "bottom":g="jqx-rc-b";h="jqx-rc-t";break;case "left":g="jqx-rc-l";h="jqx-rc-r";break;case "right":g="jqx-rc-r",h="jqx-rc-l"}f._headerElement.className+=" "+f.toThemeProperty(g);for(e=0;e<f._items.length;e++)f._items[e].className+=" "+f.toThemeProperty(g),f._contentSections[e].className+=" "+f.toThemeProperty(h)}f._items[b].className+=" "+f.toThemeProperty("jqx-widget-content jqx-ribbon-item-selected");f._selectionToken.style.display=
"block";f._updatePositions(b);switch(f.animationType){case "fade":g=c(f._contentSections[b]);f._initAnimate(g);"none"===g.css("display")?g.fadeIn({duration:f.animationDelay,complete:function(){f._animationComplete(b,d)}}):g.fadeOut({duration:f.animationDelay,complete:function(){f._animationComplete(b,d)}});break;case "slide":g=c(f._contentSections[b]);h=f.position;"top"===h?h="up":"bottom"===h&&(h="down");f.slideAnimation=f._slide(g,{mode:"show",direction:h,duration:f.animationDelay},b,d);break;case "none":f._contentSections[b].style.display=
"block",f._animationComplete(b,d)}}},_clearSelection:function(b,d){var e=this;if("popup"===e.mode&&e._roundedCorners&&(e._headerElement.className+=" "+e.toThemeProperty("jqx-rc-all")),e._selecting=-1,void 0===d&&(d=e.selectedIndex),c(e._items[d]).removeClass(e.toThemeProperty("jqx-widget-content jqx-ribbon-item-selected")),e._selectionToken.style.display="none",!0!==b&&"none"!==e.animationType){var f=c(e._contentSections[d]);if("fade"===e.animationType)e._initAnimate(f),f.fadeOut({duration:e.animationDelay,
complete:function(){e._clearSelectionComplete(d)}});else if("slide"===e.animationType){var g=e.position;"top"===g?g="up":"bottom"===g&&(g="down");e._stopAnimation();d=e.selectedIndex;e.slideAnimation=e._slide(f,{mode:"hide",direction:g,duration:e.animationDelay},d);e.selectedIndex=-1}}else-1!==d&&(e._contentSections[d].style.display="none",e._clearSelectionComplete(d,b))},_addHandlers:function(){function b(b){b=p._closest(b.target,"li");var d=b._index;p._items[d]._disabled||(d!==p.selectedIndex?p._selectAt(d):
"popup"===p.mode&&"none"!==p.popupCloseMode&&(b.className+=" "+p.toThemeProperty("jqx-fill-state-hover jqx-ribbon-item-hover"),p._clearSelection()))}function d(b){if(!0===p.reorder&&!0===u){var d=p._closest(b.target,"li")._index;b=p._items[m].innerHTML;for(var e=p._contentSections[m].childNodes,f=[];0<e.length;)f.push(c(e[0]).detach());p._suppressSelectionEvents=!0;p._oldReorderIndex=m;p.removeAt(m);p.clearSelection();p.addAt(d,{title:b,content:f});p.selectAt(d);setTimeout(function(){c(p._items[d]).trigger("mousedown")},
0)}else b=p._closest(b.target,"li"),t(b._index)&&(b.className+=" "+p.toThemeProperty("jqx-fill-state-hover jqx-ribbon-item-hover"))}function e(b){b=p._closest(b.target,"li");t(b._index)&&c(b).removeClass(p.toThemeProperty("jqx-fill-state-hover jqx-ribbon-item-hover"))}function f(b){"#document"!==b.target.nodeName&&(b=p._closest(b.target,"li"),!0!==p.reorder&&!0!==p._removeByDrag||b._index!==p.selectedIndex||(u=!0,m=b._index,b.style.cursor="move"))}function g(){"mouseLeave"===p.popupCloseMode&&"popup"===
p.mode&&p._clearSelection()}function h(b){b=p._closest(b.target,"li")._index;p._items[b]._disabled||b===p.selectedIndex||p._selectAt(b)}function k(b){b=p._closest(b.target,"li")._index;p._items[b]._disabled||"popup"===p.mode&&"none"!==p.popupCloseMode&&p._clearSelection()}function l(){"mouseLeave"===p.popupCloseMode&&"popup"===p.mode&&p._clearSelection()}var m,p=this,r=p.element.id,u=!1,q=function(b){if("click"===p.popupCloseMode&&"popup"===p.mode&&-1!==p.selectedIndex&&"svg"!==b.target.tagName){var d=
p._closest(b.target,void 0,"jqx-ribbon");if(void 0!==d&&d.getAttribute("id")!==r||void 0===b.target.className||-1!==b.target.className.indexOf("jqx-ribbon-content-popup"))return void p._clearSelection();if(!c(b.target).ischildof(p.host)){var e=!1,f=[],g=function(b){b.parentElement&&(f.push(b.parentElement),g(b.parentElement))};g(b.target);c.each(f,function(){if(void 0!==this.className&&this.className.indexOf){if(-1!==this.className.indexOf("jqx-ribbon"))return e=!0,!1;if(-1!==this.className.indexOf("jqx-ribbon"))return r===
this.id&&(e=!0),!1}});e||p._clearSelection()}}};if("click"===p.selectionMode){for(var t=function(b){return(p._selecting!==b&&!1===p._allowSelection||(-1===p._selecting||p.selectedIndex!==b)&&!0===p._allowSelection)&&!p._items[b]._disabled},v=0;v<p._items.length;v++){var w=p._items[v];p.addHandler(w,"click.ribbon"+r,b);p.addHandler(w,"mouseenter.ribbon"+r,d);p.addHandler(w,"mouseleave.ribbon"+r,e);p.addHandler(w,"mousedown.ribbon"+r,f)}if("popup"===p.mode){p.addHandler(p.host,"mouseleave.ribbon"+r,
function(){"mouseLeave"===p.popupCloseMode&&"popup"===p.mode&&p._clearSelection()});for(v=0;v<p._contentSections.length;v++)p.addHandler(p._contentSections[v],"mouseleave.ribbon"+r,g);p.addHandler(c(document),"mousedown.ribbon"+r,function(b){q(b)})}if(!0===p._removeByDrag)for(v=0;v<p._items.length;v++)p._items[v].className+=" "+p.toThemeProperty("jqx-ribbon-item-docking-layout");p.addHandler(document,"mouseup.ribbon"+r,function(){u=!1;for(var b=0;b<p._items.length;b++)p._items[b].style.cursor=""});
p.addHandler(p._header,"mouseleave.ribbon"+r,function(b){!0===p._removeByDrag&&!0===u&&(p._raiseEvent("3",{draggedIndex:m,x:b.pageX,y:b.pageY}),1<p._items.length&&p.removeAt(m),u=!1,b.target.style.cursor="")})}else if("hover"===p.selectionMode){for(v=0;v<p._items.length;v++)w=p._items[v],p.addHandler(w,"mouseenter.ribbon"+r,h),"popup"===p.mode&&p.addHandler(w,"click.ribbon"+r,k);if("popup"===p.mode){p.addHandler(p.host,"mouseleave.ribbon"+r,function(){"mouseLeave"===p.popupCloseMode&&"popup"===p.mode&&
p._clearSelection()});for(v=0;v<p._contentSections.length;v++)p.addHandler(p._contentSections,"mouseleave.ribbon"+r,l);p.addHandler(c(document),"mousedown.ribbon"+r,function(b){q(b)})}}var y,A;c.jqx.mobile.isTouchDevice()?(y="touchstart",A="touchend"):(y="mousedown",A="mouseup");p.addHandler(p._scrollButtonNear,y+".ribbon"+r,function(){return"horizontal"===p._orientation?p._timeoutNear=setInterval(function(){p._headerElement.scrollLeft-=p.scrollStep*(p.rtl&&"msie"===p._browser.browser?-1:1);p._updatePositions()},
p.scrollDelay):p._timeoutNear=setInterval(function(){p._headerElement.scrollTop-=p.scrollStep;p._updatePositions()},p.scrollDelay),!1});p.addHandler(p._scrollButtonFar,y+".ribbon"+r,function(){return"horizontal"===p._orientation?p._timeoutFar=setInterval(function(){p._headerElement.scrollLeft+=p.scrollStep*(p.rtl&&"msie"===p._browser.browser?-1:1);p._updatePositions()},p.scrollDelay):p._timeoutFar=setInterval(function(){p._headerElement.scrollTop+=p.scrollStep;p._updatePositions()},p.scrollDelay),
!1});p.addHandler(c(document),A+".ribbon"+r,function(){clearInterval(p._timeoutNear);clearInterval(p._timeoutFar)})},_removeHandlers:function(b,d){var e=this.element.id;b||(b=this.selectionMode);d||(d=this.mode);for(var f=0;f<this._items.length;f++){var g=this._items[f];this.removeHandler(g,"mouseenter.ribbon"+e);"click"===b&&(this.removeHandler(g,"click.ribbon"+e),this.removeHandler(g,"mouseleave.ribbon"+e),this.removeHandler(g,"mousedown.ribbon"+e))}"click"===b?(this.removeHandler(document,"mouseup.ribbon"+
e),this.removeHandler(this._header,"mouseleave.ribbon"+e)):"hover"===b&&"popup"===d&&this.removeHandler(this.host,"mouseleave.ribbon"+e);var h,k;c.jqx.mobile.isTouchDevice()?(h="touchstart",k="touchend"):(h="mousedown",k="mouseup");this.removeHandler(this._scrollButtonNear,h+".ribbon"+e);this.removeHandler(this._scrollButtonFar,h+".ribbon"+e);this.removeHandler(c(document),k+".ribbon"+e)},_checkStructure:function(b){if(2!==b.length)throw Error("jqxRibbon: Invalid HTML structure. You need to add a ul and a div to the widget container.");
if(this._header.children().length!==this._content.children().length)throw Error("jqxRibbon: Invalid HTML structure. For each list item you must have a corresponding div element.");},_addClasses:function(){var b="jqx-widget-content jqx-ribbon-content-section jqx-ribbon-content-section-"+this.position,d="jqx-widget-content jqx-ribbon-content jqx-ribbon-content-"+this._orientation,e="jqx-widget-header jqx-disableselect jqx-ribbon-header jqx-ribbon-header-"+this._orientation,f="jqx-ribbon-item jqx-ribbon-item-"+
this.position;if(this._content.removeClass(),this._header.removeClass(this.toThemeProperty("jqx-rc-all jqx-widget-header jqx-disableselect jqx-rc-t jqx-rc-b jqx-rc-l jqx-rc-r jqx-rc-all jqx-ribbon-header-"+this._orientation+"-popup jqx-ribbon-header-bottom jqx-ribbon-header-auto jqx-ribbon-header-right jqx-ribbon-header-rtl")),this.host.removeClass(),this._roundedCorners)switch(this.position){case "top":e+=" jqx-rc-t";f+=" jqx-rc-t";b+=" jqx-rc-b";break;case "bottom":e+=" jqx-rc-b";f+=" jqx-rc-b";
b+=" jqx-rc-t";break;case "left":e+=" jqx-rc-l";f+=" jqx-rc-l";b+=" jqx-rc-r";break;case "right":e+=" jqx-rc-r",f+=" jqx-rc-r",b+=" jqx-rc-l"}else switch(this.position){case "top":f+=" jqx-rc-t";break;case "bottom":f+=" jqx-rc-b";break;case "left":f+=" jqx-rc-l";break;case "right":f+=" jqx-rc-r"}!0===this.rtl&&(e+=" jqx-ribbon-header-rtl",f+=" jqx-ribbon-item-rtl");this.element.className+=" "+this.toThemeProperty("jqx-widget jqx-ribbon");this._headerElement.className+=" "+this.toThemeProperty(e);
this._contentElement.className+=" "+this.toThemeProperty(d);for(d=0;d<this._items.length;d++){var e=c(this._contentSections[d]),g=c(this._items[d]);e.removeClass();g.removeClass(this.toThemeProperty("jqx-fill-state-disabled jqx-ribbon-item-rtl jqx-widget-content jqx-ribbon-item-selected jqx-rc-t jqx-rc-b jqx-rc-l jqx-rc-r jqx-ribbon-item-docking-layout jqx-ribbon-item jqx-ribbon-item-"+this.position));"popup"===this.mode&&(b+=" jqx-ribbon-content-section-popup jqx-ribbon-content-popup-"+this.position+
" jqx-ribbon-content-section-"+this._orientation+"-popup");this._contentSections[d].className+=" "+this.toThemeProperty(b);this._items[d].className+=" "+this.toThemeProperty(f)}var h,k;if("popup"===this.mode?(-1===this.selectedIndex&&this._roundedCorners&&(this.element.className+=" "+this.toThemeProperty("jqx-rc-all"),this._headerElement.className+=" "+this.toThemeProperty("jqx-rc-all")),this.element.className+=" "+this.toThemeProperty("jqx-ribbon-popup"),this._headerElement.className+=" "+this.toThemeProperty("jqx-ribbon-header-"+
this._orientation+"-popup"),this._contentElement.className+=" "+this.toThemeProperty("jqx-ribbon-content-popup"),this._positionPopup()):"horizontal"===this._orientation?"auto"!==this.height?(k=this._headerElement.offsetHeight,"top"===this.position?this._contentElement.style.paddingTop=this._toPx(k):this._headerElement.className+=" "+this.toThemeProperty("jqx-ribbon-header-bottom")):this._headerElement.className+=" "+this.toThemeProperty("jqx-ribbon-header-auto"):"vertical"===this._orientation&&("auto"!==
this.width?(h=this._headerElement.offsetWidth,"left"===this.position?this._contentElement.style.paddingLeft=this._toPx(h):(this._headerElement.className+=" "+this.toThemeProperty("jqx-ribbon-header-right"),this._contentElement.style.paddingRight=this._toPx(h))):(this.element.className+=" "+this.toThemeProperty("jqx-ribbon-auto"),this._headerElement.className+=" "+this.toThemeProperty("jqx-ribbon-header-auto"),this._contentElement.className+=" "+this.toThemeProperty("jqx-ribbon-content-auto-width"))),
"7.0"===this._browser.version&&"msie"===this._browser.browser)if("horizontal"===this._orientation)this._header.css("width",this.host.width()-parseInt(this._header.css("padding-left"),10)-parseInt(this._header.css("padding-right"),10)-parseInt(this._header.css("border-left-width"),10)-parseInt(this._header.css("border-right-width"),10)),this._items.height(this._items.height()-parseInt(this._items.css("padding-top"),10)-parseInt(this._items.css("padding-bottom"),10)-parseInt(this._items.css("border-top-width"),
10)-parseInt(this._items.css("border-bottom-width"),10)),this._contentSections.width(this._contentSections.width()-parseInt(this._contentSections.css("border-left-width"),10)-parseInt(this._contentSections.css("border-right-width"),10)-parseInt(this._contentSections.css("padding-left"),10)-parseInt(this._contentSections.css("padding-right"),10)),"default"===this.mode&&"auto"!==this.height&&("top"===this.position?this._contentSections.css("padding-top",k):this._contentSections.css("padding-bottom",
k),this._content.css("height",this.host.height()+2),this._contentSections.css("height",this._content.height()-parseInt(this._contentSections.css("border-bottom-width"),10)-parseInt(this._contentSections.css("border-top-width"),10)-1));else{var l;"left"===this.position?(this._contentElement.className+=" "+this.toThemeProperty("jqx-ribbon-content-left"),l=parseInt(this._contentSections.css("border-left-width"),10)+parseInt(this._contentSections.css("border-right-width"),10)+1):(this._contentElement.className+=
" "+this.toThemeProperty("jqx-ribbon-content-right"),l=0);this._header.css("height",this.host.height()-parseInt(this._header.css("padding-top"),10)-parseInt(this._header.css("padding-bottom"),10)-parseInt(this._header.css("border-top-width"),10)-parseInt(this._header.css("border-bottom-width"),10));this._items.width(this._items.width()-parseInt(this._items.css("padding-left"),10)-parseInt(this._items.css("padding-right"),10)-parseInt(this._items.css("border-left-width"),10)-parseInt(this._items.css("border-right-width"),
10));this._contentSections.height(this._contentSections.height()-parseInt(this._contentSections.css("border-top-width"),10)-parseInt(this._contentSections.css("border-bottom-width"),10)-parseInt(this._contentSections.css("padding-top"),10)-parseInt(this._contentSections.css("padding-bottom"),10));"default"===this.mode&&"auto"!==this.width&&("left"===this.position?this._contentSections.css("padding-left",h):this._contentSections.css("padding-right",h),this._contentSections.width(this._content.width()-
this._header.width()-l))}},_positionPopup:function(){var b="7.0"===this._browser.version&&"msie"===this._browser.browser;switch(this.position){case "top":this._contentElement.style.top=this._toPx(this._headerElement.offsetHeight);break;case "bottom":this._contentElement.style.bottom=b?this._toPx(this._height(this._headerElement)):this._toPx(this._headerElement.offsetHeight);break;case "left":this._contentElement.style.left=this._toPx(this._headerElement.offsetWidth);break;case "right":this._contentElement.style.right=
this._header.outerWidth()+"px"}},_appendScrollButtons:function(){function b(b,c,e){b.className=d.toThemeProperty("jqx-ribbon-scrollbutton jqx-ribbon-scrollbutton-"+d.position+" jqx-ribbon-scrollbutton-"+d.scrollPosition+" jqx-widget-header "+c);b.innerHTML='<div class="'+d.toThemeProperty("jqx-ribbon-scrollbutton-inner "+e)+'"></div>';"horizontal"===d._orientation?b.style.height=d._toPx(d._height(d._headerElement)):b.style.width=d._toPx(d._width(d._headerElement));d.element.appendChild(b)}var d=this,
c="horizontal"===d._orientation?["left","right"]:["up","down"],f=document.createElement("div");b(f,"jqx-ribbon-scrollbutton-lt","jqx-icon-arrow-"+c[0]);var g=document.createElement("div");if(b(g,"jqx-ribbon-scrollbutton-rb","jqx-icon-arrow-"+c[1]),d._scrollButtonRc(f,g),d._scrollButtonNear=f,d._scrollButtonFar=g,d.roundedCorners)switch(d.position){case "top":case "bottom":f.style.marginLeft="-1px";g.style.marginRight="-1px";break;case "right":case "left":f.style.marginTop="-1px",g.style.marginBottom=
"-1px"}},_scrollButtonRc:function(b,d){if(this.roundedCorners)switch(this.position){case "top":"far"!==this.scrollPosition&&(b.className+=" "+this.toThemeProperty("jqx-rc-tl"));"near"!==this.scrollPosition&&(d.className+=" "+this.toThemeProperty("jqx-rc-tr"));break;case "bottom":"far"!==this.scrollPosition&&(b.className+=" "+this.toThemeProperty("jqx-rc-bl"));"near"!==this.scrollPosition&&(d.className+=" "+this.toThemeProperty("jqx-rc-br"));break;case "left":"far"!==this.scrollPosition&&(b.className+=
" "+this.toThemeProperty("jqx-rc-tl"));"near"!==this.scrollPosition&&(d.className+=" "+this.toThemeProperty("jqx-rc-bl"));break;case "right":"far"!==this.scrollPosition&&(b.className+=" "+this.toThemeProperty("jqx-rc-tr")),"near"!==this.scrollPosition&&(d.className+=" "+this.toThemeProperty("jqx-rc-br"))}},_updateItems:function(b){function d(){c._items[f]._index===c.selectedIndex&&(c.selectedIndex=f)}var c=this;c._items=c._header.children();c._contentSections=c._content.children();for(var f=0;f<c._items.length;f++){var g=
c._items[f];g.setAttribute("unselectable","on");void 0===g._index&&(g._disabled=!1,g._isInitialized=!1,c._contentSections[f]._layout="default");!0===b&&d();g._index=f;!0!==b&&d();c._contentSections[f]&&(c._contentSections[f]._index=f)}},_positionContent:function(b){var d,e,f,g,h,k,l=this,m=l._contentSections[b];"horizontal"===l._orientation?(d=l.element.offsetWidth,e=l.host.offset().left,f=l._items[b].offsetWidth,g=c(l._items[b]).offset().left,h=m.offsetWidth||parseInt(m.style.width,10),k="left"):
(d=l.element.offsetHeight,e=l.host.offset().top,f=l._items[b].offsetHeight,g=c(l._items[b]).offset().top,h=m.offsetHeight||parseInt(m.style.height,10),k="top");b=function(b){0>b?b=0:b+h>d&&(b=d-h);m.style[k]=l._toPx(b)};switch(m._layout){case "near":b(g-e);break;case "far":b(g-e-(h-f));break;case "center":b(g-e-(h-f)/2);break;default:if("right"===l.position)for(e=0;e<l._contentSections.length;e++)l._contentSections[e].style.right="1px";else m.style[k]=""}},_checkScrollButtons:function(b){var d=this,
e=0;c.each(d._items,function(){var b=c(this);"none"!==b.css("display")&&(e+="horizontal"===d._orientation?b.outerWidth(!0):b.outerHeight(!0))});var f="horizontal"===d._orientation?["margin-left","margin-right"]:["margin-top","margin-bottom"],g="horizontal"===d._orientation?d._width(d._headerElement):d._height(d._headerElement);if(d._itemMargins||(d._itemMargins=[],d._itemMargins.push(c(d._items[0]).css(f[0])),d._itemMargins.push(c(d._items[d._items.length-1]).css(f[1]))),e>g){d._scrollButtonNear.style.display=
"block";d._scrollButtonFar.style.display="block";var g=d.rtl?d._itemMargins[0]:17,h=d.rtl?d._itemMargins[0]:17;switch(d.scrollPosition){case "near":h=0;g=34;break;case "far":h=34,g=17}d._items[0]&&(d._items[0].style[f[0]]=d._toPx(g));d._items[d._items.length-1]&&(d._items[d._items.length-1].style[f[1]]=d._toPx(h))}else d._items[0]&&(d._items[0].style[f[0]]=d._toPx(d._itemMargins[0])),d._items[d._items.length-1]&&(d._items[d._items.length-1].style[f[1]]=d._toPx(d._itemMargins[1])),d._scrollButtonNear.style.display=
"none",d._scrollButtonFar.style.display="none";!0===b&&("horizontal"===d._orientation?(b=d._toPx(d._height(d._headerElement)),d._scrollButtonNear.style.height=b,d._scrollButtonFar.style.height=b):(b=d._toPx(d._width(d._headerElement)),d._scrollButtonNear.style.width=b,d._scrollButtonFar.style.width=b))},_positionSelectionToken:function(b){if(-1!==b&&(b=c(this._items[b]),0!==b.length)){var d,e,f,g,h;if("horizontal"===this._orientation){var k;!0===this.rtl?(h=1===this._browserWidthRtlFlag?this._headerElement.scrollWidth-
this._headerElement.clientWidth:0,k=this._browserScrollRtlFlag):(h=0,k=1);f=b[0].offsetLeft+h-this._headerElement.scrollLeft*k-this._selectionTokenOffsetX+2;h=this._headerElement.offsetHeight-1;g=this._width(b[0])+parseInt(b.css("padding-left"),10)+parseInt(b.css("padding-right"),10);"top"===this.position?(d=h-this._selectionTokenOffsetY,e=""):(d="",e=h-this._selectionTokenOffsetY);this._selectionToken.style.top=this._toPx(d);this._selectionToken.style.bottom=this._toPx(e);this._selectionToken.style.left=
this._toPx(f);this._selectionToken.style.width=this._toPx(g)}else d=b[0].offsetTop-this._headerElement.scrollTop-this._selectionTokenOffsetX+2,h=this._headerElement.offsetWidth-1,e=this._height(b[0])+parseInt(b.css("padding-top"),10)+parseInt(b.css("padding-bottom"),10),"left"===this.position?(f=h-this._selectionTokenOffsetY,g=""):(f="",g=h-this._selectionTokenOffsetY),this._selectionToken.style.top=this._toPx(d),this._selectionToken.style.left=this._toPx(f),this._selectionToken.style.right=this._toPx(g),
this._selectionToken.style.height=this._toPx(e)}},_updatePositions:function(b,d){if(isNaN(b)&&(b=!0===d&&null!==this._selecting&&0<=this._selecting?this._selecting:this.selectedIndex),-1!==b&&(this._positionSelectionToken(b),"popup"===this.mode&&"default"!==this._contentSections[b]._layout&&this._positionContent(b),"popup"===this.mode&&("left"===this.position||"right"===this.position))){this._contentElement.style.width="auto";var c=this._contentSections[b].style.width&&0<=this._contentSections[b].style.width.indexOf("%");
this._contentElement.style.width=c?this._toPx(this._width(this._contentSections[b])-this._width(this._headerElement)):this._toPx(this._width(this._contentSections[b]))}},_animationComplete:function(b,d){var c=-1!==d?d:null;this._contentElement.style.pointerEvents="auto";!0!==this._suppressSelectionEvents?(this._raiseEvent("0",{selectedIndex:b}),this._raiseEvent("2",{unselectedIndex:c,selectedIndex:b})):(!0!==this._suppressReorder&&void 0!==this._oldReorderIndex&&b!==this._oldReorderIndex&&this._raiseEvent("4",
{newIndex:b,oldIndex:this._oldReorderIndex}),this._suppressSelectionEvents=!1,this._suppressReorder=!1);this.selectedIndex=b;this.initContent&&!1===this._items[b]._isInitialized&&(this.initContent(b),this._items[b]._isInitialized=!0);this._allowSelection=!0;this._selecting=null},_clearSelectionComplete:function(b,d){this._selecting=null;void 0===b&&(b=this.selectedIndex);-1!==b&&(this._contentElement.style.pointerEvents="none",!0!==this._suppressSelectionEvents&&this._raiseEvent("1",{unselectedIndex:b}));
!0!==d&&(this.selectedIndex=-1)},_slide:function(b,d,e,f){var g=this;if(g.activeAnimations||(g.activeAnimations=[]),0<g.activeAnimations.length)for(var h=0;h<g.activeAnimations.length;h++)g.activeAnimations[h].clearQueue(),g.activeAnimations[h].finish();else b.clearQueue(),b.animate("finish");var k,l={save:function(b,d){for(var c=0;c<d.length;c++)null!==d[c]&&0<b.length&&b.data("ui-effects-"+d[c],b[0].style[d[c]])},restore:function(b,d){var c,e;for(e=0;e<d.length;e++)null!==d[e]&&(c=b.data("ui-effects-"+
d[e]),void 0===c&&(c=""),b.css(d[e],c))},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var d={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},e=c("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),f={width:b.width(),height:b.height()},g=document.activeElement;try{g.id}catch(h){g=document.body}return b.wrap(e),(b[0]===g||c.contains(b[0],g))&&c(g).focus(),e=b.parent(),
"static"===b.css("position")?(e.css({position:"relative"}),b.css({position:"relative"})):(c.extend(d,{position:b.css("position"),zIndex:b.css("z-index")}),c.each(["top","left","bottom","right"],function(c,e){d[e]=b.css(e);isNaN(parseInt(d[e],10))&&(d[e]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(f),e.css(d).show()},removeWrapper:function(b){var d=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===d||c.contains(b[0],
d))&&c(d).focus()),b}},m="position top bottom left right width height".split(" "),p=d.mode,h="show"===p;k=d.direction||"left";var r="up"===k||"down"===k?"top":"left",u="up"===k||"left"===k,q={};l.save(b,m);b.show();k=d.distance||b["top"===r?"outerHeight":"outerWidth"](!0);l.createWrapper(b).css({overflow:"hidden"});h&&b.css(r,u?isNaN(k)?"-"+k:-k:k);q[r]=(h?u?"+=":"-=":u?"-=":"+=")+k;return g.activeAnimations.push(b),b.animate(q,{duration:d.duration,easing:d.easing,complete:function(){g.activeAnimations.pop(b);
"show"===p?g._animationComplete(e,f):"hide"===p&&(b.hide(),g._clearSelectionComplete(e));l.restore(b,m);l.removeWrapper(b)}}),function(){b.clearQueue();b.stop(!0,!0)}},_toPx:function(b){return"number"==typeof b?b+"px":b},_width:function(b){var d=c(b),e=d.css("border-left-width"),f=d.css("border-right-width"),g=parseInt(d.css("padding-left"),10),h=parseInt(d.css("padding-right"),10);(d="none"===d.css("display"))&&(b.style.display="block");e=-1===e.indexOf("px")?1:parseInt(e,10);f=-1===f.indexOf("px")?
1:parseInt(f,10);e=b.offsetWidth-(e+f+g+h);return d&&(b.style.display="none"),Math.max(0,e)},_height:function(b){var d=c(b),e=d.css("border-top-width"),f=d.css("border-bottom-width"),g=parseInt(d.css("padding-top"),10),d=parseInt(d.css("padding-bottom"),10),e=-1===e.indexOf("px")?1:parseInt(e,10),f=-1===f.indexOf("px")?1:parseInt(f,10);return Math.max(0,b.offsetHeight-(e+f+g+d))},_closest:function(b,d,c){if(d){if(b.nodeName.toLowerCase()===d)return b;for(var f=b.parentNode;null!==f&&"#document"!==
f.nodeName;){if(f.nodeName.toLowerCase()===d)return f;f=f.parentNode}}if(c){if(-1<(" "+b.className+" ").replace(/[\n\t]/g," ").indexOf(" "+c+" "))return b;for(b=b.parentNode;null!==b&&"#document"!==b.nodeName;){if(-1<(" "+b.className+" ").replace(/[\n\t]/g," ").indexOf(" "+c+" "))return b;b=b.parentNode}}},_initAnimate:function(b){b.initAnimate&&!b.animate&&b.initAnimate()}})}(jqxBaseFramework);
var saveAs=saveAs||function(c){if(!("undefined"===typeof c||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var b=c.document.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in b,e=/constructor/i.test(c.HTMLElement),f=/CriOS\/[\d]+/.test(navigator.userAgent),g=function(b){(c.setImmediate||c.setTimeout)(function(){throw b;},0)},h=function(b){setTimeout(function(){"string"===typeof b?(c.URL||c.webkitURL||c).revokeObjectURL(b):b.remove()},4E4)},k=function(b){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?
new Blob([String.fromCharCode(65279),b],{type:b.type}):b},l=function(l,m,u){u||(l=k(l));var q=this,t="application/octet-stream"===l.type,v,w=function(){for(var b=["writestart","progress","write","writeend"],b=[].concat(b),d=b.length;d--;){var c=q["on"+b[d]];if("function"===typeof c)try{c.call(q,q)}catch(e){g(e)}}};u=function(){if((f||t&&e)&&c.FileReader){var b=new FileReader;b.onloadend=function(){var d=f?b.result:b.result.replace(/^data:[^;]*;/,"data:attachment/file;");c.open(d,"_blank")||(c.location.href=
d);q.readyState=q.DONE;w()};b.readAsDataURL(l);q.readyState=q.INIT}else v||(v=(c.URL||c.webkitURL||c).createObjectURL(l)),t?c.location.href=v:c.open(v,"_blank")||(c.location.href=v),q.readyState=q.DONE,w(),h(v)};q.readyState=q.INIT;d?(v=(c.URL||c.webkitURL||c).createObjectURL(l),setTimeout(function(){b.href=v;b.download=m;var d=new MouseEvent("click");b.dispatchEvent(d);w();h(v);q.readyState=q.DONE})):u()},m=l.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(b,
d,c){d=d||b.name||"download";c||(b=k(b));return navigator.msSaveOrOpenBlob(b,d)};m.abort=function(){};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;return function(b,d,c){return new l(b,d||b.name||"download",c)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define([],function(){return saveAs});
!function(c){"object"==typeof exports&&"undefined"!=typeof module?module.exports=c():"function"==typeof define&&define.amd?define([],c):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=c()}(function(){return function b(d,e,f){function g(k,m){if(!e[k]){if(!d[k]){var p="function"==typeof require&&require;if(!m&&p)return p(k,!0);if(h)return h(k,!0);p=Error("Cannot find module '"+k+"'");throw p.code="MODULE_NOT_FOUND",p;}p=e[k]={exports:{}};
d[k][0].call(p.exports,function(b){var e=d[k][1][b];return g(e?e:b)},p,p.exports,b,d,e,f)}return e[k].exports}for(var h="function"==typeof require&&require,k=0;k<f.length;k++)g(f[k]);return g}({1:[function(b,d,e){(function(b){function e(){r=!0;for(var b,d,f=u.length;f;){d=u;u=[];for(b=-1;++b<f;)d[b]();f=u.length}r=!1}var h,k=b.MutationObserver||b.WebKitMutationObserver;if(k){var l=0,k=new k(e),m=b.document.createTextNode("");k.observe(m,{characterData:!0});h=function(){m.data=l=++l%2}}else if(b.setImmediate||
"undefined"==typeof b.MessageChannel)h="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var d=b.document.createElement("script");d.onreadystatechange=function(){e();d.onreadystatechange=null;d.parentNode.removeChild(d);d=null};b.document.documentElement.appendChild(d)}:function(){setTimeout(e,0)};else{var p=new b.MessageChannel;p.port1.onmessage=e;h=function(){p.port2.postMessage(0)}}var r,u=[];d.exports=function(b){1!==u.push(b)||r||h()}}).call(this,"undefined"!=
typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(b,d,e){function f(){}function g(b){if("function"!=typeof b)throw new TypeError("resolver must be a function");this.state=v;this.queue=[];this.outcome=void 0;b!==f&&m(this,b)}function h(b,d,e){this.promise=b;"function"==typeof d&&(this.onFulfilled=d,this.callFulfilled=this.otherCallFulfilled);"function"==typeof e&&(this.onRejected=e,this.callRejected=this.otherCallRejected)}function k(b,d,e){r(function(){var f;
try{f=d(e)}catch(g){return u.reject(b,g)}f===b?u.reject(b,new TypeError("Cannot resolve promise with itself")):u.resolve(b,f)})}function l(b){var d=b&&b.then;return b&&"object"==typeof b&&"function"==typeof d?function(){d.apply(b,arguments)}:void 0}function m(b,d){function e(d){g||(g=!0,u.reject(b,d))}function f(d){g||(g=!0,u.resolve(b,d))}var g=!1,h=p(function(){d(f,e)});"error"===h.status&&e(h.value)}function p(b,d){var e={};try{e.value=b(d),e.status="success"}catch(f){e.status="error",e.value=
f}return e}var r=b(1),u={},q=["REJECTED"],t=["FULFILLED"],v=["PENDING"];d.exports=e=g;g.prototype["catch"]=function(b){return this.then(null,b)};g.prototype.then=function(b,d){if("function"!=typeof b&&this.state===t||"function"!=typeof d&&this.state===q)return this;var e=new this.constructor(f);this.state!==v?k(e,this.state===t?b:d,this.outcome):this.queue.push(new h(e,b,d));return e};h.prototype.callFulfilled=function(b){u.resolve(this.promise,b)};h.prototype.otherCallFulfilled=function(b){k(this.promise,
this.onFulfilled,b)};h.prototype.callRejected=function(b){u.reject(this.promise,b)};h.prototype.otherCallRejected=function(b){k(this.promise,this.onRejected,b)};u.resolve=function(b,d){var e=p(l,d);if("error"===e.status)return u.reject(b,e.value);if(e=e.value)m(b,e);else{b.state=t;b.outcome=d;for(var e=-1,f=b.queue.length;++e<f;)b.queue[e].callFulfilled(d)}return b};u.reject=function(b,d){b.state=q;b.outcome=d;for(var e=-1,f=b.queue.length;++e<f;)b.queue[e].callRejected(d);return b};e.resolve=function(b){return b instanceof
this?b:u.resolve(new this(f),b)};e.reject=function(b){var d=new this(f);return u.reject(d,b)};e.all=function(b){function d(b,f){e.resolve(b).then(function(b){q[f]=b;++k!==g||h||(h=!0,u.resolve(l,q))},function(b){h||(h=!0,u.reject(l,b))})}var e=this;if("[object Array]"!==Object.prototype.toString.call(b))return this.reject(new TypeError("must be an array"));var g=b.length,h=!1;if(!g)return this.resolve([]);for(var q=Array(g),k=0,t=-1,l=new this(f);++t<g;)d(b[t],t);return l};e.race=function(b){function d(b){e.resolve(b).then(function(b){h||
(h=!0,u.resolve(k,b))},function(b){h||(h=!0,u.reject(k,b))})}var e=this;if("[object Array]"!==Object.prototype.toString.call(b))return this.reject(new TypeError("must be an array"));var g=b.length,h=!1;if(!g)return this.resolve([]);for(var q=-1,k=new this(f);++q<g;)d(b[q]);return k}},{1:1}],3:[function(b,d,e){d="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"!=typeof d.Promise&&(d.Promise=b(2))},{2:2}],4:[function(b,d,e){function f(b,
d){b=b||[];d=d||{};try{return new Blob(b,d)}catch(e){if("TypeError"!==e.name)throw e;for(var f=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),g=0;g<b.length;g+=1)f.append(b[g]);return f.getBlob(d.type)}}function g(b,d){d&&b.then(function(b){d(null,b)},function(b){d(b)})}function h(b,d,e){"function"==typeof d&&b.then(d);"function"==typeof e&&b["catch"](e)}function k(b){return(new B(function(d){var e=
b.transaction(T,"readwrite"),g=f([""]);e.objectStore(T).put(g,"key");e.onabort=function(b){b.preventDefault();b.stopPropagation();d(!1)};e.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);d(e||!b||43<=parseInt(b[1],10))}}))["catch"](function(){return!1})}function l(b){return"boolean"==typeof H?B.resolve(H):k(b).then(function(b){return H=b})}function m(b){b=E[b.name];var d={};d.promise=new B(function(b){d.resolve=b});b.deferredOperations.push(d);
b.dbReady?b.dbReady=b.dbReady.then(function(){return d.promise}):b.dbReady=d.promise}function p(b,d){return new B(function(e,f){if(b.db){if(!d)return e(b.db);m(b);b.db.close()}var g=[b.name];d&&g.push(b.version);var h=G.open.apply(G,g);d&&(h.onupgradeneeded=function(d){var e=h.result;try{e.createObjectStore(b.storeName),1>=d.oldVersion&&e.createObjectStore(T)}catch(f){if("ConstraintError"!==f.name)throw f;console.warn('The database "'+b.name+'" has been upgraded from version '+d.oldVersion+" to version "+
d.newVersion+', but the storage "'+b.storeName+'" already exists.')}});h.onerror=function(b){b.preventDefault();f(h.error)};h.onsuccess=function(){e(h.result);var d=E[b.name].deferredOperations.pop();d&&d.resolve()}})}function r(b){return new B(function(d,e){var f=new FileReader;f.onerror=e;f.onloadend=function(e){e=btoa(e.target.result||"");d({__local_forage_encoded_blob:!0,data:e,type:b.type})};f.readAsBinaryString(b)})}function u(b){for(var d=atob(b.data),e=d.length,g=new ArrayBuffer(e),h=new Uint8Array(g),
q=0;e>q;q++)h[q]=d.charCodeAt(q);return f([g],{type:b.type})}function q(b){var d=this,e=d._initReady().then(function(){var b=E[d._dbInfo.name];return b&&b.dbReady?b.dbReady:void 0});return h(e,b,b),e}function t(b){var d,e,f,g,h;d=.75*b.length;var q=b.length,k=0;"="===b[b.length-1]&&(d--,"="===b[b.length-2]&&d--);var t=new ArrayBuffer(d),l=new Uint8Array(t);for(d=0;q>d;d+=4)e=D.indexOf(b[d]),f=D.indexOf(b[d+1]),g=D.indexOf(b[d+2]),h=D.indexOf(b[d+3]),l[k++]=e<<2|f>>4,l[k++]=(15&f)<<4|g>>2,l[k++]=(3&
g)<<6|63&h;return t}function v(b){var d=new Uint8Array(b),e="";for(b=0;b<d.length;b+=3)e+=D[d[b]>>2],e+=D[(3&d[b])<<4|d[b+1]>>4],e+=D[(15&d[b+1])<<2|d[b+2]>>6],e+=D[63&d[b+2]];return 2===d.length%3?e=e.substring(0,e.length-1)+"=":1===d.length%3&&(e=e.substring(0,e.length-2)+"=="),e}function w(b,d,e,f){var h=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var q=new B(function(g,q){h.ready().then(function(){void 0===d&&(d=null);var k=d,t=h._dbInfo;t.serializer.serialize(d,
function(d,l){l?q(l):t.db.transaction(function(e){e.executeSql("INSERT OR REPLACE INTO "+t.storeName+" (key, value) VALUES (?, ?)",[b,d],function(){g(k)},function(b,d){q(d)})},function(d){if(d.code===d.QUOTA_ERR){if(0<f)return void g(w.apply(h,[b,k,e,f-1]));q(d)}})})})["catch"](q)});return g(q,e),q}function y(b,d){b[d]=function(){var e=arguments;return b.ready().then(function(){return b[d].apply(b,e)})}}function A(){for(var b=1;b<arguments.length;b++){var d=arguments[b];if(d)for(var e in d)d.hasOwnProperty(e)&&
(ea(d[e])?arguments[0][e]=d[e].slice():arguments[0][e]=d[e])}return arguments[0]}function F(b){for(var d in K)if(K.hasOwnProperty(d)&&K[d]===b)return!0;return!1}var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol?"symbol":typeof b},G=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;
if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();"undefined"==typeof Promise&&b(3);var H,E,B=Promise,T="local-forage-detect-blob-support",S=Object.prototype.toString,X={_driver:"asyncStorage",_initStorage:function(b){function d(){return B.resolve()}var e=this,f={db:null};if(b)for(var g in b)f[g]=b[g];E||(E={});var h=E[f.name];h||(h={forages:[],db:null,dbReady:null,deferredOperations:[]},E[f.name]=h);h.forages.push(e);e._initReady||(e._initReady=
e.ready,e.ready=q);b=[];for(g=0;g<h.forages.length;g++){var k=h.forages[g];k!==e&&b.push(k._initReady()["catch"](d))}var t=h.forages.slice(0);return B.all(b).then(function(){return f.db=h.db,p(f,!1)}).then(function(b){f.db=b;var d;d=e._defaultConfig.version;if(f.db){var g=!f.db.objectStoreNames.contains(f.storeName),h=f.version>f.db.version;(f.version<f.db.version&&(f.version!==d&&console.warn('The database "'+f.name+"\" can't be downgraded from version "+f.db.version+" to version "+f.version+"."),
f.version=f.db.version),h||g)?(g&&(d=f.db.version+1,d>f.version&&(f.version=d)),d=!0):d=!1}else d=!0;return d?p(f,!0):b}).then(function(b){f.db=h.db=b;e._dbInfo=f;for(b=0;b<t.length;b++){var d=t[b];d!==e&&(d._dbInfo.db=f.db,d._dbInfo.version=f.version)}})},iterate:function(b,d){var e=this,f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo,h=g.db.transaction(g.storeName,"readonly").objectStore(g.storeName).openCursor(),q=1;h.onsuccess=function(){var e=h.result;if(e){var f=e.value;f&&f.__local_forage_encoded_blob&&
(f=u(f));f=b(f,e.key,q++);void 0!==f?d(f):e["continue"]()}else d()};h.onerror=function(){f(h.error)}})["catch"](f)});return g(f,d),f},getItem:function(b,d){var e=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo,h=g.db.transaction(g.storeName,"readonly").objectStore(g.storeName).get(b);h.onsuccess=function(){var b=h.result;void 0===b&&(b=null);b&&b.__local_forage_encoded_blob&&(b=u(b));
d(b)};h.onerror=function(){f(h.error)}})["catch"](f)});return g(f,d),f},setItem:function(b,d,e){var f=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var h=new B(function(e,g){var h;f.ready().then(function(){return h=f._dbInfo,"[object Blob]"===S.call(d)?l(h.db).then(function(b){return b?d:r(d)}):d}).then(function(d){var f=h.db.transaction(h.storeName,"readwrite"),q=f.objectStore(h.storeName).put(d,b);null===d&&(d=void 0);f.oncomplete=function(){void 0===
d&&(d=null);e(d)};f.onabort=f.onerror=function(){g(q.error?q.error:q.transaction.error)}})["catch"](g)});return g(h,e),h},removeItem:function(b,d){var e=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo,h=g.db.transaction(g.storeName,"readwrite"),q=h.objectStore(g.storeName)["delete"](b);h.oncomplete=function(){d()};h.onerror=function(){f(q.error)};h.onabort=function(){f(q.error?q.error:
q.transaction.error)}})["catch"](f)});return g(f,d),f},clear:function(b){var d=this,e=new B(function(b,e){d.ready().then(function(){var f=d._dbInfo,g=f.db.transaction(f.storeName,"readwrite"),h=g.objectStore(f.storeName).clear();g.oncomplete=function(){b()};g.onabort=g.onerror=function(){e(h.error?h.error:h.transaction.error)}})["catch"](e)});return g(e,b),e},length:function(b){var d=this,e=new B(function(b,e){d.ready().then(function(){var f=d._dbInfo,g=f.db.transaction(f.storeName,"readonly").objectStore(f.storeName).count();
g.onsuccess=function(){b(g.result)};g.onerror=function(){e(g.error)}})["catch"](e)});return g(e,b),e},key:function(b,d){var e=this,f=new B(function(d,f){return 0>b?void d(null):void e.ready().then(function(){var g=e._dbInfo,h=!1,q=g.db.transaction(g.storeName,"readonly").objectStore(g.storeName).openCursor();q.onsuccess=function(){var e=q.result;return e?void(0===b?d(e.key):h?d(e.key):(h=!0,e.advance(b))):void d(null)};q.onerror=function(){f(q.error)}})["catch"](f)});return g(f,d),f},keys:function(b){var d=
this,e=new B(function(b,e){d.ready().then(function(){var f=d._dbInfo,g=f.db.transaction(f.storeName,"readonly").objectStore(f.storeName).openCursor(),h=[];g.onsuccess=function(){var d=g.result;return d?(h.push(d.key),void d["continue"]()):void b(h)};g.onerror=function(){e(g.error)}})["catch"](e)});return g(e,b),e}},D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=/^~~local_forage_type~([^~]+)~/,Y=Object.prototype.toString,V={serialize:function(b,d){var e="";if(b&&(e=Y.call(b)),
b&&("[object ArrayBuffer]"===e||b.buffer&&"[object ArrayBuffer]"===Y.call(b.buffer))){var f,g="__lfsc__:";b instanceof ArrayBuffer?(f=b,g+="arbf"):(f=b.buffer,"[object Int8Array]"===e?g+="si08":"[object Uint8Array]"===e?g+="ui08":"[object Uint8ClampedArray]"===e?g+="uic8":"[object Int16Array]"===e?g+="si16":"[object Uint16Array]"===e?g+="ur16":"[object Int32Array]"===e?g+="si32":"[object Uint32Array]"===e?g+="ui32":"[object Float32Array]"===e?g+="fl32":"[object Float64Array]"===e?g+="fl64":d(Error("Failed to get type for BinaryArray")));
d(g+v(f))}else if("[object Blob]"===e)e=new FileReader,e.onload=function(){var e="~~local_forage_type~"+b.type+"~"+v(this.result);d("__lfsc__:blob"+e)},e.readAsArrayBuffer(b);else try{d(JSON.stringify(b))}catch(h){console.error("Couldn't convert value into a JSON string: ",b),d(null,h)}},deserialize:function(b){if("__lfsc__:"!==b.substring(0,9))return JSON.parse(b);var d,e=b.substring(13);b=b.substring(9,13);if("blob"===b&&R.test(e)){var g=e.match(R);d=g[1];e=e.substring(g[0].length)}e=t(e);switch(b){case "arbf":return e;
case "blob":return f([e],{type:d});case "si08":return new Int8Array(e);case "ui08":return new Uint8Array(e);case "uic8":return new Uint8ClampedArray(e);case "si16":return new Int16Array(e);case "ur16":return new Uint16Array(e);case "si32":return new Int32Array(e);case "ui32":return new Uint32Array(e);case "fl32":return new Float32Array(e);case "fl64":return new Float64Array(e);default:throw Error("Unkown type: "+b);}},stringToBuffer:t,bufferToString:v},N={_driver:"webSQLStorage",_initStorage:function(b){var d=
this,e={db:null};if(b)for(var f in b)e[f]="string"!=typeof b[f]?b[f].toString():b[f];b=new B(function(b,f){try{e.db=openDatabase(e.name,String(e.version),e.description,e.size)}catch(g){return f(g)}e.db.transaction(function(g){g.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){d._dbInfo=e;b()},function(b,d){f(d)})})});return e.serializer=V,b},iterate:function(b,d){var e=this,f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo;
g.db.transaction(function(e){e.executeSql("SELECT * FROM "+g.storeName,[],function(e,f){for(var h=f.rows,q=h.length,k=0;q>k;k++){var t=h.item(k),l=t.value;if(l&&(l=g.serializer.deserialize(l)),l=b(l,t.key,k+1),void 0!==l)return void d(l)}d()},function(b,d){f(d)})})})["catch"](f)});return g(f,d),f},getItem:function(b,d){var e=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo;g.db.transaction(function(e){e.executeSql("SELECT * FROM "+
g.storeName+" WHERE key = ? LIMIT 1",[b],function(b,e){var f=e.rows.length?e.rows.item(0).value:null;f&&(f=g.serializer.deserialize(f));d(f)},function(b,d){f(d)})})})["catch"](f)});return g(f,d),f},setItem:function(b,d,e){return w.apply(this,[b,d,e,1])},removeItem:function(b,d){var e=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo;g.db.transaction(function(e){e.executeSql("DELETE FROM "+
g.storeName+" WHERE key = ?",[b],function(){d()},function(b,d){f(d)})})})["catch"](f)});return g(f,d),f},clear:function(b){var d=this,e=new B(function(b,e){d.ready().then(function(){var f=d._dbInfo;f.db.transaction(function(d){d.executeSql("DELETE FROM "+f.storeName,[],function(){b()},function(b,d){e(d)})})})["catch"](e)});return g(e,b),e},length:function(b){var d=this,e=new B(function(b,e){d.ready().then(function(){var f=d._dbInfo;f.db.transaction(function(d){d.executeSql("SELECT COUNT(key) as c FROM "+
f.storeName,[],function(d,e){var f=e.rows.item(0).c;b(f)},function(b,d){e(d)})})})["catch"](e)});return g(e,b),e},key:function(b,d){var e=this,f=new B(function(d,f){e.ready().then(function(){var g=e._dbInfo;g.db.transaction(function(e){e.executeSql("SELECT key FROM "+g.storeName+" WHERE id = ? LIMIT 1",[b+1],function(b,e){var f=e.rows.length?e.rows.item(0).key:null;d(f)},function(b,d){f(d)})})})["catch"](f)});return g(f,d),f},keys:function(b){var d=this,e=new B(function(b,e){d.ready().then(function(){var f=
d._dbInfo;f.db.transaction(function(d){d.executeSql("SELECT key FROM "+f.storeName,[],function(d,e){for(var f=[],g=0;g<e.rows.length;g++)f.push(e.rows.item(g).key);b(f)},function(b,d){e(d)})})})["catch"](e)});return g(e,b),e}},z={_driver:"localStorageWrapper",_initStorage:function(b){var d={};if(b)for(var e in b)d[e]=b[e];return d.keyPrefix=d.name+"/",d.storeName!==this._defaultConfig.storeName&&(d.keyPrefix+=d.storeName+"/"),this._dbInfo=d,d.serializer=V,B.resolve()},iterate:function(b,d){var e=
this,f=e.ready().then(function(){for(var d=e._dbInfo,f=d.keyPrefix,g=f.length,h=localStorage.length,q=1,k=0;h>k;k++){var t=localStorage.key(k);if(0===t.indexOf(f)){var l=localStorage.getItem(t);if(l&&(l=d.serializer.deserialize(l)),l=b(l,t.substring(g),q++),void 0!==l)return l}}});return g(f,d),f},getItem:function(b,d){var e=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var f=e.ready().then(function(){var d=e._dbInfo,f=localStorage.getItem(d.keyPrefix+
b);return f&&(f=d.serializer.deserialize(f)),f});return g(f,d),f},setItem:function(b,d,e){var f=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var h=f.ready().then(function(){void 0===d&&(d=null);var e=d;return new B(function(g,h){var q=f._dbInfo;q.serializer.serialize(d,function(d,f){if(f)h(f);else try{localStorage.setItem(q.keyPrefix+b,d),g(e)}catch(k){"QuotaExceededError"!==k.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==k.name||h(k),h(k)}})})});return g(h,
e),h},removeItem:function(b,d){var e=this;"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b));var f=e.ready().then(function(){localStorage.removeItem(e._dbInfo.keyPrefix+b)});return g(f,d),f},clear:function(b){var d=this,e=d.ready().then(function(){for(var b=d._dbInfo.keyPrefix,e=localStorage.length-1;0<=e;e--){var f=localStorage.key(e);0===f.indexOf(b)&&localStorage.removeItem(f)}});return g(e,b),e},length:function(b){var d=this.keys().then(function(b){return b.length});
return g(d,b),d},key:function(b,d){var e=this,f=e.ready().then(function(){var d,f=e._dbInfo;try{d=localStorage.key(b)}catch(g){d=null}return d&&(d=d.substring(f.keyPrefix.length)),d});return g(f,d),f},keys:function(b){var d=this,e=d.ready().then(function(){for(var b=d._dbInfo,e=localStorage.length,f=[],g=0;e>g;g++)0===localStorage.key(g).indexOf(b.keyPrefix)&&f.push(localStorage.key(g).substring(b.keyPrefix.length));return f});return g(e,b),e}},W={},K={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",
WEBSQL:"webSQLStorage"},L="clear getItem iterate key keys length removeItem setItem".split(" "),O={description:"",driver:[K.INDEXEDDB,K.WEBSQL,K.LOCALSTORAGE].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},I={};I[K.INDEXEDDB]=function(){try{if(!G)return!1;var b="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),d="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");
return(!b||d)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}();I[K.WEBSQL]="function"==typeof openDatabase;b=K.LOCALSTORAGE;var Z;try{Z="undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(U){Z=!1}I[b]=Z;var ea=Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)};Z=new (function(){function b(d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.INDEXEDDB=K.INDEXEDDB;
this.LOCALSTORAGE=K.LOCALSTORAGE;this.WEBSQL=K.WEBSQL;this._defaultConfig=A({},O);this._config=A({},this._defaultConfig,d);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver)["catch"](function(){})}return b.prototype.config=function(b){if("object"===("undefined"==typeof b?"undefined":C(b))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var d in b){if("storeName"===d&&
(b[d]=b[d].replace(/\W/g,"_")),"version"===d&&"number"!=typeof b[d])return Error("Database version must be a number.");this._config[d]=b[d]}return"driver"in b&&b.driver?this.setDriver(this._config.driver):!0}return"string"==typeof b?this._config[b]:this._config},b.prototype.defineDriver=function(b,d,e){var f=new B(function(d,e){try{var f=b._driver,g=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),h=Error("Custom driver name already in use: "+b._driver);
if(!b._driver)return void e(g);if(F(b._driver))return void e(h);for(var q=L.concat("_initStorage"),h=0;h<q.length;h++){var k=q[h];if(!k||!b[k]||"function"!=typeof b[k])return void e(g)}var t=B.resolve(!0);"_support"in b&&(t=b._support&&"function"==typeof b._support?b._support():B.resolve(!!b._support));t.then(function(e){I[f]=e;W[f]=b;d()},e)}catch(l){e(l)}});return h(f,d,e),f},b.prototype.driver=function(){return this._driver||null},b.prototype.getDriver=function(b,d,e){var f=this,g=B.resolve().then(function(){if(!F(b)){if(W[b])return W[b];
throw Error("Driver not found.");}switch(b){case f.INDEXEDDB:return X;case f.LOCALSTORAGE:return z;case f.WEBSQL:return N}});return h(g,d,e),g},b.prototype.getSerializer=function(b){var d=B.resolve(V);return h(d,b),d},b.prototype.ready=function(b){var d=this,e=d._driverSet.then(function(){return null===d._ready&&(d._ready=d._initDriver()),d._ready});return h(e,b,b),e},b.prototype.setDriver=function(b,d,e){function f(){k._config.driver=k.driver()}function g(b){return k._extend(b),f(),k._ready=k._initStorage(k._config),
k._ready}function q(b){return function(){function d(){for(;e<b.length;){var h=b[e];return e++,k._dbInfo=null,k._ready=null,k.getDriver(h).then(g)["catch"](d)}f();return k._driverSet=B.reject(Error("No available storage method found.")),k._driverSet}var e=0;return d()}}var k=this;ea(b)||(b=[b]);var t=this._getSupportedDrivers(b);return this._driverSet=(null!==this._driverSet?this._driverSet["catch"](function(){return B.resolve()}):B.resolve()).then(function(){var b=t[0];return k._dbInfo=null,k._ready=
null,k.getDriver(b).then(function(b){k._driver=b._driver;f();k._wrapLibraryMethodsWithReady();k._initDriver=q(t)})})["catch"](function(){f();return k._driverSet=B.reject(Error("No available storage method found.")),k._driverSet}),h(this._driverSet,d,e),this._driverSet},b.prototype.supports=function(b){return!!I[b]},b.prototype._extend=function(b){A(this,b)},b.prototype._getSupportedDrivers=function(b){for(var d=[],e=0,f=b.length;f>e;e++){var g=b[e];this.supports(g)&&d.push(g)}return d},b.prototype._wrapLibraryMethodsWithReady=
function(){for(var b=0;b<L.length;b++)y(this,L[b])},b.prototype.createInstance=function(d){return new b(d)},b}());d.exports=Z},{3:3}]},{},[4])(4)});"use strict";var CBStatIconField=function(c){jsGrid.Field.call(this,c)};CBStatIconField.prototype=new jsGrid.Field({css:"jsg-icon",align:"center",itemTemplate:genTemplate("statIcon")});jsGrid.fields.staticon=CBStatIconField;var CBResIconField=function(c){jsGrid.Field.call(this,c)};
CBResIconField.prototype=new jsGrid.Field({css:"jsg-icon",align:"center",itemTemplate:genTemplate("resIcon")});jsGrid.fields.resicon=CBResIconField;function genTemplate(c){return function(b,d){return b?String.formatEx('<span data-{0}="'+d.id+'"><img src="'+("/Common/Media/Ribbons/Reader/Status/"+b+"16.png")+'"height="16"></span>',c):String.formatEx('<span data-{0}="'+d.id+'"></span>',c)}}function CBDebug(){}CBDebug.assert=function(c,b){};CBDebug.call=function(c,b,d){};CBDebug.profile=function(c){};
CBDebug.profileEnd=function(){};function ASSERT(){}"use strict";
var CB={namespace:function(c){c=c.split(".");var b=CB;"CB"===c[0]&&(c=c.slice(1));for(var d=0;d<c.length;d+=1)"undefined"===typeof b[c[d]]&&(b[c[d]]={}),b=b[c[d]]},inherit:function(c,b){var d=c.prototype;c.prototype=new b;for(var e in d)d.hasOwnProperty(e)&&(c.prototype[e]=d[e]);c.superClass=b;c.prototype.superClass=b.prototype;return c},V0:function(c,b){for(var d in b)b.hasOwnProperty(d)&&(c.prototype[d]=b[d])},V1:function(c,b){return ObjUtil.copyTo(b,c,!0)},V2:function(c,b){Object.defineProperty(c,
b,{writable:!1})},V3:function(c,b,d,e){Object.defineProperty(c,b,{get:d,set:e})},V4:function(c,b,d,e){Object.defineProperty(c.prototype,b,{get:d,set:e})},V5:{V6:function(c,b){c.charAt(0)==b&&(c=c.slice(1,c.length-1));2<c.length&&c.charAt(c.length-1)==b&&(c=c.slice(0,c.length-1));return c}}};function Char(){}Char.IsDigit=function(c){return"9">=c&&"0"<=c};Char.IsLetter=function(c){return"z">=c&&"a"<=c||"Z">=c&&"A"<=c};Char.IsUpperCaseLetter=function(c){return"Z">=c&&"A"<=c};
Char.IsLetterOrDigit=function(c){return Char.IsLetter(c)||Char.IsDigit(c)};Char.IsWhiteSpace=function(c){return"\r"===c||"\n"===c||" "===c||"\t"===c};Char.getIsChar=function(c){return function(b){return b===c}};Char.getIsNotChar=function(c){return function(b){return b!==c}};function StringIterator(c){this.m_str=c;this.m_len=c.length}StringIterator.prototype.m_str=null;StringIterator.prototype.m_inx=-1;StringIterator.g_hasIndex=function(){return!0}();
StringIterator.g_hasIndex?(StringIterator.prototype.Current=function(){return this.m_str[this.m_inx]},StringIterator.prototype.Peek=function(){return this.m_inx>=this.m_len-1?0:this.m_str[this.m_inx+1]},StringIterator.prototype.Next=function(){++this.m_inx;return this.m_inx===this.m_len?0:this.m_str[this.m_inx]}):(StringIterator.prototype.Current=function(){return this.m_str.charAt(this.m_inx)},StringIterator.prototype.Peek=function(){return this.m_inx>=this.m_len-1?0:this.m_str.charAt(this.m_inx+
1)},StringIterator.prototype.Next=function(){++this.m_inx;return this.m_inx===this.m_len?0:this.m_str.charAt(this.m_inx)});StringIterator.prototype.CurrentString=function(c){return this.SubString(this.m_inx,c)};StringIterator.prototype.NextString=function(c){return this.SubString(this.m_inx+1,c)};StringIterator.prototype.SubString=function(c,b){var d=this.m_len-c;if(!b||b>d)b=d;return this.m_str.substring(c,c+b)};StringIterator.prototype.getPosition=function(){return this.m_inx};
StringIterator.prototype.setPosition=function(c){this.m_inx=c};StringIterator.prototype.skip=function(c){this.m_inx+=c};StringIterator.prototype.isEOF=function(){return this.m_inx===this.m_len};StringIterator.prototype.AcceptWhile=function(c,b){var d="";if(b){var e=this.Current();if(!c(e))return d;d=e}for(e=this.Next();0!==e&&c(e);e=this.Next())d+=e;return d};StringIterator.prototype.AcceptUntil=function(c,b){return this.AcceptWhile(NOT(c),b)};
StringIterator.prototype.AcceptStr=function(c,b){var d=c.length;return(b?this.CurrentString(d):this.NextString(d))===c?(b||++d,this.skip(d),!0):!1};StringIterator.prototype.AcceptChar=function(c,b){if(b){if(this.Current()===c)return this.skip(1),!0}else if(this.Peek()===c)return this.skip(2),!0;return!1};StringIterator.prototype.skipWhile=function(c,b){if(!b||c(this.Current()))for(var d=this.Next();0!==d&&c(d);d=this.Next());};StringIterator.prototype.skipUntil=function(c){return this.skipWhite(NOT(c))};
String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")});String.quote||(String.prototype.quote=function(){return'"'+this.replace(/\\/g,"\\\\").replace(RegExp('"',"g"),'\\"')+'"'});String.startsWith||(String.prototype.startsWith=function(c){return this.indexOf?0===this.indexOf(c):!1});String.capitalize||(String.capitalize=function(){return this.length?this[0].toUpperCase()+this.substring(1,this.length).toLowerCase():this});
CB.V7={V8:function(c,b,d,e,f){d=d||1;e=e||1;f=f||1;if(0===c.length)return b.length;if(0===b.length)return c.length;var g=[],h;for(h=0;h<=b.length;h++)g[h]=[h];var k;for(k=0;k<=c.length;k++)g[0][k]=k;for(h=1;h<=b.length;h++)for(k=1;k<=c.length;k++)b.charAt(h-1)==c.charAt(k-1)?g[h][k]=g[h-1][k-1]:g[h][k]=Math.min(g[h-1][k-1]+d,Math.min(g[h][k-1]+e,g[h-1][k]+f));return g[b.length][c.length]}};"use strict";
function StringBuilder(){var c=null,b=null,d=0,e="";this.appendFormat=function(){var b=String.formatEx.apply("",arguments);this.append(b)};this.append=function(f){e+=f;2800<e.length&&(null===c?c=b=[]:(f=b,b=[],f[1]=b),b[0]=e,e="",++d)};this.toString=function(){if(0==d)return e;for(;1<d;){for(var f=c,g=[],h=g,k=0;"undefined"!=typeof f;)"undefined"==typeof h[0]?(h[0]=f[0],++k):("undefined"!=typeof f[0]&&(h[0]+=f[0]),h[1]=[],h=h[1]),f=f[1];c=g;b=h;d=k}return c[0]+e}}
(function(){function c(b){for(var c="",g=d.lastIndex=0;;){var h=d.exec(b);if(!h)break;var k=h.index;k>g&&(g=b.substring(g,k).quote(),c&&(c+="+"),c+=g);h=h[1];g=parseInt(h);k="nz(";k=isNaN(g)?k+("(_a."+h+")"):k+("(_a["+(g+1)+"])");k+=")";c&&(c+="+");c+=k;g=d.lastIndex}b.length>g&&(b=b.substring(g).quote(),c&&(c+="+"),c+=b);return new Function("_a","var nz = function(_v){if(_v === undefined || _v === null)return ''; return _v.toString()};return "+c+";")}var b={},d=/{(\w+(\.\w+)*(\[\d+\])?)}/g;String.formatEx||
(String.formatEx=function(d){var f=b[d];f||(f=c(d),b[d]=f);var g=arguments;2===arguments.length&&"object"===typeof arguments[1]&&0>d.indexOf("{0}")&&(g=arguments[1]);return f(g)});String.f=String.formatEx;String.vformatEx||(String.vformatEx=function(b,d){return c(b)(d)})})();CB.V9=function(){return function(c){}}();"use strict";CB.namespace("CB.Va");var glLoc,lm;
CB.Va=function(){return function(c){this.locObjects=[].concat(c);lm=this.locObjects[0];for(c=1;c<this.locObjects.length;c++){var b=this.locObjects[c],d;for(d in b)b.hasOwnProperty(d)&&(lm[d]=b[d])}d=ObjUtil.clone(CB.V34l);d.arrStrPieces[CB.Piece.Vb]=d.arrStrPieces[CB.Piece.Vc]=lm.NOTATION_KING;d.arrStrPieces[CB.Piece.Vd]=d.arrStrPieces[CB.Piece.Ve]=lm.NOTATION_QUEEN;d.arrStrPieces[CB.Piece.Vf]=d.arrStrPieces[CB.Piece.Vg]=lm.NOTATION_ROOK;d.arrStrPieces[CB.Piece.Vh]=d.arrStrPieces[CB.Piece.Vi]=lm.NOTATION_BISHOP;
d.arrStrPieces[CB.Piece.Vj]=d.arrStrPieces[CB.Piece.Vk]=lm.NOTATION_KNIGHT;d.arrStrPieces[CB.Piece.Vl]=d.arrStrPieces[CB.Piece.Vm]="";lm.NOTA_LOCALIZATION=d}}();"use strict";CB.namespace("CB.Vn.Chess.ENG");
CB.Vn.Chess.ENG={LOGIN:"Log in",LOGOUT:"Log out",ACCOUNT:"My Account",BOARDS:"Boards",RECONNECT:"Reconnect",Vo:"Resign",Vp:"Close Board",Vq:"Offer Draw",Vr:"Accept Draw",Vs:"{0} accepted a draw.",Vt:"{0} offers a draw.",Vu:"{0} accepts a draw.",Vv:"{0} resigns.",Vw:"Testing Connection to Server",CONNECTING:"Connecting to server, please wait...",Vx:"Reconnected OK",Vy:"Name",Vz:"Country",V10:"Rank",WHITE:"White",BLACK:"Black",V11:"Elo White",V12:"Elo Black",RESULT:"Result",V13:"Time Control",V14:"Tournament",
GAMES:"Games",V15:"Chat",V16:"Your chat partner is gone.",V17:"Connection",V18:"Map",KING:"King",QUEEN:"Queen",ROOK:"Rook",BISHOP:"Bishop",KNIGHT:"Knight",PAWN:"Pawn",V19:"Type Chat Here",V1a:"Type Here To Chat With",GUEST:"Guest",V1b:"Confirm",V1c:"Cancel",V1d:"Clock",TIME:"Time",V1e:"Gain per Move",V1f:"Close",V1g:"Add",V1h:"Remove",NOTATION:"Notation",BOARD_FRITZ:"Fritz",BOARD_CRYSTALS:"Crystals",BOARD_USCF:"USCF",BOARD_OLDSTYLE:"OldStyle",BOARD_HABSBURG:"Habsburg",V1i:"Fritz & Chesster",V1j:"Play Blitz",
V1k:"New Game",TAKE_BACK:"Take Back",MAKE_MOVE:"Make Move",FLIP_BOARD:"Flip Board",V1l:"Copy",V1m:"Search Board",V1n:"Year",V1o:"Book",LIVE_BOOK:"Live Book",V1p:"Move",V1q:"Nr Games",V1r:"Score",V1s:"Last Played",V1t:"Elo Avg.",V1u:"Visits",V1v:"Loading statistics",V1w:"Let's Check",V1x:"Eval",V1y:"Variation",DEPTH:"Depth",V1z:"Engine",V20:"Enter your search text...",V21:"Retrieving games",V22:"Player details",V23:"Player information",V24:"First Name",V25:"Last Name",V26:"Year of Birth",V27:"Trend",
V28:"Rating",V29:"Send Feedback",V2a:"Your Comment",V2b:"Your E-mail Address",V2c:"Send",BROWSER_DOESNT_SUPPORT_3D:"Browser does not support 3d boards",BOARD3D_FRITZ:"Fritz",BOARD3D_MODERN:"Modern",BOARD3D_ROOM:"Room",BOARD3D_BALLOON:"Balloon",BOARD3D_METAL:"Metal",V2d:"Silver",BOARD3D_FUTURE:"Future",V2e:"Marble",V2f:"Welcome",V2g:"Material",V2h:"Analysis",ANALYSIS_ENGINE:"Engine",ENG_SEARCH_INFO_FMT:"Depth {0}/{1}, Speed = {2}kPos/s, Time = {3}s",V2i:"Paste",PW_INVALID:"<bold>User/Password invalid, please try again</bold>",
PLEASE_LOGIN:"Please log in with your ChessBase (Playchess) account:",V2j:"Name",V2k:"Password",V2l:"Create Account",V2m:"Guest",PLEASE_LOGIN_SHORT:"Please Log In",LOADING_ENGINE:"Loading Engine...",V2n:"Loading Live Games ...",V2o:"Inviting other players to a game of {0} ({1})",OTHER_TOOLS:"More Apps",DATABASES:"Databases",OPEN_DATABASE:"Open Database",CREATE_DATABASE:"Create Database",DELETE_DATABASE:"Delete Database",V2p:"Delete",V2q:"Clean Up",V2r:"My Databases",V2s:"Databases shared with me",
V2t:"Select Database For '{0}'",V2u:"Open PGN",SAVE:"Save",SAVE_AND_REPLACE_GAMES:"Save and replace games",SAVE_AS_NEW:"Save As New",EDIT_GAME:"Edit Game",DATABASE_FUNCTIONS:"Open, create and delete databases",V2v:"Text Before",TEXT_AFTER:"Text",V2w:"Start Line",PROMOTE_LINE:"Promote Line",DELETE_LINE:"Delete Line",CUT_LINE:"Cut Line",V2x:"Open a PGN file from your computer",V2y:"Add a text annotation before this move",TEXT_AFTER_TIP:"Add a text annotation after this move",V2z:"Retract current move and start a line",
V30:"Promote the currently selected line",DELETE_LINE_TIP:"Delete the selected line",CUT_LINE_TIP:"Cut off the following moves",V31:"Stay Logged In",V32:"Forgot Password",CHANGE_PASSWORD:"Change Password",V33:"Old Password",V34:"New Password",V35:"Confirm Password",MENU_PLAYCHESS_TOOL:"Play & Watch",MENU_DATABASE_TOOL:"Live Database",MENU_MYGAMES_TOOL:"My Own Games",MENU_FRITZ_TOOL:"Chess Program Fritz",MENU_FRITZ_CHESSTER_TOOL:"Chess For Kids",MENU_TACTICS_TOOL:"Tactics Training",LANGUAGE:"Language",
LOGIN_CREATE_LINK:"Click here to create an account",LOGIN_PLEASE_LOGIN:"Please Log In",LOGIN_ACCOUNT_FREE:"Creating an account is free. The account is valid for all other ChessBase Web Tools and for play.chessbase.com.",LOGIN_WELCOME:"Welcome, {0}",V36:"Manage friends",INVITE_FRIEND:"Invite a friend",V37:"Ping",NOTATION_KING:"K",NOTATION_QUEEN:"Q",NOTATION_KNIGHT:"N",NOTATION_BISHOP:"B",NOTATION_ROOK:"R",V38:"P",GENERAL_INVITE:'Thank you for using the <span style="font-weight:bold">{0}</span>.',V39:'Thank you for using <span style="font-weight:bold">ChessBase MyGames</span>, your personal chess database in the web.',
V3a:"Please login with your ChessBase Account to create and access your cloud chess databases. You can also use the cloud databases with ChessBase 13.",V3b:"ECO",V3c:"Back",V3d:"Next Move",V3e:"Previous Move",V3f:"Next Game",V3g:"Previous Game",MENU_VIDEO_TOOL:"Training Videos",MENU_OPENINGS_TOOL:"Manage Openings",V3h:"Requesting Moves",FRESH_POSITION:"Fresh Position",V3i:"Embed",V3j:"Help",V3k:"Toggle 2D/3D Board",BOARD3D_BLACKWHITE:"Black white",V3l:"Mate",V3m:"Stalemate",V3n:"Setup Position",WHITE_MATES:"White mates",
WHITE_CLEARLY_WINNING:"White is clearly winning",WHITE_WINNING:"White is winning",WHITE_DECISIVE:"White has a decisive advantage",WHITE_CLEARLY_BETTER:"White is clearly better",WHITE_BETTER:"White is better",WHITE_SLIGHTLY:"White is slightly better",WHITE_EDGE:"White is minimally better",BLACK_MATES:"Black mates",BLACK_CLEARLY_WINNING:"Black is clearly winning",BLACK_WINNING:"Black is winning",BLACK_DECISIVE:"Black has a decisive advantage",BLACK_CLEARLY_BETTER:"Black is clearly better",BLACK_BETTER:"Black is better",
BLACK_SLIGHTLY:"Black is slightly better",BLACK_EDGE:"Black is minimally better",EQUAL_POS:"The position is equal",PREMIUM_ONLY:"Premium Only",V3o:"Avatar",V3p:"Assisted Calculation",V3q:"Calculate variations with Fritz' assistance before you continue the game here.",V3r:"Enter moves blindly. Click in the notation to add variations anywhere. Insert Diagrams for checking. Click 'Assisted Calculation' to resume your game.",V3s:"Calculating...",V3t:"Wood",TRAINING_SOLUTION:"Show Solution",TRAINING_HELP:"Get Help",
TRAINING_QUESTION:"Find the correct move",UNANNOTATE:"Unannotate",V3u:"More Lines",V3v:"Less Lines",V3w:"Calculate Threat",V3x:"Start",V3y:"Pause",V3z:"At the moment there\u2019s no live broadcast",CONNECTED_TO_SERVER:"Connected to server: {0}",V40:"Initializing",INSERT_DIAGRAM:"Insert Diagram",BOARD:"Board",V41:"Loading board, just a second..."};"use strict";CB.namespace("CB.Vn.Chess.GER");
CB.Vn.Chess.GER={LOGIN:"Anmelden",LOGOUT:"Abmelden",ACCOUNT:"Mein Konto",BOARDS:"Bretter",RECONNECT:"Verbinden",Vo:"Aufgeben",Vp:"Brett schlie\u00dfen",Vq:"Remis bieten",Vr:"Remis akzeptieren",Vs:"{0} hat das Remis angenommen.",Vt:"{0} bietet Remis.",Vu:"{0} nimmt Remis an.",Vv:"{0} gibt auf.",Vw:"Test Verbindung zum Server",CONNECTING:"Verbindung wird aufgebaut, einen Moment...",Vx:"Verbindung wiederhergestellt",Vy:"Name",Vz:"Land",V10:"Rang",WHITE:"Weiss",BLACK:"Schwarz",V11:"Elo Weiss",V12:"Elo Schwarz",
RESULT:"Ergebnis",V13:"Bedenkzeit",V14:"Turnier",GAMES:"Partien",V15:"Chat",V16:"Ihr Chat Partner ist gegangen.",V17:"Verbindung",V18:"Karte",KING:"K\u00f6nig",QUEEN:"Dame",ROOK:"Turm",BISHOP:"L\u00e4ufer",KNIGHT:"Springer",PAWN:"Bauer",V19:"Chat hier eingeben",V1a:"Hier tippen f\u00fcr Chat an",GUEST:"Gast",V1b:"Best\u00e4tigen",V1c:"Abbruch",V1d:"Clock",TIME:"Time",V1e:"Gain per Move",V1f:"Close",V1g:"Add",V1h:"Remove",NOTATION:"Notation",BOARD_FRITZ:"Fritz",BOARD_CRYSTALS:"Crystals",BOARD_USCF:"USCF",
BOARD_OLDSTYLE:"OldStyle",BOARD_HABSBURG:"Habsburg",V1i:"Fritz & Fertig",V1j:"Blitzpartie",V1k:"Neue Partie",TAKE_BACK:"Zug zur\u00fcck",MAKE_MOVE:"Zug vor",FLIP_BOARD:"Brett drehen",V1l:"Kopieren",V1m:"Brett suchen",V1n:"Jahr",V1o:"Buch",LIVE_BOOK:"Live Buch",V1p:"Zug",V1q:"Nr Games",V1r:"Score",V1s:"Zuletzt gespielt",V1t:"Elo Avg.",V1u:"Besuche",V1v:"L\u00e4dt Statistiken",V1w:"Let's Check",V1x:"Eval",V1y:"Variation",DEPTH:"Tiefe",V1z:"Engine",V20:"Suchtext hier eingeben...",V21:"Lade Partien",
V22:"Spieler Details",V23:"Spieler Information",V24:"Vorname",V25:"Nachname",V26:"Geburtsjahr",V27:"Trend",V28:"Rating",V29:"Feedback senden",V2a:"Ihr Hinweis",V2b:"Ihre E-Mail-Adresse",V2c:"Absenden",BROWSER_DOESNT_SUPPORT_3D:"Ihr Browser unterst\u00fctzt noch kein 3D",BOARD3D_FRITZ:"Fritz",BOARD3D_MODERN:"Modern",BOARD3D_ROOM:"Room",BOARD3D_BALLOON:"Balloon",BOARD3D_METAL:"Metal",V2d:"Silver",BOARD3D_FUTURE:"Future",V2e:"Marble",V2f:"Willkommen",V2g:"Material",V2h:"Analyse",ANALYSIS_ENGINE:"Engine",
ENG_SEARCH_INFO_FMT:"Tiefe {0}/{1}, {2}Tsd Pos/s, Zeit = {3}s",V2i:"Einf\u00fcgen",PW_INVALID:'Account <em>"{0}"</em> oder Passwort nicht erkannt.',PLEASE_LOGIN:"Anmelden mit ChessBase (Playchess) Konto:",V2j:"Name",V2k:"Passwort",V2l:"Konto neu anlegen",V2m:"Gast",PLEASE_LOGIN_SHORT:"Bitte anmelden",LOADING_ENGINE:"Lade Engine...",V2n:"Lade Live Partien ...",V2o:"Inviting other players to a game of {0} ({1})",OTHER_TOOLS:"Weitere Apps",DATABASES:"Datenbanken",OPEN_DATABASE:"Datenbank \u00f6ffnen",
CREATE_DATABASE:"Neue Datenbank",DELETE_DATABASE:"Datenbank l\u00f6schen",V2p:"L\u00f6schen",V2q:"Aufr\u00e4umen",V2r:"Meine Datenbanken",V2s:"Mit mir geteilt",V2t:"Datenbankauswahl f\u00fcr '{0}'",V2u:"PGN \u00d6ffnen",SAVE:"Speichern",SAVE_AND_REPLACE_GAMES:"Partien speichern und ersetzen",SAVE_AS_NEW:"Neue Version speichern",EDIT_GAME:"Kenndaten setzen",DATABASE_FUNCTIONS:"Datenbanken \u00f6ffnen, anlegen und l\u00f6schen",V2v:"Text vor Zug",TEXT_AFTER:"Text",V2w:"Variante",PROMOTE_LINE:"Aufwerten",
DELETE_LINE:"L\u00f6schen",CUT_LINE:"Schneiden",V2x:"PGN-Datei von Ihrem Computer \u00f6ffnen",V2y:"Textkommentar vor diesem Zug",TEXT_AFTER_TIP:"Textkommentar nach diesem Zug",V2z:"Zug zur\u00fccknehmen und Variante starten",V30:"Ausgew\u00e4hlte Variante wird Hauptvariante",DELETE_LINE_TIP:"Ausgew\u00e4hlte Variante l\u00f6schen",CUT_LINE_TIP:"Nachfolgende Z\u00fcge wegschneiden",V31:"Angemeldet bleiben",V32:"Passwort vergessen",CHANGE_PASSWORD:"Passwort \u00e4ndern",V33:"Altes Passwort",V34:"Neues Passwort",
V35:"Passwort best\u00e4tigen",MENU_PLAYCHESS_TOOL:"Spielen & Zuschauen",MENU_DATABASE_TOOL:"Live Datenbank",MENU_MYGAMES_TOOL:"Meine Partien",MENU_FRITZ_TOOL:"Schachprogramm Fritz",MENU_FRITZ_CHESSTER_TOOL:"Fritz & Fertig f\u00fcr Kinder",MENU_TACTICS_TOOL:"Taktiktraining",LANGUAGE:"Sprache",LOGIN_CREATE_LINK:"Hier klicken, um Account anzulegen",LOGIN_PLEASE_LOGIN:"Bitte anmelden",LOGIN_ACCOUNT_FREE:"Ein ChessBase Account ist kostenlos und gilt f\u00fcr alle ChessBase Web Tools und f\u00fcr www.schach.de.",
LOGIN_WELCOME:"Willkommen, {0}",V36:"Freunde verwalten",INVITE_FRIEND:"Einen Freund einladen",V37:"Ping",NOTATION_KING:"K",NOTATION_QUEEN:"D",NOTATION_KNIGHT:"S",NOTATION_BISHOP:"L",NOTATION_ROOK:"T",V38:"",GENERAL_INVITE:'Danke f\u00fcr den Einsatz von <span style="font-weight:bold">{0}</span>.',V39:'Danke f\u00fcr den Einsatz von <span style="font-weight:bold">ChessBase MyGames</span>, ihrer pers\u00f6nlichen Schachdatenbank im Web.',V3a:"Mit Ihrem ChessBase Account k\u00f6nnen Sie Clouddatenbanken f\u00fcr Schachpartien anlegen und verwalten. Diese Clouddatenbanken stehen auch unter ChessBase 13 zur Verf\u00fcgung.",
V3b:"ECO",V3c:"Zur\u00fcck",V3d:"Next Move",V3e:"Previous Move",V3f:"Next Game",V3g:"Previous Game",MENU_VIDEO_TOOL:"Videotraining",MENU_OPENINGS_TOOL:"Er\u00f6ffnungen verwalten",V3h:"Z\u00fcge anfordern",FRESH_POSITION:"Frische Stellung",V3i:"Teilen",V3j:"Hilfe",V3k:"2D/3D Brett umschalten",BOARD3D_BLACKWHITE:"Schwarzweiss",V3l:"Matt",V3m:"Patt",V3n:"Stellung aufbauen",WHITE_MATES:"Weiss setzt Matt",WHITE_CLEARLY_WINNING:"Weiss steht v\u00f6llig auf Gewinn",WHITE_WINNING:"Weiss steht auf Gewinn",
WHITE_DECISIVE:"Weiss hat gro\u00dfen Vorteil",WHITE_CLEARLY_BETTER:"Weiss steht deutlich besser",WHITE_BETTER:"Weiss steht besser",WHITE_SLIGHTLY:"Weiss steht etwas besser",WHITE_EDGE:"Weiss steht minimal besser",BLACK_MATES:"Schwarz setzt Matt",BLACK_CLEARLY_WINNING:"Schwarz steht v\u00f6llig auf Gewinn",BLACK_WINNING:"Schwarz steht auf Gewinn",BLACK_DECISIVE:"Schwarz hat gro\u00dfen Vorteil",BLACK_CLEARLY_BETTER:"Schwarz steht deutlich besser",BLACK_BETTER:"Schwarz steht besser",BLACK_SLIGHTLY:"Schwarz steht etwas besser",
BLACK_EDGE:"Schwarz steht minimal besser",EQUAL_POS:"Die Stellung ist ausgeglichen",PREMIUM_ONLY:"Nur bei Premium",V3o:"Avatar",V3p:"Rechentraining",V3q:"Berechnen Sie beliebige (gepr\u00fcfte) Varianten bevor Sie die Partie hier fortsetzen.",V3r:"F\u00fchren Sie Z\u00fcge blind aus. Klicken Sie in die Notation, um Varianten hinzuzuf\u00fcgen. F\u00fcgen Sie Kontrolldiagramme ein. Klick auf 'Rechentraining' setzt die Partie fort.",TRAINING_SOLUTION:"L\u00f6sung zeigen",TRAINING_HELP:"Hilfestellung",
TRAINING_QUESTION:"Finde den richtigen Zug",UNANNOTATE:"Entkommentieren",V3u:"Mehr Varianten",V3v:"Weniger Varianten",V3w:"Drohung berechnen",V3x:"Start",V3y:"Pause",V3z:"Im Augenblick l\u00e4uft keine Live\u00fcbertragung",CONNECTED_TO_SERVER:"Verbunden: {0}",V40:"Initialisiere",INSERT_DIAGRAM:"Diagramm einf\u00fcgen",BOARD:"Brett",V41:"Brett wird geladen, eine Sekunde..."};CB.Vn.Chess.DEU=CB.Vn.Chess.GER;"use strict";CB.namespace("CB.Vn.Chess.ESP");
CB.Vn.Chess.ESP={LOGIN:"Conectar",LOGOUT:"Cerrar sesi\u00f3n",ACCOUNT:"Mi cuenta",BOARDS:"Tablero",RECONNECT:"Reconectar",Vo:"Rendirse",Vp:"Cerrar tablero",Vq:"Ofrecer tablas",Vr:"Aceptar tablas",Vs:"{0} acept\u00f3 tablas.",Vt:"{0} ofrece tablas.",Vu:"{0} acepta tablas.",Vv:"{0} se rinde.",Vw:"Probando la conexi\u00f3n con el servidor",CONNECTING:"Conectando con el servidor, por favor espere...",Vx:"Reconectado",Vy:"Nombre",Vz:"Pa\u00eds",V10:"Rango",WHITE:"Blancas",BLACK:"Negras",V11:"Elo blancas",
V12:"Elo negras",RESULT:"Resultado",V13:"Control de tiempo",V14:"Torneo",GAMES:"Partidas",V15:"Charla",V16:"Su interlocutor se ha ido.",V17:"Conexi\u00f3n",V18:"Mapa",KING:"Rey",QUEEN:"Dama",ROOK:"Torre",BISHOP:"Alfil",KNIGHT:"Caballo",PAWN:"Pe\u00f3n",V19:"Escriba aqu\u00ed la charla",V1a:"Escriba aqu\u00ed con quien quiere charlar",GUEST:"Invitado",V1b:"Confirmar",V1c:"Cancelar",V1d:"Reloj",TIME:"Tiempo",V1e:"Incr. por mov.",V1f:"Cerrar",V1g:"A\u00f1adir",V1h:"Quitar",NOTATION:"Notaci\u00f3n",BOARD_FRITZ:"Fritz",
BOARD_CRYSTALS:"Crystals",BOARD_USCF:"USCF",BOARD_OLDSTYLE:"OldStyle",BOARD_HABSBURG:"Habsburg",V1i:"Fritz & Chesster",V1j:"Jugar blitz",V1k:"Nueva partida",TAKE_BACK:"Retroceder",MAKE_MOVE:"Jugar",FLIP_BOARD:"Girar tablero",V1l:"Copiar",V1m:"Buscar tablero",V1n:"A\u00f1o",V1o:"Libro",LIVE_BOOK:"Live Book",V1p:"Jugada",V1q:"Partidas",V1r:"Marcador",V1s:"\u00daltima vez",V1t:"Elo medio",V1u:"Visitas",V1v:"Cargando estad\u00edsticas",V1w:"Let's Check",V1x:"Eval.",V1y:"Variante",DEPTH:"Prof.",V1z:"M\u00f3dulo",
V20:"Escriba el texto a buscar...",V21:"Obtener partidas",V22:"Datos del jugador",V23:"Informaci\u00f3n del jugador",V24:"Nombre",V25:"Apellidos",V26:"Nacido en",V27:"Tendencia",V28:"Elo",V29:"Enviar comentario",V2a:"Su comentario",V2b:"Su e-mail",V2c:"Enviado",BROWSER_DOESNT_SUPPORT_3D:"El navegador no admite tableros 3D",BOARD3D_FRITZ:"Fritz",BOARD3D_MODERN:"Moderno",BOARD3D_ROOM:"Habitaci\u00f3n",BOARD3D_BALLOON:"Globos",BOARD3D_METAL:"Metal",V2d:"Plata",BOARD3D_FUTURE:"Futuro",V2e:"M\u00e1rmol",
V2f:"Bienvenido",V2g:"Material",V2h:"An\u00e1lisis",ANALYSIS_ENGINE:"M\u00f3dulo",ENG_SEARCH_INFO_FMT:"Prof {0}/{1}, {2}kPos/s, tiempo = {3}s",V2i:"Pegar",PW_INVALID:"Usuario/Contrase\u00f1a no v\u00e1lido. Por favor, vuelva a intentarlo",PLEASE_LOGIN:"Por favor conecte con su cuenta ChessBase (Playchess):",V2j:"Nombre",V2k:"Contrase\u00f1a",V2l:"Crear cuenta",V2m:"Invitado",PLEASE_LOGIN_SHORT:"Por favor, identif\u00edquese",LOADING_ENGINE:"Cargando m\u00f3dulo...",V2n:"Cargando partidas en directo...",
V2o:"Invitando a otros jugadores a una partida de {0} ({1})",OTHER_TOOLS:"M\u00e1s herramientas",DATABASES:"Bases de datos",OPEN_DATABASE:"Abrir base",CREATE_DATABASE:"Crear base",DELETE_DATABASE:"Borrar base",V2p:"Borrar",V2q:"Limpiar",V2r:"Mis bases",V2s:"Bases compartidas conmigo",V2t:"Seleccionar base para '{0}'",V2u:"Abrir PGN",SAVE:"Guardar",SAVE_AND_REPLACE_GAMES:"Guardar y reemplazar partidas",SAVE_AS_NEW:"Guardar como nueva",EDIT_GAME:"Editar partida",DATABASE_FUNCTIONS:"Abrir, crear y y borrar bases",
V2v:"Texto antes",TEXT_AFTER:"Texto despu\u00e9s",V2w:"Iniciar l\u00ednea",PROMOTE_LINE:"Promocionar l\u00ednea",DELETE_LINE:"Borrar l\u00ednea",CUT_LINE:"Cortar l\u00ednea",V2x:"Abrir un archivo PGN de su equipo",V2y:"A\u00f1adir comentario en forma de texto antes de esta jugada",TEXT_AFTER_TIP:" A\u00f1adir comentario en forma de texto tras esta jugada",V2z:"Retroceder la jugada y comenzar una variante",V30:"Subir de nivel la variante seleccionada",DELETE_LINE_TIP:"Borrar la variante seleccionada",
CUT_LINE_TIP:"Truncar la variante",V31:"Seguir conectado",V32:"Contrase\u00f1a olvidada",CHANGE_PASSWORD:"Cambiar contrase\u00f1a",V33:"Contrase\u00f1a antigua",V34:"Contrase\u00f1a nueva",V35:"Confirmar contrase\u00f1a",MENU_PLAYCHESS_TOOL:"Playchess",MENU_DATABASE_TOOL:"Live Database",MENU_MYGAMES_TOOL:"My Games Cloud",MENU_FRITZ_TOOL:"Fritz Online",MENU_FRITZ_CHESSTER_TOOL:"Chess For Kids",MENU_TACTICS_TOOL:"Tactics Training",LANGUAGE:"Idioma",LOGIN_CREATE_LINK:"Haga clic aqu\u00ed para crear una cuenta",
LOGIN_PLEASE_LOGIN:"Por favor identif\u00edquese",LOGIN_ACCOUNT_FREE:"La creaci\u00f3n de una cuenta es gratis. La cuenta vale para todas las dem\u00e1s herramientas web de ChessBase y para jugar en www.playchess.com.",LOGIN_WELCOME:"Bienvenido {0}",V36:"Gestionar amigos",INVITE_FRIEND:"Invitar a un amigo",V37:"Ping",NOTATION_KING:"R",NOTATION_QUEEN:"D",NOTATION_KNIGHT:"C",NOTATION_BISHOP:"A",NOTATION_ROOK:"T",V38:"P",GENERAL_INVITE:"Gracias por usar {0}.",V39:"Gracias por usar ChessBase MyGames, su base de datos de ajedrez personal en la web.",
V3a:"Por favor con\u00e9ctese con su cuenta ChessBase para tener acceso a sus bases de datos en la nube. Tambi\u00e9n puede usar las bases de datos en la nube con ChessBase 13.",V3b:"ECO",V3c:"Volver",V3d:"Siguiente jug.",V3e:"Anterior jug.",V3f:"Siguiente part.",V3g:"Anterior part.",MENU_VIDEO_TOOL:"V\u00eddeos de entrenamiento",MENU_OPENINGS_TOOL:"Gestionar aperturas",V3h:"Requesting Moves",FRESH_POSITION:"Fresh Position",V3i:"Embed",V3j:"Help",V3k:"Toggle 2D/3D Board",BOARD3D_BLACKWHITE:"Black white",
V3l:"Mate",V3m:"Ahogado",V3n:"Armar posici\u00f3n",WHITE_MATES:"Las blancas dan mate",WHITE_CLEARLY_WINNING:"Las blancas tienen clara ventaja ganadora",WHITE_WINNING:"Las blancas tienen ventaja ganadora",WHITE_DECISIVE:"Las blancas tienen ventaja decisiva",WHITE_CLEARLY_BETTER:"Las blancas est\u00e1n claramente mejor",WHITE_BETTER:"Las blancas est\u00e1n mejor",WHITE_SLIGHTLY:"Las blancas est\u00e1n un poco mejor",WHITE_EDGE:"Las blancas tienen una ventaja m\u00ednima",BLACK_MATES:"Las negras dan mate",
BLACK_CLEARLY_WINNING:"Las negras tienen clara ventaja ganadora",BLACK_WINNING:"Las negras tienen ventaja ganadora",BLACK_DECISIVE:"Las negras tienen ventaja decisiva",BLACK_CLEARLY_BETTER:"Las negras est\u00e1n claramente mejor",BLACK_BETTER:"Las negras est\u00e1n mejor",BLACK_SLIGHTLY:"Las negras est\u00e1n un poco mejor",BLACK_EDGE:"Las negras tienen una ventaja m\u00ednima",EQUAL_POS:"La posici\u00f3n est\u00e1 igualada",PREMIUM_ONLY:"S\u00f3lo premium",V3o:"Avatar",V3p:"Entrenar c\u00e1lculo",
V3q:"Calcular variantes con la ayuda de Fritz antes de continuar la partida aqu\u00ed.",V3r:"Ejecute jugadas a la ciega. Haga clic en la notaci\u00f3n para a\u00f1adir variantes. Haga clic en 'Entrenar c\u00e1lculo' para reanudar la partida.",V3s:"Calculando...",V3t:"Madera",TRAINING_SOLUTION:"Ver soluci\u00f3n",TRAINING_HELP:"Ayuda",TRAINING_QUESTION:"Encontrar la jugada correcta",UNANNOTATE:"Desanotar",V3u:"M\u00e1s l\u00edneas",V3v:"Menos l\u00edneas",V3w:"Calcular amenaza",V3x:"Start",V3y:"Pause",
V3z:"En ese momento, no hay una transmisi\u00f3n",CONNECTED_TO_SERVER:"Connected to server: {0}",V40:"Initializing",INSERT_DIAGRAM:"Insert Diagram",BOARD:"Tablero",V41:"Loading board, just a second..."};function getCtxFunction(c,b){return function(){return b.apply(c,arguments)}}Function.prototype.bind||(Function.prototype.bind=function(c){return getCtxFunction(c,this)});
var V34y={initInstForListeners:function(c){c.addListener=V34y.addListener;c.removeListener=V34y.removeListener;c.fireEvent=V34y.fireEvent;c.getListeners=V34y.getListeners;c.enableEvents=V34y.enableEvents;c.eventsEnabled=!0;c.idLstnr=0},initForListeners:function(c){V34y.initInstForListeners(c.prototype)},enableEvents:function(c){this.eventsEnabled=c},getListeners:function(c){c="m_lstOn"+c;var b=this[c];b||(b={},this[c]=b);return b},addListener:function(c,b){this.getListeners(c)[this.idLstnr]=b;return this.idLstnr++},
removeListener:function(c,b){delete this.getListeners(c)[b]},fireEvent:function(c,b){if(this.eventsEnabled){var d=this.getListeners(c),e;for(e in d)d.hasOwnProperty(e)&&d[e].apply(this,b)}},addInstEvent:function(c,b,d){c[String.formatEx("addOn{0}Listener",b)]=function(d){return this.addListener(b,d)};c[String.formatEx("removeOn{0}Listener",b)]=function(d){this.removeListener(b,d)};c[String.formatEx("fireOn{0}",b)]=function(){var c=arguments||[];d&&(c=d.call(this));this.fireEvent(b,c)};c.removeAllListeners=
function(){for(var b in this)this.hasOwnProperty(b)&&0==b.search("m_lstOn")&&delete b}},addEvent:function(c,b,d){V34y.addInstEvent(c.prototype,b,d)}};function HashTable(c,b){c&&(this.funcHash=c);b&&(this.funcEq=b);this.impl={}}HashTable.prototype.impl={};HashTable.prototype.funcHash=function(c){return ObjUtil.hashCode(c)};HashTable.prototype.funcEq=function(c,b){return c===b};
HashTable.prototype.getItem=function(c){var b=this.funcHash(c);if(b=this.impl[b]){var d=function(b){return this.funcEq(b.key,c)}.bind(this),b=b.filter(d);if(null!=b&&0<b.length)return b[0].value}};HashTable.prototype.setItem=function(c,b){var d=this.funcHash(c),e=this.impl[d];e||(e=[],this.impl[d]=e);for(var d=0,f=e.length;d<f;++d){var g=e[d];if(this.funcEq(g.key,c)){g.value=b;return}}e.push({key:c,value:b})};
HashTable.prototype.removeItem=function(c){var b=this.funcHash(c),d=this.impl[b];if(d){var e=function(b){return!this.funcEq(b.key,c)}.bind(this),d=d.filter(e);this.impl[b]=d}};HashTable.prototype.clear=function(){this.impl={}};"use strict";
var ObjUtil={clone:function(c,b){b||(b=new HashTable);var d=b.getItem(c);if(d)return d;c.clone?d=c.clone(b):(d=ObjUtil.isArray(c)?[]:new c.constructor,b.setItem(c,d),ObjUtil.copyTo(c,d,!1,b));b.setItem(c,d);return d},clone2:function(c){return ObjUtil.copyTo2(c,new c.constructor)},cloneNoFunc:function(c){c=JSON.stringify(c);return JSON.parse(c)},copyTo:function(c,b,d,e){for(var f in c)if(!(d&&f in b)){var g=c[f],h=g;null!=g&&"object"===typeof g&&(h=ObjUtil.clone(g,e));b[f]=h}c.toString!==b.toString&&
(b.toString=c.toString);return b},copyTo2:function(c,b){for(var d in c){var e=c[d],f=e;null!=e&&"object"===typeof e&&(f=ObjUtil.clone2(e));b[d]=f}return b}};function _CMP(c,b){if(void 0===c!==(void 0===b))return!1;if(void 0===c&&void 0===b)return!0;if(null===c!==(null===b))return!1;if(null===c&&null===b)return!0;var d=typeof c,e=typeof b;return"object"===d!==("object"===e)?!1:"object"===d&&"object"===e?ObjUtil.equals(c,b):c==b}
ObjUtil.equals=function(c,b){if(c.equals)return c.equals(b);for(var d in c)if(!_CMP(c[d],b[d]))return!1;return!0};ObjUtil.isEmpty=function(c){return!Object.keys(c).length};ObjUtil.isFunction=function(c){return!!(c&&c.constructor&&c.call&&c.apply)};ObjUtil.isArray=function(c){return"[object Array]"===Object.prototype.toString.call(c)};function djb2(c){for(var b=5381,d,e=0;e<c.length;++e)d=c.charCodeAt(e)&255,b=4294967295&(b<<5)+b+d;return b}
function StringHash(c){return djb2(typeof c+c.constructor.toString())}ObjUtil.hashCode=function(c){return c.hashCode?c.hashCode():"object"===typeof c?StringHash(c):djb2(c.toString())};function EnumToString(c,b){for(var d in c)if(c[d]===b)return d;return""}function StringToEnum(c,b){if(b in c)return c[b]}function StringToEnumFlags(c,b){for(var d=b.split("|"),e=0,f=0,g=d.length;f<g;++f){var h=StringToEnum(c,d[f]);h&&(e|=h)}return e}
function evalObj(c){var b={},d;for(d in c){var e=c[d];b[d]=e;"string"===typeof e&&(0>e.indexOf("{")||(b[d]=eval("("+e+")")))}return b}function minusToCamel(c){for(var b=c.indexOf("-");0<=b;b=c.indexOf("-")){var d=c.substring(0,b);c=c.substring(b+1);0<c.length&&(c=c.charAt(0).toUpperCase()+(1<c.length?c.substring(1):""));c=d+c}return c}function NOT(c){return function(){return!c.apply(this,arguments)}}function TRUE(){return function(){return!0}}function FALSE(){return function(){return!1}}
function EqualsFilter(c){return function(b,d,e){return ObjUtil.equals(b,c)}}"use strict";Array.prototype.find||(Array.prototype.find=function(c){if("function"!==typeof c)throw new TypeError("predicate must be a function");for(var b=Object(this),d=b.length>>>0,e,f=0;f<d;f++)if(f in b&&(e=b[f],c.call(this,e,f,b)))return e});Array.prototype.all||(Array.prototype.all=function(c){return!this.some(function(b,d,e){return!c(b,d,e)})});
Array.prototype.findIndex||(Array.prototype.findIndex=function(c){if("function"!==typeof c)throw new TypeError("predicate must be a function");for(var b=Object(this),d=b.length>>>0,e,f=0;f<d;f++)if(f in b&&(e=b[f],c.call(this,e,f,b)))return f;return-1});
Array.prototype.pickRandom||(Array.prototype.pickRandom=function(c){if("function"!==typeof c)throw new TypeError("predicate must be a function");for(var b=Object(this),d=b.length>>>0,e,f=void 0,g=0,h=0;h<d;h++)h in b&&(g+=c.call(this,b[h],h,b));for(var k=Math.random()*g,h=g=0;h<d;h++)if(h in b&&(e=b[h],g+=c.call(this,e,h,b),g>=k)){f=e;break}return f});"use strict";
CB.V43=function(){var c=function(b){this.V44=b;this.V45=[]};c.prototype.count=function(){return this.V45.length};c.prototype.add=function(b){this.V45.push(b);return this.V45.length-1};c.prototype.remove=function(b){if(void 0===this.V45[b])throw Error("Removing unknown handler: "+b);delete this.V45[b]};c.prototype.execute=function(){for(var b=0;b<this.V45.length;b++)if(void 0!==this.V45[b])this.V45[b](this.V44)};c.prototype.empty=function(){for(var b=0;b<this.V45.length;b++)if(void 0!==this.V45[b])return!1;
return!0};return c}();"use strict";CB.namespace("CB.V47");CB.V47.V48=function(c){return unescape(encodeURIComponent(c))};CB.V47.V49=function(c){return CB.V47.V4a(c)};CB.V47.test=function(){var c=CB.V47.V48("Rh\u00f4ne");return CB.V47.V4b(c)};
CB.V47.V4a=function(c){var b,d,e,f,g,h;b="";e=c.length;for(d=0;d<e;)switch(f=c[d++].charCodeAt(0),f>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(f);break;case 12:case 13:g=c[d++].charCodeAt(0);b+=String.fromCharCode((f&31)<<6|g&63);break;case 14:g=c[d++].charCodeAt(0),h=c[d++].charCodeAt(0),b+=String.fromCharCode((f&15)<<12|(g&63)<<6|(h&63)<<0)}return b};
CB.V47.V4b=function(c){for(var b=!1,d=0;d<c.length&&!b;d++){var e=c.charCodeAt(d);if(e&128)if(194<=e&&223>=e&&128<=c.charCodeAt(d+1)&&191>=c.charCodeAt(d+1))d+=2,b=!0;else if(224==e&&160<=c.charCodeAt(d+1)&&191>=c.charCodeAt(d+1)&&128<=c.charCodeAt(d+2)&&191>=c.charCodeAt(d+2)||(225<=e&&236>=e||238==e||239==e)&&128<=c.charCodeAt(d+1)&&191>=c.charCodeAt(d+1)&&128<=c.charCodeAt(d+2)&&191>=c.charCodeAt(d+2)||237==e&&128<=c.charCodeAt(d+1)&&159>=c.charCodeAt(d+1)&&128<=c.charCodeAt(d+2)&&191>=c.charCodeAt(d+
2))d+=3,b=!0;else if(240==e&&144<=c.charCodeAt(d+1)&&191>=c.charCodeAt(d+1)&&128<=c.charCodeAt(d+2)&&191>=c.charCodeAt(d+2)&&128<=c.charCodeAt(d+3)&&191>=c.charCodeAt(d+3)||241<=e&&243>=e&&128<=c.charCodeAt(d+1)&&191>=c.charCodeAt(d+1)&&128<=c.charCodeAt(d+2)&&191>=c.charCodeAt(d+2)&&128<=c.charCodeAt(d+3)&&191>=c.charCodeAt(d+3)||244==e&&128<=c.charCodeAt(d+1)&&143>=c.charCodeAt(d+1)&&128<=c.charCodeAt(d+2)&&191>=c.charCodeAt(d+2)&&128<=c.charCodeAt(d+3)&&191>=c.charCodeAt(d+3))d+=4,b=!0}return b};
CB.V47.V4c=function(c){for(var b=0;b<c.length;b++)if(c.charCodeAt(b)&128)return!0;return!1};CB.V47.V4d=function(c){return CB.V47.base64.encode(c)};CB.V47.V4e=function(c){return CB.V47.base64.V4f(c)};
CB.V47.base64={base64s:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",encode:function(c){if("function"===typeof btoa)return btoa(c);for(var b=this.base64s,d,e,f=0,g="";c.length>=f+3;)d=(c.charCodeAt(f++)&255)<<16|(c.charCodeAt(f++)&255)<<8|c.charCodeAt(f++)&255,g+=b.charAt((d&16515072)>>18)+b.charAt((d&258048)>>12)+b.charAt((d&4032)>>6)+b.charAt(d&63);0<c.length-f&&3>c.length-f&&(e=!!(c.length-f-1),d=(c.charCodeAt(f++)&255)<<16|(e?(c.charCodeAt(f)&255)<<8:0),g+=b.charAt((d&16515072)>>
18)+b.charAt((d&258048)>>12)+(e?b.charAt((d&4032)>>6):"=")+"=");return g},V4f:function(c){if("function"===typeof atob)return atob(c);var b=this.base64s,d,e="",f;for(f=0;f<c.length;f+=4)d=(b.indexOf(c.charAt(f))&255)<<18|(b.indexOf(c.charAt(f+1))&255)<<12|(b.indexOf(c.charAt(f+2))&255)<<6|b.indexOf(c.charAt(f+3))&255,e+=String.fromCharCode((d&16711680)>>16,(d&65280)>>8,d&255);return 61===c.charCodeAt(f-2)?e.substring(0,e.length-2):61===c.charCodeAt(f-1)?e.substring(0,e.length-1):e},V4g:function(c){this.V4h=
new Uint8Array(256);for(var b=0;b<this.base64s.length;b++)this.V4h[this.base64s.charCodeAt(b)]=b;var b=.75*c.length,d=c.length,e=0,f,g,h,k;"="===c[c.length-1]&&(b--,"="===c[c.length-2]&&b--);for(var l=new ArrayBuffer(b),m=new Uint8Array(l),b=0;b<d;b+=4)f=this.V4h[c.charCodeAt(b)],g=this.V4h[c.charCodeAt(b+1)],h=this.V4h[c.charCodeAt(b+2)],k=this.V4h[c.charCodeAt(b+3)],m[e++]=f<<2|g>>4,m[e++]=(g&15)<<4|h>>2,m[e++]=(h&3)<<6|k&63;return l}};
CB.V47.V4i=function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=(new RegExp("[\\?&]"+c+"=([^&#]*)")).exec(window.location.href);if(null===c)return"";c=c[1];c.length&&"/"==c.charAt(c.length-1)&&(c=c.slice(0,c.length-1));return c};CB.V47.V4j=function(c){if(c){var b=c.toLowerCase();b.replace(/</g,"(");b.replace(/>/g,")");b&&15<b.length&&(-1!=c.search("http://")&&(b=b.slice(7)),-1!=c.search("https://")&&(b=b.slice(8)),c=b.indexOf("/"),0<c&&(b=b.slice(0,c)));return b}return""};
CB.V47.V4k=function(c){c=c.replace("%22",'"');c=c.replace("%27","'");if('"'==c.charAt(0)||"'"==c.charAt(0))c=c.slice(1,c.length-1);return c};CB.V47.V4l=function(c){return c.replace(/[\u00A0-\u2666<>\&]/g,function(b){return"&#"+b.charCodeAt(0)+";"})};var decodeHtmlEntity=function(c){},encodeHtmlEntity=function(c){};CB.V47.V4m=function(c){return c.replace(/[\u00A0-\u2666<>\&]/g,function(b){return"&#"+b.charCodeAt(0)+";"})};CB.V47.V4n=function(c){return c.replace(/&#(\d+);/g,function(b,d){return String.fromCharCode(d)})};
(function(c,b){c.JSONP=function(b,e,f,g){b=b||"";e=e||{};f=f||"";g=g||function(){};var h=function(b){var d=[],c;for(c in b)b.hasOwnProperty(c)&&d.push(c);return d};if("object"==typeof e){for(var k="",h=h(e),l=0;l<h.length;l++)k+=encodeURIComponent(h[l])+"="+encodeURIComponent(e[h[l]]),l!=h.length-1&&(k+="&");b+="?"+k}else"function"==typeof e&&(g=f=e);"function"==typeof f&&(g=f,f="callback");Date.now||(Date.now=function(){return(new Date).getTime()});e=Date.now();var m="jsonp"+Math.round(e+1000001*
Math.random());c[m]=function(b){g(b);delete c[m]};b=-1===b.indexOf("?")?b+"?":b+"&";e=document.createElement("script");e.setAttribute("src",b+f+"="+m);document.getElementsByTagName("head")[0].appendChild(e)}})(window);function byteswap_ushort(c){var b=new ArrayBuffer(2),b=new DataView(b);b.setUInt16(0,c);c=b.GetUint8();b.SetUint8(0,b.GetUint8(1));b.SetUint8(1,c);return b.GetUint16(0)}
function byteswap_ulong(c){var b=new ArrayBuffer(4),b=new DataView(b);b.setUInt32(0,c);c=new ArrayBuffer(4);c=new DataView(c);for(var d=0;4>d;d++)c.setUint8(d,b.getUint8(3-d));return c.GetUint32(0)}function byteswap_uint64(c){var b=new ArrayBuffer(8),b=new DataView(b);b.setUInt64(0,c);c=new ArrayBuffer(8);c=new DataView(c);for(var d=0;8>d;d++)c.setUint8(d,b.getUint8(7-d));return c.GetUint64(0)}
function getInternetExplorerVersion(){return 0<=navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./)?11:-1}function idiv(c,b){return(c-c%b)/b}function isNumber(c){return!isNaN(parseInt(c,10))}CB.V4o=function(c,b,d){if("number"!=typeof b)throw Error("CB.setFlag: number expected for bits");void 0===c.flags&&(c.flags=0);c.flags=d?c.flags|b:c.flags&~b};CB.V4p=function(c,b){return 0!=(c&b)};CB.namespace("CB.V4q");CB.V4q={};
CB.V4q.V4r=function(c){c=new Date(10*c);return c.getUTCHours()<<24|c.getUTCMinutes()<<16|c.getUTCSeconds()<<8|c.getUTCMilliseconds()/10};"use strict";CB=CB||{};
CB.Timer=function(){var c=function(b){this.handler=b;this.active=!1};c.prototype.V4s=function(b){this.runOnce(0,b)};c.prototype.runOnce=function(b,d){d&&(this.handler=d);this.stop();this.V4t=!1;this.active=!0;this.timeout=b;this.timer=window.setTimeout(this.V4u.bind(this),b)};c.prototype.runPeriodic=function(b,d){d&&(this.handler=d);this.stop();this.active=this.V4t=!0;this.timeout=b;this.timer=window.setInterval(this.V4u.bind(this),b||5E3)};c.prototype.stop=function(){this.V4t?window.clearInterval(this.timer):
window.clearTimeout(this.timer);this.active=!1};c.prototype.isActive=function(){return this.active};c.prototype.V4u=function(){this.handler&&this.handler();this.active=!1};c.prototype.V4v=function(){return this.timeout?this.timeout:0};c.V4w=function(b){for(b+=(new Date).getTime();new Date<b;);};c.V4s=function(b,d){d=d||100;(new CB.Timer).runOnce(d,b)};return c}();CB.V4x=window.performance&&window.performance.now;
CB.V4y=function(){var c=function(){this.start()};c.prototype.start=function(){this.V4z=CB.V4x?window.performance.now():(new Date).valueOf()};c.prototype.V50=function(){return CB.V4x?Math.round(100*(window.performance.now()-this.V4z))/100:(new Date).valueOf()-this.V4z};c.prototype.V51=function(b){var d="";b&&(d=b+": ");d+=this.V50()+"ms";this.start();return d};c.prototype.V52=function(){return Math.round(this.V50())};return c}();
CB.V53=function(){return CB.V4x?Math.round(window.performance.now()):(new Date).valueOf()};CB.V54=function(){return CB.V4x?window.performance.now():(new Date).valueOf()};CB.V55=function(){var c=function(b){this.V56=void 0!==b?b:!0;this.start()};c.prototype.start=function(){this.tick=(new Date).valueOf()};c.prototype.V57=function(b){return this.V59()>1E3*b?(this.V56&&this.start(),!0):!1};c.prototype.V59=function(){return(new Date).valueOf()-this.tick};return c}();
CB.V35b=function(){var c=function(){};c.prototype.exec=function(b,d){this.timer&&this.timer.stop();this.timer=new CB.Timer(b);this.V5a=d;this.timer.runOnce(d)};c.prototype.isActive=function(){return this.timer&&this.timer.isActive()};c.prototype.stop=function(){this.timer&&this.timer.stop()};c.prototype.V5b=function(){this.isActive()&&(this.timer.stop(),this.timer.runOnce(this.V5a||1E3))};return c}();"use strict";
CB.Date=function(){var c=function(b,d,c){b&&(this.year=b);d&&(this.month=d);c&&(this.day=c)};c.prototype.year=0;c.prototype.month=0;c.prototype.day=0;c.prototype.toString=function(){return String.formatEx("{day}.{month}.{year}",this)};c.g_regexPGN=/(?:(\d{4})|\?{4})\.(?:(\d{2})|\?{2})\.(?:(\d{2})|\?{2})/;c.fromPGNString=function(b){return(b=c.g_regexPGN.exec(b))?new c(Number(b[1]),Number(b[2]),Number(b[3])):new c};c.prototype.V5c=function(b){this.year=b>>9;this.month=b>>5&15;this.day=b&31};c.prototype.V5d=
function(){var b=new Date;this.year=b.getFullYear();this.month=b.getMonth()+1;this.day=b.getDate()};c.prototype.V5e=function(){return this.year<<9|this.month<<5|this.day};c.prototype.fromDataBuf=function(b){b=b.V35k();this.V5c(b)};c.prototype.V35j=function(b){b.V35h(this.year<<9|this.month<<5|this.day)};c.prototype.toLocaleString=function(){var b="";this.year&&(b=this.year.toString(),this.month&&(b=this.month.toString()+"."+b,10>this.month&&(b="0"+b),this.day&&(b=this.day.toString()+"."+b,10>this.day&&
(b="0"+b))));return b};c.prototype.toPGNString=function(){var b="";if(this.year){b=this.year.toString();if(this.month){var d=this.month.toString();10>this.month&&(d="0"+d);b+="."+d}else b+=".??";this.day?(d=this.day.toString(),10>this.day&&(d="0"+d),b+="."+d):b+=".??"}return b};c.prototype.getDay=function(){return this.day};c.prototype.V5f=function(b){this.day=b};c.prototype.getMonth=function(){return this.month};c.prototype.setMonth=function(b){this.month=b};c.prototype.getYear=function(){return this.year};
c.prototype.setYear=function(b){this.year=b};c.getThisYear=function(){var b=new CB.Date;b.V5d();return b.getYear()};return c}();"use strict";CB.V5g=function(){var c=function(b){this.time=b};c.prototype.time=0;return c}();CB.V5h=function(){var c=function(){this.V5i=0};c.prototype.V35j=function(b){b.V35d(this.V5i)};c.prototype.fromDataBuf=function(b){b.V35i(this.V5i)};return c}();function CBGuid(){this.uint16Data3=this.uint16Data2=this.uint32Data1=0;this.uint8Data4=[0,0,0,0,0,0,0,0]}
CBGuid.prototype={fromRandom:function(c){var b=0;if(void 0!==c)for(var d=0;d<c.length;d++)b+=c.charCodeAt(d);this.uint32Data1=Math.floor(4294967296*Math.random()+b);this.uint16Data2=Math.floor(65536*Math.random()+b);this.uint16Data3=Math.floor(65536*Math.random()+b);for(d=0;8>d;d++)this.uint8Data4[d]=Math.floor(256*Math.random()+b)},toString:function(){for(var c=this.uint32Data1.toString(16)+"-"+this.uint16Data2.toString(16)+"-"+this.uint16Data3.toString(16)+"-",b=0;2>b;b++)c+=this.uint8Data4[b].toString(16);
c+="-";for(b=2;8>b;b++)c+=this.uint8Data4[b].toString(16);return c},V35j:function(c){c.V351(this.uint32Data1);c.V352(this.uint16Data2);c.V352(this.uint16Data3);for(var b=0;8>b;b++)c.writeUint8(this.uint8Data4[b])},fromDataBuf:function(c){this.uint32Data1=c.V35g();this.uint16Data2=c.V352();this.uint16Data3=c.V352();for(var b=0;8>b;b++)this.uint8Data4[b]=c.readUint8()}};"use strict";
CB.V5j={V5k:0,AFG:1,ALB:2,ALG:3,AND:4,ANG:5,ANT:6,ARG:7,ARM:8,V5l:9,AUT:10,AZE:11,BAH:12,BHN:13,BAN:14,BAR:15,BLR:16,BEL:17,BLZ:18,BER:19,BOL:20,BIH:21,BOT:22,BRA:23,IVB:24,BRN:25,BUL:26,BUR:27,CAN:28,CHI:29,CHN:30,COL:31,CRI:32,CRO:33,CUB:34,CYP:35,CZE:36,DEN:37,DJI:38,DOM:39,ECU:40,EGY:41,ENG:42,ESP:43,EST:44,ETH:45,FAI:46,FIJ:47,FIN:48,FRA:49,MKD:50,GAM:51,GEO:52,GER:53,GHA:54,GRE:55,GUA:56,GCI:57,GUY:58,HAI:59,HON:60,HKG:61,HUN:62,ISL:63,IND:64,INA:65,IRI:66,IRQ:67,ISR:68,IRL:69,ITA:70,IVO:71,
JAM:72,JPN:73,JCI:74,JOR:75,KAZ:76,KEN:77,KOR:78,KYR:79,KUW:80,LAT:81,LBN:82,LBY:83,LIE:84,LTU:85,LUX:86,MAC:87,MAD:88,MAS:89,MLI:90,MLT:91,MAU:92,MRI:93,MEX:94,MDA:95,MNC:96,MON:97,MAR:98,MOZ:99,MYA:100,NAM:101,NEP:102,NED:103,AHO:104,NZL:105,NCA:106,NGR:107,NOR:108,PAK:109,PLE:110,PAN:111,PNG:112,PAR:113,PER:114,PHI:115,POL:116,POR:117,PUR:118,QAT:119,ROU:120,RUS:121,ESA:122,SMR:123,SCO:124,SEN:125,SEY:126,SIN:127,SVK:128,SLO:129,RSA:130,SRI:131,SUD:132,SUR:133,SWE:134,SUI:135,SYR:136,TJK:137,TAN:138,
THA:139,TRI:140,TUN:141,TUR:142,TKM:143,UGA:144,UKR:145,UAE:146,USA:147,URU:148,URS:149,UZB:150,VEN:151,VIE:152,ISV:153,WLS:154,YEM:155,YUG:156,ZAM:157,ZIM:158,ZRE:159,DDR:160,CSR:161,CAM:162,CHD:163,KAP:164,KBA:165,COM:166,CON:167,NKO:168,LAO:169,LES:170,MWI:171,MDV:172,MSH:173,OMN:174,NAU:175,MIC:176,NIG:177,SAU:178,TOG:179,TON:180,VAN:181,VAT:182,TUV:183,SWA:184,SIE:185,SLU:186,PAP:187,SVI:188,SAM:189,SKI:190,SAL:191,GE2:192,ZAR:193,RWA:194,LBR:195,NET:196,TPE:197,ASU:198,AGG:199,ARN:200,BNN:201,
BTN:202,BRI:203,CMB:204,CAY:205,CAR:206,CIB:207,CIA:208,COA:209,CIN:210,ELG:211,ERI:212,FGB:213,FRG:214,FRP:215,GAB:216,GGB:217,GRA:218,GRL:219,FGA:220,GMA:221,GUI:222,GUB:223,IOM:224,JMY:225,MFR:226,MYF:227,MSG:228,NCF:229,NNN:230,NNA:231,NMI:232,OTM:233,PAL:234,PIG:235,RUF:236,SAO:237,SOM:238,SVN:239,HGB:240,PGB:241,TKI:242,TCI:243,WFR:244,NIR:245,ISS:246,GBR:247,SAA:248,MNE:249,SRB:250,CAT:251,BAS:252,KOS:253,V5m:254};
CB.V5n=function(){var c=[];c[CB.V5j.V5k]="United Nations";c[CB.V5j.AFG]="Afghanistan";c[CB.V5j.ALB]="Albania";c[CB.V5j.ALG]="Algeria";c[CB.V5j.ASU]="American samoa";c[CB.V5j.AND]="Andorra";c[CB.V5j.ANG]="Angola";c[CB.V5j.AGG]="Anguilla";c[CB.V5j.ANT]="Antigua and Barbuda";c[CB.V5j.ARG]="Argentina";c[CB.V5j.ARM]="Armenia";c[CB.V5j.ARN]="Aruba";c[CB.V5j.V5l]="Australia";c[CB.V5j.AUT]="Austria";c[CB.V5j.AZE]="Azerbaijan";c[CB.V5j.BAH]="Bahamas";c[CB.V5j.BHN]="Bahrain";c[CB.V5j.BAN]="Bangladesh";c[CB.V5j.BAR]=
"Barbados";c[CB.V5j.BLR]="Belarus";c[CB.V5j.BEL]="Belgium";c[CB.V5j.BLZ]="Belize";c[CB.V5j.BNN]="Benin";c[CB.V5j.BER]="Bermuda";c[CB.V5j.BTN]="Bhutan";c[CB.V5j.BOL]="Bolivia";c[CB.V5j.BIH]="Bosnia and Herzegovina";c[CB.V5j.BOT]="Botswana";c[CB.V5j.BRA]="Brazil";c[CB.V5j.IVB]="Virgin Islands British";c[CB.V5j.ISV]="Virgin Islands US";c[CB.V5j.BRN]="Brunei";c[CB.V5j.BUL]="Bulgaria";c[CB.V5j.BUR]="Burkina faso";c[CB.V5j.BRI]="Burundi";c[CB.V5j.CMB]="Cambodja";c[CB.V5j.CAM]="Cameroon";c[CB.V5j.CAN]="Canada";
c[CB.V5j.KAP]="Cape verde";c[CB.V5j.CAY]="Cayman Islands";c[CB.V5j.CAR]="Central African Republic";c[CB.V5j.CHD]="Chad";c[CB.V5j.CIB]="Jersey";c[CB.V5j.CHI]="Chile";c[CB.V5j.CHN]="China";c[CB.V5j.CIA]="Christmas";c[CB.V5j.COA]="Cocos (Keeling)";c[CB.V5j.COL]="Colombia";c[CB.V5j.COM]="Comoros";c[CB.V5j.CON]="Congo-Brazzaville";c[CB.V5j.CIN]="Cook Islands";c[CB.V5j.CRI]="Costa Rica";c[CB.V5j.CRO]="Croatia";c[CB.V5j.CUB]="Cuba";c[CB.V5j.CYP]="Cyprus";c[CB.V5j.CZE]="Czech Republic";c[CB.V5j.DEN]="Denmark";
c[CB.V5j.DJI]="Djibouti";c[CB.V5j.DOM]="Dominican Republic";c[CB.V5j.ECU]="Ecuador";c[CB.V5j.ELG]="Equatorial Guinea";c[CB.V5j.EGY]="Egypt";c[CB.V5j.ENG]="England";c[CB.V5j.ERI]="Eritrea";c[CB.V5j.ESP]="Spain";c[CB.V5j.EST]="Estonia";c[CB.V5j.ETH]="Ethiopia";c[CB.V5j.FGB]="England";c[CB.V5j.FAI]="Faroes";c[CB.V5j.FIJ]="Fiji";c[CB.V5j.FIN]="Finland";c[CB.V5j.FRA]="France";c[CB.V5j.FRG]="Guyana";c[CB.V5j.FRP]="Tahiti(French Polinesia)";c[CB.V5j.MKD]="Macedonia";c[CB.V5j.GAB]="Gabon";c[CB.V5j.GAM]="Gambia";
c[CB.V5j.GEO]="Georgia";c[CB.V5j.GER]="Germany";c[CB.V5j.SAA]="Germany";c[CB.V5j.DDR]="Germany";c[CB.V5j.GE2]="Germany";c[CB.V5j.GHA]="Ghana";c[CB.V5j.GGB]="Gibraltar";c[CB.V5j.GRE]="Greece";c[CB.V5j.GRA]="Grenada";c[CB.V5j.GRL]="Greenland";c[CB.V5j.FGA]="Guadeloupe";c[CB.V5j.GMA]="Guam";c[CB.V5j.GUA]="Guatemala";c[CB.V5j.GUI]="Guinea";c[CB.V5j.GUB]="Guinea-Bissau";c[CB.V5j.GCI]="Guernsey";c[CB.V5j.GUY]="Guyana";c[CB.V5j.HAI]="Haiti";c[CB.V5j.HON]="Honduras";c[CB.V5j.HKG]="Hong Kong";c[CB.V5j.HUN]=
"Hungary";c[CB.V5j.ISL]="Iceland";c[CB.V5j.IND]="India";c[CB.V5j.INA]="Indonesia";c[CB.V5j.IRI]="Iran";c[CB.V5j.IRQ]="Iraq";c[CB.V5j.IOM]="Isle of MAN";c[CB.V5j.ISR]="Israel";c[CB.V5j.IRL]="Ireland";c[CB.V5j.ITA]="Italy";c[CB.V5j.IVO]="Cote d'Ivoire";c[CB.V5j.JAM]="Jamaica";c[CB.V5j.JMY]="Svalbard and Jan Mayen";c[CB.V5j.JPN]="Japan";c[CB.V5j.JCI]="Jersey";c[CB.V5j.JOR]="Jordan";c[CB.V5j.KAZ]="Kazakhstan";c[CB.V5j.KEN]="Kenya";c[CB.V5j.KBA]="Kiribati";c[CB.V5j.KOR]="South Korea";c[CB.V5j.KYR]="Kyrgyzstan";
c[CB.V5j.KUW]="Kuwait";c[CB.V5j.LAO]="Laos";c[CB.V5j.LAT]="Latvia";c[CB.V5j.LBN]="Lebanon";c[CB.V5j.LES]="Lesotho";c[CB.V5j.LBR]="Liberia";c[CB.V5j.LBY]="Libya";c[CB.V5j.LIE]="Liechtenstein";c[CB.V5j.LTU]="Lithuania";c[CB.V5j.LUX]="Luxembourg";c[CB.V5j.MAC]="Macao";c[CB.V5j.MAD]="Madagascar";c[CB.V5j.MAS]="Malaysia";c[CB.V5j.MLI]="Mali";c[CB.V5j.MLT]="Malta";c[CB.V5j.MWI]="Malawi";c[CB.V5j.MFR]="Martinique";c[CB.V5j.MAU]="Mauritania";c[CB.V5j.MRI]="Mauritius";c[CB.V5j.MYF]="Mayotte";c[CB.V5j.MEX]=
"Mexico";c[CB.V5j.MIC]="Micronesia";c[CB.V5j.MDA]="Moldova";c[CB.V5j.MNC]="Monaco";c[CB.V5j.MON]="Mongolia";c[CB.V5j.MSG]="Montserrat";c[CB.V5j.MAR]="Morocco";c[CB.V5j.MOZ]="Mozambique";c[CB.V5j.MYA]="Myanmar(Burma)";c[CB.V5j.NAM]="Namibia";c[CB.V5j.NEP]="Nepal";c[CB.V5j.NED]="Netherlands";c[CB.V5j.AHO]="Netherlands Antilles";c[CB.V5j.NCF]="New caledonia";c[CB.V5j.NZL]="New zealand";c[CB.V5j.NCA]="Nicaragua";c[CB.V5j.NGR]="Nigeria";c[CB.V5j.NNN]="Niue";c[CB.V5j.NNA]="Norfolk";c[CB.V5j.NMI]="Northern Mariana";
c[CB.V5j.NOR]="Norway";c[CB.V5j.OTM]="Timor-Leste";c[CB.V5j.PAK]="Pakistan";c[CB.V5j.PAL]="Palau";c[CB.V5j.PLE]="Palestine";c[CB.V5j.PAN]="Panama";c[CB.V5j.PNG]="Papua new GUINEA";c[CB.V5j.PAR]="Paraguay";c[CB.V5j.PER]="Peru";c[CB.V5j.PHI]="Philippines";c[CB.V5j.PIG]="Pitcairn";c[CB.V5j.POL]="Poland";c[CB.V5j.POR]="Portugal";c[CB.V5j.PUR]="Puerto rico";c[CB.V5j.QAT]="Qatar";c[CB.V5j.RUF]="Reunion";c[CB.V5j.ROU]="Romania";c[CB.V5j.URS]="Russian Federation";c[CB.V5j.RUS]="Russian Federation";c[CB.V5j.ZAR]=
"Russian Federation";c[CB.V5j.ESA]="El Salvador";c[CB.V5j.SMR]="San Marino";c[CB.V5j.SAO]="Sao Tome and PRINCIPE";c[CB.V5j.SCO]="Scotland";c[CB.V5j.SEN]="Senegal";c[CB.V5j.YUG]="Serbia(Yugoslavia)";c[CB.V5j.SRB]="Serbia(Yugoslavia)";c[CB.V5j.SEY]="Seychelles";c[CB.V5j.SIN]="Singapore";c[CB.V5j.SVK]="Slovakia";c[CB.V5j.SLO]="Slovenia";c[CB.V5j.SOM]="Somalia";c[CB.V5j.RSA]="South africa";c[CB.V5j.SRI]="Sri lanka";c[CB.V5j.SUD]="Sudan";c[CB.V5j.SUR]="Suriname";c[CB.V5j.SVN]="Svalbard and Jan Mayen";
c[CB.V5j.SWE]="Sweden";c[CB.V5j.SUI]="Switzerland";c[CB.V5j.SYR]="Syria";c[CB.V5j.HGB]="Saint Helena";c[CB.V5j.PGB]="Saint Pierre and Miquelon";c[CB.V5j.TJK]="Tajikistan";c[CB.V5j.TAN]="Tanzania";c[CB.V5j.THA]="Thailand";c[CB.V5j.TKI]="Tokelau";c[CB.V5j.TRI]="Trinidad and Tobago";c[CB.V5j.TUN]="Tunisia";c[CB.V5j.TCI]="Turks and Caicos Islands";c[CB.V5j.TUR]="Turkey";c[CB.V5j.TKM]="Turkmenistan";c[CB.V5j.UGA]="Uganda";c[CB.V5j.UKR]="Ukraine";c[CB.V5j.UAE]="United Arab Emirates";c[CB.V5j.USA]="United States of America";
c[CB.V5j.URU]="Uruguay";c[CB.V5j.UZB]="Uzbekistan";c[CB.V5j.VEN]="Venezuela";c[CB.V5j.VIE]="Viet Nam";c[CB.V5j.WLS]="Wales";c[CB.V5j.WFR]="Wallis and Futuna";c[CB.V5j.YEM]="Yemen";c[CB.V5j.ZAM]="Zambia";c[CB.V5j.ZIM]="Zimbabwe";c[CB.V5j.ZRE]="Congo-Kinshasa(Zaire)";c[CB.V5j.NKO]="North korea";c[CB.V5j.MDV]="Maldives";c[CB.V5j.MSH]="Marshall Islands";c[CB.V5j.OMN]="Oman";c[CB.V5j.NAU]="Nauru";c[CB.V5j.NIG]="Niger";c[CB.V5j.SAU]="Saudi Arabia";c[CB.V5j.TOG]="Togo";c[CB.V5j.TON]="Tonga";c[CB.V5j.VAN]=
"Vanuatu";c[CB.V5j.VAT]="Vatican City";c[CB.V5j.TUV]="Tuvalu";c[CB.V5j.SWA]="Swaziland";c[CB.V5j.SIE]="Sierra Leone";c[CB.V5j.SLU]="Saint Lucia";c[CB.V5j.PAP]="Papua New Guinea";c[CB.V5j.SVI]="St Vincent and The Grenadines";c[CB.V5j.SAM]="Samoa";c[CB.V5j.SKI]="St Kitts and NEVIS";c[CB.V5j.SAL]="Solomon islands";c[CB.V5j.RWA]="Rwanda";c[CB.V5j.TPE]="Taiwan";c[CB.V5j.NIR]="Northern Ireland";c[CB.V5j.GBR]="United Kingdom(Great Britain)";c[CB.V5j.KOS]="Kosovo";var b=[],d=function(d){this.n=d;void 0===
this.n&&(this.n=CB.V5j.V5k);if(0==b.length){d=0;for(var f in CB.V5j)CB.V5j.hasOwnProperty(f)&&(b[d]=f,d+=1);for(f=0;f<b.length;f++){var g=c[f];void 0===g&&(g=c[0]);d=b[f];1<d.length&&(g=window.escape(g),g=" background-image: url( "+CB.V5o()+"media/flags/flags16/"+g+".png ) !important;",CB.V5p.V5q(".cls-"+d,g+"background-repeat:no-repeat; background-position:center center;"))}}};d.prototype.V5r=function(){return b[this.n]};d.prototype.V5s=function(){return c[this.n]};return d}();"use strict";
CB.V5t={V5u:function(){this.V5v||(this.V5w()&&(this.V5v="iOS"+this.V5w()),this.V5x()&&(this.V5v="Andr"+this.V5x()),this.V5y()&&(this.V5v="Win"),this.V5z()&&(this.V5v="Ux"),this.V60()&&(this.V5v="Mac"),this.V5v=navigator.platform);return this.V5v},V61:function(){return this.V5u()+" "+String.f("{0}/{1}/{2}, cpus={3}",window.innerWidth,window.innerHeight,window.devicePixelRatio,this.V62())},V63:function(){return"cordova"==CB.V47.V4i("client")},V64:function(){4;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|bada|Opera Mini/i.test(navigator.userAgent)},
V65:function(){return!CB.V5t.V64()&&1400<screen.width&&1E3<screen.height},V66:function(){var c=document.documentElement;c.requestFullscreen?c.requestFullscreen():c.webkitrequestFullscreen?c.webkitrequestFullscreen():c.mozrequestFullscreen?c.mozrequestFullscreen():c.msrequestFullscreen&&c.msrequestFullscreen()},V67:function(){return document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||(screen.availHeight||screen.height-30)<=window.innerHeight},V68:function(){7;return 1E3<=screen.width&&
760<=screen.height||1E3<=screen.height},V69:function(){return/iPhone/i.test(navigator.userAgent)||/iPod/i.test(navigator.userAgent)},V6a:function(){return/iPad/i.test(navigator.userAgent)},V5w:function(){return parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||!1},V5y:function(){return/Win32/i.test(navigator.platform)},V5z:function(){return/Linux/i.test(navigator.platform)},
V60:function(){return/Mac/i.test(navigator.platform)},isTouchDevice:function(){void 0===this.V6b&&(this.V6b=this.V64()||"ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints);return this.V6b},V6c:function(){try{return window.self!==window.top&&-1==document.referrer.search(/google/i)&&-1==document.referrer.search(/bing/i)}catch(c){return!0}},V6d:function(){if(void 0!==window.screenLeft)return new CB.V6e(window.screenLeft,window.screenTop);if(void 0!==window.screenX)return new CB.V6e(window.screenX,
window.screenY)},V6f:function(){var c=window,b=document,d=b.documentElement,b=b.getElementsByTagName("body")[0];return new CB.Size(c.innerWidth||d.clientWidth||b.clientWidth,c.innerHeight||d.clientHeight||b.clientHeight)},V6g:function(){return 1400<=screen.width&&900<=screen.height},V6h:function(c){return screen.width*(c||1)<screen.height},V6i:function(){if(document.inputEncoding)switch(document.inputEncoding){default:return 1252;case "ISO-8859-11":return 874;case "Windows-31J":return 932;case "ISO-8859-2":return 1250;
case "ISO-8859-5":return 1251;case "ISO-8859-1":return 1252;case "ISO-8859-7":return 1253;case "ISO-8859-9":return 1254;case "ISO-8859-8":return 1255;case "ISO-8859-6":return 1256;case "ISO-8859-13":return 1257}else return 1252},V6j:function(){var c=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(c=parseFloat(RegExp.$1));return c},V6k:function(){return this.V64()||this.isTouchDevice()},V6l:function(){return void 0!==Function.prototype.bind&&
"WebSocket"in window?11<=this.V6m()?!0:this.V6n()&&4.2>=this.V5x()||this.V6o()&&535>this.V6p()&&!this.V6q()?!1:!0:!1},V6r:function(){return document.location&&document.location.protocol?"https:"==document.location.protocol:window.location&&window.location.protocol?"https:"==window.location.protocol:!1},V6m:function(){var c=window.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+
3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10)},V6s:function(){var c=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./);return c?parseInt(c[1]):0},V6t:function(){var c=this.V6m();return c?12>c:!1},V6u:function(){var c=null;try{c=!!new ActiveXObject("htmlfile")}catch(b){c=!1}return c},V6v:function(){return null!=window.webkitURL},V6q:function(){return-1!=navigator.userAgent.indexOf("Chrome")},V6w:function(){return-1!=navigator.userAgent.indexOf("Safari")&&
-1==navigator.userAgent.indexOf("Chrome")&&-1==navigator.userAgent.indexOf("CriOS")},V6x:function(){return-1!=navigator.userAgent.indexOf("Firefox")},V6y:function(){var c=this.V6m(),b=this.V6s();return this.V6q()||11<=c||54<=b},V6n:function(){return 0<=navigator.userAgent.indexOf("Android")&&-1==navigator.userAgent.indexOf("Chrome")},V6z:function(){return 0<this.V5x()},V6o:function(){return 0<=navigator.userAgent.indexOf("Windows")&&0<=navigator.userAgent.indexOf("Safari")},V6p:function(){var c=navigator.userAgent;
return 0<=c.indexOf("Safari")?parseFloat(c.slice(c.indexOf("Safari")+7)):0},V5x:function(){var c=navigator.userAgent;return 0<=c.indexOf("Android")?parseFloat(c.slice(c.indexOf("Android")+8)):0},V70:function(c){if(window.WebGLRenderingContext)for(var b=document.createElement("canvas"),d=["webgl","experimental-webgl","moz-webgl","webkit-3d"],e=!1,f=0;4>f;f++)try{if((e=b.getContext(d[f]))&&"function"==typeof e.getParameter)return c?{name:d[f],V71:e}:!0}catch(g){}return!1},runsOnChessBaseDomain:function(){return-1!=
document.URL.search(/chessbase.com/i)&&-1==document.URL.search(/cloudserver/i)||-1!=document.URL.search(/playchess.com/i)},runsOnChessBaseCom:function(){return-1!=document.URL.search(/chessbase.com/i)},V72:function(){return-1!=document.URL.search(/live.chessbase.com/i)||-1!=document.URL.search(/acc.chessbase.com/i)},V73:function(){alert(0);return window.devicePixelRatio},V74:function(c){this.V75=c},pixToZoom:function(c){return this.V75?c/this.V75:window.devicePixelRatio?c/window.devicePixelRatio:
c},zoomToPix:function(c){return this.V75?c*this.V75:window.devicePixelRatio?c*window.devicePixelRatio:c},V62:function(){return window.navigator.hardwareConcurrency},browser:{V76:function(){return{browser:this.search(this.data.browser),version:this.search(navigator.userAgent)||this.search(navigator.appVersion),V77:this.search(this.data.V77)}},search:function(c){if("object"===typeof c)for(var b=0;b<c.length;b++){var d=c[b].string,e=c[b].prop;this.V78=c[b].versionSearch||c[b].identity;if(d){if(-1!=d.indexOf(c[b].subString))return c[b].identity}else if(e)return c[b].identity}else if(b=
c.indexOf(this.V78),-1!=b)return parseFloat(c.substr(b+this.V78.length+1))},data:{browser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:Window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},
{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],V77:[{string:navigator.platform,subString:"Win",
identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]}}};"use strict";
CB.V79={ENG:0,DEU:1,GER:1,FRA:2,ESP:3,ITA:4,NED:5,POR:6,DEF:7,SLO:8,SWE:9,BAS:10,SVK:11,POL:12,CZE:13,CAT:14,TRK:15,MGY:16,RUS:17,GRK:18,ROM:19,CHN:20,UN:21,NOR:22,HEB:23,UKR:24,VIE:25,ARA:26,SER:27,LIT:28,BRA:29,FAR:30,CRO:31,GAL:32,HIN:33,V7a:function(){return void 0!==navigator.languages&&navigator.languages.length?navigator.languages[0]:void 0!==navigator.language?navigator.language:void 0!==navigator.userLanguage?navigator.userLanguage:"en-en"},V7b:function(){return this.V7a().slice(0,2)},V7c:function(){var c=
CB.V79.V7a();return this.V7d(c)},V7d:function(c){return-1<c.indexOf("de")?this.DEU:-1<c.indexOf("es")?this.ESP:-1<c.indexOf("nl")?this.NED:-1<c.indexOf("fr")?this.FRA:-1<c.indexOf("it")?this.ITA:-1<c.indexOf("sl")?this.SLO:-1<c.indexOf("sv")?this.SWE:-1<c.indexOf("ro")?this.ROM:-1<c.indexOf("zh")?this.CHN:-1<c.indexOf("ru")?this.RUS:-1<c.indexOf("no")?this.NOR:-1<c.indexOf("pl")?this.POL:-1<c.indexOf("he")?this.HEB:-1<c.indexOf("ca")?this.CAT:-1<c.indexOf("tr")?this.TRK:-1<c.indexOf("sl")?this.SLO:
-1<c.indexOf("el")?this.GRK:-1<c.indexOf("uk")?this.UKR:-1<c.indexOf("vi")?this.VIE:-1<c.indexOf("ar")?this.ARA:-1<c.indexOf("sr")?this.SER:-1<c.indexOf("lt")?this.LIT:-1<c.indexOf("pt-br")||-1<c.indexOf("pt")?this.BRA:-1<c.indexOf("fa")?this.FAR:-1<c.indexOf("ga")?this.GAL:-1<c.indexOf("hr")?this.CRO:-1<c.indexOf("hi")?this.HIN:-1<c.indexOf("cs")?this.CZE:this.ENG},V7e:function(c){switch(c){default:case CB.V79.ENG:return"en";case CB.V79.DEU:return"de";case CB.V79.ESP:return"es";case CB.V79.NED:return"nl";
case CB.V79.FRA:return"fr";case CB.V79.ITA:return"it";case CB.V79.POR:return"pt";case CB.V79.SLO:return"sl";case CB.V79.SWE:return"sv";case CB.V79.ROM:return"ro";case CB.V79.CHN:return"zh";case CB.V79.RUS:return"ru";case CB.V79.NOR:return"no";case CB.V79.POL:return"pl";case CB.V79.HEB:return"he";case CB.V79.CAT:return"ca";case CB.V79.TRK:return"tr";case CB.V79.SLO:return"sl";case CB.V79.GRK:return"el";case CB.V79.UKR:return"uk";case CB.V79.VIE:return"vi";case CB.V79.ARA:return"ar";case CB.V79.SER:return"sr";
case CB.V79.LIT:return"lt";case CB.V79.BRA:return"pt";case CB.V79.FAR:return"fa";case CB.V79.CRO:return"hr";case CB.V79.GAL:return"ga";case CB.V79.HIN:return"hi";case CB.V79.CZE:return"cs"}},V7f:function(c){switch(c){default:case CB.V79.ENG:return"en";case CB.V79.DEU:return"de";case CB.V79.ESP:return"es";case CB.V79.FRA:return"fr";case CB.V79.NED:return"nl";case CB.V79.ITA:return"it"}},getRibbonFlagName:function(c){switch(c){default:case CB.V79.ENG:return"en-us"==this.V7a()?"us":"gb";case CB.V79.DEU:return"de-at"==
this.V7a()?"at":"de";case CB.V79.ESP:return"es";case CB.V79.NED:return"nl";case CB.V79.ROM:return"ro";case CB.V79.CHN:switch(this.V7a()){default:case "zh-cn":return"cn";case "zh-tw":return"tw";case "zh-sg":return"si";case "zh-hk":return"hk"}case CB.V79.FRA:return"fr";case CB.V79.RUS:return"ru";case CB.V79.NOR:return"no";case CB.V79.ITA:return"it";case CB.V79.POL:return"pl";case CB.V79.UN:return"_United_Nations";case CB.V79.HEB:return"il";case CB.V79.CAT:return"_Catalonia";case CB.V79.TRK:return"tr";
case CB.V79.SLO:return"si";case CB.V79.GRK:return"gr";case CB.V79.UKR:return"ua";case CB.V79.VIE:return"vn";case CB.V79.ARA:return"sa";case CB.V79.SER:return"rs";case CB.V79.LIT:return"lt";case CB.V79.BRA:return"br";case CB.V79.FAR:return"ir";case CB.V79.CRO:return"hr";case CB.V79.GAL:return"ie";case CB.V79.HIN:return"in";case CB.V79.CZE:return"cz"}}};
CB.V79.V7g=function(c){switch(c){default:case CB.V79.ENG:return"ENG";case CB.V79.DEU:case CB.V79.GER:return"GER";case CB.V79.ESP:return"ESP";case CB.V79.NED:return"NED";case CB.V79.ROM:return"ROM";case CB.V79.CHN:return"CHN";case CB.V79.FRA:return"FRA";case CB.V79.RUS:return"RUS";case CB.V79.NOR:return"NOR";case CB.V79.POL:return"POL";case CB.V79.ITA:return"ITA";case CB.V79.HEB:return"HEB";case CB.V79.CAT:return"CAT";case CB.V79.TRK:return"TRK";case CB.V79.SLO:return"SLO";case CB.V79.UN:return"UN";
case CB.V79.GRK:return"EL";case CB.V79.UKR:return"UKR";case CB.V79.VIE:return"VIE";case CB.V79.ARA:return"ARA";case CB.V79.SER:return"SER";case CB.V79.LIT:return"LIT";case CB.V79.BRA:return"BRA";case CB.V79.FAR:return"FAR";case CB.V79.CRO:return"CRO";case CB.V79.GAL:return"GAL";case CB.V79.HIN:return"HIN";case CB.V79.CZE:return"CZE"}};
CB.V79.getNativeLangName=function(c){switch(c){default:case CB.V79.ENG:return"English";case CB.V79.DEU:return"Deutsch";case CB.V79.ESP:return"Espa\u00f1ol";case CB.V79.NED:return"Nederlands";case CB.V79.ROM:return"Rom\u00e2n";case CB.V79.CHN:return"\u4e2d\u6587";case CB.V79.FRA:return"Fran\u00e7ais";case CB.V79.RUS:return"\u0420\u0443\u0441\u0441\u043a\u0438\u0439";case CB.V79.NOR:return"Norsk";case CB.V79.POL:return"Polski";case CB.V79.ITA:return"Italiano";case CB.V79.HEB:return"\u05e2\u05d1\u05e8\u05d9\u05ea";
case CB.V79.CAT:return"Catal\u00e0";case CB.V79.TRK:return"T\u00fcrk\u00e7e";case CB.V79.SLO:return"Slovenski";case CB.V79.GRK:return"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac";case CB.V79.UKR:return"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430";case CB.V79.VIE:return"Ti\u1ebfng Vi\u1ec7t";case CB.V79.ARA:return"\u0627\u0644\u0639\u0631\u0628\u064a\u0629";case CB.V79.SER:return"Srbski";case CB.V79.LIT:return"Lietuvi\u0173";case CB.V79.BRA:return"Portugu\u00eas";case CB.V79.FAR:return"\u0641\u0627\u0631\u0633\u06cc";
case CB.V79.CRO:return"Hrvatski";case CB.V79.GAL:return"Gaeilge";case CB.V79.HIN:return"\u0939\u093f\u0928\u094d\u0926\u0940";case CB.V79.CZE:return"\u010ce\u0161tina"}};CB.V79.V7h=function(c){var b=[];c.forEach(function(d){b.push(this.getNativeLangName(d))}.bind(this));return b};CB.V79.V7i=function(c){var b=[];c.forEach(function(d){b.push(this.getRibbonFlagName(d))}.bind(this));return b};"use strict";
CB.V7j=function(){var c=function(b,c){this.fLat=b;this.fLong=c;this.nNation=this.V7k=0},b=function(b){return Math.PI/180*b};c.prototype={toString:function(){return""},fromDataBuf:function(b){this.fLat=b.readFloat32();this.fLong=b.readFloat32();this.nNation=b.V35k()},V35j:function(b){b.writeFloat32(this.fLat);b.writeFloat32(this.fLong);b.V35h(this.nNation)},getSphericDist:function(d){return this.fLat==d.fLat&&this.fLong==d.fLong?0:6378*Math.acos(Math.sin(b(this.fLat))*Math.sin(b(d.fLat))+Math.cos(b(this.fLat))*
Math.cos(b(d.fLat))*Math.cos(b(d.fLong-this.fLong)))},getAzimuthDirection:function(d){return-Math.atan2(Math.sin(b(this.fLong-d.fLong))*Math.cos(b(this.fLat)),Math.cos(b(this.fLat))*Math.sin(b(d.fLat))-Math.sin(b(this.fLat))*Math.cos(b(d.fLat))*Math.cos(b(this.fLong-d.fLong)))},getNewPoint:function(d,c){var f=d/6378,g=Math.acos(Math.cos(f)*Math.cos(b(90-this.fLat))+Math.sin(b(90-this.fLat))*Math.sin(f)*Math.cos(b(c))),f=Math.asin(Math.sin(f)*Math.sin(b(c))/Math.sin(g));return new CB.V7j(90-g/(Math.PI/
180),f/(Math.PI/180)+this.V7l)},fromBrowser:function(){navigator.geolocation.getCurrentPosition(function(b){this.fLat=b.coords.latitude;this.fLong=b.coords.longitude;this.V7k=b.coords.altitude},function(b){},{enableHighAccuracy:!1,timeout:2E4,maximumAge:"Infinite"})}};return c}();"NOMINIFY=w,h,topLeft";"use strict";
CB.V6e=function(){var c=function(b,d){"object"==typeof b&&"undefined"==typeof d?void 0!=b.clientX?this.set(b.clientX,b.clientY):b.touches&&b.touches.length?this.set(b.touches[0].pageX,b.touches[0].pageY):void 0!=b.pageX&&this.set(b.pageX,b.pageY):this.set(b,d)};c.prototype.set=function(b,d){this.x=b;this.y=d};c.prototype.add=function(b){return new CB.V6e(this.x+b.x,this.y+b.y)};c.prototype.subtract=function(b){return new CB.V6e(this.x-b.x,this.y-b.y)};c.prototype.V7m=function(b){b=this.subtract(b);
return Math.sqrt(b.x*b.x+b.y*b.y)};c.prototype.V7n=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};c.prototype.toInt=function(){this.x=Math.floor(this.x+.5);this.y=Math.floor(this.y+.5)};c.prototype.cloneIntPoint=function(){var b=new c(this.x,this.y);b.toInt();return b};c.prototype.toString=function(){return"("+this.x+","+this.y+")"};c.prototype.getX=function(){return this.x};c.prototype.getY=function(){return this.y};return c}();
CB.Size=function(){var c=function(b,d){this.w=b;this.h=d};c.prototype.toString=function(){return"w="+this.w+", h="+this.h};c.prototype.V7o=function(b){return new CB.V6e((b.w-this.w)/2,(b.h-this.h)/2)};return c}();
CB.V7p=function(){var c=function(b,d,c,f){this.left=b||0;this.top=d||0;this.right=c||0;this.bottom=f||0};Object.defineProperty(c.prototype,"w",{get:function(){return this.getSize().w},set:function(b){this.right=this.left+b-1},enumerable:!0});Object.defineProperty(c.prototype,"h",{get:function(){return this.getSize().h},set:function(b){this.bottom=this.top+b-1},enumerable:!0});Object.defineProperty(c.prototype,"topLeft",{get:function(){return new CB.V6e(this.left,this.top)},set:function(b){var d=this.w,
c=this.h;this.left=b.x;this.top=b.y;this.w=d;this.h=c},enumerable:!0});c.prototype.V7q=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};c.prototype.V7r=function(b,d){this.left=b.x;this.top=b.y;this.right=b.x+d.w-1;this.bottom=b.y+d.h-1};c.prototype.V7s=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};c.prototype.V7t=function(b,d,c,f){this.left=Math.min(b,c);this.right=Math.max(b,c);this.top=Math.min(d,f);this.bottom=Math.max(d,
f)};c.prototype.toString=function(){return"l="+this.left+", t="+this.top+" "+this.getSize().toString()};c.prototype.getPos=function(){return new CB.V6e(this.left,this.top)};c.prototype.V7u=function(){return new CB.V6e(this.left,this.top)};c.prototype.V7v=function(){return new CB.V6e(this.right,this.top)};c.prototype.V7w=function(){return new CB.V6e(this.right,this.bottom)};c.prototype.V7x=function(){return new CB.V6e(this.left,this.bottom)};c.prototype.getSize=function(){return new CB.Size(this.right-
this.left+1,this.bottom-this.top+1)};c.prototype.getUnion=function(b){return new CB.V7p(Math.min(Math.min(this.left,b.left),Math.min(this.right,b.right)),Math.min(Math.min(this.top,b.top),Math.min(this.bottom,b.bottom)),Math.max(Math.max(this.left,b.left),Math.max(this.right,b.right)),Math.max(Math.max(this.top,b.top),Math.max(this.bottom,b.bottom)))};c.prototype.V7y=function(b){var d=new CB.V7p(this.left,this.top,this.right,this.bottom);if(d.left<b.left||d.left>=b.right)d.left=b.left;if(d.right>
b.right||d.right<=b.left)d.right=b.right;if(d.top<b.top||d.top>=b.bottom)d.top=b.top;if(d.bottom>b.bottom||d.bottom<=b.top)d.bottom=b.bottom;return d};c.prototype.V7z=function(b,d){return b>=this.left&&b<=this.right&&d>=this.top&&d<=this.bottom};c.prototype.getPath=function(){var b=new CB.V80;b.push(this.V7u());b.push(this.V7v());b.push(this.V7w());b.push(this.V7x());return b};c.prototype.move=function(b,d){this.left+=b;this.top+=d;this.right+=b;this.bottom+=d};c.prototype.V81=function(b,d){this.left+=
b;this.right-=b;this.top+=d;this.bottom-=d};c.prototype.expand=function(b,d){this.V81(-b,-d)};return c}();
CB.V82=function(){var c=function(b,d,c){this.set(b,d,c)};c.prototype.set=function(b,d,c){this.x=b;this.y=d;this.z=c};c.prototype.add=function(b){return new CB.Vec(this.x+b.x,this.y+b.y,this.z+b.z)};c.prototype.subtract=function(b){return new CB.V6e(this.x-b.x,this.y-b.y,this.z-b.z)};c.prototype.getLength=function(){return void 0!==this.z?Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z):Math.sqrt(this.x*this.x+this.y*this.y)};c.prototype.V83=function(){this.x=-this.x;this.y=-this.y;void 0!==this.z&&
(this.z=-this.z)};c.prototype.toString=function(){return void 0!==this.z?"("+this.x+","+this.y+","+this.z+")":"("+this.x+","+this.y+")"};return c}();
CB.V80=function(){var c=function(){this.subPaths=[]};c.prototype.toString=function(){for(var b="Pth:",d=0;d<this.subPaths.length;d++)b+="s=",this.subPaths[d].forEach(function(d,c,g){b+=d.toString();g<c.length-1&&(b+=",")});return b};c.prototype.push=function(b){0===this.subPaths.length&&this.subPaths.push([]);this.subPaths[this.subPaths.length-1].push(b)};c.prototype.exec=function(b){b.beginPath();for(var d=0;d<this.subPaths.length;d++)1<this.subPaths[d].length&&this.V84(b,this.subPaths[d]);b.closePath()};
c.prototype.V84=function(b,d){b.moveTo(d[0].x,d[0].y);for(var c=1;c<d.length;c++)b.lineTo(d[c].x,d[c].y)};c.prototype.V85=function(b){for(var d=0;d<this.subPaths.length;d++)3<this.subPaths[d].length&&(b.beginPath(),this.V86(b,this.subPaths[d]),b.closePath())};c.prototype.V86=function(b,d){b.moveTo(d[0].x,d[0].y);var c;for(c=1;c<d.length-2;c++)b.quadraticCurveTo(d[c].x,d[c].y,(d[c].x+d[c+1].x)/2,(d[c].y+d[c+1].y)/2);b.quadraticCurveTo(d[c].x,d[c].y,d[c+1].x,d[c+1].y)};c.prototype.reverse=function(){this.subPaths.length&&
this.subPaths[this.subPaths.length-1].reverse()};c.prototype.append=function(b){this.subPaths=this.subPaths.concat(b.subPaths)};return c}();
CB.V87={clipRect:function(c,b){b.getPath().exec(c);c.clip()},V88:function(c,b,d){b=b.getPath();d=d.getPath();d.reverse();b.append(d);this.V89(c,b)},V8a:function(c,b){b.getPath().exec(c);c.stroke()},fillRect:function(c,b){b.getPath().exec(c);c.fill()},V89:function(c,b){b.exec(c);c.clip()},V8b:function(c,b,d,e,f){c.beginPath();c.moveTo(b,d);c.lineTo(e,f);c.stroke()},V8c:function(c,b,d,e,f,g){e<2*g&&(g=e/2);f<2*g&&(g=f/2);c.beginPath();c.moveTo(b+g,d);c.arcTo(b+e,d,b+e,d+f,g);c.arcTo(b+e,d+f,b,d+f,g);
c.arcTo(b,d+f,b,d,g);c.arcTo(b,d,b+e,d,g);c.stroke()},V8d:function(c,b,d,e){c=CB.V87.V8e(c,d,e);window.saveAs(c,b)},V8e:function(c,b,d){var e=document.createElement("canvas");e.width=b;e.height=d;c.data&&c.data.length?e.getContext("2d").putImageData(c,0,0):e.getContext("2d").drawImage(c,0,0);return CB.V87.V8f(e.toDataURL())},V8f:function(c){var b=atob(c.split(",")[1]);c=c.split(",")[0].split(":")[1].split(";")[0];for(var d=new ArrayBuffer(b.length),e=new Uint8Array(d),f=0;f<b.length;f++)e[f]=b.charCodeAt(f);
return new Blob([d],{type:c})}};CB.Color=function(){var c=function(b,d,c,f){this.V8g=b;this.V8h=d;this.V8i=c;this.alpha=void 0!==f?f:1};c.prototype.toString=function(){return"rgba( "+Math.round(this.V8g)+", "+Math.round(this.V8h)+", "+Math.round(this.V8i)+", "+this.alpha+" )"};return c}();
CB.HSLColor=function(){var c=function(b,d,c,f){this.hue=b;this.V8j=d;this.V8k=c;this.alpha=f||1};c.prototype.toString=function(){return 1>this.alpha?"hsla( "+Math.round(this.hue)+", "+Math.round(this.V8j)+"%, "+Math.round(this.V8k)+"%, "+this.alpha+" )":"hsl( "+Math.round(this.hue)+", "+Math.round(this.V8j)+"%, "+Math.round(this.V8k)+"% )"};c.RED=0;c.YELLOW=60;c.GREEN=120;c.CYAN=180;c.BLUE=240;c.MAGENTA=300;return c}();"use strict";
CB.V8l=function(){var c=function(){this.loaded=!1;this.height=this.width=0;this.url="";this.V8m=function(){}};c.prototype.isValid=function(){return 0<this.width&&0<this.height};c.prototype.V8n=function(b){this.image=new Image;V35p&&V35p.config.V8o&&(0>b.search("data:image/png;base64")||!CB.V5t.V6w())&&(this.image.crossOrigin="Anonymous");this.image.addEventListener("load",c.prototype.V8p.bind(this));this.image.addEventListener("error",c.prototype.V8q.bind(this));this.url=b;this.image.src=b};c.V8r=
function(b,d){var c=new CB.V8l;b.getItem(d).then(function(b){b?(b=(window.URL||window.webkitURL).createObjectURL(b),c.V8n(b),c.urlToRevoke=b):c.V8n(d)});return c};c.prototype.V8s=function(b){if("undefined"!=typeof this.image&&this.loaded)return b.createPattern(this.image,"repeat")};c.prototype.V8t=function(b,d,c,f,g){try{this.imageData=b.getImageData(d,c,f,g),this.loaded=!0,this.width=f,this.height=g}catch(h){console.log(h)}};c.prototype.V8u=function(b,d,c,f,g,h,k){try{void 0===this.canvas&&(this.canvas=
document.createElement("canvas"),this.context=this.canvas.getContext("2d")),this.canvas.width=f,this.canvas.height=g,0<d+f&&0<c+g&&this.context&&b&&(this.context.drawImage(b.canvas,d,c,h,k,0,0,f,g),this.imageData=this.context.getImageData(0,0,f,g)),this.loaded=!0,this.width=f,this.height=g}catch(l){console.log(l)}};c.prototype.draw=function(b,d,c,f,g,h,k,l,m){var p=Function.prototype.call.bind(Array.prototype.slice);this.loaded&&(void 0!==this.imageData?(p=p(arguments),p.splice(0,1,this.imageData),
b.putImageData.apply(b,p)):void 0!==this.image&&(p=p(arguments),p.splice(0,1,this.image),b.drawImage.apply(b,p)))};c.prototype.V8v=function(b,d,c,f,g){this.loaded&&(void 0!==this.imageData?b.putImageData(this.imageData,d,c,f,g):void 0!==this.image&&b.drawImage(this.image,d,c,f,g))};c.prototype.V8w=function(b,d,c,f,g){this.loaded&&(void 0!==this.imageData?this.V8x(b,this.imageData,b.putImageData,d,c,f,g):void 0!==this.image&&this.V8x(b,this.image,b.drawImage,d,c,f,g))};c.prototype.V8x=function(b,d,
c,f,g,h,k){new CB.V7p(f,g,f+h,g+k);for(var l=g,m=f;l<g+k;){for(;m<f+h;){var p=this.width,r=this.height;m+p>f+h&&(p=f+h-m);l+r>g+k&&(r=g+k-l);try{c.call(b,d,0,0,p,r,m,l,p,r)}catch(u){}m+=this.width}m=f;l+=this.height}};c.prototype.isValid=function(){return this.loaded};c.prototype.V8p=function(){this.loaded=!0;this.width=this.image.width;this.height=this.image.height;this.V8m();this.urlToRevoke&&(window.URL||window.webkitURL).revokeObjectURL(this.urlToRevoke)};c.prototype.V8q=function(){5};return c}();
"use strict";CB.namespace("CB.V8y");
CB.V8y=function(){var c=function(){this.V8z=new CB.V8l;this.V90=new CB.V8l;this.V92=this.V91=-1;this.pos=new CB.V6e(0,0);this.V93=new CB.V6e(0,0);this.V94=this.loaded=!1};c.prototype.toString=function(){return this.pos.toString()};c.prototype.V8n=function(b){this.V8z.V8m=this.V8p.bind(this);this.V8z.V8n(b)};c.prototype.V8t=function(b,d,c,f,g){this.V8z.V8t(b,d,c,f,g);this.V8p()};c.prototype.V8p=function(){this.w=this.V8z.width;this.h=this.V8z.height;this.V95=Math.floor(this.w/2);this.V96=Math.floor(this.h/
2);this.loaded=!0};c.prototype.moveTo=function(b,d){if(this.V8z.loaded){this.V93=this.pos;var c=d.cloneIntPoint();this.pos=c;this.V90.isValid()&&this.V90.draw(b,this.V92-this.V95,this.V91-this.V96);this.V97&&(this.V90=new CB.V8l,this.V97=!1);this.V90.V8t(b,c.x-this.V95,c.y-this.V96,this.w,this.h);this.V92=c.x;this.V91=c.y;this.V98(b,c.x-this.V95,c.y-this.V96);this.V94=!0}};c.prototype.setBackground=function(b){b&&(this.V97=!0,this.V90=b,this.V92=this.pos.x,this.V91=this.pos.y)};c.prototype.hasBackground=
function(){return this.V90.loaded||this.V97};c.prototype.hide=function(b){this.V90.isValid()&&this.V94&&(this.V90.draw(b,this.V92-this.V95,this.V91-this.V96),this.V94=!1)};c.prototype.saveBeforeMove=function(b,d){var c=d.cloneIntPoint();this.V97&&(this.V90=new CB.V8l,this.V97=!1);this.V90.V8t(b,c.x-this.V95,c.y-this.V96,this.w,this.h);this.V92=c.x;this.V91=c.y};c.prototype.moveToNoSave=function(b,d){if(this.V8z.loaded){this.V93=this.pos;var c=d.cloneIntPoint();this.pos=c;this.V98(b,c.x-this.V95,c.y-
this.V96);this.V94=!0}};c.prototype.show=function(b){this.V90.isValid()&&this.V95&&(this.V90.draw(b,this.V92-this.V95,this.V91-this.V96),this.V97&&(this.V90=new CB.V8l,this.V97=!1),this.V90.V8t(b,this.V92-this.V95,this.V91-this.V96,this.w,this.h),this.V98(b,this.V92-this.V95,this.V91-this.V96),this.V94=!0)};c.prototype.V99=function(b){this.V97&&(this.V90=new CB.V8l,this.V97=!1);this.V90.V8t(b,this.V92-this.V95,this.V91-this.V96,this.w,this.h)};c.prototype.V98=function(b,d,c){b.save();if(37<this.V8z.width){var f=
Math.min(3,Math.round(Math.sqrt(this.V8z.width/30)));b.shadowOffsetX=f;b.shadowOffsetY=f;b.shadowBlur=1*f;b.shadowColor="rgba( 40, 18, 10, 0.24 )"}this.V8z.draw(b,d,c);b.restore()};c.prototype.deleteBackground=function(){this.V97=!1;this.V90=new CB.V8l;this.V91=this.V92=-1};c.prototype.V9a=function(b){this.V9b=b};c.prototype.getMoveClipRect=function(){return new CB.V7p(Math.min(this.pos.x,this.V93.x)-this.V95,Math.min(this.pos.y,this.V93.y)-this.V96,Math.max(this.pos.x,this.V93.x)+this.V95,Math.max(this.pos.y,
this.V93.y)+this.V96)};return c}();
CB.Animation=function(){var c=function(b){this.cbcanvas=b;this.V9c=30;this.V9d=this.lastTime=0;this.startTime=this.V9e();this.V9f=0;this.jobs=[];this.V9g=[]};c.prototype.V9h=function(){window.cancelAnimationFrame(this.V9i);this.V9g=[];if(this.jobs.length){for(var b=0;b<this.jobs.length;b++)this.jobs[b].deleteBackground();this.jobs=[];return!0}return!1};c.prototype.V9j=function(b,d,c){this.lastTime=this.V9m=this.V9l=0;this.startTime=this.V9e();this.V9k=c;this.V9g.push(function(){this.V9n(b,d)}.bind(this));
this.V9i=window.requestAnimationFrame(function(b){this.V9o(b)}.bind(this))};c.prototype.V9o=function(b){var d=10,c=1;void 0===b&&(b=new Date);this.tick(b);for(b=0;b<this.V9g.length;b++)this.V9g[b]();this.V9g=[];this.V9m+=1;this.V9l+=this.V9f;2<this.V9m&&(d=Math.floor(this.V9l/this.V9m),40>d&&(c=1<d?Math.floor(40/d+.5):40));var f=this.cbcanvas.V9p,g=!0;for(b=0;b<this.jobs.length;b++)this.jobs[b].shouldHideInThisStep()&&this.jobs[b].hide(f);for(b=0;b<this.jobs.length;b++)this.jobs[b].isImmobileInThisStep()&&
!this.jobs[b].getsInvisibleAtEnd()&&this.jobs[b].moveToNoSave(f,this.jobs[b].currPos);for(b=0;b<this.jobs.length;b++)this.jobs[b].isStillMoving()&&(this.jobs[b].hasReachedEndPos()?this.jobs[b].currPos=this.jobs[b].ptTo:this.jobs[b].displace(c),this.jobs[b].saveBeforeMove(f,this.jobs[b].currPos));for(b=0;b<this.jobs.length;b++)this.jobs[b].isStillMoving()&&(this.jobs[b].moveToNoSave(f,this.jobs[b].currPos),this.cbcanvas.V9q(this.jobs[b].getMoveClipRect())),this.jobs[b].prepNextStep(c)||(g=!1);this.V9k&&
this.cbcanvas.V9r(this.V9k);this.cbcanvas.V9s();this.V9t();g?(this.V9u&&this.V9u(),this.jobs=[]):this.V9i=window.requestAnimationFrame(function(b){this.V9o(b)}.bind(this));g||(3<this.V9m?this.currFPS=d:delete this.currFPS)};c.prototype.V9t=function(){for(var b=[],d=0;d<this.jobs.length;d++)this.jobs[d].canDelete()||b.push(this.jobs[d]);this.jobs=b};c.prototype.V9n=function(b,d){for(var c=this.cbcanvas.V9p,f=0;f<this.jobs.length;f++)this.jobs[f].hide(c);for(f=0;f<b.length;f++)b[f].hide(c);for(f=0;f<
this.jobs.length;f++)-1==this.jobs[f].sqTo&&this.jobs[f].moveTo(c,this.jobs[f].ptTo);for(f=0;f<this.jobs.length;f++)-1!=this.jobs[f].sqTo&&this.jobs[f].moveTo(c,this.jobs[f].ptTo);var g=0<this.jobs.length;this.jobs=[];for(f=0;f<b.length;f++)b[f].startAnimation(c,d),b[f].deleteBackground(),b[f].moveTo(c,b[f].ptFrom),this.jobs.push(b[f]);return g};c.prototype.tick=function(b){this.V9v(b);this.V9d=this.V9e()-this.startTime;this.lastTime=b};c.prototype.V9v=function(b){0==this.lastTime&&(this.lastTime=
this.startTime);this.V9f=0===this.lastTime||this.lastTime==b?this.V9c:1E3/(b-this.lastTime)};c.prototype.V9e=function(){return(new Date).getTime()};return c}();"use strict";
CB.V9w=function(){var c=function(){this.nSize=this.V9x=0;this.buffer=new ArrayBuffer(188);this.viewBuf=new DataView(this.buffer);this.V9y=[];this.V9z=[]};c.prototype.clear=function(){this.nSize=this.V9x=0;this.V9y=[];this.V9z=[]};c.prototype.rewind=function(){this.V9x=0;this.V9y=[];this.V9z=[]};c.prototype.getPos=function(){return this.V9x};c.prototype.setPos=function(b){if(b<=this.nSize&&b<=this.buffer.byteLength)this.V9x=b;else throw"Error: SetPos exceeds DataBuffer size";};c.prototype.getSize=
function(){return this.nSize};c.prototype.setSize=function(b){if(b>=this.buffer.byteLength)throw"DBuf setSize illegal";this.nSize=b};c.prototype.Va0=function(){return this.nSize+4};c.prototype.Va1=function(b,d){b.setInt32(d,this.nSize);this.Va2(b,d,4);d+=4;for(var c=0;c<this.nSize;c++)b.setUint8(c+d,this.viewBuf.getUint8(c))};c.prototype.Va3=function(b,d){this.Va2(b,d,4);var c=b.getInt32(d);if(35E4>c&&0<=c){this.Va4(c);d+=4;for(var f=0;f<c;f++){var g=b.getUint8(f+d);this.viewBuf.setUint8(f,g)}this.Va5(c)}};
c.prototype.V357=function(b){b=CB.V47.V48(b);this.V34s(b)};c.prototype.V34s=function(b){this.Va4(b.length+4);this.V35h(b.length);for(var d=0;d<b.length;d++){var c=b.charCodeAt(d);this.viewBuf.setUint8(this.V9x+d,c)}this.Va5(b.length)};c.prototype.V35a=function(b){var d=this.V35k();if(d<=b&&25E4>d){b="";for(var c=0;c<d;c++){var f=this.viewBuf.getUint8(this.V9x+c);b+=String.fromCharCode(f)}b=CB.V47.V49(b);this.V9x+=d}else throw Error("Data Error: Read String");return b};c.prototype.V34p=function(b){this.Va4(b.length+
4);this.V35h(b.length);for(var d=0;d<b.length;d++){var c=b.charCodeAt(d);this.viewBuf.setUint8(this.V9x+d,c)}this.Va5(b.length)};c.prototype.V34q=function(b){var d="",c=this.V35k();if(c<=b&&25E4>c){for(b=0;b<c;b++)var f=this.viewBuf.getUint8(this.V9x+b),d=d+String.fromCharCode(f);this.V9x+=c}else throw Error(String.f("Data Error: Read String, Len={0}, maxLen={1}",c,b));return d};c.prototype.writeByteLenASCIIString=function(b){this.Va4(b.length+2);this.writeUint8(b.length+1);for(var d=0;d<b.length;d++){var c=
b.charCodeAt(d);this.viewBuf.setUint8(this.V9x+d,c)}this.viewBuf.setUint8(this.V9x+b.length,0);this.Va5(b.length+1)};c.prototype.readByteLenASCIIString=function(b){var d="",c=this.readUint8();0<c&&--c;if(1E3>c){for(var f=0;f<c;f++)var g=this.viewBuf.getUint8(this.V9x+f),d=d+String.fromCharCode(g);if(c<=b)this.V9x+=c+1;else throw Error(String.f("Data Error: Read ByteLenString, len={0}, maxLen={1}",c,b));}else throw Error(String.f("Data Error: Read ByteLenString > 1000, len={0}",c));return d};c.prototype.readSizedString=
function(b){var d="";if(25E4>b){for(var c=0;c<b;c++)var f=this.viewBuf.getUint8(this.V9x+c),d=d+String.fromCharCode(f);this.V9x+=b}else throw Error("Data Error: Read SizedString, max="+b);return d};c.prototype.writeSizedString=function(b){var d=b.length;this.Va4(d);for(var c=0;c<d;c++){var f=b.charCodeAt(c);this.viewBuf.setUint8(this.V9x+c,f)}this.Va5(d)};c.prototype.Va6=function(b){var d;if(25E4>b){d="";for(var c=0;c<b;c++){var f=this.viewBuf.getUint8(this.V9x+c);d+=String.fromCharCode(f)}d=CB.V47.V49(d);
this.V9x+=b}else throw Error("Data Error: Read UTF8String, len="+b);return d};c.prototype.readByteArray=function(b){for(var d=[],c=0;c<b&&this.V9x+c<this.nSize;c++)d.push(this.viewBuf.getUint8(this.V9x+c));this.V9x+=b;return d};c.prototype.writeByteArray=function(b,d){for(var c=0;c<b.length&&c<d;c++)this.writeByte(b[c])};c.prototype.writeDataBuffer=function(b){this.V35h(b.getSize());this.Va4(b.getSize());for(var d=0;d<b.getSize();d++)this.viewBuf.setUint8(this.V9x+d,b.viewBuf.getUint8(d));this.Va5(b.getSize())};
c.prototype.readDataBuffer=function(){var b=new CB.V9w,d=this.V35k();b.Va4(d);for(var c=0;c<d;c++)b.viewBuf.setUint8(c,this.viewBuf.getUint8(this.V9x+c));this.V9x+=d;b.Va5(d);b.V9x=0;return b};c.prototype.writeData=function(b){this.Va4(b.getSize());for(var d=0;d<b.getSize();d++)this.viewBuf.setUint8(this.V9x+d,b.viewBuf.getUint8(d));this.Va5(b.getSize())};c.prototype.V35n=function(b){if(void 0===b)throw Error("V35n, value undefined");this.Va4(1);b?this.viewBuf.setUint8(this.V9x,1):this.viewBuf.setUint8(this.V9x,
0);this.Va5(1)};c.prototype.V35o=function(b){b=this.viewBuf.getUint8(this.V9x);this.V9x+=1;return 0!=b};c.prototype.writeUint8=function(b){if(void 0===b)throw Error("writeUint8, value undefined");this.Va4(1);this.viewBuf.setUint8(this.V9x,b);this.Va5(1)};c.prototype.readUint8=function(){var b=this.viewBuf.getUint8(this.V9x);this.V9x+=1;return b};c.prototype.readByte=c.prototype.readUint8;c.prototype.writeByte=c.prototype.writeUint8;c.prototype.V35f=function(b){if(void 0===b)throw Error("V35f, value undefined");
this.Va4(2);this.viewBuf.setInt16(this.V9x,b);this.Va2(this.viewBuf,this.V9x,2);this.Va5(2)};c.prototype.V35l=function(){var b=0;this.V9x<=this.viewBuf.byteLength-2&&(this.Va2(this.viewBuf,this.V9x,2),b=this.viewBuf.getInt16(this.V9x),this.Va2(this.viewBuf,this.V9x,2),this.V9x+=2);return b};c.prototype.readShort=c.prototype.V35l;c.prototype.writeShort=c.prototype.V35f;c.prototype.V352=function(b){if(void 0===b)throw Error("V352, value undefined");this.Va4(2);this.viewBuf.setUint16(this.V9x,b);this.Va2(this.viewBuf,
this.V9x,2);this.Va5(2)};c.prototype.V35e=function(){var b=0;this.V9x<=this.viewBuf.byteLength-2&&(this.Va2(this.viewBuf,this.V9x,2),b=this.viewBuf.getUint16(this.V9x),this.Va2(this.viewBuf,this.V9x,2),this.V9x+=2);return b};c.prototype.V35h=function(b){if(void 0===b)throw Error("V35h, value undefined");this.Va4(4);this.viewBuf.setInt32(this.V9x,b);this.Va2(this.viewBuf,this.V9x,4);this.Va5(4)};c.prototype.writeFakeInt64=function(b){this.V35h(b);this.V35h(0)};c.prototype.readFakeInt64=function(){var b=
this.V35k();this.V35k();return b};c.prototype.V35k=function(){var b=0;this.V9x<=this.viewBuf.byteLength-4&&(this.Va2(this.viewBuf,this.V9x,4),b=this.viewBuf.getInt32(this.V9x),this.Va2(this.viewBuf,this.V9x,4),this.V9x+=4);return b};c.prototype.writeInt=c.prototype.V35h;c.prototype.readInt=c.prototype.V35k;c.prototype.V351=function(b){this.Va4(4);this.viewBuf.setUint32(this.V9x,b);this.Va2(this.viewBuf,this.V9x,4);this.Va5(4)};c.prototype.V35g=function(){var b=0;this.V9x<=this.viewBuf.byteLength-
4&&(this.Va2(this.viewBuf,this.V9x,4),b=this.viewBuf.getUint32(this.V9x),this.Va2(this.viewBuf,this.V9x,4),this.V9x+=4);return b};c.prototype.V350=function(b){b=b.getYear()<<9|b.getMonth()<<5|b.getDay();this.V351(b)};c.prototype.V35c=function(){var b=new CB.Date,d=this.V35g();b.setYear(d>>9);b.setMonth(d>>5&15);b.V5f(d&31);return b};c.prototype.Va7=function(){var b=this.V35g();return new CB.V5g(b)};c.prototype.V35d=function(b){if(void 0===b)throw Error("V35d, value undefined");var d=Math.floor(b/
4294967296);this.V35h(b-d);this.V35h(d)};c.prototype.readUint64=function(){if(this.V9x<=this.viewBuf.byteLength-8){this.Va2(this.viewBuf,this.V9x,8);var b=this.viewBuf.getUint32(this.V9x);this.V9x+=4;var d=this.viewBuf.getUint32(this.V9x);this.V9x+=4;return 4294967296*b+d}return 0};c.prototype.V35i=function(){if(this.V9x<=this.viewBuf.byteLength-8){this.Va2(this.viewBuf,this.V9x,8);var b=this.viewBuf.getInt32(this.V9x);this.V9x+=4;var d=this.viewBuf.getUint32(this.V9x);this.V9x+=4;return 4294967296*
b+d}return 0};c.prototype.writeFloat32=function(b){this.Va4(4);this.viewBuf.setFloat32(this.V9x,b);this.Va2(this.viewBuf,this.V9x,4);this.Va5(4)};c.prototype.readFloat32=function(){this.Va2(this.viewBuf,this.V9x,4);var b=this.viewBuf.getFloat32(this.V9x);this.V9x+=4;return b};c.prototype.Va8=function(b){this.Va4(8);this.viewBuf.setFloat64(this.V9x,b);this.Va2(this.viewBuf,this.V9x,8);this.Va5(8)};c.prototype.readFloat64=function(){this.Va2(this.viewBuf,this.V9x,8);var b=this.viewBuf.getFloat64(this.V9x);
this.V9x+=8;return b};c.prototype.Va9=function(){for(var b=this.getSize(),d=[],c=0;c<b;c++){var f=this.viewBuf.getUint8(c);d[c]=f}return CB.Vaa.Vab(d,b)};c.prototype.Vac=function(b,d){this.clear();if(d){var c=[],f=CB.Vaa.Vad(c,b);if(0<f)for(var g=0;g<f;g++)this.writeByte(c[g])}else for(c=0,10<b.length&&(c=parseInt(b.substr(0,10),10)),0>c&&(c=0),f=0;f<c;f++)g=b.substr(10+2*f,2),g=parseInt(g,16),this.writeByte(g)};c.prototype.Vae=function(b){this.clear();b=CB.V47.base64.V4g(b);for(var d=new Uint8Array(b),
c=0;c<b.byteLength;c++)this.writeByte(d[c]);this.writeByteArray(b,b.byteLength);this.rewind()};c.prototype.readBEInt32=function(){var b=this.readUint8(),d=this.readUint8(),c=this.readUint8(),f=this.readUint8();return b<<24|d<<16|c<<8|f};c.prototype.writeBEInt32=function(b){if(void 0===b)throw Error("V35h, value undefined");this.Va4(4);this.viewBuf.setInt32(this.V9x,b);this.Va5(4)};c.prototype.readBEInt24=function(){var b=this.readUint8(),d=this.readUint8(),c=this.readUint8();return b<<16|d<<8|c};
c.prototype.readBEInt16=function(){var b=this.readUint8(),d=this.readUint8();return 256*b+d};c.prototype.writeBEInt24=function(b){var d=b>>8,c=b&255;this.writeUint8(b>>16);this.writeUint8(d);this.writeUint8(c)};c.prototype.writeBEInt16=function(b){var d=b&255;this.writeUint8(b>>8);this.writeUint8(d)};c.prototype.writeArray=function(b){var d=b.length;this.V35h(d);for(var c=0;c<d;++c)b[c].write(this)};c.prototype.Vaf=function(b){var d=b.length;this.V35f(d);for(var c=0;c<d;++c)b[c].write(this)};c.prototype.readArray=
function(b,d){var c=this.V35k();65534<c&&CBDebug.assert(65535>c);b.length=c;for(var f=0;f<c;++f){var g=d(this);b[f]=g}};c.prototype.Vag=function(b,d){var c=this.V35l();b.length=c;for(var f=0;f<c;++f){var g=d(this);b[f]=g}};c.prototype.beginSizedWrite=function(){this.V9y.push(this.getPos());this.V35h(0)};c.prototype.endSizedWrite=function(){var b=this.getPos();if(0<this.V9y.length){this.setPos(this.V9y[this.V9y.length-1]);var d=this.nSize;this.V35h(b-this.V9y[this.V9y.length-1]-4);this.nSize=d;this.setPos(b);
this.V9y.pop()}else throw Error("DB::EndWrite");};c.prototype.beginSizedRead=function(){this.V9y.push(this.getPos());this.V9z.push(this.V35k())};c.prototype.endSizedRead=function(){if(0<this.V9y.length&&0<this.V9z.length){var b=this.getPos()-this.V9y[this.V9y.length-1]-4;this.skip(this.V9z[this.V9z.length-1]-b);this.V9y.pop();this.V9z.pop()}else throw Error("DB::EndRead");};c.prototype.skipSizedRead=function(){var b=this.V35k();this.skip(b)};c.prototype.skip=function(b){if(this.V9x+b<=this.nSize)this.V9x+=
b;else throw Error("DB::Skip");};c.prototype.Vah=function(b,d){var c=this.getPos();this.setPos(b);d();this.setPos(c)};c.prototype.Va4=function(b){if(this.V9x+b>=this.buffer.byteLength||this.nSize+b>=this.buffer.byteLength){var d=Math.max(this.V9x,this.nSize),c=8*Math.floor(3*(d+b)/16+1);if(c<b+d)throw"DataBuffer Size";b=new ArrayBuffer(c);d=new DataView(b);for(c=0;c<this.buffer.byteLength/4;c++)d.setUint32(4*c,this.viewBuf.getUint32(4*c));this.buffer=b;this.viewBuf=d}};c.prototype.Va5=function(b){if(this.V9x+
b>=this.buffer.byteLength)throw"DataBuffer overrun";this.V9x+=b;this.nSize+=b;if(this.nSize>=this.buffer.byteLength)throw"DataBuffer Size Limit exc.";};c.prototype.Va2=function(b,d,c){for(var f=[],g=0;g<c;g++)f.push(b.getUint8(d+g));for(g=0;g<c;g++)b.setUint8(d+g,f[c-g-1])};return c}();function createReadFactory(c){return function(b){var d=new c;d.read(b);return d}}function createReadFactory2(c){return function(b){var d=new c;d.read2(b);return d}}"use strict";
CB.Vai=function(){var c=function(b){this.bag=[];var d;if(0<arguments.length)for(d=0;d<b.length;d++)this.Vaj(b[d])};c.prototype.clear=function(){this.bag=[]};c.prototype.search=function(b,d){for(var c=this.bag.length,f,g=2==arguments.length?d:0;g<c;){f=g+Math.floor((c-g)/2);if(this.bag[f].setEquals(b))return f;b.setGreater(this.bag[f])?g=f+1:c=f}return g};c.prototype.Vaj=function(b){var d=this.search(b);void 0!==this.bag[d]&&this.bag[d].setEquals(b)||this.bag.splice(d,0,b)};c.prototype.contains=function(b){var d=
this.search(b);return void 0!==this.bag[d]?this.bag[d].setEquals(b):!1};c.prototype.get=function(b){var d=this.search(b);if(void 0!==this.bag[d]&&this.bag[d].setEquals(b))return this.bag[d]};c.prototype.size=function(){return this.bag.length};c.prototype.Vak=function(){return this.bag};c.prototype.equals=function(b){if(this.size()!=b.size())return!1;var d;for(d=0;d<this.bag.length;d++)if(!this.bag[d].setEquals(b.bag[d]))return!1;return!0};c.prototype.save=function(b,d){var c=new CB.Vam;c.save(b+"_len",
this.bag.length);for(var f=0;f<this.bag.length;f++)d&&!d(this.bag[f])||c.save(b+"_o"+f,this.bag[f])};c.prototype.load=function(b,d){var c=new CB.Vam,f=c.load(b+"_len");if(f)for(var g=0,h=0;h<f;h++){var k=c.load(b+"_o"+h);d?(k=d(k))&&(this.bag[g++]=k):this.bag[g++]=k}};return c}();
CB.Van=function(){var c=function(b){this.bag=[];var d;if(0<arguments.length)for(d=0;d<b.length;d++)this.Vaj(b[d])};c.prototype.clear=function(){this.bag=[]};c.prototype.search=function(b,d){for(var c=this.bag.length,f,g=2==arguments.length?d:0;g<c;){f=g+Math.floor((c-g)/2);if(this.bag[f]==b)return f;b>this.bag[f]?g=f+1:c=f}return g};c.prototype.Vaj=function(b){var d=this.search(b);void 0!==this.bag[d]&&this.bag[d]==b||this.bag.splice(d,0,b)};c.prototype.contains=function(b){var d=this.search(b);return void 0!==
this.bag[d]?this.bag[d]==b:!1};c.prototype.get=function(b){var d=this.search(b);if(void 0!==this.bag[d]&&this.bag[d]==b)return this.bag[d]};c.prototype.size=function(){return this.bag.length};c.prototype.Vak=function(){return this.bag};c.prototype.equals=function(b){if(this.size()!=b.size())return!1;var d;for(d=0;d<this.bag.length;d++)if(this.bag[d]!=b.bag[d])return!1;return!0};c.prototype.save=function(b,d){var c=new CB.Vam;c.save(b+"_len",this.bag.length);for(var f=0;f<this.bag.length;f++)d&&!d(this.bag[f])||
c.save(b+"_o"+f,this.bag[f])};c.prototype.load=function(b,d){var c=new CB.Vam,f=c.load(b+"_len");if(f)for(var g=0,h=0;h<f;h++){var k=c.load(b+"_o"+h);d?(k=d(k))&&(this.bag[g++]=k):this.bag[g++]=k}};return c}();"use strict";CB.namespace("CB.Vao");
CB.Vao=function(){var c=function(b){this.Vap=b;this.Vaq={};this.Var={}};c.staticIdVector=0;c.staticIdBunch=0;c.prototype.Vas=function(b,d,c,f){var g={vec:[],overhead:new CB.V9w},h=b.getBuf().V35g();b.getBuf().V35g();var k=b.getBuf().V35g();b.getBuf().V35g();g.overhead=b.getBuf().readDataBuffer();if(0<k){for(var l=b.getBuf().V35k(),m=0;m<l&&3E4>m;m++){var p=f(b.getBuf());g.vec.push(p)}d=new CB.Vat(d);d.setUserType(c);d.getBuf().V351(h);d.getBuf().V351(0);d.getBuf().V351(k);d.getBuf().V351(0);d.getBuf().V35h(l);
d.address(b.getIdReceiver(),b.V353());this.Vap(d)}return g};c.prototype.Vau=function(b,d,e,f,g,h,k,l){var m=++c.staticIdVector,p=++c.staticIdBunch,r=0;do{var u=new CB.V9w;u.V35h(m);u.V35h(0);u.V35h(p);u.V35h(0);u.writeDataBuffer(k);var q=0,t=u.getPos();u.V35h(q);if(e.length){var v;do{var w=u.getSize(),y=u.getPos();l(u,e[r]);(v=u.getSize()<f)||0==q?(q++,r++):(u.setPos(y),u.setSize(w))}while(v&&r<e.length);v=u.getPos();u.setPos(t);u.V35h(q);u.setPos(v)}this.Vaq[p]={sender:b,receiver:d,buf:u,idBunch:p,
idVec:m,msgType:g,userType:h,nSent:0};p++}while(r<e.length);this.Var[m]={idVec:m,data:{msgType:g,userType:h,overHead:k}};this.Vax(b,d,m)};c.prototype.Vax=function(b,d,c){var f=!1,g;for(g in this.Vaq)if(this.Vaq.hasOwnProperty(g)){var h=this.Vaq[g],f=f||h.idVec==c;if(0==c||h.idVec==c){0==h.nSent%10&&(g=new CB.Vat(h.msgType),g.setUserType(h.userType),g.getBuf().writeData(h.buf),g.address(b,d),this.Vap(g));h.nSent++;break}}!f&&(f=this.Var[c])&&(g=new CB.Vat(f.data.msgType),g.setUserType(f.data.userType),
g.getBuf().writeFakeInt64(c),g.getBuf().writeFakeInt64(0),g.getBuf().writeDataBuffer(f.data.overHead),g.address(b,d),this.Vap(g),delete this.Var[c])};c.prototype.Vay=function(b){var d=b.getBuf().readFakeInt64(),c=b.getBuf().readFakeInt64(),f=b.getBuf().V35k();delete this.Vaq[c];this.Vax(b.getIdReceiver(),b.V353(),d);return f};return c}();"use strict";CB.Vaz={WHITE:0,BLACK:1,Vb0:3};CB.Vaz.Vb1=8;CB.Vaz.other=function(c){return c^CB.Vaz.BLACK};
CB.Vaz.fromString=function(c){return"w"===c?CB.Vaz.WHITE:CB.Vaz.BLACK};CB.Vaz.toString=function(c){return c===CB.Vaz.WHITE?"w":"b"};CB.Piece={V5k:0,KING:1,QUEEN:2,KNIGHT:3,BISHOP:4,ROOK:5,PAWN:6,Vb:1,Vd:2,Vj:3,Vh:4,Vf:5,Vl:6,Vc:9,Ve:10,Vk:11,Vi:12,Vg:13,Vm:14,COLOUR:8,WHITE:0,BLACK:8};CB.Piece.Vb2=7;CB.Piece.Vb1=8;CB.Piece.Vb3=function(c){return c&CB.Piece.Vb2};CB.Piece.side=function(c){return(c&CB.Vaz.Vb1)/8};CB.Piece.Vb4=function(c){return c^CB.Vaz.Vb1};CB.Piece.Vb5=function(c,b){return c|8*b};
CB.Piece.Vb6=" KQNBRP  kqnbrp".split("");CB.Piece.toString=function(c){return CB.Piece.Vb6[c]};CB.Piece.fromString=function(c){c=CB.Piece.Vb6.indexOf(c);return 0>c?CB.Piece.V5k:c};CB.Vb7={V5k:0,Vb8:1,Vb9:2,Vba:4,Vbb:8};CB.Vb7.Vbc=CB.Vb7.Vb9|CB.Vb7.Vb8;CB.Vb7.Vbd=CB.Vb7.Vbb|CB.Vb7.Vba;CB.Vb7.Vbe=CB.Vb7.Vbc|CB.Vb7.Vbd;CB.Vb7.toString=function(c){if(c===CB.Vb7.V5k)return"-";var b="";c&CB.Vb7.Vb9&&(b+="K");c&CB.Vb7.Vb8&&(b+="Q");c&CB.Vb7.Vbb&&(b+="k");c&CB.Vb7.Vba&&(b+="q");return b};
CB.Vb7.fromString=function(c){var b=CB.Vb7.V5k;c=new StringIterator(c);for(var d=c.Next();0!==d;d=c.Next())switch(d){case "K":b|=CB.Vb7.Vb9;break;case "Q":b|=CB.Vb7.Vb8;break;case "k":b|=CB.Vb7.Vbb;break;case "q":b|=CB.Vb7.Vba}return b};
CB.Vbf={Vbg:0,Vbh:7,Vbi:3,Vbj:56,Vbk:0,Vbl:1,Vbm:2,Vbn:3,Vbo:4,Vbp:5,Vbq:6,Vbr:7,Vbs:8,Vbt:9,Vbu:10,Vbv:11,Vbw:12,Vbx:13,Vby:14,Vbz:15,Vc0:16,Vc1:17,Vc2:18,Vc3:19,Vc4:20,Vc5:21,Vc6:22,Vc7:23,Vc8:24,Vc9:25,Vca:26,Vcb:27,Vcc:28,Vcd:29,Vce:30,Vcf:31,Vcg:32,Vch:33,Vci:34,Vcj:35,Vck:36,Vcl:37,Vcm:38,Vcn:39,Vco:40,F2:41,Vcp:42,Vcq:43,Vcr:44,Vcs:45,Vct:46,Vcu:47,Vcv:48,Vcw:49,Vcx:50,Vcy:51,Vcz:52,Vd0:53,Vd1:54,Vd2:55,Vd3:56,Vd4:57,Vd5:58,Vd6:59,Vd7:60,Vd8:61,Vd9:62,Vda:63,Vdb:0,Vdc:1,Vdd:2,Vde:3,Vdf:4,Vdg:5,
Vdh:6,Vdi:7,Vdj:0,Vdk:1,Vdl:2,Vdm:3,Vdn:4,Vdo:5,Vdp:6,Vdq:7};CB.Vdr=CB.Vbf;CB.Vbf.g_arrSquareStrs="a1 a2 a3 a4 a5 a6 a7 a8 b1 b2 b3 b4 b5 b6 b7 b8 c1 c2 c3 c4 c5 c6 c7 c8 d1 d2 d3 d4 d5 d6 d7 d8 e1 e2 e3 e4 e5 e6 e7 e8 f1 f2 f3 f4 f5 f6 f7 f8 g1 g2 g3 g4 g5 g6 g7 g8 h1 h2 h3 h4 h5 h6 h7 h8".split(" ");CB.Vbf.toString=function(c){return this.g_arrSquareStrs[c]};CB.Vbf.Vds=CB.Vbf.toString;CB.Vbf.Vdt=function(c,b){return CB.Vbf.Vds(CB.Vbf.Vdu(c,b))};
CB.Vbf.Vdv=function(c){return String.fromCharCode("a".charCodeAt()+c)};CB.Vbf.Vdw=function(c){return c+1};CB.Vbf.Vdx=function(c){return c.charCodeAt(0)-"a".charCodeAt()};CB.Vbf.Vdy=function(c){return c.charCodeAt(0)-"1".charCodeAt()};CB.Vbf.fromString=function(c){if(c&&2===c.length){var b=CB.Vbf.Vdx(c.charAt(0));c=CB.Vbf.Vdy(c.charAt(1));return CB.Vbf.I(b,c)}};CB.Vbf.R=function(c){return(c&CB.Vbf.Vbh)>>CB.Vbf.Vbg};CB.Vbf.Vdz=function(c){return(c&CB.Vbf.Vbj)>>CB.Vbf.Vbi};CB.Vbf.Ve0=CB.Vbf.R;
CB.Vbf.Ve1=CB.Vbf.Vdz;CB.Vbf.Ve2=function(c,b){var d=CB.Vbf.R(c)-CB.Vbf.R(b),e=CB.Vbf.Vdz(c)-CB.Vbf.Vdz(b);return Math.sqrt(d*d+e*e)};CB.Vbf.I=function(c,b){return 8*c+b};CB.Vbf.Vdu=CB.Vbf.I;CB.Vbf.isLegal=function(c,b){return c<=CB.Vbf.Vdi&&c>=CB.Vbf.Vdb&&b<=CB.Vbf.Vdq&&b>=CB.Vbf.Vdj};CB.Vbf.Ve3=function(c){var b=CB.Vbf.Vdz(c);c=CB.Vbf.R(c);return!((b+c)%2)};CB.Vbf.Ve4=function(c){return!CB.Vbf.Ve3(c)};
CB.Vbf.V7m=function(c,b){var d=CB.Vbf.Ve1(c)-CB.Vbf.Ve1(b),e=CB.Vbf.Ve0(c)-CB.Vbf.Ve0(b);return Math.sqrt(d*d+e*e)};CB.Vbf.Ve5=function(c){return c===CB.Vaz.WHITE?CB.Vbf.Vdq:CB.Vbf.Vdj};"use strict";
CB.Ve6=function(){var c=function(b){this.sqs=[];for(var d=0;64>d;d++)this.sqs.push(0);b&&this.setup()};c.Ve7=64;c.prototype.setup=function(){this.sqs=[CB.Piece.Vf,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Vg,CB.Piece.Vj,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Vk,CB.Piece.Vh,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Vi,CB.Piece.Vd,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Ve,CB.Piece.Vb,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Vc,CB.Piece.Vh,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Vi,CB.Piece.Vj,CB.Piece.Vl,
0,0,0,0,CB.Piece.Vm,CB.Piece.Vk,CB.Piece.Vf,CB.Piece.Vl,0,0,0,0,CB.Piece.Vm,CB.Piece.Vg]};c.prototype.clear=function(){this.sqs.forEach(function(b,d,c){c[d]=0})};c.prototype.Ve8=function(b){for(var d=CB.Vaz.WHITE,c=CB.Piece.KING,f=0;f<b.length;f++)switch(b[f]){case "K":c=CB.Piece.KING;break;case "Q":c=CB.Piece.QUEEN;break;case "R":c=CB.Piece.ROOK;break;case "B":c=CB.Piece.BISHOP;break;case "N":c=CB.Piece.KNIGHT;break;case "P":c=CB.Piece.PAWN;break;case "a":case "b":case "c":case "d":case "e":case "f":case "g":case "h":var g=
b.charCodeAt(f),h=b.charCodeAt(f+1);49<=h&&56>=h?this.sqs[(g-97<<3)+h-49]=c|d:98==g&&(d=CB.Vaz.Vb1);break;case "w":d=CB.Vaz.WHITE}};c.prototype.Ve9=function(b){for(var d=0;d<b.length;d++)this.sqs[d]=b[d]};c.prototype.copyTo=function(b){for(var d=0;64>d;d++)b[d]=this.sqs[d]};c.prototype.set=function(b,d){this.sqs[b]=d};c.prototype.get=function(b){return this.sqs[b]};c.prototype.change=function(b,d){this.sqs[d]=this.sqs[b];this.sqs[b]=0};c.prototype.Vea=function(b,d,c){this.sqs[d]=c;this.sqs[b]=0};
c.prototype.Veb=function(b,d,c){this.sqs[d]=this.sqs[b];this.sqs[b]=0;this.sqs[c]=0};c.prototype.writeToDataBuffer=function(b){for(var d=0;64>d;d++)b.writeByte(this.sqs[d])};c.prototype.Vec=function(){for(var b=[],d=7;0<=d;d--){for(var c="",f=0;8>f;f++)var g=this.get(8*f+d),c=g?c+CB.Piece.Vb6[g]:CB.Vbf.Ve3(8*f+d)?c+".":c+" ";b.push(c)}return b};c.prototype.Ved=function(b,d,c,f){for(d=0;64>d;d++)if((void 0===f||!f[d])&&c[d]==b)return d;return-1};c.prototype.test=function(){var b=new CB.Ve6;b.setup();
b.Vec().forEach(function(b){})};return c}();"use strict";CB.Vee=function(){var c=function(b,d){void 0!==b?(this.cr=b.cr,this.ep=b.ep,this.mvd=b.board[d.from],this.vct=b.board[d.to]):(this.cr=CB.Vb7.V5k,this.ep=0,this.mvd=this.vct=CB.Piece.V5k);void 0!==d&&(this.fldVct=d.to);this.from2=this.to2=0};c.prototype.Vef=function(b,d){this.fldVct=d;this.vct=b};c.prototype.Veg=function(b,d){this.from2=b;this.to2=d};return c}();"use strict";
CB.Veh=function(){var c=function(b,d,c){this.to=this.from=0;this.prom=CB.Piece.V5k;b&&(this.from=b);d&&(this.to=d);c&&(this.prom=c)};c.g_mvW00=new c(CB.Vbf.Vcg,CB.Vbf.Vcv);c.g_mvW000=new c(CB.Vbf.Vcg,CB.Vbf.Vc0);c.g_mvB00=new c(CB.Vbf.Vcn,CB.Vbf.Vd2);c.g_mvB000=new c(CB.Vbf.Vcn,CB.Vbf.Vc7);c.prototype.Vei=!1;c.prototype.Vej=!1;c.prototype.needCol=!1;c.prototype.needRow=!1;c.prototype.mvd=CB.Piece.V5k;c.prototype.vct=CB.Piece.V5k;Object.defineProperty(c.prototype,"piece",{get:function(){return this.mvd},
set:function(b){this.mvd=b},enumerable:!0});Object.defineProperty(c.prototype,"capt",{get:function(){return this.vct},set:function(b){this.vct=b},enumerable:!0});c.prototype.Vek=!1;c.prototype.Vel=!1;c.prototype.isNullMove=function(){return this.from===this.to&&!this.from};c.prototype.isCastling=function(){return this.isShortCastling()||this.isLongCastling()};c.prototype.equals=function(b){return this.from===b.from&&this.to===b.to&&this.prom===b.prom};c.prototype.isValid=function(){return this.from!=
this.to};c.prototype.Vem=function(){return this.equals(CB.Veh.g_mvW00)&&this.mvd===CB.Piece.Vb||this.equals(CB.Veh.g_mvB00)&&this.mvd===CB.Piece.Vc};c.prototype.isShortCastling=function(){return this.Vek};c.prototype.Ven=function(){return this.equals(CB.Veh.g_mvW000)&&this.mvd===CB.Piece.Vb||this.equals(CB.Veh.g_mvB000)&&this.mvd===CB.Piece.Vc};c.prototype.isLongCastling=function(){return this.Vel};c.prototype.setIsCastling=function(){this.Vek=this.Vem();this.Vel=this.Ven()};c.prototype.subLines=
null;c.prototype.annos=null;c.prototype.isCheck=function(){return this.Vei};c.prototype.setCheck=function(b){this.Vei=b};c.prototype.isMate=function(){return this.Vej};c.prototype.setMate=function(b){this.Vej=b};c.prototype.isTake=function(){return this.vct!=CB.Piece.V5k};c.prototype.getMoved=function(){return this.mvd};c.prototype.setMoved=function(b){this.mvd=b};c.prototype.getVictim=function(){return this.vct};c.prototype.setVictim=function(b){this.vct=b};c.prototype.getPiece=c.prototype.getMoved;
c.prototype.isProm=function(){return this.prom!=CB.Piece.V5k};c.prototype.isPawn=function(){return this.mvd&&(this.mvd&7)==CB.Piece.PAWN};c.prototype.getSide=function(){return CB.Piece.side(this.mvd)};c.prototype.isNeedCol=function(){return this.needCol};c.prototype.setNeedCol=function(b){this.needCol=b};c.prototype.isNeedRow=function(){return this.needRow};c.prototype.setNeedRow=function(b){this.needRow=b};c.prototype.getTreeMoveCount=function(){var b=1;this.subLines&&(b=this.subLines.reduce(function(b,
c){return b+c.getTreeMoveCount()},b));return b};c.prototype.indexOfLine=function(b){return this.subLines?this.subLines.indexOf(b):-1};c.prototype.findLine=function(b){if(this.subLines)for(var d=0;d<this.subLines.length;++d){var c=this.subLines[d];if(c[0].equals(b))return c}return null};c.prototype.removeLine=function(b){this.subLines&&(b=this.subLines.indexOf(b),0>b||this.subLines.splice(b,1))};c.prototype.removeLines=function(){this.subLines=null};c.prototype.getLine=function(b){return this.subLines[b]};
c.prototype.getSubLines=function(){return this.subLines};c.prototype.getSubLinesCount=function(){return this.subLines?this.subLines.length:0};c.prototype.hasLines=function(){return null!=this.subLines&&0<this.subLines.length};c.prototype.newLine=function(b,d){this.subLines||(this.subLines=[]);var c=new CB.Veo(b,d);this.subLines.push(c);return c};c.prototype.addLine=function(b){this.subLines||(this.subLines=[]);this.subLines.push(b)};c.prototype.insertLine=function(b,d){this.subLines||(this.subLines=
[]);this.subLines.splice(b,0,d)};c.prototype.swapLines=function(b,d){if(this.subLines){var c=this.subLines[b];this.subLines[b]=this.subLines[d];this.subLines[d]=c}};c.prototype.write=function(b){if(this.prom){var d=this.to|this.prom-CB.Piece.QUEEN<<6;b.writeByte(this.from|64);b.writeByte(d)}else b.writeByte(this.from),b.writeByte(this.to);this.Vep(b);this.Veq(b)};c.prototype.write2=function(b){if(this.prom){var d=this.to|this.prom-CB.Piece.QUEEN<<6;b.writeByte(this.from|64);b.writeByte(d)}else b.writeByte(this.from),
b.writeByte(this.to);d=0;this.annos&&this.annos.count()&&(d|=1);this.getSubLinesCount()&&(d|=2);b.writeUint8(d);d&1&&this.Ver(b);d&2&&this.Ves(b)};c.prototype.read=function(b){this.from=b.readByte();this.to=b.readByte();64==(this.from&192)&&(this.prom=CB.Piece.QUEEN+(this.to>>6));this.from&=63;this.to&=63;this.Vet(b);this.Veu(b)};c.prototype.read2=function(b){this.from=b.readByte();this.to=b.readByte();64==(this.from&192)&&(this.prom=CB.Piece.QUEEN+(this.to>>6));this.from&=63;this.to&=63;var d=b.readByte();
d&1&&this.Vev(b);d&2&&this.Vew(b)};c.prototype.Vet=function(b){this.annos=CB.Annotation.readFactory(b)};c.prototype.Vev=function(b){this.annos=CB.Annotation.readFactory2(b)};c.prototype.Vep=function(b){CB.Annotation.write(b,this.annos)};c.prototype.Ver=function(b){CB.Annotation.write2(b,this.annos)};c.prototype.Veu=function(b){var d=b.readByte();if(127>=d){this.subLines=Array(d);for(var c=0;c<d;++c)this.subLines[c]=CB.Veo.readFactory(b)}};c.prototype.Vew=function(b){var d=b.readByte();if(127>=d){this.subLines=
Array(d);for(var c=0;c<d;++c)this.subLines[c]=CB.Veo.readFactory2(b)}};c.prototype.Veq=function(b){var d=this.getSubLinesCount();b.writeByte(d);if(d)for(var c=0;c<d;++c)this.subLines[c].write(b)};c.prototype.Ves=function(b){var d=this.getSubLinesCount();b.writeByte(d);if(d)for(var c=0;c<d;++c)this.subLines[c].write2(b)};c.readFactory=createReadFactory(c);c.readFactory2=createReadFactory2(c);c.prototype.moveLinesTo=function(b){b.subLines=this.subLines;this.subLines=null};c.prototype.toString=function(){var b=
CB.Vbf.toString(this.from)+CB.Vbf.toString(this.to);this.prom!=CB.Piece.V5k&&(b+=CB.Piece.toString(this.prom).toLowerCase());return b};c.g_regex=/^[a-h][1-8][a-h][1-8]([NBRQ])?$/i;c.isValidString=function(b){return c.g_regex.test(b)};c.fromString=function(b){var d=b.substring(0,2),c=b.substring(2,4),d=CB.Vbf.fromString(d),c=CB.Vbf.fromString(c),f=void 0;4<b.length&&(b=b.charAt(4),f=CB.Piece.Vb3(CB.Piece.fromString(b)));return new CB.Veh(d,c,f)};c.prototype.toJSON=function(){return{from:CB.Vbf.toString(this.from),
to:CB.Vbf.toString(this.to),prom:"  Q N B R  ".split(" ")[this.prom%8]}};c.prototype.Vex=function(b){this.from=CB.Vbf.fromString(b.from);this.to=CB.Vbf.fromString(b.to);b=" KQNBR".search(RegExp(b.prom,"i"));this.prom=0<b?b:0;return{from:CB.Vbf.toString(this.from),to:CB.Vbf.toString(this.to),prom:"  Q N B R  ".split(" ")[this.prom%8]}};c.prototype.setSubParentData=function(b,d,c){if(this.subLines)for(var f=0;f<this.subLines.length;++f){var g=this.subLines[f];g.setParentMoveIndex(d);g.setParentLine(b);
c&&g.setSubParentData(!0)}};c.prototype.getAnno=function(){return this.annos};c.prototype.hasAnno=function(){return null!=this.annos};c.prototype.setAnnoItem=function(b,d){this.annos||(this.annos=new CB.Annotation);this.annos.setItem(b,d)};c.prototype.setAnno=function(b){this.annos=b};c.prototype.getAnnoItem=function(b){return this.annos?this.annos.getItem(b):null};c.prototype.deleteAnnoItem=function(b){this.annos&&this.annos.deleteItem(b)};c.prototype.Vey=function(){this.annos=null};c.prototype.unAnnotate=
function(){this.Vey();this.removeLines()};c.prototype.forAllMoves=function(b){b(this);if(this.subLines)for(var d=0;d<this.subLines.length;d++)this.subLines[d].forAllMoves(b)};return c}();"use strict";
CB.Vez=function(){var c=function(b,d,c,f){this.from=b||0;this.to=d||0;this.type=c||0;this.prom=f||0};c.prototype.Vf0=function(b){b&&(this.from=b.from,this.to=b.to,this.prom=b.prom,this.type=void 0!==b.type?b.type:0)};c.prototype.toString=function(){return CB.Vbf.toString(this.from)+"-"+CB.Vbf.toString(this.to)+", ty="+this.type};c.prototype.fromDataBuf=function(b){this.from=b.readUint8();this.to=b.readUint8();this.type=b.readUint8();this.prom=b.readUint8()};c.prototype.V35j=function(b){b.writeUint8(this.from);
b.writeUint8(this.to);b.writeUint8(this.type);b.writeUint8(this.prom)};return c}();"use strict";
CB.Veo=function(){var c=function(b,d){this.parent=null;this.inxMvParent=0;b&&(this.parent=b,this.inxMvParent=d)};c.prototype=[];c.prototype.Vf1=function(){return!this.parent};c.prototype.Vf2=function(){this.parent=null;this.inxMvParent=0};c.prototype.getParentLine=function(){return this.parent};c.prototype.setParentLine=function(b){this.parent=b};c.prototype.getParentMoveIndex=function(){return this.inxMvParent};c.prototype.setParentMoveIndex=function(b){this.inxMvParent=b};c.prototype.getTreeMoveCount=
function(){return this.reduce(function(b,d){return b+d.getTreeMoveCount()},0)};c.prototype.setSubParentData=function(b){this.forEach(function(d,c){d.setSubParentData(this,c,b)}.bind(this))};c.prototype.swapMoves=function(b,d){var c=[b,this.length-b];if(d)for(var f=0,g=d.length;f<g;++f)c.push(d[f]);c=this.splice.apply(this,c);this.setSubParentData();c=[0,d.length].concat(c);d.splice.apply(d,c);d.setSubParentData();d.setParentLine(this);return d};c.prototype.selfTest=function(b,d,c){CBDebug.assert(this.inxMvParent===
c);CBDebug.assert(!d||null!=this.getParentMove()&&0<=this.getParentMove().indexOfLine(this));b=ObjUtil.clone(b);c=0;for(var f=this.length;c<f;++c){var g=this[c];if(g.hasLines()){CBDebug.assert(!d||c);for(var h=g.getSubLines(),k=0;k<h.length;++k)h[k].selfTest(ObjUtil.clone(b),this,c)}b.makeMove(g)}};c.prototype.getParentMove=function(){return this.parent?this.parent[this.inxMvParent]:null};c.prototype.toString=function(){return this.join(" ")};c.readFactory=createReadFactory(c);c.readFactory2=createReadFactory2(c);
c.prototype.read=function(b){b.readArray(this,CB.Veh.readFactory);this.setSubParentData();this.Vf3()};c.prototype.read2=function(b){var d=b.readUint8();d&128&&(d=(d<<8|b.readUint8())&32767);if(0<d){if(2048<d)return!1;if(0<d){this.length=d;for(var c=0;c<d;c++){var f=new CB.Veh;f.read2(b);this[c]=f}}}else if(0>d)return!1;this.setSubParentData();this.Vf3()};c.prototype.write=function(b){this.Vf4();b.writeArray(this)};c.prototype.write2=function(b){this.Vf4();2048>=this.length&&(this.length&-128&&b.writeUint8(this.length<<
8|128),b.writeUint8(this.length&255));for(var d=0;d<this.length;d++)this[d].write2(b)};c.prototype.hasLines=function(){return this.some(function(b){return b.hasLines()})};c.prototype.Vf3=function(){for(var b=1;b<this.length;b++)if(this[b].hasAnno()&&this[b].getAnno().hasTraining()){var d=this[b].getAnno().getTraining();this[b].getAnno().setTraining(null);this[b-1].setAnnoItem(CB.AnnoType.Vf5,d)}};c.prototype.Vf4=function(){for(var b=this.length-2;0<=b;b--)if(this[b].hasAnno()&&this[b].getAnno().hasTraining()){var d=
this[b].getAnno().getTraining();this[b].getAnno().setTraining(null);this[b+1].setAnnoItem(CB.AnnoType.Vf5,d)}};c.prototype.isAnnotated=function(){return this.some(function(b){return b.hasLines()||b.hasAnno()})};c.prototype.setAnno=function(b){this.anno=b};c.prototype.getAnno=function(b){return this.anno};c.prototype.setAnnoItem=function(b,d){this.anno||(this.anno=new CB.Annotation);this.anno.setItem(b,d)};c.prototype.hasAnno=function(){return void 0!==this.anno};c.prototype.unAnnotate=function(){this.forEach(function(b){b.unAnnotate()})};
c.prototype.forAllMoves=function(b){this.forEach(function(d){d.forAllMoves(b)})};c.prototype.removeLines=function(){this.forEach(function(b){b.removeLines()})};return c}();"use strict";
CB.Vf6=function(){var c=function(b,d){this.line=void 0!=b?b:null;this.mvsToGo=void 0!=d?d:0};c.prototype.getLine=function(){return this.line};c.prototype.getMovesToGo=function(){return this.mvsToGo};c.prototype.setMovesToGo=function(b){this.mvsToGo=b};c.prototype.incMovesToGo=function(){++this.mvsToGo};c.prototype.decMovesToGo=function(){--this.mvsToGo};c.prototype.isLineEnd=function(){return this.line.length===this.mvsToGo};c.prototype.isLineStart=function(){return 0===this.mvsToGo};c.prototype.pushMove=
function(b){this.line.length=this.mvsToGo;this.line.push(b);++this.mvsToGo};c.prototype.deleteRemaining=function(){this.line.length=this.mvsToGo};c.prototype.deletePrevious=function(){this.line.splice(0,this.mvsToGo-1);this.mvsToGo=1;this.line.setSubParentData();this.line.Vf2();return this.line};c.prototype.shallowClone=function(){return new c(this.line,this.mvsToGo)};return c}();
CB.LineStack=function(){var c=function(b,d){b&&(d||(d=0),this.push(new CB.Vf6(b,d)))};c.prototype=[];c.prototype.Top=function(){return this[this.length-1]};c.prototype.shallowClone=function(){var b=new CB.LineStack;b.length=this.length;for(var d=0,c=this.length;d<c;++d)b[d]=this[d].shallowClone();return b};c.prototype.deleteRemaining=function(){this.Top().deleteRemaining()};c.prototype.deletePrevious=function(){var b=this.Top(),d=b.deletePrevious();this.length=0;this.push(b);return d};c.prototype.gotoPrev=
function(){var b=this.Top();b&&(b.decMovesToGo(),1<this.length&&0===b.getMovesToGo()&&this.pop())};c.prototype.promoteLine=function(){var b=this.Top();if(b){var d=b.getLine(),c=b.getMovesToGo(),b=d.getParentLine(),f=d.getParentMoveIndex(),g=b[f],h=g.indexOfLine(d);g.removeLine(d);var k=d[0];g.moveLinesTo(k);b.swapMoves(f,d);k.insertLine(h,d);c+=f;this.pop();b=this.Top();b.setMovesToGo(c)}};c.prototype.Vf7=function(){for(var b=[],d=null,c=0,f=this.length;c<f;++c){var g=this[c],h=g.getLine(),g=g.getMovesToGo(),
k=0;d&&(k=d.indexOfLine(h));b.push({inxLine:k,mvsToGo:g});d=h[g]}return b};c.prototype.selfTest=function(){for(var b=null,d=0,c=0,f=this.length;c<f;++c){var g=this[c],h=g.getLine(),g=g.getMovesToGo();CBDebug.assert(h.getParentLine()===b);CBDebug.assert(h.getParentMoveIndex()===d);CBDebug.assert(!b||0<=h.getParentMove().indexOfLine(h));b=h;d=g}};return c}();"use strict";
CB.Position=function(){function c(b,d){this.piece=b;this.field=d}function b(b,d){return function(c){return c===b||d&&c===d}}var d=function(b){this.Vf8();b?this.Vf9(b):this.initStartPos()};d.NOEP=-1;d.prototype.V42=function(b){for(var d=0;d<this.board.length;++d)this.board[d]=b.board[d];this.sd=b.sd;this.ep=b.ep;this.cr=b.cr;this.Vfa=b;this.numPly=b.numPly};d.prototype.equals=function(b){if(!b||this.sd!=b.sd||this.ep!=b.ep||this.cr!=b.cr)return!1;for(var d=0;d<this.board.length;++d)if(this.board[d]!==
b.board[d])return!1;return!0};d.prototype.Vfb=function(b,d){return idiv(b,2)+1};d.mvToPlyNum=function(b,d){return 2*(b-1)+d};d.prototype.getMoveNum=function(){return this.Vfb(this.numPly,this.sd)};d.prototype.setMoveNum=function(b){this.numPly=d.mvToPlyNum(b,this.sd)};d.prototype.getPlyNum=function(){return this.numPly};d.prototype.initStartPos=function(){this.sd=CB.Vaz.WHITE;for(var b=CB.Vbf.Vdb;b<=CB.Vbf.Vdi;++b)this.board[CB.Vbf.I(b,CB.Vbf.Vdk)]=CB.Piece.Vl,this.board[CB.Vbf.I(b,CB.Vbf.Vdp)]=CB.Piece.Vm;
this.board[CB.Vbf.Vbk]=this.board[CB.Vbf.Vd3]=CB.Piece.Vf;this.board[CB.Vbf.Vbs]=this.board[CB.Vbf.Vcv]=CB.Piece.Vj;this.board[CB.Vbf.Vc0]=this.board[CB.Vbf.Vco]=CB.Piece.Vh;this.board[CB.Vbf.Vc8]=CB.Piece.Vd;this.board[CB.Vbf.Vcg]=CB.Piece.Vb;this.board[CB.Vbf.Vbr]=this.board[CB.Vbf.Vda]=CB.Piece.Vg;this.board[CB.Vbf.Vbz]=this.board[CB.Vbf.Vd2]=CB.Piece.Vk;this.board[CB.Vbf.Vc7]=this.board[CB.Vbf.Vcu]=CB.Piece.Vi;this.board[CB.Vbf.Vcf]=CB.Piece.Ve;this.board[CB.Vbf.Vcn]=CB.Piece.Vc;this.cr=CB.Vb7.Vbe;
this.numPly=this.Vfa=0};d.prototype.boardEquals=function(b){for(var d=0;64>d;d++)if(this.board[d]!=b[d])return!1;return!0};d.prototype.Vf9=function(b){b=new StringIterator(b);var c=CB.Vbf.Vdq,g=CB.Vbf.Vdb,h;for(h=b.Next();0!==h&&!Char.IsWhiteSpace(h);h=b.Next())if("/"===h)--c,g=CB.Vbf.Vdb;else if(Char.IsDigit(h))g+=Number(h);else{var k=CB.Vbf.I(g,c);h=CB.Piece.fromString(h);CBDebug.assert(h!==CB.Piece.V5k);this.board[k]=h;g++}b.isEOF()||(b.skipWhile(Char.IsWhiteSpace),b.isEOF()||(this.sd=CB.Vaz.fromString(b.Current()),
b.skipWhile(Char.IsWhiteSpace),b.isEOF()||(c=b.AcceptUntil(Char.IsWhiteSpace,!0),this.cr=CB.Vb7.fromString(c),b.isEOF()||(b.skipWhile(Char.IsWhiteSpace),c=b.AcceptUntil(Char.IsWhiteSpace,!0),"-"===c?this.ep=d.NOEP:(c=CB.Vbf.fromString(c),this.ep=CB.Vbf.Vdz(c)),b.skipWhile(Char.IsWhiteSpace),c=b.AcceptUntil(Char.IsWhiteSpace,!0),this.Vfa=Number(c),b.skipWhile(Char.IsWhiteSpace),b=b.AcceptUntil(Char.IsWhiteSpace,!0),(b=Number(b))||(b=1),this.numPly=d.mvToPlyNum(b,this.sd)))))};d.prototype.Vfc=function(b){this.Vfd();
for(var d=b.length,c=!1,h=0;h<d;h++)if(("b"==b[h]||"s"==b[h])&&"K"==b[h+1]){c="s"==b[h];break}for(var k=0,l=0,h=0;h<d;h++)switch(b[h]){case "K":k=CB.Piece.KING;break;case "D":case "Q":k=CB.Piece.QUEEN;break;case "T":case "R":k=CB.Piece.ROOK;break;case "L":k=CB.Piece.BISHOP;break;case "B":k=c?CB.Piece.PAWN:CB.Piece.BISHOP;break;case "S":case "N":k=CB.Piece.KNIGHT;break;case "P":k=CB.Piece.PAWN;break;case "a":case "b":case "c":case "d":case "e":case "f":case "g":case "h":48<b.charCodeAt(h+1)&&57>b.charCodeAt(h+
1)?this.board[(b.charCodeAt(h)-97<<3)+b.charCodeAt(h+1)-49]=k|l:"b"!=b[h]||c||(l=CB.Piece.BLACK);break;case "s":c&&(l=CB.Piece.BLACK);break;case "w":l=CB.Piece.WHITE;break;case ":":this.Vfe(b.slice(h+1)),h=d}0==this.cr&&(this.board[CB.Vbf.Vcg]==CB.Piece.Vb&&(this.board[CB.Vbf.Vd3]==CB.Piece.Vf?this.cr|=CB.Vb7.Vb9:this.board[CB.Vbf.Vbk]==CB.Piece.Vf&&(this.cr|=CB.Vb7.Vb8)),this.board[CB.Vbf.Vcn]==CB.Piece.Vc&&(this.board[CB.Vbf.Vda]==CB.Piece.Vg?this.cr|=CB.Vb7.Vbb:this.board[CB.Vbf.Vbr]==CB.Piece.Vg&&
(this.cr|=CB.Vb7.Vba)))};d.prototype.Vfe=function(b){"b"==b[0]&&(this.sd=CB.Vaz.BLACK)};d.prototype.Vff=function(){return this.makeMove(new CB.Veh(0,0))};d.prototype.Vfg=function(){return this.unmakeMove(new CB.Veh(0,0))};d.prototype.makeMove=function(b){if(b){var c=new CB.Vee(this,b);++this.numPly;this.sd=CB.Vaz.other(this.sd);var g=this.ep;this.ep=d.NOEP;if(b.isNullMove())return c;var h=this.board[b.from],k=this.board[b.to];this.board[b.to]=this.board[b.from];this.board[b.from]=CB.Piece.V5k;var l=
CB.Vbf.R(b.from),m=CB.Vbf.R(b.to),p=CB.Vbf.Vdz(b.from),r=CB.Vbf.Vdz(b.to);CB.Piece.Vb3(h)===CB.Piece.PAWN&&(r!==p&&r===g&&k===CB.Piece.V5k&&(k=CB.Piece.Vb4(h),g=CB.Vbf.I(r,l),this.board[g]=CB.Piece.V5k,c.Vef(k,g)),b.prom!==CB.Piece.V5k&&(k=CB.Piece.Vb5(b.prom,CB.Piece.side(h)),this.board[b.to]=k),2===Math.abs(l-m)&&(this.ep=p));CB.Piece.Vb3(h)===CB.Piece.KING&&2===Math.abs(r-p)&&(r===CB.Vbf.Vdh?(h=CB.Vbf.I(CB.Vbf.Vdi,l),l=CB.Vbf.I(CB.Vbf.Vdg,l)):(h=CB.Vbf.I(CB.Vbf.Vdb,l),l=CB.Vbf.I(CB.Vbf.Vde,l)),
this.board[l]=this.board[h],this.board[h]=CB.Piece.V5k,c.Veg(h,l));if(this.cr){if(this.cr&CB.Vb7.Vbc)if(b.from===CB.Vbf.Vcg)this.cr&=~CB.Vb7.Vbc;else if(b.from===CB.Vbf.Vbk||b.to===CB.Vbf.Vbk)this.cr&=~CB.Vb7.Vb8;else if(b.from===CB.Vbf.Vd3||b.to===CB.Vbf.Vd3)this.cr&=~CB.Vb7.Vb9;if(this.cr&CB.Vb7.Vbd)if(b.from===CB.Vbf.Vcn)this.cr&=~CB.Vb7.Vbd;else if(b.from===CB.Vbf.Vbr||b.to===CB.Vbf.Vbr)this.cr&=~CB.Vb7.Vba;else if(b.from===CB.Vbf.Vda||b.to===CB.Vbf.Vda)this.cr&=~CB.Vb7.Vbb}return c}};d.prototype.unmakeMove=
function(b,d){!b.isNullMove()&&(this.board[b.from]=d.mvd,this.board[b.to]=CB.Piece.V5k,this.board[d.fldVct]=d.vct,d.to2||d.from2)&&(this.board[d.from2]=this.board[d.to2],this.board[d.to2]=CB.Piece.V5k);this.cr=d.cr;this.ep=d.ep;--this.numPly;this.sd=CB.Vaz.other(this.sd)};d.prototype.V34r=function(){var b=this.Vfh();return this.filterLegals(b)};d.prototype.Vfh=function(b){for(var d=[],c=0;c<this.board.length;++c){var h=this.board[c];h!==CB.Piece.V5k&&(b&&h!==b||CB.Piece.side(h)===this.sd&&this.Vfi(c,
h,d))}return d};d.prototype.Vfj=function(b,d){d||(d=this.board[b]);var c=[];this.Vfi(b,d,c);return c};d.prototype.Vfk=function(b,d){var c=this.Vfj(b,d);return this.filterLegals(c)};d.prototype.Vfi=function(b,d,c){switch(d){case CB.Piece.Vl:case CB.Piece.Vm:this.Vfl(d,b,c);break;case CB.Piece.Vj:case CB.Piece.Vk:this.Vfm(d,b,c);break;case CB.Piece.Vh:case CB.Piece.Vi:this.Vfn(d,b,c);break;case CB.Piece.Vf:case CB.Piece.Vg:this.Vfo(d,b,c);break;case CB.Piece.Vd:case CB.Piece.Ve:this.Vfp(d,b,c);break;
case CB.Piece.Vb:case CB.Piece.Vc:this.Vfq(d,b,c)}};d.prototype.Vfr=function(b,d){return this.Vfh(d).filter(function(d){return d.to===b})};d.g_arrKnightMvs=[[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[1,-2],[2,-1]];d.g_arrKingMvs=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];d.g_arrBishopMvs=[[1,1],[-1,1],[-1,-1],[1,-1]];d.g_arrRookMvs=[[1,0],[0,1],[-1,0],[0,-1]];d.prototype.Vfm=function(b,c,g){this.Vfs(b,c,d.g_arrKnightMvs,!1,g)};d.prototype.Vfq=function(b,c,g){this.Vfs(b,c,d.g_arrKingMvs,
!1,g);if(b===CB.Piece.Vb){if(!(this.cr&CB.Vb7.Vbc)||this.Vft(CB.Vbf.Vcg,CB.Vaz.BLACK))return;this.cr&CB.Vb7.Vb9&&this.board[CB.Vbf.Vco]===CB.Piece.V5k&&this.board[CB.Vbf.Vcv]===CB.Piece.V5k&&(this.Vft(CB.Vbf.Vco,CB.Vaz.BLACK)||this.Vft(CB.Vbf.Vcv,CB.Vaz.BLACK)||g.push(CB.Veh.g_mvW00));this.cr&CB.Vb7.Vb8&&this.board[CB.Vbf.Vc8]===CB.Piece.V5k&&this.board[CB.Vbf.Vc0]===CB.Piece.V5k&&this.board[CB.Vbf.Vbs]===CB.Piece.V5k&&(this.Vft(CB.Vbf.Vc8,CB.Vaz.BLACK)||this.Vft(CB.Vbf.Vc0,CB.Vaz.BLACK)||g.push(CB.Veh.g_mvW000))}b===
CB.Piece.Vc&&this.cr&CB.Vb7.Vbd&&!this.Vft(CB.Vbf.Vcn,CB.Vaz.WHITE)&&(this.cr&CB.Vb7.Vbb&&this.board[CB.Vbf.Vcu]===CB.Piece.V5k&&this.board[CB.Vbf.Vd2]===CB.Piece.V5k&&(this.Vft(CB.Vbf.Vcu,CB.Vaz.WHITE)||this.Vft(CB.Vbf.Vd2,CB.Vaz.WHITE)||g.push(CB.Veh.g_mvB00)),this.cr&CB.Vb7.Vba&&this.board[CB.Vbf.Vcf]===CB.Piece.V5k&&this.board[CB.Vbf.Vc7]===CB.Piece.V5k&&this.board[CB.Vbf.Vbz]===CB.Piece.V5k&&(this.Vft(CB.Vbf.Vcf,CB.Vaz.WHITE)||this.Vft(CB.Vbf.Vc7,CB.Vaz.WHITE)||g.push(CB.Veh.g_mvB000)))};d.prototype.Vfo=
function(b,c,g){this.Vfs(b,c,d.g_arrRookMvs,!0,g)};d.prototype.Vfn=function(b,c,g){this.Vfs(b,c,d.g_arrBishopMvs,!0,g)};d.prototype.Vfp=function(b,d,c){this.Vfo(b,d,c);this.Vfn(b,d,c)};d.prototype.Vfl=function(b,d,c){var h=b===CB.Piece.Vl?1:-1,k=b===CB.Piece.Vl?CB.Vbf.Vdq:CB.Vbf.Vdj,l=CB.Vbf.Vdz(d),m=CB.Vbf.R(d),p=CB.Piece.side(b),r=m+h,u=CB.Vbf.I(l,r),k=r===k;this.board[u]===CB.Piece.V5k&&(k?(c.push(new CB.Veh(d,u,CB.Piece.QUEEN)),c.push(new CB.Veh(d,u,CB.Piece.ROOK)),c.push(new CB.Veh(d,u,CB.Piece.BISHOP)),
c.push(new CB.Veh(d,u,CB.Piece.KNIGHT))):(u=new CB.Veh(d,u),c.push(u)),b===CB.Piece.Vl&&m===CB.Vbf.Vdk||b===CB.Piece.Vm&&m===CB.Vbf.Vdp)&&(u=CB.Vbf.I(l,m+2*h),this.board[u]===CB.Piece.V5k&&(u=new CB.Veh(d,u),c.push(u)));for(u=-1;1>=u;u+=2){var q=l+u,r=m+h;if(CB.Vbf.isLegal(q,r)){var r=CB.Vbf.I(q,r),t=this.board[r];if(t!==CB.Piece.V5k&&CB.Piece.side(t)!==p)if(k)c.push(new CB.Veh(d,r,CB.Piece.QUEEN)),c.push(new CB.Veh(d,r,CB.Piece.ROOK)),c.push(new CB.Veh(d,r,CB.Piece.BISHOP)),c.push(new CB.Veh(d,r,
CB.Piece.KNIGHT));else{var v=new CB.Veh(d,r);c.push(v)}t===CB.Piece.V5k&&q===this.ep&&(t=p===CB.Vaz.WHITE?CB.Vbf.Vdn:CB.Vbf.Vdm,q=CB.Vbf.I(q,t),q=this.board[q],m===t&&q===CB.Piece.Vb4(b)&&(r=new CB.Veh(d,r),c.push(r)))}}};d.prototype.Vfs=function(b,d,c,h,k){b=CB.Piece.side(b);for(var l=CB.Vbf.R(d),m=CB.Vbf.Vdz(d),p=0,r=c.length;p<r;++p){var u=c[p],q=m,t=l,v=h;do{q+=u[0];t+=u[1];if(!CB.Vbf.isLegal(q,t))break;var w=CB.Vbf.I(q,t),y=this.board[w];if(y!==CB.Piece.V5k)if(CB.Piece.side(y)===b)break;else v=
!1;w=new CB.Veh(d,w);k.push(w)}while(v)}};d.prototype.filterLegals=function(b){var d=this;return b.filter(function(b){return!d.isSuicideMove(b)})};d.prototype.isProm=function(b,d){var c=this.sd;return this.board[b]==CB.Piece.Vb5(CB.Piece.PAWN,c)&&CB.Vbf.R(d)==CB.Vbf.Ve5(c)};d.prototype.isLegalFromTo=function(b,d){var c=new CB.Veh(b,d);this.isProm(b,d)&&(c.prom=CB.Piece.QUEEN);return this.isLegalMove(c)};d.prototype.isLegalMove=function(b){return null!=b&&(b.isNullMove()||this.Vfu(b))&&!this.isSuicideMove(b)};
d.prototype.Vfu=function(b){if(null==b)return!1;var d=b.from,c=b.to;if(d===c)return!1;var h=this.board[d];if(h===CB.Piece.V5k||CB.Piece.side(h)!==this.sd)return!1;c=this.board[c];return c!==CB.Piece.V5k&&CB.Piece.side(h)===CB.Piece.side(c)?!1:this.Vfj(d,h).some(b.equals.bind(b))};d.prototype.isSuicideMove=function(b){var d=this.makeMove(b),c=this.Vfv();this.unmakeMove(b,d);return c};d.prototype.Vf8=function(){this.board=Array(CB.Ve6.Ve7);this.Vfd()};d.prototype.Vfd=function(){for(var b=0;64>b;b++)this.board[b]=
CB.Piece.V5k;this.sd=CB.Vaz.WHITE;this.cr=0;this.ep=d.NOEP;this.numPly=this.Vfa=0};d.prototype.toFEN=function(){for(var b="",c=CB.Vbf.Vdq;c>=CB.Vbf.Vdj;--c){for(var g=0,h=CB.Vbf.Vdb;h<=CB.Vbf.Vdi;++h){var k=CB.Vbf.I(h,c),k=this.board[k];k===CB.Piece.V5k?++g:(0<g&&(b+=g),g=0,b+=CB.Piece.toString(k))}0<g&&(b+=g);c>CB.Vbf.Vdj&&(b+="/")}b=b+" "+CB.Vaz.toString(this.sd);b=b+" "+CB.Vb7.toString(this.cr);b+=" ";this.ep===d.NOEP?b+="-":(c=this.getEPField(),b+=CB.Vbf.toString(c));b+=" 0 ";c=this.getMoveNum();
return b+c};d.prototype.toString=d.prototype.toFEN;d.prototype.Vfw=function(){for(var b=" KQNBRP".split(""),d="",c=[],h=[],k=0;16>k;k++)c.push([0,0,0,0,0,0,0,0,0,0]),h[k]=0;for(k=0;64>k;k++){var l=this.board[k]&15;l&&16>h[l]&&(c[l][h[l]++]=k)}d+="w";for(k=1;7>k;k++)if(0<h[k]){1<k&&(d+=",");for(var l=b[k],d=d+String(l),m=0;m<h[k];m++)l=c[k][m],d+=CB.Vbf.toString(l),m<h[k]-1&&(d+=",")}d+="/b";for(k=9;15>k;k++)if(0<h[k])for(9<k&&(d+=","),l=b[k&7],d+=String(l),m=0;m<h[k];m++)l=c[k][m],d+=CB.Vbf.toString(l),
m<h[k]-1&&(d+=",");return d};d.prototype.getPiece=function(b){return this.board[b]};d.prototype.getPieces=function(){for(var b=[],d=0;d<this.board.length;++d){var g=this.board[d];g!==CB.Piece.V5k&&(g=new c(g,d),b.push(g))}return b};c.prototype.toString=function(){var b=CB.Piece.Vb3(this.piece);return CB.Piece.toString(b)+CB.Vbf.toString(this.field)};c.prototype.equals=function(b){return this.piece===b.piece&&this.field===b.field};d.prototype.getSideToMove=function(){return this.sd};d.prototype.isWTM=
function(){return this.sd===CB.Vaz.WHITE};d.prototype.isBTM=function(){return this.sd===CB.Vaz.BLACK};d.prototype.setBTM=function(b){this.sd=b?CB.Vaz.BLACK:CB.Vaz.WHITE};d.prototype.getBTM=d.prototype.isBTM;d.prototype.setCastleRights=function(b){this.cr=b};d.prototype.Vfx=function(){return this.ep===d.NOEP?-1:this.ep%8};d.prototype.getCPPEPFile=function(){return this.ep===d.NOEP?0:this.ep%8+1};d.prototype.setCPPEPFile=function(b){this.ep=0>=b?d.NOEP:b-1};d.prototype.getEPField=function(){return this.ep===
d.NOEP?-1:CB.Vbf.I(this.ep,this.sd===CB.Vaz.WHITE?CB.Vbf.Vdo:CB.Vbf.Vdl)};d.prototype.getEPCol=function(){return this.ep};d.prototype.getEPVictimField=function(){return this.ep===d.NOEP?-1:CB.Vbf.I(this.ep,this.sd===CB.Vaz.WHITE?CB.Vbf.Vdn:CB.Vbf.Vdm)};d.prototype.getCastleRights=function(){return this.cr};d.prototype.Vfy=function(){var b=0;this.board[CB.Vbf.Vcg]===CB.Piece.Vb&&(this.board[CB.Vbf.Vbk]===CB.Piece.Vf&&(b|=CB.Vb7.Vb8),this.board[CB.Vbf.Vd3]===CB.Piece.Vf&&(b|=CB.Vb7.Vb9));this.board[CB.Vbf.Vcn]===
CB.Piece.Vc&&(this.board[CB.Vbf.Vbr]===CB.Piece.Vg&&(b|=CB.Vb7.Vba),this.board[CB.Vbf.Vda]===CB.Piece.Vg&&(b|=CB.Vb7.Vbb));return b};d.prototype.Vfz=function(){for(var b=[],d=this.sd==CB.Vaz.WHITE?CB.Vbf.Vdn:CB.Vbf.Vdm,c=CB.Piece.Vb5(CB.Piece.PAWN,this.sd),h=CB.Piece.Vb4(c),k=CB.Vbf.Vdb;k<=CB.Vbf.Vdi;++k){var l=CB.Vbf.I(k,d);this.board[l]===h&&(k>CB.Vbf.Vdb&&this.board[CB.Vbf.I(k-1,d)]===c||k<CB.Vbf.Vdi&&this.board[CB.Vbf.I(k+1,d)]===c)&&b.push(k)}return b};d.prototype.Vft=function(b,d){return 0<
this.Vg0(b,d).length};d.prototype.Vg0=function(b,d){var c=[];this.Vg1(b,d,c);return c};d.prototype.Vg1=function(b,d,c){this.getPawnAttacksTo(b,d,c);this.getKnightAttacksTo(b,d,c);this.getKingAttacksTo(b,d,c);this.Vg2(b,d,c)};d.prototype.getKnightAttacksTo=function(c,f,g){this.Vg3(c,f,d.g_arrKnightMvs,b(CB.Piece.Vb5(CB.Piece.KNIGHT,f)),!1,g)};d.prototype.getKingAttacksTo=function(c,f,g){this.Vg3(c,f,d.g_arrKingMvs,b(CB.Piece.Vb5(CB.Piece.KING,f)),!1,g)};d.prototype.getQueenAttacksTo=function(c,f,g){this.Vg3(c,
f,d.g_arrBishopMvs,b(CB.Piece.Vb5(CB.Piece.QUEEN,f)),!0,g);this.Vg3(c,f,d.g_arrRookMvs,b(CB.Piece.Vb5(CB.Piece.QUEEN,f)),!0,g)};d.prototype.getPawnMovesTo=function(b,d,c){if(this.board[b]===CB.Piece.V5k){var h=CB.Vbf.R(b),k=CB.Vbf.Vdz(b);if(d!==CB.Vaz.WHITE||h!==CB.Vbf.Vdj&&h!==CB.Vbf.Vdk)if(d!==CB.Vaz.BLACK||h!==CB.Vbf.Vdq&&h!==CB.Vbf.Vdp){var l=d===CB.Vaz.WHITE?-1:1;b=CB.Piece.Vb5(CB.Piece.PAWN,d);d=d===CB.Vaz.WHITE?CB.Vbf.Vdm:CB.Vbf.Vdn;var m=CB.Vbf.I(k,h+l);this.board[m]===b?c.push(m):h===d&&
this.board[m]===CB.Piece.V5k&&(h=CB.Vbf.I(k,h+2*l),this.board[h]===b&&c.push(h))}}};d.prototype.getBishopAttacksTo=function(c,f,g){this.Vg3(c,f,d.g_arrBishopMvs,b(CB.Piece.Vb5(CB.Piece.BISHOP,f)),!0,g)};d.prototype.getRookAttacksTo=function(c,f,g){this.Vg3(c,f,d.g_arrRookMvs,b(CB.Piece.Vb5(CB.Piece.ROOK,f)),!0,g)};d.prototype.Vg2=function(c,f,g){this.Vg3(c,f,d.g_arrRookMvs,b(CB.Piece.Vb5(CB.Piece.ROOK,f),CB.Piece.Vb5(CB.Piece.QUEEN,f)),!0,g);this.Vg3(c,f,d.g_arrBishopMvs,b(CB.Piece.Vb5(CB.Piece.BISHOP,
f),CB.Piece.Vb5(CB.Piece.QUEEN,f)),!0,g)};d.g_arrWhPawnAttks=[[1,1],[-1,1]];d.g_arrBlPawnAttks=[[1,-1],[-1,-1]];d.prototype.getPawnAttacksTo=function(c,f,g){f===CB.Vaz.WHITE?this.Vg3(c,f,d.g_arrWhPawnAttks,b(CB.Piece.Vl),!1,g):this.Vg3(c,f,d.g_arrBlPawnAttks,b(CB.Piece.Vm),!1,g)};d.prototype.Vg3=function(b,d,c,h,k,l){var m=CB.Vbf.R(b);b=CB.Vbf.Vdz(b);for(var p=0,r=c.length;p<r;++p){var u=c[p],q=b,t=m,v=k;do{q-=u[0];t-=u[1];if(!CB.Vbf.isLegal(q,t))break;var w=CB.Vbf.I(q,t),y=this.board[w];if(y!==CB.Piece.V5k){if(CB.Piece.side(y)!==
d)break;else v=!1;h(y)&&l.push(w)}}while(v)}};d.prototype.Vg4=function(b){b=CB.Piece.Vb5(CB.Piece.KING,b);return this.board.indexOf(b)};d.prototype.isCheck=function(){var b=this.Vg4(this.sd),d=CB.Vaz.other(this.sd);return this.Vft(b,d)};d.prototype.Vfv=function(){var b=CB.Vaz.other(this.sd),b=this.Vg4(b);return this.Vft(b,this.sd)};d.prototype.isMate=function(){return this.isCheck()?!this.hasLegals():!1};d.prototype.Vg5=function(){return this.isCheck()?!1:!this.hasLegals()};d.prototype.swapSide=function(){return this.isCheck()||
this.isMate()||this.Vg5()?!1:(this.makeMove(new CB.Veh),!0)};d.prototype.hasLegals=function(){return 0<this.V34r().length};d.prototype.getVictim=function(b){var d=this.board[b.to];return d!==CB.Piece.V5k?d:CB.Piece.Vb3(this.board[b.from])===CB.Piece.PAWN&&CB.Vbf.Vdz(b.from)!==CB.Vbf.Vdz(b.to)?(b=CB.Vbf.I(CB.Vbf.Vdz(b.to),CB.Vbf.R(b.from)),this.board[b]):CB.Piece.V5k};d.prototype.isTake=function(b){return tgis.getVictim(b)!==CB.Piece.V5k};d.prototype.Vg6=function(b){var d=b.from,c=this.board[d],h=
{needCol:!1,needRow:!1},k=CB.Piece.Vb3(c);if(k===CB.Piece.PAWN||k===CB.Piece.KING)return h;for(var l=[],m=0;m<CB.Ve6.Ve7;++m)this.board[m]===c&&m!==d&&l.push(m);if(!l.length||k===CB.Piece.BISHOP&&l.every(function(b){return CB.Vbf.Ve3(b)!==CB.Vbf.Ve3(d)}))return h;for(var m=k=!0,p=!1,r=0,u=l.length;r<u;++r){var q=l[r];this.Vfj(q,c).some(function(d){return d.to===b.to})&&(p=!0,k&=CB.Vbf.Vdz(q)!==CB.Vbf.Vdz(d),m&=CB.Vbf.R(q)!==CB.Vbf.R(d))}p&&(h.needCol=k||!m,h.needRow=!k);return h};d.prototype.preCalcCtx=
function(b){this.Vg7(b);if(!b.isNullMove()){var d=this.Vg6(b);b.setNeedCol(d.needCol);b.setNeedRow(d.needRow)}};d.prototype.Vg7=function(b){if(b.isNullMove())b.setMoved(CB.Piece.Vb5(CB.Piece.PAWN,this.sd)),b.setVictim(CB.Piece.V5k);else{b.setMoved(this.board[b.from]);var d=this.getVictim(b);b.setVictim(d);b.setIsCastling()}};d.prototype.postCalcCtx=function(b,d){if(b.isNullMove())b.setCheck(!1);else{var c=this.isCheck();b.setCheck(c);c&&d&&b.setMate(!this.hasLegals())}};d.prototype.read=function(b){this.board=
b.readByteArray(CB.Ve6.Ve7);this.sd=b.readInt();this.ep=b.readByte()-1;this.cr=b.readByte();this.numPly=0};d.prototype.write=function(b){b.writeByteArray(this.board,CB.Ve6.Ve7);b.writeInt(this.sd);b.writeByte(this.ep+1);b.writeByte(this.cr)};d.prototype.copyTo=function(b){b.sd=this.sd;b.ep=this.ep;b.cr=this.cr;for(var d=0;64>d;d++)b.board[d]=this.board[d]};d.packBoard=function(b){for(var d=Array(32),c=0,h=d.length;c<h;++c)d[c]=b[2*c]|b[2*c+1]<<4;return d};d.unpackBoard=function(b){for(var d=Array(2*
b.length),c=0,h=b.length;c<h;++c)d[2*c]=b[c]&15,d[2*c+1]=b[c]>>4;return d};d.prototype.Vg8=function(b,d){for(var c=0;c<this.board.length;c++)CB.Piece.side(this.board[c])==d&&(b[c]=this.board[c])};d.prototype.setEquals=function(b){for(var d=0;d<this.board.length;d++)if(this.board[d]!=b.board[d])return!1;return this.sd!=b.sd||this.ep!=b.ep||this.cr!=b.cr?!1:!0};d.prototype.setGreater=function(b){for(var d=0;d<this.board.length;d++)if(this.board[d]!=b.board[d])return this.board[d]>b.board[d];return this.sd!=
b.sd?this.sd>b.sd:this.ep!=b.ep?this.ep>b.ep:this.cr!=b.cr?this.cr>b.cr:!1};d.prototype.Vg9=function(b){var d=new CB.Ve6;d.Ve9(this.board);d.Vec().forEach(void 0!==b?b:function(b){});d="s="+this.sd+", ep="+this.ep+", cr="+this.cr;void 0!==b&&b(d)};d.prototype.isLegal=function(){var b=this.getPieces();if(32<b.length||2>b.length)return!1;for(var d=Array(CB.Piece.Vm+1),c=0;c<d.length;++c)d[c]=0;for(c=0;c<b.length;++c){var h=b[c];++d[h.piece];if(CB.Piece.Vb3(h.piece)===CB.Piece.PAWN&&(h=CB.Vbf.R(h.field),
h==CB.Vbf.Vdj||h==CB.Vbf.Vdq))return!1}return 1!==d[CB.Piece.Vb]||1!==d[CB.Piece.Vc]||8<d[CB.Piece.Vl]||8<d[CB.Piece.Vm]?!1:!0};d.prototype.Vga=function(b){if(b.length!=this.board.length)return!1;for(var d=0;d<this.board.length;d++)if(this.board[d]!=b[d])return!1;return!0};d.prototype.Vgb=function(b){for(var d=[],c=0;c<this.board.length;c++)this.board[c]==b&&d.push(c);return d};return d}();"use strict";
CB.Annotation=function(){var c=function(){};c.prototype={};c.Vgc="[#]";c.prototype.toString=function(){var b="",d;for(d in this)this.hasOwnProperty(d)&&(b+=this[d].toString());return b};c.prototype.Vgd=function(b,d){for(var c=0;c<d;++c){var f=b.readShort(),g=AnnoRec.readHeader(b);CBDebug.assert(g.len===f,"LEN OK");g.len-=AnnoRec.ANNO_HEAD_SIZE;(f=AnnoFactory.factory(g.type))?(f.read(g.len,b),this.setItem(g.type,f)):b.skip(g.len)}return this};c.prototype.Vge=function(b,d){this.Vgd(b,d);return this};
c.prototype.write=function(b){var d=0,c;for(c in this)this.hasOwnProperty(c)&&d++;b.writeShort(d);for(c in this)this.hasOwnProperty(c)&&this[c].write(b,c)};c.prototype.write2=function(b){var d=[],c;for(c in this)this.hasOwnProperty(c)&&d.push(c);var f=b.getPos();b.writeByte(0);var g=0;for(c=0;c<d.length;c++)this[d[c]].write&&(this[d[c]].write(b,d[c]),g++);d=b.getPos();b.setPos(f);b.writeByte(g);b.setPos(d)};c.write=function(b,d){d?d.write(b):b.writeShort(0)};c.write2=function(b,d){d?d.write2(b):b.writeByte(0)};
c.prototype.read=function(b){var d=b.readShort();this.Vgd(b,d)};c.prototype.read2=function(b){var d=b.readByte();d&&this.Vge(b,d)};c.prototype.fromDataBuf=c.prototype.read;c.prototype.V35j=c.prototype.write;c.readFactory=function(b){var d=b.readShort();return d?(new CB.Annotation).Vgd(b,d):null};c.readFactory2=function(b){var d=b.readUint8();return d?(new CB.Annotation).Vge(b,d):null};c.prototype.empty=function(){for(var b in this)if(this.hasOwnProperty(b))return!1;return!0};c.prototype.count=function(){var b=
0,d;for(d in this)this.hasOwnProperty(d)&&b++;return b};c.prototype.setItem=function(b,d){this[b]=d};c.prototype.hasItem=function(b){return!!this[b]};c.prototype.getItem=function(b){return this[b]};c.prototype.deleteItem=function(b){delete this[b]};c.prototype.Vgf=function(b){this[CB.AnnoType.Vgg]=new CB.Vgh(b)};c.prototype.addPostText=function(b){this[CB.AnnoType.Vgi]&&this[CB.AnnoType.Vgi].m_str.length?this[CB.AnnoType.Vgi].addText(" "+b):this[CB.AnnoType.Vgi]=new CB.Vgh(b)};c.prototype.Vgj=function(){if(this[CB.AnnoType.Vgi]&&
this[CB.AnnoType.Vgi].m_str.length)return-1!=this[CB.AnnoType.Vgi].m_str.search("[#]")};c.prototype.toggleDiagram=function(){this[CB.AnnoType.Vgi]&&this[CB.AnnoType.Vgi].m_str.length?-1!=this[CB.AnnoType.Vgi].m_str.search("[#]")?(this[CB.AnnoType.Vgi].m_str=this[CB.AnnoType.Vgi].m_str.replace("[#]",""),this[CB.AnnoType.Vgi].m_str.length||delete this[CB.AnnoType.Vgi]):this[CB.AnnoType.Vgi].m_str+="[#]":this[CB.AnnoType.Vgi]=new CB.Vgh("[#]")};c.prototype.Vgk=function(){};c.prototype.Vgl=function(){return this.hasItem(CB.AnnoType.Vgg)};
c.prototype.Vgm=function(){if(this.Vgl())return this[CB.AnnoType.Vgg].getString()};c.prototype.getPostText=function(){if(this.Vgn())return this[CB.AnnoType.Vgi].getString()};c.prototype.Vgn=function(){return this.hasItem(CB.AnnoType.Vgi)};c.prototype.addSymbol=function(b){this[CB.AnnoType.Vgo]||(this[CB.AnnoType.Vgo]=new CB.Vgp);this[CB.AnnoType.Vgo].addSymbol(b)};c.prototype.Vgq=function(){return void 0!==this[CB.AnnoType.Vgo]};c.prototype.Vgr=function(){return this.hasItem(CB.AnnoType.SQUARE_LIST)};
c.prototype.Vgs=function(){return this.hasItem(CB.AnnoType.ARROW_LIST)};c.prototype.hasTraining=function(){return this.hasItem(CB.AnnoType.Vf5)};c.prototype.getTraining=function(){return this[CB.AnnoType.Vf5]};c.prototype.setTraining=function(b){b?this[CB.AnnoType.Vf5]=b:delete this[CB.AnnoType.Vf5]};return c}();"use strict";
CB.Vgt={Vgu:-1,BLACK_WINS:0,DRAW:1,WHITE_WINS:2,Vgv:3,Vgw:3,Vgx:3,isFinished:function(c){return c>=this.BLACK_WINS&&c<=this.WHITE_WINS},toString:function(c){switch(c){case this.Vgu:return lm.IN_PROGRESS;case this.WHITE_WINS:return"1\u20130";case this.BLACK_WINS:return"0\u20131";case this.DRAW:return"\u00bd\u2013\u00bd";case this.Vgw:return"";default:return""}},fromString:function(c){switch(c){case "\u00bd\u2013\u00bd":case "1/2-1/2":case "1/2":return this.DRAW;case "1\u20130":case "1-0":return this.WHITE_WINS;
case "0\u20131":case "0-1":return this.BLACK_WINS}}};CB.Vgy=function(){var c=function(b){this.n=b};c.prototype.isFinished=function(){return CB.Vgt.isFinished(this.n)};c.prototype.toString=function(){return CB.Vgt.toString(this.n)};c.prototype.toPGNString=function(){switch(this.n){default:return"*";case CB.Vgt.WHITE_WINS:return"1-0";case CB.Vgt.BLACK_WINS:return"0-1";case CB.Vgt.DRAW:return"1/2-1/2"}};return c}();
CB.Vgz=function(){var c=function(){this.white=new CB.PlayerData;this.black=new CB.PlayerData;this.event=new CB.EventData;this.player=[this.white,this.black];this.result=CB.Vgt.Vgv;this.clockParams=null};c.prototype.annotator="";c.prototype.round=0;c.prototype.subRound=0;c.prototype.board=0;c.prototype.eco="";c.prototype.result=CB.Vgt.Vgv;c.prototype.eloWh=0;c.prototype.eloBl=0;c.prototype.date=new CB.Date;c.prototype.clockParams=null;c.prototype.getStrPlayers=function(b,d){var c=this.white.getListStr(d||
0),f=this.black.getListStr(d||0);f&&f.length&&(b?(0<this.eloWh&&(c+=" ("+this.eloWh+")"),c=c+" - "+f,0<this.eloBl&&(c+=" ("+this.eloBl+")")):c=c+"-"+f);return c};c.prototype.toString=function(){var b=this.event.toString(),d=this.date.toLocaleString(),c=this.getStrPlayers(!0,999);b&&(c+=", "+b);d&&(c+=" "+d);return c};c.prototype.getWhite=function(){return this.white.toString()};c.prototype.getClockParams=function(){return this.clockParams};c.prototype.Vh0=function(b){this.clockParams=b};c.prototype.Vh1=
function(b){this.white.init(b)};c.prototype.getBlack=function(){return this.black.toString()};c.prototype.Vh2=function(b){this.black.init(b)};c.prototype.Vh3=function(){return this.eco};c.prototype.Vh4=function(b){this.eco=b};c.prototype.getEvent=function(){return this.event.event};c.prototype.Vh5=function(b){this.event.event=b};c.prototype.getAnnotator=function(){return this.annotator};c.prototype.Vh6=function(b){this.annotator=b};c.prototype.getSite=function(){return this.event.site};c.prototype.Vh7=
function(b){this.event.site=b};c.prototype.isDefined=function(){return this.getWhite()||this.getBlack()};c.prototype.getResult=function(){return this.result};c.prototype.getCBResult=function(){return new CB.Vgy(this.result)};c.prototype.setResult=function(b){var d=this.result;this.result="undefined"!=typeof b?b:CB.Vgt.Vgv;return d};c.prototype.Vh8=function(b){b&&(b=b.split("."),this.round=parseInt(b[0],10),1<b.length&&(this.subRound=parseInt(b[1],10)))};c.prototype.getRoundStr=function(){var b="";
this.round&&(b=""+this.round,this.subRound&&(b=b+"."+this.subRound));return b};c.prototype.getEloWhite=function(){return this.eloWh};c.prototype.Vh9=function(b){this.eloWh=b};c.prototype.getEloBlack=function(){return this.eloBl};c.prototype.Vha=function(b){this.eloBl=b};c.prototype.Vhb=function(){return Math.max(this.eloWh,this.eloBl)};c.prototype.Vhc=function(b){this.date=CB.Date.fromPGNString(b)};c.prototype.Vhd=function(){return this.date.toLocaleString()};c.prototype.getDateStr=function(){return this.date.toPGNString()};
c.prototype.setDeleted=function(b){this.flags=(this.deleted=b)?this.flags|1:this.flags&-2};c.prototype.read=function(b){this.white=CB.PlayerData.readFactory(b);this.black=CB.PlayerData.readFactory(b);try{this.event=CB.EventData.readFactory(b);CB.SourceData.readFactory(b);this.annotator=CB.AnnotatorData.readFactory(b).name;this.eloWh=b.readShort();this.eloBl=b.readShort();this.Vhe=b.V35e();this.eco=CB.Vgz.Vhf(this.Vhe);this.result=CB.Vgz.Vhg(b);this.date=new CB.Date;var d=b.readInt();this.date.V5c(d);
this.plyCount=b.readShort();this.round=b.readByte();this.subRound=b.readByte();b.readInt();b.readInt();b.skipSizedRead()}catch(c){return console.log(c),!1}return!0};c.prototype.compactFromDataBuf=function(b){b.beginSizedRead();this.eType=b.V35l();this.nGame=b.V35k();this.white=CB.PlayerData.readFactory(b);this.black=CB.PlayerData.readFactory(b);this.event=CB.EventData.readFactory(b);this.eloWh=b.V35l();this.eloBl=b.V35l();this.result=CB.Vgz.Vhg(b);this.date=new CB.Date;this.date.fromDataBuf(b);this.plyCount=
b.V35l();this.round=b.readByte();this.subRound=b.readByte();b.V35g();b.V35g();this.Vhe=b.V35e();this.eco=CB.Vgz.Vhf(this.Vhe);this.flags=b.V35e();this.deleted=!!(this.flags&1);b.endSizedRead()};c.prototype.compactToDataBuf=function(b){b.beginSizedWrite();void 0!==this.eType?b.V35f(this.eType):b.V35f(1);void 0!==this.nGame?b.V35h(this.nGame):b.V35h(0);this.white.write(b);this.black.write(b);this.event.write(b);b.writeShort(this.eloWh);b.writeShort(this.eloBl);c.Vhi(this.result,b);void 0===this.date&&
(this.date=new CB.Date(0));this.date.V35j(b);this.plyCount?b.V35f(this.plyCount):b.V35f(0);b.writeByte(this.round);b.writeByte(this.subRound);b.V351(0);b.V351(0);this.Vhe?b.V352(this.Vhe):b.V352(0);void 0===this.flags&&(this.flags=0);this.deleted&&(this.flags|=1);b.V352(this.flags);b.endSizedWrite()};c.prototype.write=function(b){this.white.write(b);this.black.write(b);this.event.write(b);(new CB.SourceData).write(b);(new CB.AnnotatorData(this.annotator)).write(b);b.writeShort(this.eloWh);b.writeShort(this.eloBl);
b.writeShort(0);c.Vhi(this.result,b);b.writeInt(0);this.plyCount?b.writeShort(this.plyCount):b.writeShort(0);b.writeByte(this.round);b.writeByte(this.subRound);b.writeInt(0);b.writeInt(0);b.beginSizedWrite();b.endSizedWrite()};c.Vhg=function(b){var d=b.readByte();b.readByte();b.readByte();return d};c.Vhi=function(b,d){d.writeByte(b);d.writeByte(0);d.writeByte(0)};c.Vhf=function(b){var d,c;d=b>>7;if(0<d&&500>=d){if(d--,c=String.fromCharCode("A".charCodeAt()+d/100)[0],d%=100,c+=String.fromCharCode("0".charCodeAt()+
d/10)[0],c+=String.fromCharCode("0".charCodeAt()+d%10)[0],d=b&127)c+="/",100<=d?c+="99":(c+=String.fromCharCode("0".charCodeAt()+d/10)[0],c+=String.fromCharCode("0".charCodeAt()+d%10)[0])}else c="";return c};c.prototype.toJson=function(){return{gameNo:this.nGame,white:this.white.getListStr(1),black:this.black.getListStr(1),event:this.event.event,date:this.date.getYear(),result:CB.Vgt.toString(this.result),elow:this.eloWh,elob:this.eloBl,eco:this.eco,round:this.round,subRound:this.subRound,plyCount:this.plyCount,
flags:this.flags}};c.prototype.matchesFilterVal=function(b){return-1!=this.white.last.search(b)||-1!=this.black.last.search(b)||-1!=this.event.site.search(b)||-1!=this.event.event.search(b)?!0:!1};return c}();
CB.PlayerData=function(){var c=function(b,d){this.first=b?b:"";this.last=d?d:""};c.prototype.toString=function(){return this.first&&this.first.length&&this.last&&this.last.length?String.formatEx("{last}, {first}",this):this.last||this.first};c.prototype.getListStr=function(b){return b&&this.first&&this.last&&this.first.length&&this.last.length?this.last+","+this.first.substr(0,b):this.last||this.first};c.Vhj=!0;c.Vhk=!1;c.prototype.init=function(b){if(c.Vhj){var d=b.split(",");if(2===d.length){this.first=
d[1].trim();this.last=d[0].trim();return}}if(c.Vhk&&(d=b.split(" "),1<d.length)){this.first=d[0];this.last=d.slice(1).join(" ");return}this.last=b;this.first=""};c.create=function(b){var d=new c;d.init(b);return d};c.prototype.read=function(b){this.last=b.readByteLenASCIIString(50);this.first=b.readByteLenASCIIString(50);this.last=this.last.trim();this.first=this.first.trim()};c.readFactory=createReadFactory(c);c.prototype.write=function(b){b.writeByteLenASCIIString(this.last);b.writeByteLenASCIIString(this.first)};
return c}();
CB.EventData=function(){var c=function(){this.event=this.site="";this.rounds=this.flags=this.Vhl=this.nation=this.type=this.Vhh=0};c.prototype.read=function(b){this.site=b.readByteLenASCIIString(100);this.event=b.readByteLenASCIIString(100);this.Vhh=b.readInt();this.type=b.readShort();this.nation=b.readShort();this.Vhl=b.readByte();this.flags=b.readByte();this.rounds=b.readShort()};c.readFactory=createReadFactory(c);c.prototype.write=function(b){b.writeByteLenASCIIString(this.site);b.writeByteLenASCIIString(this.event);b.writeInt(this.Vhh);
b.writeShort(this.type);b.writeShort(this.nation);b.writeByte(this.Vhl);b.writeByte(this.flags);b.writeShort(this.rounds)};c.prototype.toString=function(){var b=this.event;this.site&&this.event&&this.site!=this.event&&(b+=" ");this.site!=this.event&&(b+=this.site);return b};return c}();
CB.SourceData=function(){var c=function(){this.Vhm=this.source="";this.Vhp=this.version=this.Vho=this.Vhn=0};c.prototype.read=function(b){this.source=b.readByteLenASCIIString(100);this.Vhm=b.readByteLenASCIIString(100);this.Vhn=b.readInt();this.Vho=b.readInt();this.version=b.readByte();this.Vhp=b.readByte()};c.readFactory=createReadFactory(c);c.prototype.write=function(b){b.writeByteLenASCIIString(this.source);b.writeByteLenASCIIString(this.Vhm);b.writeInt(this.Vhn);b.writeInt(this.Vho);b.writeByte(this.version);
b.writeByte(this.Vhp)};return c}();
CB.TeamData=function(){var c=function(){this.team="";this.nation=this.Vhq=this.num=0};c.prototype.toString=function(){return this.num?String.formatEx("{team} {num}",this):this.team};c.prototype.read=function(b){this.team=b.readByteLenASCIIString(100);this.num=b.readShort();this.Vhq=b.readByte();this.nation=b.readByte()};c.readFactory=createReadFactory(c);c.prototype.write=function(b){b.writeByteLenASCIIString(this.team);b.writeShort(this.num);b.writeByte(this.Vhq);b.writeByte(this.nation)};return c}();
CB.AnnotatorData=function(){var c=function(b){this.name="";b&&(this.name=b)};c.prototype.toString=function(){return this.name};c.prototype.read=function(b){this.name=b.readByteLenASCIIString(100)};c.readFactory=createReadFactory(c);c.prototype.write=function(b){b.writeByteLenASCIIString(this.name)};return c}();"use strict";CB.Vhr={V1c:-1,Vhs:-64,Vht:63,Vhu:64,Vhv:128,Vhw:256,Vhx:512,Vhy:1024,Vhz:2048,Vi0:4096};
CB.Game=function(){var c=function(b,d){b||(b=new CB.Position);this.start=b;d||(d=new CB.Veo);this.mainLine=d;this.stk=new CB.LineStack(this.mainLine);this.hdr=new CB.Vgz;this.initPost()};c.prototype.start=null;c.prototype.cur=null;c.prototype.mainLine=null;c.prototype.stk=null;c.prototype.hdr=null;c.prototype.init=function(b,d){c.call(this,b,d);this.fireOnChanged();this.fireOnHeaderChanged()};c.prototype.initPost=function(){this.cur=ObjUtil.clone(this.start);c.Vi1(this.start,this.mainLine)};c.prototype.assign=
function(b,d){this.start=b.start;this.cur=b.cur;this.mainLine=b.mainLine;this.stk=b.stk;this.hdr=b.hdr;this.replaceGameNo=b.replaceGameNo;this.replaceDBId=b.replaceDBId;d||(this.fireOnResetGame(),this.fireOnCurPosChanged(),this.fireOnChanged(),this.fireOnHeaderChanged())};c.prototype.getMoves=function(){return this.mainLine};c.prototype.setMoves=function(b){this.mainLine=b};c.prototype.getMainLine=c.prototype.getMoves;c.prototype.getCurPos=function(){return this.cur};c.prototype.getStartPos=function(){return this.start};
c.prototype.isNormalInit=function(){var b=new CB.Position;return ObjUtil.equals(this.start,b)};c.prototype.getNextMove=function(){var b=this.stk.Top();if(b){if(b.isLineEnd())return null;var d=b.getLine(),b=b.getMovesToGo();return d[b]}return null};c.prototype.getLastMove=function(){var b=this.stk.Top();if(!b||b.isLineStart())return null;var d=b.getLine(),b=b.getMovesToGo();return d[b-1]};c.prototype.getPreviousMove=c.prototype.getLastMove;c.Vi1=function(b,d){for(var e=ObjUtil.clone(b),f=0,g=d.length;f<
g;++f){var h=d[f];e.preCalcCtx(h);if(h.hasLines())for(var k=h.getSubLines(),l=0,m=k.length;l<m;++l)c.Vi1(e,k[l]);e.makeMove(h);e.postCalcCtx(h,f===d.length-1)}};c.prototype.reset=function(){c.apply(this);this.fireOnCurPosChanged();this.fireOnChanged();this.fireOnHeaderChanged()};c.prototype.setResult=function(b){this.hdr.setResult(b);this.fireOnChanged();this.fireOnHeaderChanged()};c.prototype.getResult=function(){return this.hdr.getResult()};c.prototype.getTopItem=function(){return this.stk.Top()};
c.prototype.getTopLine=function(){if(this.stk.Top())return this.stk.Top().getLine()};c.prototype.Vi2=function(){if(this.stk.Top())return this.stk.Top().getMovesToGo()};c.prototype.isLineEnd=function(){return this.stk.Top()?this.stk.Top().isLineEnd():!1};c.prototype.isOnMainLine=function(){return 1===this.stk.length};c.prototype.isGameStart=function(){return 1===this.stk.length&&this.stk[0].isLineStart()};c.prototype.Vi3=function(){return 1===this.stk.length&&this.stk[0].isLineEnd()};c.prototype.getStackPos=
function(b){for(var d=ObjUtil.clone(this.start),c=0,f=b.length;c<f;++c)for(var g=b[c],h=g.getLine(),g=g.getMovesToGo(),k=0;k<g;++k)d.makeMove(h[k]);return d};c.prototype.Vi4=function(b,d){var e=c.getStackForLine(b,d);return this.getStackPos(e)};c.prototype.setStack=function(b){this.stk=b;0<this.stk.length&&(this.mainLine=this.stk[0].line);this.cur=this.getStackPos(this.stk)};c.prototype.Vf7=function(){return this.stk.Vf7()};c.prototype.getHeader=function(){return this.hdr};c.prototype.setHeader=function(b){this.hdr=
b};c.prototype.getGameNo=function(){return this.hdr.nGame};c.prototype.requiresPremiumForDownload=function(){var b=0;this.forAllMoves(function(d){b++});return b>2*this.getMainLine().length?5<this.hdr.annotator.length:!1};c.prototype.selfTest=function(){CBDebug.call(this.stk,this.stk.selfTest);CBDebug.call(this.mainLine,this.mainLine.selfTest,this.start,null,0)};c.prototype.Vi5=function(b){return this.stk.length};c.prototype.Vi6=function(b,d){this.Vi7(d)};c.prototype.isOnLastMove=function(){return this.getMoveIndex()==
this.mainLine.length};c.prototype.getPlyNum=function(){return this.getCurPos().getPlyNum()};c.prototype.getMoveNo=c.prototype.getPlyNum;c.prototype.getAnno=function(b){if(this.getLastMove())return this.getLastMove().getAnnoItem(b);if(this.mainLine.anno)return this.mainLine.anno.getItem(b)};c.prototype.setAnno=function(b,d){this.getLastMove()&&(this.getLastMove().setAnnoItem(b,d),this.fireOnChanged())};c.prototype.setAnnoBeforeFirstMove=function(b,d,c){this.mainLine.anno||(this.mainLine.anno=new CB.Annotation);
this.mainLine.anno.setItem(b,d);c||this.fireOnChanged()};c.prototype.getOrCreateCurrAnno=function(){if(this.getPreviousMove())return this.getPreviousMove().hasAnno()||this.getPreviousMove().setAnno(new CB.Annotation),this.getPreviousMove().getAnno();this.getMoves().hasAnno()||this.getMoves().setAnno(new CB.Annotation);return this.getMoves().getAnno()};c.prototype.updateFromExtern=function(){this.fireOnChanged();this.fireOnCurPosChanged()};c.prototype.Vi8=function(){this.fireOnHeaderChanged()};c.prototype.Vi9=
function(b,d){for(var c=this.getCurLine(),f=0;f<c.length;f++)c[f]&&(b?c[f].deleteAnnoItem(b):c[f].setAnno(null));d||this.fireOnChanged()};c.prototype.deleteAnno=function(b,d){this.getLastMove()&&(this.getLastMove().deleteAnnoItem(b),d||this.fireOnAnnoChanged())};c.prototype.getEvaluationProfile=function(){if(this.mainLine.anno&&this.mainLine.anno[CB.AnnoType.Via])return this.mainLine.anno[CB.AnnoType.Via];var b=this.getCurLine();if(b.length&&b[0].annos)return b[0].annos[CB.AnnoType.Via]};c.prototype.toString=
function(){for(var b=new CB.Vib(CB.V34l),d=this.hdr.toString(),d=d+"\r\n",c=0;c<this.mainLine.length;c++){var f=b.getMoveNota(this.mainLine[c]),g=b.getStrMoveNumInLine(c,this.getStartPos().getPlyNum()),d=d+(g+f);c<this.mainLine.length-1&&(d+=" ")}return d+=" "+this.hdr.getCBResult().toString()};c.prototype.onSync=function(b){if(V35p.panelMgr&&V35p.panelMgr.onSync)V35p.panelMgr.onSync(b)};c.Vic=function(){return new CB.Game};V34y.initForListeners(c);V34y.addEvent(c,"CurPosChanged",function(){return[this,
this.getCurPos()]});V34y.addEvent(c,"Navigate",function(){return[this]});V34y.addEvent(c,"Move",function(){return[this,this.getLastMove()]});V34y.addEvent(c,"Changed");V34y.addEvent(c,"HeaderChanged");V34y.addEvent(c,"AnnoChanged");V34y.addEvent(c,"ResetGame");V34y.addEvent(c,"GameEnd",function(){return[this,this.getResult()]});V34y.addEvent(c,"ClickInNotation");V34y.addEvent(c,"NotaDoubleClick");V34y.addEvent(c,"Eval");return c}();
(function(c){c.prototype.jump=function(b){b=this.getMoveIndex()+b;1>b&&(b=1);b>this.mainLine.length&&(b=this.mainLine.length);this.gotoIndex(b);this.fireOnNavigate();this.fireOnCurPosChanged()};c.prototype.gotoFirst=function(){this.gotoIndex(0)};c.prototype.gotoLast=function(){this.gotoIndex(this.mainLine.length)};c.prototype.gotoIndex=function(b){b=c.getStackForIndex(this.mainLine,b);this.gotoStack(b)};c.prototype.gotoLine=function(b,e){var f=c.getStackForLine(b,e);this.gotoStack(f)};c.prototype.gotoSimplePath=
function(b){for(var c=this.mainLine,f=new CB.LineStack,g=0,h=b.length;g<h;++g){var k=b[g],l=new CB.Vf6(c,k.mvsToGo);f.push(l);g<h-1&&(c=c[k.mvsToGo].getLine(k.inxLine))}this.gotoStack(f)};c.prototype.triggerOnClickInNotation=function(){this.fireOnClickInNotation()};c.prototype.gotoNext=function(){if(!this.isLineEnd()){var b=this.getNextMove();this.cur.makeMove(b);(b=this.getTopItem())&&b.incMovesToGo();this.fireOnCurPosChanged();this.fireOnNavigate()}};c.prototype.gotoPrev=function(b){if(!this.isGameStart()){var c=
this.stk;c.gotoPrev();this.gotoStack(c,b)}};c.prototype.gotoPrevClone=function(){if(!this.isGameStart()){var b=ObjUtil.clone(this.stk);b.gotoPrev();this.gotoStack(b)}};c.prototype.gotoStart=function(){this.gotoIndex(1);this.fireOnCurPosChanged();this.fireOnNavigate()};c.prototype.gotoEnd=function(){this.gotoIndex(this.mainLine.length);this.fireOnCurPosChanged();this.fireOnNavigate()};c.prototype.gotoStack=function(b,c){this.setStack(b);c||(this.fireOnCurPosChanged(),this.fireOnNavigate())};c.prototype.gotoMove=
function(b,c){var f=this.getNextMove();return f?b.equals(f)?(b.mvd=f.mvd,this.gotoNext(),c&&this.fireOnMove(),!0):(f=f.findLine(b))?(this.gotoLine(f,1),c&&this.fireOnMove(),!0):!1:!1};c.prototype.getMoveOffs=function(){return this.cur.numPly-this.start.numPly};c.prototype.getMoveIndex=function(){var b=0;if(0<this.stk.length)for(var b=this.stk[this.stk.length-1],c=b.getLine(),b=b.getMovesToGo(),f=this.stk.length-2;0<=f;--f){var g=this.stk[f].getLine(),h=c.getParentMoveIndex(),k=g[h],l=k.indexOfLine(c);
CBDebug.assert(0<=l,"inxPrevLine >= 0");for(c=0;c<l;++c)b+=k.getLine(c).getTreeMoveCount();h+=1;for(k=g.length;h<k;++h)if(l=g[h],l.hasLines())for(var c=0,m=l.getSubLinesCount();c<m;++c)b+=l.getLine(c).getTreeMoveCount();b+=g.length;c=g}return b};c.getStackForLine=function(b,c){for(var f=[];null!=b;c=b.getParentMoveIndex(),b=b.getParentLine()){var g=new CB.Vf6(b,c);f.push(g)}for(var h=new CB.LineStack;0<f.length;)g=f.pop(),h.push(g);return h};c.getStackForIndex=function(d,c){var f={complete:!1,inxMv:c},
g=new CB.LineStack;b.call(this,d,f,g);return g};var b=function(d,c,f){var g=d.length;if(c.inxMv<=g)return f.push(new CB.Vf6(d,c.inxMv)),c.complete=!0;c.inxMv-=g;for(g=d.length-1;0<=g;--g){var h=d[g];if(h.hasLines()){f.push(new CB.Vf6(d,g));for(var k=0,l=h.getSubLinesCount();k<l;++k){var m=h.getLine(k);b(m,c,f);if(c.complete)return!0}f.pop()}}return!1}})(CB.Game);
(function(c){function b(b){this.cur.preCalcCtx(b);var d=this.cur.makeMove(b);this.cur.postCalcCtx(b,!0);return d}function d(b){return e.call(this,b,function(b,d){b.length=d+1})}function e(d,c){var f=b.call(this,d),e=this.stk.Top();if(e){var g=e.getLine(),h=e.getMovesToGo();g[h]=d;c(g,h);e.setMovesToGo(h+1)}this.fireOnMove(d);this.fireOnCurPosChanged();return f}function f(b){return e.call(this,b,function(b,d){m(this.cur,b,d+1)}.bind(this))}function g(d,c,f){var e=b.call(this,d),g=this.stk.Top(),h=
g.getMovesToGo();c=g.getLine()[h].getLine(c);c[0]=d;f(c);d=new CB.Vf6(c,1);this.stk.push(d);this.fireOnMove();this.fireOnCurPosChanged();return e}function h(b,d){return g.call(this,b,d,function(b){b.length=1})}function k(b,d){var c=function(b){m(this.cur,b,1)}.bind(this);return g.call(this,b,d,c)}function l(d){var c=b.call(this,d),f=this.stk.Top();if(f){var e=f.getLine(),g=f.getMovesToGo();g<e.length?(f=e[g].newLine(e,g),f=new CB.Vf6(f,0),f.pushMove(d),this.stk.push(f)):f.pushMove(d);this.fireOnMove();
this.fireOnCurPosChanged();return c}}function m(b,d,c){c=c||0;for(b=ObjUtil.clone(b);c<d.length;++c){var f=d[c];if(!b.isLegalMove(f))break;if(f.hasLines())for(var e=f.getSubLinesCount()-1;0<=e;--e){var g=f.getLine(e);m(b,g);0===g.length&&f.removeLine(e)}b.makeMove(f)}d.length=c}c.prototype.storeOnce=function(){this.storeState={start:ObjUtil.clone(this.start),cur:ObjUtil.clone(this.cur),mainLine:ObjUtil.clone(this.mainLine),stk:ObjUtil.clone(this.stk)}};c.prototype.restoreOnce=function(){this.storeState&&
(this.start=ObjUtil.clone(this.storeState.start),this.cur=ObjUtil.clone(this.storeState.cur),this.mainLine=ObjUtil.clone(this.storeState.mainLine),this.stk=ObjUtil.clone(this.storeState.stk))};c.prototype.storeOnce2=function(){this.storeState={start:ObjUtil.clone2(this.start),cur:ObjUtil.clone2(this.cur),mainLine:ObjUtil.clone2(this.mainLine),stk:ObjUtil.clone2(this.stk)}};c.prototype.restoreOnce2=function(){this.storeState&&(this.start=ObjUtil.clone2(this.storeState.start),this.cur=ObjUtil.clone2(this.storeState.cur),
this.mainLine=ObjUtil.clone2(this.storeState.mainLine),this.stk=ObjUtil.clone2(this.storeState.stk))};c.prototype.makeMove=function(b,c){0<=c&&63>=c&&(c=CB.Vhr.Vhx);if(this.gotoMove(b))return!0;var e=null,g=c&CB.Vhr.Vht;switch(c&CB.Vhr.Vhs){case CB.Vhr.V1c&CB.Vhr.Vhs:case CB.Vhr.V1c:break;case CB.Vhr.Vhz:e=l.call(this,b);this.promoteLine();break;case CB.Vhr.Vhx:e=l.call(this,b);break;case CB.Vhr.Vhy:e=f.call(this,b);break;default:case CB.Vhr.Vhv:e=d.call(this,b);break;case CB.Vhr.Vhw:e=h.call(this,
b,g);break;case CB.Vhr.Vi0:e=k.call(this,b,g)}return e?(b.undo=e,!0):!1}})(CB.Game);"use strict";
(function(c){function b(b){CBDebug.call(this,this.selfTest);if(!this.isOnMainLine()){var c=this.getTopLine(),f=c.getParentMove(),g=f.getSubLinesCount();g&&1!==g&&(c=f.indexOfLine(c),b=c+b,0>b||b>=g||(f.swapLines(c,b),CBDebug.call(this,this.selfTest),this.fireOnChanged()))}}c.prototype.promoteLine=function(){if(this.isOnMainLine())return!1;CBDebug.call(this,this.selfTest);this.stk.promoteLine();CBDebug.call(this,this.selfTest);this.fireOnChanged();return!0};c.prototype.upLine=function(){b.call(this,
-1)};c.prototype.downLine=function(){b.call(this,1)};c.prototype.deleteLine=function(){if(!this.isOnMainLine()){CBDebug.call(this,this.selfTest);var b=this.stk.shallowClone(),c=this.getTopLine();c.getParentMove().removeLine(c);b.pop();this.setStack(b);CBDebug.call(this,this.selfTest);this.fireOnCurPosChanged();this.fireOnChanged()}};c.prototype.deleteRemaining=function(){this.stk.deleteRemaining();this.fireOnChanged()};c.prototype.deletePrevious=function(){if(0!=this.getCurLine().length){var b=this.stk.shallowClone();
b.gotoPrev();b=this.getStackPos(b);this.mainLine=this.stk.deletePrevious();this.start=b;this.fireOnChanged()}};c.prototype.unAnnotate=function(){this.mainLine.unAnnotate();var b=new CB.LineStack(this.mainLine,0);this.setStack(b);this.fireOnChanged();this.fireOnCurPosChanged()};c.prototype.startLine=function(){this.gotoPrev()};c.prototype.forAllMoves=function(b){this.mainLine.forAllMoves(b)}})(CB.Game);
(function(c){function b(b){for(var c=[],f=0,g=this.stk.length;f<g;++f){var h=this.stk[f],k=h.getLine(),h=h.getMovesToGo();b||f!=g-1||(h=k.length);h&&(c=c.concat(k.slice(0,h)))}return c}c.prototype.getCurLine=function(){return b.call(this,!1)};c.prototype.getCurLineCut=function(){return b.call(this,!0)};c.prototype.getLineStartMoveNo=function(){for(var b=0,c=0;c<this.stk.length-1;c++)b+=this.stk[c].getMovesToGo();return b};c.prototype.getCurLineIndex=function(){for(var b=0,c=0,f=this.stk.length;c<
f;++c)b+=this.stk[c].getMovesToGo();return b};c.prototype.setCurLineIndex=function(b){for(var c=new LineStack,f=0,g=this.stk.length;f<g;++f){var h=this.stk[f],k=h.getMovesToGo();if(f<g-1&&k<b)c.push(h),b-=k;else{f=h.getLine();k=b;b=new CB.Vf6(f,k);c.push(b);break}}this.gotoStack(c)}})(CB.Game);
(function(c){function b(b){var d=new CB.Position,d=ObjUtil.equals(this.start,d);b.V35n(d);d||(this.start.write(b),b.writeShort(0),b.writeShort(this.start.getMoveNum()),b.V35n(d))}function d(b){var d=b.V35o();!d&&(this.start.read(b),b.readShort(),d=b.readShort(),this.start.setMoveNum(d),d=b.V35o())&&(this.start=new CB.Position)}function e(b){d.call(this,b);var c=new CB.Annotation;c.read2(b);this.mainLine.read2(b);c.empty()||this.mainLine.setAnno(c)}c.prototype.fromBuf64=function(b){var d=new CB.V9w;
d.Vae(b);b=new CB.Game;var c=new CB.Vgz;c.compactFromDataBuf(d);d.V35k();b.readGameOnly2(d);b.setHeader(c);this.assign(b)};c.prototype.write=function(d){var c=this.getMoveIndex();d.writeInt(c);d.writeInt(0);this.hdr.write(d);b.call(this,d);(new CB.Annotation).write(d);this.mainLine.write(d);d.beginSizedWrite();d.endSizedWrite()};c.prototype.read=function(b){var c=b.readInt();b.readInt();this.hdr.read(b);d.call(this,b);var e=new CB.Annotation;e.read(b);this.mainLine.read(b);e.empty()||this.mainLine.setAnno(e);
b.beginSizedRead();b.endSizedRead();this.initPost();CBDebug.call(this,this.selfTest);this.fireOnChanged();this.gotoIndex(c)};c.prototype.read2=function(b){var d=!1;this.hdr.read(b)&&(e.call(this,b),d=!0);this.initPost();return d};c.prototype.read3=function(b){var d=b.readInt();b.readInt();this.hdr.read(b);e.call(this,b);b.beginSizedWrite();b.endSizedWrite();this.initPost();CBDebug.call(this,this.selfTest);this.fireOnChanged();this.fireOnHeaderChanged();this.gotoIndex(d)};c.prototype.readGameOnly2=
function(b){e.call(this,b);this.initPost()};c.prototype.writeGameOnly2=function(d){b.call(this,d);d.writeUint8(0);this.mainLine.write2(d)};c.prototype.fromDataBuf=c.prototype.read;c.prototype.V35j=c.prototype.write})(CB.Game);"use strict";CB.V34l={arrStrPieces:[],Vid:"x",Vie:"+",strMate:"#",strProm:"",Vif:"0-0",Vig:"0-0-0",Vih:"--",Vii:!1};CB.V34l.arrStrPieces[CB.Piece.Vb]=CB.V34l.arrStrPieces[CB.Piece.Vc]="K";CB.V34l.arrStrPieces[CB.Piece.Vd]=CB.V34l.arrStrPieces[CB.Piece.Ve]="Q";
CB.V34l.arrStrPieces[CB.Piece.Vf]=CB.V34l.arrStrPieces[CB.Piece.Vg]="R";CB.V34l.arrStrPieces[CB.Piece.Vh]=CB.V34l.arrStrPieces[CB.Piece.Vi]="B";CB.V34l.arrStrPieces[CB.Piece.Vj]=CB.V34l.arrStrPieces[CB.Piece.Vk]="N";CB.V34l.arrStrPieces[CB.Piece.Vl]=CB.V34l.arrStrPieces[CB.Piece.Vm]="";
CB.Vib=function(){var c=function(b){this.Vij=b||CB.V34l};c.prototype.Vik=function(){return this.Vij};c.prototype.Vil=function(b,d,c){var f=0;c&&(f=c);b=b.getMoveNum();for(c="";f<d.length;++f){var g=d[f],h=g.getMoved(),h=CB.Piece.side(h)===CB.Vaz.WHITE;c+=this.getMoveNota(g,h||!f?b:0)+" ";h||++b}return c};c.prototype.Vim=function(b,d){var c=b.getMainLine().length,c=c-d;0>c&&(c=0);for(var c=Math.floor(c/2)+1,f=[],g=Math.max(0,b.getMoveNo()-d),h=g;h<b.getMainLine().length;++h){var k=b.getMainLine()[h],
l=k.getMoved(),l=CB.Piece.side(l)===CB.Vaz.WHITE;f.push(this.getMoveNota(k,l||h==g?c:0));l||++c}return f};c.prototype.Vin=function(b,d){var c=Math.floor(d.getCurPos().getMoveNum()/2+1);d.getCurPos().preCalcCtx(b);return this.getMoveNota(b,c)};c.prototype.getMoveNota=function(b,d){var c="",f=b.getMoved();d&&(c=""+d+".",CB.Piece.side(f)===CB.Vaz.BLACK&&(c+=".."));b.isNullMove()?c+=this.Vij.Vih:b.isShortCastling()?c+=this.Vij.Vif:b.isLongCastling()?c+=this.Vij.Vig:(c=1>f||15<f?c+("[pcMvd="+f+"]"):c+
this.Vij.arrStrPieces[f],b.isNeedCol()&&(c+=CB.Vbf.Vdv(CB.Vbf.Vdz(b.from))),b.isNeedRow()&&(c+=CB.Vbf.Vdw(CB.Vbf.R(b.from))),b.isTake()&&(f===CB.Piece.Vl||f===CB.Piece.Vm?(c+=CB.Vbf.Vdv(CB.Vbf.Vdz(b.from)),this.Vij.Vii||(c+=this.Vij.Vid)):c+=this.Vij.Vid),c+=CB.Vbf.toString(b.to),b.prom&&(c+=this.Vij.strProm,c+=this.Vij.arrStrPieces[b.prom]));b.isMate()?c+=this.Vij.strMate:b.isCheck()&&(c+=this.Vij.Vie);return c};c.prototype.getStrMoveNumInLine=function(b,d,c){var f=CB.Position.prototype.Vfb(b+d),
g="";if(0==(b+d&1)||0==b)g=f.toString()+".",c?0==(b+d&1)&&(g+=".."):0!=(b+d&1)&&(g+="..");return g};c.Vio={};c.Vio.Vip=CB.V34l;return c}();var NotationLocalizations=CB.Vib.Vio;"use strict";CB.Viq={};
CB.Vir=function(){var c=function(){};c.prototype.init=function(b,d,c){this.id=-1;this.idGame=b;this.gameAction=d;this.controlMove=c;this.Vis=new Date};c.prototype.Vit=function(b){var d=new CB.Vat(Viu);d.setUserType(b);this.V35j(d.getBuf());return d};c.prototype.fromDataBuf=function(b){this.id=b.V35k();this.Vis=b.V35k();this.idGame=b.V35k();this.controlMove=new CB.Vez;this.controlMove.fromDataBuf(b);this.Viv=b.V35k();this.Viw=b.V35k();this.gameAction=new CB.Vix;this.gameAction.fromDataBuf(b)};c.prototype.V35j=
function(b){b.V35h(this.id);b.V35h(this.Vis);b.V35h(this.idGame);this.controlMove.V35j(b);b.V35h(this.Viv||0);b.V35h(this.Viw||0);this.gameAction.V35j(b)};c.prototype.isAnEarlierMove=function(b){if(this.gameAction.type==CB.Viy.Viz){var d=this.gameAction.moveData;if(this.gameAction.moveData.moveNo<b.getPlyNum()&&(d=new CB.Veh(d.move[0],d.move[1],d.move[2]),b.getMoves()[this.gameAction.moveData.moveNo].equals(d)&&(0==this.gameAction.moveData.moveNo||b.getMoves()[this.gameAction.moveData.moveNo-1].equals(this.controlMove))))return!0}return!1};
c.prototype.Vj0=function(){return this.gameAction.type==CB.Viy.Viz};c.prototype.toString=function(){return"gameId="+this.idGame.toString(10)+" "+this.gameAction.toString()};return c}();"use strict";CB.Vj1={V5k:0,Vj2:1,Vj3:2,Vj4:3,Vj5:function(c){return c==CB.Vaz.BLACK?CB.Vj1.Vj2:CB.Vj1.Vj3}};
CB.Vj6=function(){var c=function(b){this.board=b;this.Vj7=function(){return null};this.Vj8=!0;this.Vj9=[]};c.prototype.Vja=function(){var b=this.Vjb();null!==b&&b===this.getCurPos().getSideToMove()&&this.Vjc()};c.prototype.Vjd=function(){if(this.Vj9.length)return this.Vj9[this.Vj9.length-1].to};c.prototype.Vje=function(b){try{this.Vjf()}catch(c){CB.Vjg("ME:sq",c)}};c.prototype.Vjh=function(b){};c.prototype.Vjf=function(){this.Vj9=[];this.Vji().undoAttributes()};c.prototype.Vjj=function(b){b=b||1-
.25*this.Vj9.length;return"hsla( 120, 75%, 55%, "+Math.max(.1,b)+")"};c.prototype.Vjk=function(){try{for(var b=[],c=0;c<this.Vj9.length;c++){var f=this.Vj9[c],g=this.Vjj(.9-.3*c);b.push(new CB.Vjl(f.from,f.to,g))}b.length&&this.Vji().queueBoardAttributes(b,{eraseQueue:!1,renderNow:!0,requestAnimInRender:!0})}catch(h){CB.Vjg("ME::rp")}};c.prototype.Vjm=function(b,c,f){try{if(this.Vjn()&&this.Vjo(b)){var g=new CB.Veh(b,c,f&7);this.fireOnStopClock();this.fireOnMoveEntered(g);return!0}if(this.Vj8){var h=
new CB.Veh(b,c,f&7);this.Vj9.push(h)}}catch(k){CB.Vjg("MvE::Entd",k)}return!1};c.prototype.Vjo=function(b){return CB.Piece.side(this.getCurPos().getPiece(b))==this.getCurPos().getSideToMove()};c.prototype.Vjp=function(b){try{var c=!0;if(this.Vj8){var f=this.getCurPos().getPiece(b);f&&CB.Piece.side(f)!=this.getCurPos().getSideToMove()&&CB.Piece.side(f)===this.Vjb()&&(c=!1);b==this.Vjd()&&(c=!1)}c&&this.board.undoAttributes()}catch(g){CB.Vjg("ME::clr",g)}};var b=!1;c.prototype.Vjc=function(){if(b)return!1;
b=!0;var d=!1;if(this.Vj9.length){var c=this.Vj9.shift();this.getCurPos().isLegalFromTo(c.from,c.to)&&this.getCurPos().getSideToMove()==this.Vjb()&&(this.fireOnStopClock(),new CB.Timer.V4s(function(){this.fireOnMoveEntered(c)}.bind(this)),d=!0,this.Vjk())}b=!1;return d};c.prototype.Vjq=function(b,c){var f={ok:!1,from:-1};try{if(b.get(c)==CB.Piece.V5k){var g=this.getCurPos().V34r(),g=g.filter(function(b){return b.to==c});if(f.ok=1==g.length&&this.Vjr())f.from=g[0].from}}catch(h){CB.Vjg("ME:FS",h)}return f};
c.prototype.isLegal=function(b,c,f){return this.Vjn(b.get(c))?this.getCurPos().isLegalFromTo(c,f)||this.isPremove(b,c,f)&&0!=b.get(c):!1};c.prototype.Vjn=function(b){switch(this.Vjs()){case CB.Vj1.Vj4:return!0;case CB.Vj1.Vj2:return this.getCurPos().isWTM()||this.Vj8&&CB.Piece.side(b)==CB.Vaz.WHITE;case CB.Vj1.Vj3:return this.getCurPos().isBTM()||this.Vj8&&CB.Piece.side(b)==CB.Vaz.BLACK;default:return!1}};c.prototype.Vjr=function(){switch(this.Vjs()){case CB.Vj1.Vj2:return this.getCurPos().isWTM();
case CB.Vj1.Vj3:return this.getCurPos().isBTM();default:case CB.Vj1.Vj4:return!0}};c.prototype.Vjt=function(b){};c.prototype.Vju=function(){this.Vjv(null)};c.prototype.isPremove=function(b,c,f){return 0<=c&&0<=f&&64>c&&64>f?(b=b.get(c))?this.Vj8&&this.getCurPos().isBTM()==(CB.Piece.side(b)==CB.Vaz.WHITE):!1:!1};c.prototype.isLegalFromTo=function(b,c){return this.getCurPos().isLegalFromTo(b,c)};c.prototype.Vjw=function(b,c){return this.isLegalFromTo(b,c)?this.getCurPos().getEPCol()==CB.Vbf.Ve1(c):
!1};c.prototype.test=function(){};c.prototype.getGame=function(){return this.board.getGame()};c.prototype.getCurPos=function(){return this.getGame().getCurPos()};c.prototype.Vji=function(){return this.board};c.prototype.Vjb=function(){return this.Vj7()};c.prototype.Vjv=function(b){ObjUtil.isFunction(b)?this.Vj7=b:this.Vj7=function(){return b}};c.prototype.Vjs=function(){switch(this.Vjb()){case CB.Vaz.WHITE:return CB.Vj1.Vj2;case CB.Vaz.BLACK:return CB.Vj1.Vj3;default:return CB.Vj1.Vj4}};c.prototype.Vjx=
function(b,c){if(0<=c&&64>c){var f=b.get(c);return this.getCurPos().isBTM()==(CB.Piece.side(f)==CB.Vaz.BLACK)}};V34y.initForListeners(c);V34y.addEvent(c,"MoveEntered");V34y.addEvent(c,"StopClock");return c}();"use strict";
CB.Vjy=function(){var c=1,b=function(b,e){this.game=e||new CB.Game;CB.V2(this,"game");this.Vk0();this.Vk1=[];this.Vjz=b;this.Vk2=!0;this.uniqueId=c++;this.Vk3=new CB.Vk4;this.Vk3.setGame(this.game);this.fnInitGame=function(b){b.reset();if(PGN&&V35p&&V35p.urlParams&&V35p.urlParams.pgn){var d=PGN.Vk5(V35p.urlParams.pgn);b.assign(d)}else V35p&&V35p.urlParams&&V35p.urlParams.buf64&&(CB.V47.V4i("buf64"),d=new CB.Game,d.fromBuf64(V35p.urlParams.buf64),b.assign(d))}};b.prototype.destroy=function(){this.setBoardWin(null);
this.Vk3.setGame(null);this.Vk6();this.releaseCommandHandlers();this.V354&&this.V354.destroy()};b.prototype.Vk7=function(b){this.boardWin&&(this.boardWin.Vk8.allowedColor=b)};b.prototype.linkCommandHandlers=function(){this.Vk9=V35p.commands.Vka(this);this.Vkb=V35p.commands.Vkc(this)};b.prototype.releaseCommandHandlers=function(){V35p.commands.Vkd(this.Vk9);V35p.commands.Vke(this.Vkb)};b.prototype.createControl=function(b,c,f,g){this.animateBoard=!0;this.boardArea=new CB.Vkf(b,c,f,g);b=g&&g.fnBoardFactory?
g.fnBoardFactory(b,c,f,"ByKernel",g):new CB.Vkg(b,c,f,"ByKernel",g);g&&g.addTitle&&b.addTitle(null,g.noClock);this.setBoardWin(b);this.V354.createGUIElements(this.boardWin);this.boardArea.addBoard(this.boardWin);this.initGame();this.boardWin.Vkh();this.releaseCommandHandlers();this.linkCommandHandlers();return this.boardArea};b.prototype.createControl3D=function(b,c,f){this.animateBoard=V35p.Vki();this.boardArea=new CB.BoardArea3D(b,c,f);b=new CB.BoardControl3D(b,c,f,"FritzBoard",this.Vkj.bind(this));
this.setBoardWin(b);this.V354.createGUIElements(this.boardWin);this.boardArea.addBoard(this.boardWin);this.initGame();this.boardWin.Vkh();this.releaseCommandHandlers();this.linkCommandHandlers();return this.boardArea};b.prototype.Vkj=function(){this.boardWin&&this.boardWin.setGame(this.game)};b.prototype.Vkk=function(b){this.Vk3&&this.Vk3.enable(b)};b.prototype.setBlackIsBottom=function(b){this.boardWin&&this.boardWin.setBlackIsBottom(b)};b.prototype.setBoardWin=function(b){this.boardWin&&this.boardWin.Vk8.removeOnMoveEnteredListener(this.Vkl);
if(this.boardWin=b)this.boardWin.Vk8&&(this.boardWin.Vk8.Vjv&&this.boardWin.Vk8.Vjv(this.Vjb.bind(this)),this.boardWin.Vk8.addOnMoveEnteredListener&&(this.Vkl=this.boardWin.Vk8.addOnMoveEnteredListener(this.Vkm.bind(this)))),this.boardWin.setGame(this.game),this.idGame&&(this.boardWin.idGame=this.idGame)};b.prototype.Vkn=function(b,c,f){this.notation=CB.NotaElement.factory(b,c,null);this.notation.setGame(this.game);return this.notation};b.prototype.Vko=function(b){this.notation&&this.notation.Vko(b)};
b.prototype.Vkp=function(){this.V354.Vkp()};b.prototype.setPlayingMode=function(b){this.Vkq=this.Vkq||{};this.V354&&this.V354.Vkr(this.Vkq);this.boardWin&&this.V354&&(this.V354.Vks(this.boardWin),this.V354.destroy());this.V354=b;this.boardWin&&(this.V354.createGUIElements(this.boardWin),this.V354.Vkp(),this.V354&&this.V354.Vkt(this.Vkq),this.V354.Vku());this.boardArea&&this.boardArea.Vkv();this.V354.getFnLoadSearchResult&&(this.loadSearchResultGame=this.V354.getFnLoadSearchResult())};b.Vkw=null;b.Vkx=
function(d){b.Vky();return b.Vkw[d]};b.Vky=function(){b.Vkw||(b.Vkw={},b.Vkw[V35p.V358.LEVEL_BLITZ_3_0]={clockParams:new CB.Vkz(3,0)},b.Vkw[V35p.V358.LEVEL_BLITZ_4_0]={clockParams:new CB.Vkz(4,0)},b.Vkw[V35p.V358.LEVEL_BLITZ_5_0]={clockParams:new CB.Vkz(5,0)},b.Vkw[V35p.V358.LEVEL_BLITZ_3_2]={clockParams:new CB.Vkz(3,2)},b.Vkw[V35p.V358.LEVEL_BLITZ_5_5]={clockParams:new CB.Vkz(5,5)},b.Vkw[V35p.V358.LEVEL_1_SECOND]={fixedTime:1E3},b.Vkw[V35p.V358.LEVEL_5_SECONDS]={fixedTime:5E3},b.Vkw[V35p.V358.LEVEL_15_SECONDS]=
{fixedTime:15E3},b.Vkw[V35p.V358.LEVEL_40_SECONDS]={fixedTime:4E4})};b.prototype.execCommand=function(b){try{switch(b){case V35p.V358.V1k:this.newGame();break;case V35p.V358.V3n:this.Vl0(this.V354.Vl1);break;case V35p.V358.Vl2:this.V354.Vl3()&&this.game.gotoPrev();break;case V35p.V358.Vl4:this.V354.Vl3()&&this.game.gotoNext();break;case V35p.V358.V2w:this.startLine();break;case V35p.V358.FLIP_BOARD:this.boardWin&&this.boardWin.flipBoard();break;case V35p.V358.PROMOTE_LINE:this.V354.onPromoteLine()&&
this.game.promoteLine();break;case V35p.V358.DELETE_LINE:this.V354.onDeleteLine()&&this.game.deleteLine();break;case V35p.V358.CUT_LINE:this.V354.onCutLine()&&this.game.deleteRemaining();break;case V35p.V358.Vl5:this.V354.onDeletePrevious()&&this.game.deletePrevious();break;case V35p.V358.ADD_POST_TEXT:this.Vl6(!0);break;case V35p.V358.Vl7:this.Vl6(!1);break;case V35p.V358.INSERT_DIAGRAM:this.V354.Vl8()&&this.Vl9();break;case V35p.V358.Vla:this.Vlb(1);break;case V35p.V358.Vlc:this.Vlb(-1);break;case V35p.V358.Vld:this.Vle();
break;case V35p.V358.Vlf:this.V354.test();break;case V35p.V358.Vlg:this.Vlh();break;case V35p.V358.Vli:this.Vlj();break;case V35p.V358.MARK_GOOD:this.V354.onAnnotate()&&this.addSymbol(CB.Vlk.Vll);break;case V35p.V358.MARK_BAD:this.V354.onAnnotate()&&this.addSymbol(CB.Vlk.Vlm);break;case V35p.V358.MARK_VERYGOOD:this.V354.onAnnotate()&&this.addSymbol(CB.Vlk.Vln);break;case V35p.V358.MARK_VERYBAD:this.V354.onAnnotate()&&this.addSymbol(CB.Vlk.Vlo);break;case V35p.V358.MARK_INTERESTING:this.V354.onAnnotate()&&
this.addSymbol(CB.Vlk.Vlp);break;case V35p.V358.MARK_DUBIOUS:this.V354.onAnnotate()&&this.addSymbol(CB.Vlk.Vlq);break;case V35p.V358.WHITE_WINS:this.V354.onEval(CB.Vlr.WHITE_WINS)&&this.addSymbol(CB.Vlr.WHITE_WINS);break;case V35p.V358.WHITE_BETTER:this.V354.onEval(CB.Vlr.WHITE_BETTER)&&this.addSymbol(CB.Vlr.WHITE_BETTER);break;case V35p.V358.WHITE_SLIGHTLY:this.V354.onEval(CB.Vlr.Vls)&&this.addSymbol(CB.Vlr.Vls);break;case V35p.V358.EQUAL:this.V354.onEval(CB.Vlr.EQUAL)&&this.addSymbol(CB.Vlr.EQUAL);
break;case V35p.V358.UNCLEAR:this.V354.onEval(CB.Vlr.UNCLEAR)&&this.addSymbol(CB.Vlr.UNCLEAR);break;case V35p.V358.BLACK_WINS:this.V354.onEval(CB.Vlr.BLACK_WINS)&&this.addSymbol(CB.Vlr.BLACK_WINS);break;case V35p.V358.BLACK_BETTER:this.V354.onEval(CB.Vlr.BLACK_BETTER)&&this.addSymbol(CB.Vlr.BLACK_BETTER);break;case V35p.V358.BLACK_SLIGHTLY:this.V354.onEval(CB.Vlr.Vlt)&&this.addSymbol(CB.Vlr.Vlt);break;case V35p.V358.COMPENSATION:this.V354.onEval(CB.Vlr.COMPENSATION)&&this.addSymbol(CB.Vlr.COMPENSATION)}}catch(c){b=
V35p.V358.Vlu(b),CB.Vjg(b,c)}};b.prototype.onKeyDown=function(b){var c=this.V354.onKeyDown(b);if(!c&&b&&b.getKey)switch(this.Vlv=c=!0,b.getKey()){default:c=!1;break;case b.A:b.ctrlKey?this.Vl6(!0):c=!1;break;case b.F:b.ctrlKey?this.execCommand(CB.Vlw.FLIP_BOARD):c=!1;break;case b.N:b.ctrlKey?this.execCommand(CB.Vlw.V1k):c=!1;break;case b.LEFT:this.V354.Vl3()&&this.game.gotoPrev();break;case b.RIGHT:this.Vlx();break;case b.HOME:this.V354.Vl3()&&this.game.gotoStart();break;case b.END:this.Vly();break;
case b.PAGE_DOWN:this.Vlz();break;case b.PAGE_UP:this.V354.Vl3()&&this.game.jump(-20);break;case b.SPACE:this.V354.Vl3()&&(c=this.execCommand(CB.Vlw.Vm0));break;case b.F2:b.altKey?this.execCommand(CB.Vlw.Vm1):c=!1}return c};b.prototype.onFileSelect=function(b,c){return!1};b.prototype.Vlx=function(){this.V354.Vm2()&&this.game.gotoNext()};b.prototype.Vly=function(){this.V354.Vm3()&&this.game.gotoEnd()};b.prototype.Vlz=function(){this.V354.Vm4()&&this.game.jump(20)};b.prototype.Vl0=function(b){V35p.isPremium()?
this.Vm5?this.Vm7():this.Vm6(b):V35p.panelMgr.showBoardMessage(lm.PREMIUM_ONLY,3E3)};b.prototype.Vm8=function(){var b=new CB.Position("8/7k/P7/8/K7/8/8/8 w - - 0 1"),b=new CB.Game(b);this.game.assign(b)};b.prototype.Vm6=function(b){this.boardWin&&(this.boardWin.Vm9(),this.Vm5=new CB.Vma(this.boardWin.cbcanvas,this.boardWin.width,this.boardWin.height,"posInput",function(b){(new CB.Timer(function(){this.Vm7(b)}.bind(this))).V4s()}.bind(this),b,{}),this.boardArea.Vmb(this.Vm5),this.Vm5.Vmc(),this.Vm5.setPosition(this.getCurPos()),
this.boardArea.Vmd())};b.prototype.Vm7=function(b){if(this.Vm5){var c=new CB.Game(this.Vm5.Vme());this.boardArea.Vmf(this.boardWin);this.Vm5.destroy();delete this.Vm5;this.V354.createGUIElements(this.boardWin);b||this.game.assign(c);this.V354.Vjt(c.getCurPos());this.boardWin.Vk8.Vjt(c.getCurPos());this.setBlackIsBottom(c.getCurPos().getBTM())}};b.prototype.Vmg=function(b){b&&(this.game.assign(PGN.Vk5(b)),this.game.gotoFirst())};b.prototype.initGame=function(){this.fnInitGame(this.game,this);this.V354.newGame(!1)};
b.prototype.newGame=function(){this.boardWin&&(this.boardWin.prepareFullRedraw(),this.boardWin.destroyMessage(),this.boardWin.Vmh());this.V354.Vmi(this.game);this.V354.newGame(!0)};b.prototype.Vk0=function(){this.game&&(this.Vmj=this.game.addOnNavigateListener(this.Vmk.bind(this)),this.Vml=this.game.addOnMoveListener(this.Vmm.bind(this)),this.Vmn=this.game.addOnChangedListener(this.Vmo.bind(this)),this.idHeaderListener=this.game.addOnHeaderChangedListener(this.Vmp.bind(this)),this.Vmq=this.game.addOnCurPosChangedListener(this.Vmr.bind(this)),
this.Vms=this.game.addOnResetGameListener(this.Vmt.bind(this)),this.Vmu=this.game.addOnClickInNotationListener(this.Vmv.bind(this)))};b.prototype.Vk6=function(){this.game.removeOnNavigateListener(this.Vmj);this.game.removeOnMoveListener(this.Vml);this.game.removeOnChangedListener(this.Vmn);this.game.removeOnHeaderChangedListener(this.idHeaderListener);this.game.removeOnCurPosChangedListener(this.Vmq);this.game.removeOnResetGameListener(this.Vms);this.game.removeOnClickInNotationListener(this.Vmw)};
b.prototype.Vmx=function(){return this.Vmy.bind(this)};b.prototype.Vmy=function(b,c){b.loadGameAsync(this.Vmz.bind(this),c)};b.prototype.Vmz=function(b){void 0!==b&&(this.loadSearchResultGame?this.loadSearchResultGame(b):(this.game.assign(b),this.game.gotoFirst(),this.loadSearchResultGame))};b.prototype.Vn0=function(b){1E4>b&&this.Vn1()&&!this.Vlv&&setTimeout(function(){this.Vn0(b+1)}.bind(this),5)};b.prototype.Vn2=function(b){0<this.game.getMoveIndex()&&!this.Vlv&&(this.game.gotoPrev(),setTimeout(function(){this.Vn2()}.bind(this),
5))};b.prototype.Vn1=function(){if(0==this.Vk1.length)return!1;this.game.makeMove(this.Vk1[Math.floor(Math.random()*this.Vk1.length)]);return!0};b.prototype.Vjb=function(){if(this.V354)return this.V354.Vjb()};b.prototype.Vjv=function(b){this.V354&&this.V354.Vjv(b)};b.prototype.Vn3=function(b){};b.prototype.Vkm=function(b){if(this.game.getCurPos().isLegalMove(b)&&!this.V354.Vkm(b)){if(this.V354.Vn4(b)){if(this.game.gotoMove(b))return;var c=this.V354.Vn5();this.Vn6&&(c=this.Vn6,this.Vn6=null);var f=
function(b,d){d!=CB.Vhr.V1c&&(this.game.makeMove(b,d),this.Vn7())}.bind(this);c==CB.Vhr.Vhu?(c=function(b,d,c,e){f(c,d)},CB.Vn8&&CB.Vn8.Vn9(this.game,this.game.getCurPos(),b,null,c)):f(b,c)}else this.game.fireOnCurPosChanged();this.V354.Vna(b)}};b.prototype.markLastMove=function(b,c){this.boardWin&&this.boardWin.markLastMove(b||!this.animateBoard,c)};b.prototype.Vnb=function(b,c){this.boardWin&&this.boardWin.Vnb(b,c)};b.prototype.drawArrow=function(b,c,f){this.boardWin&&this.boardWin.drawArrow(b,
c,f)};b.prototype.Vnc=function(b){if(this.boardWin){var c=this.boardWin.animSteps.forMove;CB.V5t.V64()?this.boardWin.animSteps.forMove=b||4:this.boardWin.animSteps.forMove=b||10}this.game.gotoNext();this.boardWin&&(this.boardWin.animSteps.forMove=c)};b.prototype.Vnd=function(b,c){this.Vne(function(){this.game.makeMove(b,CB.Vhr.Vhv)}.bind(this),c)};b.prototype.Vnf=function(b){if(this.boardWin){var c=this.boardWin.animSteps.forMove;CB.V5t.V64()?this.boardWin.animSteps.forMove=b||2.5:this.boardWin.animSteps.forMove=
b||6}this.game.gotoPrev();this.boardWin&&(this.boardWin.animSteps.forMove=c)};b.prototype.Vne=function(b,c){var f=this.boardWin.animSteps.forMove;CB.V5t.V64()?this.boardWin.animSteps.forMove=c||4:this.boardWin.animSteps.forMove=c||10;b();this.boardWin.animSteps.forMove=f};b.prototype.setResult=function(b,c){this.game.setResult(b);this.V354.Vng(b,c)};b.prototype.Vn7=function(){if(!this.isFinished()){var b=this.Vnh();b!=CB.Vgt.Vgx&&(this.V354.Vni||this.setResult(b,CB.Vnj.Vnk),this.Vnl&&this.Vnl(b))}};
b.prototype.isFinished=function(){return this.game.hdr.getCBResult().isFinished()};b.prototype.isBTM=function(){return this.game.getCurPos().isBTM()};b.prototype.Vnh=function(){var b=(new CB.Vnm).checkGame(this.game),c=CB.Vgt.Vgx;switch(b){case CB.Vnn.V3m:case CB.Vnn.V2g:c=CB.Vgt.DRAW;break;case CB.Vnn.V3l:c=this.game.getCurPos().isBTM()?CB.Vgt.WHITE_WINS:CB.Vgt.BLACK_WINS;break;case CB.Vnn.Vno:case CB.Vnn.Vnp:c=CB.Vgt.DRAW}return c};b.prototype.Vmk=function(){this.V354.Vnq()};b.prototype.Vmm=function(){this.V354.Vnr()};
b.prototype.Vmr=function(){this.V354.Vku();this.Vns()};b.prototype.Vmo=function(b){this.V354.Vku(b);this.Vns()};b.prototype.Vmp=function(b){this.V354.Vnt()};b.prototype.Vmt=function(){this.V354.Vnu();this.boardWin&&(this.boardWin.nextCurPosNoAnim=!0)};b.prototype.Vmv=function(){this.V354.Vnv()};b.prototype.Vl6=function(b){this.Vjz&&(this.Vk2==b?this.Vjz.Vnw():this.Vjz.Vnx(),this.Vk2=b,this.Vjz.Vny()&&(this.game.getAnno(this.Vk2?CB.AnnoType.Vgi:CB.AnnoType.Vgg),this.Vns()))};b.prototype.Vlb=function(b){this.V354.Vlb(b)};
b.prototype.Vnz=function(b,c){null!=b&&(this.V354.onTextAnno(b,this.Vk2)&&(b.length?this.game.setAnno(this.Vk2?CB.AnnoType.Vgi:CB.AnnoType.Vgg,new CB.Vgh(b)):this.game.deleteAnno(this.Vk2?CB.AnnoType.Vgi:CB.AnnoType.Vgg)),this.Vjz&&setTimeout(this.Vjz.Vo0.bind(this.Vjz)))};b.prototype.Vns=function(){if(this.Vjz&&this.Vjz.Vny&&this.Vjz.Vny()){var b=this.game.getAnno(this.Vk2?CB.AnnoType.Vgi:CB.AnnoType.Vgg);b?this.Vjz.Vo1(b.getString()):this.Vjz.Vo1("")}};b.prototype.Vo2=function(b){b&&b.length&&(this.game.getOrCreateCurrAnno().addPostText(b),
this.game.fireOnChanged())};b.prototype.Vl9=function(){var b=this.game.getOrCreateCurrAnno();b.toggleDiagram();this.V354.onTextAnno(b.getPostText()||"",!0)&&this.game.fireOnChanged()};b.prototype.deleteAnno=function(b){this.game.deleteAnno(b)};b.prototype.addSymbol=function(b){this.game.getOrCreateCurrAnno().addSymbol(b);this.game.fireOnAnnoChanged()};b.prototype.Vo3=function(b){this.game.getOrCreateCurrAnno().addSymbol(b);this.game.fireOnAnnoChanged()};b.prototype.Vo4=function(){for(var b=0;b<this.game.getMoves().length-
1;b++){var c=this.game.getMoves()[b].getAnno();if(void 0===c||null===c||void 0===c.getItem(CB.AnnoType.TIME))return!1}return 2<this.game.getMoves().length};b.prototype.Vo5=function(b){b&&this.game.getOrCreateCurrAnno().setItem(CB.AnnoType.TIME,b)};b.prototype.Vo6=function(){this.Vo2(CB.Annotation.Vgc)};b.prototype.hasTraining=function(){for(var b=0;b<this.game.getMoves().length-1;b++){var c=this.game.getMoves()[b].getAnno();if(c&&c.getItem(CB.AnnoType.Vf5))return!0}return!1};b.prototype.Vo7=function(){for(var b=
0;b<this.game.getMoves().length-1;b++){var c=this.game.getMoves()[b].getAnno();if(c){c.getItem(CB.AnnoType.Vf5)&&this.game.gotoIndex(b+1);break}if(this.game.getMoves()[b].hasLines())break}};b.prototype.getMoveNo=function(){return this.game.getMoveNo()};b.prototype.execEngineMove=function(b){this.game.makeMove(b);this.Vn7()};b.prototype.setIdGame=function(b){this.idGame=b;this.boardWin&&(this.boardWin.idGame=b)};b.prototype.getCurPos=function(){return this.game.getCurPos()};b.prototype.Vo8=function(b,
c){var f=new CB.V9w,g=!0;"TEXT"==b&&(g=!1);f.Vac(c,g);f.rewind();g=new CB.Vix;g.fromDataBuf(f);g.fillExecutedMove();f=this.game.getHeader().getWhite();g._doExecute(this.game);g=this.game.getHeader().getWhite();this.game.updateFromExtern();0!=f.localeCompare(g)&&this.game.Vi8()};b.prototype.Vlh=function(){this.Vo9(this.game.toString())};b.prototype.Vo9=function(b){if(window.clipboardData&&clipboardData.setData){if(this.boardWin){this.boardWin.addMessage("You may now paste this game as text everywhere.",
!0);var c=this.boardWin;(new CB.Timer).runOnce(3E3,function(){c.destroyMessage()})}clipboardData.setData("Text",b)}};b.prototype.Vlj=function(){if(window.clipboardData&&clipboardData.getData){var b=clipboardData.getData("Text");this.Vmg(b)}0<V35p.V34z.userName.length&&(new CB.Voa(V35p.V34z.userName,V35p.V34z.password)).getActivity(CB.Vob.Voc,this.Vod.bind(this))};b.prototype.Vod=function(b,c){0!=b&&(this.Vmg(c),this.game.updateFromExtern())};b.prototype.startLine=function(){this.game.gotoPrev();this.Vn6=
CB.Vhr.Vhx};return b}();"use strict";CB.Viy={Voe:0,Vof:1,Vog:2,Voh:3,Voi:4,Viz:5,Voj:6,Vok:7,Vol:8,Vom:9,Von:10,UNANNOTATE:11,Voo:12,Vop:13,Voq:14,Vor:15,Vos:16,Vot:17,toString:function(c){for(var b in this)if(this[b]==c)return"GameAction: "+b;return"Unknown GameAction: "+c}};
CB.Vix=function(){var c=function(){this.type=CB.Viy.Voe;this.nVal=0};c.prototype.fromDataBuf=function(b){this.type=b.V35k();this.nVal=b.V35k();switch(this.type){case CB.Viy.Voi:this.Vou=new CB.Vez;this.Vou.fromDataBuf(b);break;case CB.Viy.Viz:this.moveData=new CB.Vov;this.moveData.fromDataBuf(b);break;case CB.Viy.Vog:this.setGame=new CB.Game;this.setGame.fromDataBuf(b);break;case CB.Viy.Voj:case CB.Viy.Voo:this.anno=new CB.Annotation;this.anno.fromDataBuf(b);break;case CB.Viy.Vor:this.setGame=new CB.Game;
this.setGame.read3(b);break;case CB.Viy.Vos:this.moves=new CB.Vow;this.moves.Vox(rBuf,rBuf.ReadInt());break;case CB.Viy.Vot:this.header=new CB.Voy,this.header.ReadFromDataBuffer(rBuf,0)}};c.prototype.V35j=function(b){b.V35h(this.type);b.V35h(this.nVal);switch(this.type){case CB.Viy.Voi:this.Vou.V35j(b);break;case CB.Viy.Viz:this.moveData.V35j(b);break;case CB.Viy.Vog:this.setGame.V35j(b);break;case CB.Viy.Voj:case CB.Viy.Voo:this.anno.V35j(b)}};c.prototype.Voz=function(b){this.type=CB.Viy.Viz;this.moveData=
b};c.prototype.addText=function(b){this.anno=new CB.Annotation;this.anno.addPostText(b);this.type=CB.Viy.Voo};c.prototype.isMove=function(){return this.type==CB.Viy.Viz||this.type==CB.Viy.Voi};c.prototype.Vp0=function(){return this.type==CB.Viy.Viz};c.prototype.isGame=function(){return this.type==CB.Viy.Vog};c.prototype.Vp1=function(){return this.type==CB.Viy.Voo||this.type==CB.Viy.Voj};c.prototype.Vp2=function(){if(this.moveData)return this.moveData.centiSecs};c.prototype.fillExecutedMove=function(){if(this.type==
CB.Viy.Voi)return new CB.Veh(this.Vou.from,this.Vou.to,this.Vou.prom);if(this.type==CB.Viy.Viz)return new CB.Veh(this.moveData.move[0],this.moveData.move[1],this.moveData.move[2],this.moveData.type)};c.prototype.execute=function(b,d){var c=!0;this.Vp3()&&d&&(c=this.Vp4(b,d));c&&(c=this._doExecute(b));c&&this.Vp5()&&d&&(c=this.Vp4(b,d));return c};c.prototype.toString=function(){var b=CB.Viy.toString(this.type);switch(this.type){default:return b;case CB.Viy.Viz:return"MoveData="+this.moveData;case CB.Viy.Voj:return"SetAnno="+
this.anno;case CB.Viy.Voo:return"AddAnno="+this.anno;case CB.Viy.Voi:return"SetMove="+this.nVal}};c.prototype._doExecute=function(b){var d=!0;switch(this.type){case CB.Viy.Vof:b.reset();break;case CB.Viy.Voh:b.gotoIndex(this.nVal);d=this.nVal===b.getMoveIndex();break;case CB.Viy.Voi:var c=new CB.Veh(this.Vou.from,this.Vou.to,this.Vou.prom);this.Vp6(c,b.getCurPos())?(d=this.nVal,d===CB.Vhr.Vhu&&b.getPlyNum()<b.getMoves().length&&(d=CB.Vhr.Vhv),d=b.makeMove(c,d)):d=!1;break;case CB.Viy.Viz:d=this.Vp7(this.moveData,
b);break;case CB.Viy.Vor:case CB.Viy.Vog:b.assign(this.setGame);d=!0;break;case CB.Viy.Voj:this.nVal||0==b.getMoveOffs()?b.getMoves().setAnno(this.anno):(c=b.getPreviousMove())&&c.setAnno(this.anno);b.fireOnChanged();break;case CB.Viy.Vok:b.deleteLine();break;case CB.Viy.Vol:b.promoteLine();break;case CB.Viy.Vom:b.deletePrevious();break;case CB.Viy.Von:b.deleteRemaining();break;case CB.Viy.UNANNOTATE:b.unAnnotate();break;case CB.Viy.Voo:(c=this.nVal||0==b.getMoveOffs()?b.getMoves().getAnno():b.getPreviousMove().getAnno())||
(c=new CB.Annotation);this.anno.Vgl()?c.Vgf(this.anno.Vgm()):this.anno.Vgn()&&c.addPostText(this.anno.getPostText());this.nVal||0==b.getMoveOffs()?b.getMoves().setAnno(c):b.getPreviousMove().setAnno(c);b.fireOnChanged();break;case CB.Viy.Voq:b.onSync(this.nVal);break;case CB.Viy.Vos:b.setMoves(this.moves);break;case CB.Viy.Vot:b.setHeader(this.header),b.fireOnChanged()}return d};c.prototype.Vp3=function(){return this.type==CB.Viy.Voi||this.type==CB.Viy.Viz||this.type==CB.Viy.Voj||this.type==CB.Viy.Voo||
this.type==CB.Viy.Vol||this.type==CB.Viy.Von};c.prototype.Vp5=function(){return this.type==CB.Viy.Voh||this.type==CB.Viy.Vom||this.type==CB.Viy.Vok};c.prototype.Vp4=function(b,d){return 0==b.getMoveOffs()||b.getPreviousMove()&&b.getPreviousMove().equals(d)};c.prototype.changesMoves=function(){return this.type==CB.Viy.Voi||this.type==CB.Viy.Viz||this.type==CB.Viy.Vof||this.type==CB.Viy.Vok||this.type==CB.Viy.Vol||this.type==CB.Viy.Vom||this.type==CB.Viy.Von};c.prototype.Vp7=function(b,d){var c=!1,
f=new CB.Veh(b.move[0],b.move[1],b.move[2]);this.Vp6(f,d.getCurPos())&&(d.enableEvents(!1),d.makeMove(f,CB.Vhr.Vhv),d.getOrCreateCurrAnno().setItem(CB.AnnoType.TIME,new CB.Vp8(CB.V4q.V4r(b.centiSecs))),d.enableEvents(!0),d.fireOnMove(),d.fireOnCurPosChanged(),c=!0);return c};c.prototype.Vp6=function(b,d){return d.isLegalMove(b)};return c}();"use strict";CB.Vnn={Vp9:0,V3l:1,V3m:2,V2g:3,Vno:4,Vnp:5,Vpa:6,DRAW:7,WHITE_WINS:8,BLACK_WINS:9,Vpb:10};
CB.Vnm=function(){var c=function(){};c.prototype.checkGame=function(b){var d=this.Vpc(b.getCurPos());if(d!=CB.Vnn.Vp9)return d;if(8<=b.getPlyNum()){for(var d=b.getCurPos().getCastleRights(),c=b.getPlyNum()-8,f=b.getPlyNum()-1;f>=c;f--){var g=b.getMoves()[f];if(g){if(!g.undo)break;if(g.isTake()||g.isProm()||g.isPawn())return CB.Vnn.Vp9}else return CB.Vnn.Vp9}for(var c=b.getCurPos().getEPCol(),h=b.getPlyNum()-100,k=1,l=ObjUtil.clone(b.getCurPos()),f=b.getPlyNum();0<f;--f){g=b.getMoves()[--f];if(g.isTake()||
g.isProm()||g.isPawn())break;if(b.getCurPos().getEPCol()!=c)break;if(f<=h)return CB.Vnn.Vnp;if(!g.undo)break;l.unmakeMove(g,g.undo);if(k&&d!=l.getCastleRights()&&(k=0,0>=h))break;if(0<f){g=b.getMoves()[--f];if(g.isTake()||g.isProm()||g.isPawn())break;if(b.getCurPos().getEPCol()!=c)break;if(f<=h)return CB.Vnn.Vnp;if(!g.undo)break;l.unmakeMove(g,g.undo);if(k){if(d!=l.getCastleRights()&&(k=0,0>=h))break;if(c==l.getEPCol()&&l.boardEquals(b.getCurPos().board)&&(k++,0<=k))return CB.Vnn.Vno}}}}return CB.Vnn.Vp9};
c.prototype.Vpc=function(b){if(!b.hasLegals())return b.isCheck()?CB.Vnn.V3l:CB.Vnn.V3m;for(var d=[0,0,0,0,0,0,0,0],c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0,g=0,h=0;64>h;h++)d[b.board[h]&7]++,c[b.board[h]&15]++,(b.board[h]&7)==CB.Piece.BISHOP&&(b.board[h]&8?g=(h&1)==(h>>3&1)?g|1:g|2:f=(h&1)==(h>>3&1)?f|1:f|2);return d[CB.Piece.QUEEN]||d[CB.Piece.ROOK]||d[CB.Piece.PAWN]||!(!d[CB.Piece.BISHOP]&&1>=d[CB.Piece.KNIGHT]||!d[CB.Piece.KNIGHT]&&(1>=d[CB.Piece.BISHOP]||3>f&&3>g&&(!f||!g||f==g)))?CB.Vnn.Vp9:CB.Vnn.V2g};
c.prototype.canWin=function(b,d){var c=!1;try{for(var f=b.board,g=d==CB.Vaz.WHITE?0:CB.Vaz.Vb1,h=[],k=0;16>k;k++)h[k]=0;for(k=0;64>k;k++)h[f[k]&15]++,f[k]&&(f[k]&CB.Vaz.Vb1)==g&&(f[k]&CB.Piece.Vb2)!=CB.Piece.KING&&(c=!0);if(c&!h[CB.Vaz.Vl]&&!h[CB.Vaz.Vm]){var l=d==CB.Vaz.WHITE?CB.Piece.WHITE:CB.Piece.BLACK;if(!(h[l|CB.Piece.QUEEN]||h[l|CB.Piece.ROOK]||1!=h[l|CB.Piece.BISHOP]+h[l|CB.Piece.KNIGHT]||h[CB.Piece.COLOUR-l|CB.Piece.BISHOP]||h[CB.Piece.COLOUR-l|CB.Piece.KNIGHT]))if(h[l|CB.Piece.BISHOP]){if(h[CB.Piece.COLOUR-
l|CB.Piece.QUEEN]||h[CB.Piece.COLOUR-l|CB.Piece.ROOK])c=!1}else h[l|CB.Piece.KNIGHT]&&h[CB.Piece.COLOUR-l|CB.Piece.QUEEN]&&!h[CB.Piece.COLOUR-l|CB.Piece.ROOK]&&(c=!1)}}catch(m){c=!0,CB.Vjg("CanWin",m)}return c};return c}();"use strict";
CB.Vpd=function(){var c=0,b=function(b){this.Vpf=b;this.Vpg=new CB.Timer(this.update.bind(this));this.isBlack=!1;this.id=++c};b.prototype.onTimeOverstepped=function(b){this.Vpf.Vph(b)};b.prototype.Vpi=function(){this.Vpf.setText("---",!1);this.Vpf.setText("---",!0)};b.prototype.start=function(){};b.prototype.stop=function(){};b.prototype.Vpj=function(){return!1};b.prototype.Vpk=function(b){this.isBlack=b};b.prototype.Vja=function(b){this.Vpk(b);this.start()};b.prototype.Vpl=function(b){};b.prototype.onTimeOverstepped=
function(b){this.Vpf.Vph(b)};b.prototype.update=function(){};return b}();"use strict";
CB.Vkz=function(){var c=function(b,d){this.Vpm=void 0!==b?b:0;this.incSecs=d||0;1>this.Vpm&&0==this.incSecs&&(this.Vpm=1);this.Vpp=this.Vpo=this.Vpn=0};c.prototype.fromDataBuf=function(b){this.Vpm=b.V35k()&65535;this.incSecs=b.V35k()&65535;this.Vpn=b.V35l();this.Vpo=b.V35l();this.Vpp=b.V35k()};c.prototype.V35j=function(b){b.V35h(this.Vpm&65535);b.V35h(this.incSecs&65535);b.V35f(this.Vpn);b.V35f(this.Vpo);b.V35h(this.Vpp)};c.prototype.toString=function(){return this.Vpm+"m + "+this.incSecs+"s"};c.Vpq=
function(b){var d=new CB.Vkz(3,0);b&&(b=b.split(","),b.length&&(d.Vpm=b[0],0==d.Vpm&&(d.Vpm=5),1<b.length&&(d.incSecs=b[1])));return d};c.prototype.Vpr=function(){return 40*this.Vpm+this.incSecs};c.prototype.Vps=function(){return 900<this.Vpt()?CB.Server.Vpu.Vpv:180<=this.Vpt()?CB.Server.Vpu.Vpw:CB.Server.Vpu.Vpx};c.prototype.Vpy=function(){switch(this.Vps()){case CB.Server.Vpu.Vpx:return"Bullet";case CB.Server.Vpu.Vpw:return"Blitz";case CB.Server.Vpu.Vpv:return"Slow"}};c.prototype.Vpt=function(){return 60*
this.Vpm+40*this.incSecs};c.prototype.isBlitz=function(){return this.Vps()==CB.Server.Vpu.Vpw};c.prototype.Vpz=function(){return this.Vps()==CB.Server.Vpu.Vpx};c.prototype.Vq0=function(){return this.Vps()==CB.Server.Vpu.Vpv};c.prototype.getStartSecs=function(){return 60*this.Vpm};return c}();"use strict";CB.Vq1={Vq2:-1,Vq3:-2,Vq4:-3,Vq5:-4,Vq6:0,Vq7:1,Vq8:2,Vq9:3};
CB.ChessClock=function(){var c=1,b=function(b,e,f){CB.ChessClock.superClass.call(this,b);this.Vqa=e;this.Vqb=f;this.result=CB.Vgt.Vgu;this.Vqc=!1;this.Vqe=this.Vqd=0;this.uniqueId=c++;this.Vqf=!1;this.Vqg=null;this.Vqh=[]};CB.inherit(b,CB.Vpd);b.prototype.Vqi=function(){return 10*this.Vqd};b.prototype.Vqj=function(){return 10*this.Vqe};b.prototype.destroy=function(){};b.prototype.Vqk=function(){this.Vh0(this.clockParams)};b.prototype.Vh0=function(b){this.Vqh=[!1,!1];this.result=CB.Vgt.Vgu;b?(this.clockParams=
b,this.Vqd=6E3*this.clockParams.Vpm,this.Vqe=6E3*this.clockParams.Vpm,0==this.clockParams.Vpm&&(this.Vqe=this.Vqd=1E3),this.Vpf.Vql(new Date(10*this.Vqd),!1),this.Vpf.Vql(new Date(10*this.Vqe),!0),this.Vpf.Vqm(3E3<this.clockParams.Vpt())):(this.Vpi(),delete this.clockParams);delete this.startTime;delete this.Vqn};b.prototype.Vqo=function(b){this.Vqc=b;this.Vpf.Vqo(b)};b.prototype.Vpl=function(b){this.stop();if(this.clockParams){for(var c=6E3*this.clockParams.Vpm,f=6E3*this.clockParams.Vpm,g=this.Vqc?
-1:1,h=0;h<b.getPlyNum();h++)if(h<b.getMoves().length){var k=b.getMoves()[h].getAnno();k&&(k=k.getItem(CB.AnnoType.TIME))&&(h&1?(f-=g*k.getTimeIn100th(),f+=g*this.clockParams.incSecs*100):(c-=g*k.getTimeIn100th(),c+=g*this.clockParams.incSecs*100))}this.Vqd=c;this.Vqe=f;this.Vqr();this.isBlack=0!=(b.getMoves().length&1);this.Vpf.Vpk(this.isBlack);this.Vqs(c,f);b.isOnLastMove()&&(b.hdr.getCBResult().isFinished()?this.Vpf.Vqt(b.hdr.getResult()):this.start())}};b.prototype.Vng=function(b){this.isFinished()||
(this.result=b,this.stop(),this.Vpf.Vqt(b))};b.prototype.Vqu=function(){this.result=CB.Vgt.Vgu};b.prototype.isFinished=function(){return this.result>=CB.Vgt.BLACK_WINS&&this.result<=CB.Vgt.Vgv};b.prototype.Vpk=function(b){this.clockParams&&!this.isFinished()&&((this.isBlack=b)?this.Vqe+=100*this.clockParams.incSecs:this.Vqd+=100*this.clockParams.incSecs,this.Vqr(),this.Vpf.Vpk(b))};b.prototype.Vpj=function(){return this.Vqf};b.prototype.start=function(){this.Vqf||!this.clockParams||this.isFinished()||
(this.Vqf=!0,this.Vqr(),this.Vqs(this.Vqd,this.Vqe),this.Vpg.runOnce(1E3),delete this.Vqn)};b.prototype.stop=function(){if(this.Vqf&&(this.Vpg.stop(),this.startTime)){this.Vqf=!1;var b=(CB.V53()-this.startTime+5)/10;this.Vqn=b;this.isFinished()||this.Vqv(b,this.isBlack)}};b.prototype.Vqr=function(){this.startTime=CB.V53();this.Vqw=this.isBlack?this.Vqe:this.Vqd};b.prototype.Vqx=function(b){return b?this.Vqe:this.Vqd};b.prototype.Vqs=function(b,c){0<=b?this.Vpf.Vql(new Date(10*b),!1):this.Vpf.Vql(-1,
!1);0<=c?this.Vpf.Vql(new Date(10*c),!0):this.Vpf.Vql(-1,!0)};b.prototype.Vqv=function(b,c){if(this.clockParams){this.Vpf.Vqy(new Date(10*b),c);var f;this.Vpf.Vqy(new Date(10*b),c);f=this.Vqc?c?this.Vqe=this.Vqw+b:this.Vqd=this.Vqw+b:c?this.Vqe=this.Vqw-b:this.Vqd=this.Vqw-b;0>f?this.Vpf.Vql(-1,c):this.Vpf.Vql(new Date(10*f),c,this.Vqz());return f}};b.prototype.Vr0=function(b){if(this.clockParams&&!this.isFinished()){var c=(CB.V53()-this.startTime+5)/10;this.startTime=CB.V53()-10*b;this.Vqw-=b-c;
this.Vpg.stop();this.Vqn=b;this.Vqv(b,this.isBlack);this.update()}};b.prototype.reset=function(){this.Vh0(new CB.Vkz(0,0))};b.prototype.V50=function(){return this.Vqn?this.Vqn:this.startTime?(CB.V53()-this.startTime+5)/10:0};b.prototype.Vr1=function(){var d=b.Vr2(new Date(10*this.Vqd)),c=b.Vr2(new Date(10*this.Vqe)),f="";0<=this.Vqd&&(f=String.f("{0}={1}",lm.WHITE,d));d="";0<=this.Vqe&&(d=String.f("{0}={1}",lm.BLACK,c));(c=f)&&d&&(c+=", ");return c+d};b.prototype.Vr3=function(){return new CB.Vp8(CB.V4q.V4r(this.V50()))};
b.prototype.setText=function(b,c){this.Vpf.setText(b,c)};b.prototype.update=function(){var b=(CB.V53()-this.startTime+5)/10,c=this.Vqv(b,this.isBlack);if(0<c){this.Vpf.Vr4(1E3>c);var f=1E3;1E3>c&&(f=100);this.Vpg.runOnce(f);15<b/100&&b>c/3&&this.Vqb&&!this.Vqh[this.isBlack?1:0]&&(this.Vqb(this.isBlack),this.Vqh[this.isBlack?1:0]=!0)}else this.Vqa&&!this.isFinished()&&(this.Vpf.setText("TIME",this.isBlack),this.Vqa())};b.prototype.Vqz=function(){if(null!=this.Vqg){var b,c;this.isBlack?(b=this.Vqe,
c=this.Vqd):(b=this.Vqd,c=this.Vqe);return Math.abs(b-c)<.1*Math.abs(b)&&2E3<b?CB.Vq1.Vq6:b>c?b>1.2*c?b>2*c?CB.Vq1.Vq9:CB.Vq1.Vq8:CB.Vq1.Vq7:b<.7*c?b<.5*c?b<.3*c&&1E3>b?CB.Vq1.Vq5:CB.Vq1.Vq4:CB.Vq1.Vq3:CB.Vq1.Vq2}return 0};b.Vr2=function(b,c,f){0>b&&(b=new Date(0));var g="";c&&(g=b.getUTCHours()+":");1E4>b.valueOf()&&!f?(c=b.getUTCSeconds(),b=Math.floor(b.getUTCMilliseconds()/100),g=c+"."+b+"s"):(c=b.getUTCMinutes(),1==c.toString().length&&0<c&&(c="0"+c),g+=c,c=Math.floor(b.getUTCSeconds()),1==c.toString().length&&
(c="0"+c),g+=":"+c);return g};return b}();"use strict";CB=CB||{};
CB.Vr6=function(){var c=function(){};c.prototype.destroy=function(){};c.prototype.deleteClock=function(){};c.prototype.onTimeOverstepped=function(b){};c.prototype.onAnnotate=function(){this.saved=!1;return!0};c.prototype.onTextAnno=function(b,d){this.saved=!1;return!0};c.prototype.Vl8=function(){this.saved=!1;return!0};c.onEval=function(b){this.saved=!1;return!0};c.prototype.onPromoteLine=function(){this.saved=!1;return!0};c.prototype.onDeletePrevious=function(){this.saved=!1;return!0};c.prototype.onCutLine=
function(){this.saved=!1;return!0};c.prototype.onDeleteLine=function(){this.saved=!1;return!0};c.prototype.onBeforeUnload=function(){};c.prototype.Vn5=function(){return CB.Vhr.Vhv};c.prototype.Vl3=function(){return!0};c.prototype.Vm2=function(){return!0};c.prototype.Vm3=function(){return!0};c.prototype.Vm4=function(){return!0};c.prototype.mayLoadGames=function(){return!0};c.prototype.onKeyDown=function(b){return!1};c.prototype.isAnalysis=function(){return!1};c.prototype.setAnalysis=function(b){};
c.prototype.Vr7=function(){return!1};c.prototype.Vnu=function(){};c.prototype.beforeGameLoad=function(){this.Vr8();this.saved=!1};c.prototype.Vr9=function(){};c.prototype.Vnt=function(){};c.prototype.Vr8=function(){this.saveToCloud(!0);this.Vra=0};c.prototype.onExit=function(){this.saveToCloud()};c.prototype.onEntry=function(){};c.prototype.shouldAnimatePosChange=function(){6;return CB.V5t.runsOnChessBaseDomain()||!CB.V5t.V6t()};c.prototype.saveToCloud=function(b){return V35p.cloudMgr&&V35p.cloudMgr.Vrb()&&
!this.saved&&this.Vrc(b)&&(6<this.kernel.game.getMoves().length||!this.kernel.game.isNormalInit())?(V35p.cloudMgr.Vrd(this.kernel.game),!0):!1};c.prototype.Vrc=function(){return!0};c.prototype.Vku=function(){};c.prototype.Vnr=function(){};c.prototype.Vnq=function(){};c.prototype.Vnv=function(){};c.prototype.Vre=function(){};c.prototype.Vjt=function(b){};c.prototype.Vn4=function(b){return!0};c.prototype.Vna=function(b){};c.prototype.Vng=function(b){};c.prototype.updateClockFromGame=function(){};c.prototype.startClock=
function(){};c.prototype.stopClock=function(){};c.prototype.Vjs=function(){return CB.Vj1.Vj4};c.prototype.Vrf=function(b){};c.prototype.Vjb=function(){return null};c.prototype.Vjv=function(b){};c.prototype.Vrg=function(){};c.prototype.Vrh=function(b){};c.prototype.setManualClock=function(){};c.prototype.Vri=function(){};c.prototype.Vmi=function(b){b.reset()};c.prototype.newGame=function(){};c.prototype.Vkp=function(){};c.prototype.createGUIElements=function(b){};c.prototype.Vks=function(b){};c.prototype.Vkr=
function(b){};c.prototype.Vkt=function(b){};c.prototype.Vl1=function(b){return b.isLegal()};c.prototype.Vkm=function(b){return!1};return c}();"use strict";CB=CB||{};
CB.Vrj=function(){var c=function(b){CB.Vrj.superClass.call(this);this.kernel=b;this.Vrk=!1};CB.inherit(c,CB.Vr6);c.prototype.loadGame=function(b){this.beforeGameLoad();this.kernel.game.assign(b);this.Vr9()};c.prototype.destroy=function(){this.deleteClock()};c.prototype.deleteClock=function(){this.clock=null;this.Vrl&&(this.Vrl.stop(),delete this.Vrl);this.Vrm&&(this.Vrm.stop(),delete this.Vrm)};c.prototype.onTimeOverstepped=function(b){if(this.clock)this.clock.onTimeOverstepped(b)};c.prototype.Vn4=
function(b){this.clock&&this.clock.stop();return!0};c.prototype.isAnalysis=function(){return!0};c.prototype.Vrn=function(){"undefined"!=typeof V35p&&!V35p.analysisEngine&&CB.V5t.V65()&&V35p.config.Vro&&CB.AnalysisEngine&&(V35p.analysisEngine=new CB.AnalysisEngine)};c.prototype.Vn5=function(){return this.kernel.game.isLineEnd()?CB.Vhr.Vhx:V35p.Vrp()?CB.Vhr.Vhu:this.isAnalysis()?CB.Vhr.Vhx:CB.Vhr.Vhv};c.prototype.Vng=function(b){this.clock&&this.clock.Vng(b)};c.prototype.updateClockFromGame=function(){this.clock&&
this.clock.Vpl(this.kernel.game)};c.prototype.startClock=function(){this.clock&&this.clock.start()};c.prototype.stopClock=function(){this.clock&&this.clock.stop()};c.prototype.Vjs=function(){return CB.Vj1.Vj4};c.prototype.Vnq=function(){this.updateClockFromGame()};c.prototype.setManualClock=function(b,d,c){delete this.Vrm;this.kernel.boardWin&&this.kernel.boardWin.Vrq()&&(this.clock&&this.clock.stop(),this.Vrl=new CB.ManualClock(this.kernel.boardWin.Vrq()),this.Vrl.Vrr(b,d,c),this.Vrl.Vng(this.kernel.game.hdr.getResult()),
this.clock=this.Vrl)};c.prototype.Vnt=function(){this.Vrl&&this.Vrl.Vng(this.kernel.game.hdr.getResult())};c.prototype.Vri=function(b){delete this.Vrl;this.kernel.boardWin&&this.kernel.boardWin.Vrs()&&(this.Vrm=new CB.ChessClock(this.kernel.boardWin.Vrq()),this.Vrm.Vh0(b),b&&this.Vrm.Vpl(this.kernel.game),this.clock=this.Vrm)};c.prototype.Vrt=function(b){b.fnMarkSquaresOnButtonDown=this.getMarkedSquaresOnButtonDown.bind(this)};c.prototype.Vru=function(){this.kernel.boardWin.fnMarkSquaresOnButtonDown=
null};c.prototype.getMarkedSquaresOnButtonDown=function(b){return this.Vrv(b)};c.prototype.Vrw=function(){return"hsla( 0, 0%, 50%, 0.25 )"};c.prototype.Vrv=function(b){var d=[];this.kernel.game.getCurPos().V34r().forEach(function(c){c.from==b&&d.push({sq:c.to,clr:this.Vrw()})}.bind(this));return d};c.prototype.setIsAutoplay=function(b){this.Vrk=b};return c}();CB.Vnj={Vnk:2,Vrx:4,Vo:8,Vry:16};"use strict";CB=CB||{};
CB.Vrz=function(){var c=function(b,d){CB.Vrj.call(this,b);this.Vs0=d||0;this.Vs1=[];this.Vs2=0;this.panEng=null};CB.inherit(c,CB.Vrj);c.prototype.Vs3=function(b,d){return new CB.Vs4(b,this.Vs0,d)};c.prototype.Vlb=function(b){var d=this.Vs1[0],c=d.getMultiPV(),c=Math.max(c+b,1);this.Vs5();d.setMultiPV(c);this.goAll()};c.prototype.Vs6=function(b){this.Vs2<b+1&&(this.Vs2=b+1);if(this.kernel.Vjz.Vs7){var d=this.panEng=this.kernel.Vjz.Vs7(b);if(d&&!this.Vs1[b]){var c=this.Vs1[b]=this.Vs3(V35p.config.Vs8()[b],
b);d.setEngine(c);d.setAnalysis&&d.setAnalysis(this.isAnalysis());this.addOnBestMove(c);c.setTag(b)}}};c.prototype.Vs9=function(b){return!!this.Vs1[b]};c.prototype.Vsa=function(b){this.Vs1[b]&&(this.Vs1[b].exit(),delete this.Vs1[b])};c.prototype.Vsb=function(b,d){this.kernel.game.getCurPos().isLegalMove(d.move)&&this.kernel.execEngineMove(d.move)};c.prototype.addOnBestMove=function(b){this.Vsc=b.addOnBestMoveListener(this.Vsb.bind(this))};c.prototype.removeOnBestMove=function(b){b.removeOnBestMoveListener(this.Vsc)};
c.prototype.destroy=function(){this.Vs5();this.Vs1.forEach(function(b){b&&b.dispose()})};c.prototype.goAll=function(){this.Vs1.forEach(function(b){b&&b.go(this.kernel.game)}.bind(this))};c.prototype.Vs5=function(){this.Vs1.forEach(function(b){b&&b.stop()})};c.prototype.newGame=function(){this.Vs5();this.Vs1.forEach(function(b){b&&b.newGame()})};c.prototype.Vsd=c.prototype.Vs5;c.prototype.Vse=function(){this.Vsf(!this.Vsg())};c.prototype.Vsf=function(b){};c.prototype.Vsg=function(){return!1};c.prototype.Vsh=
function(){return 0};c.prototype.Vkr=function(b){};c.prototype.Vkt=function(b){};return c}();
CB.Vsi=function(){return{toggleEngine:function(){if(this.Vs9(0))return this.Vsa(0),!1;this.Vs6(0);this.Vku();return!0},incNMultiVars:function(c){this.Vsj+=c;1>this.Vsj&&(this.Vsj=1);64<this.Vsj&&(this.Vsj=64)},goAll:function(){this.Vsk=!1;this.Vs1.forEach(function(c){c.setMultiPV(this.Vsj);c&&(c.go(this.kernel.game,{infinite:!0}),c.fireOnThreat(!1))}.bind(this))},toggleThreat:function(){if(this.Vsk)this.goAll();else{var c=ObjUtil.clone(this.kernel.game.cur);if(c.swapSide()){this.Vsk=!0;var b=new CB.Game(c);
this.Vs1.forEach(function(d){d.setMultiPV(this.Vsj);d&&(d.go(b,{infinite:!0}),d.fireOnThreat(!0))}.bind(this))}}}}}();"use strict";
CB.Vsl=function(){var c=function e(b,c,h){e.superClass.call(this,b,CB.Vsl.POOL_SIZE);this.kernel=b;this.Vsm=c||1;this.Vsn=0;this.active=!0;this.Vso=new CB.Timer(this.Vsp.bind(this));this.Vsq=new CB.Timer(this.Vsr.bind(this));"undefined"!=typeof V35p&&!V35p.analysisEngine&&CB.V5t.V65()&&V35p.config.Vro&&CB.AnalysisEngine&&(V35p.analysisEngine=new CB.AnalysisEngine);this.Vsj=1;this.Vss=h?h.hintTimeout||500:500;this.Vst=h&&h.liveBookSilent?this.checkLiveBook.bind(this):this.Vsu.bind(this);this.Vsv=0};
CB.inherit(c,CB.Vrz);CB.Vsi&&CB.V0(c,CB.Vsi);c.POOL_SIZE=2;c.prototype.destroy=function(){V35p.analysisEngine&&(V35p.analysisEngine.dispose(),V35p.analysisEngine.Vsw(this));this.superClass.destroy.call(this);V35p.commands.Vsx(CB.Vlw.Vm1,!1)};c.prototype.Vkp=function(){for(var b=0;b<this.Vsm;b++)this.Vs6(b);V35p.commands.Vsx(CB.Vlw.Vm1,!0);this.panEng&&(this.Vsy=this.panEng.addOnMoveEnteredListener(this.kernel.Vkm.bind(this.kernel)))};c.prototype.createGUIElements=function(b){this.superClass.createGUIElements.call(this,
b);b.shouldAnimatePosChange=this.shouldAnimatePosChange.bind(this);CB.V5t.V64()&&(b.animSteps={forMove:.3,forPosition:.2});V35p.analysisEngine&&V35p.analysisEngine.Vsz(this)};c.prototype.Vnu=function(){this.Vsv=0};c.prototype.Vn4=function(b){return this.fnAcceptMove?this.fnAcceptMove(b):!0};c.prototype.onExit=function(){this.superClass.onExit.call(this);V35p.analysisEngine&&(V35p.analysisEngine.Vt0(),V35p.analysisEngine.Vt1())};c.prototype.Vna=function(b){if(this.fnAfterMove)return this.fnAfterMove(b)};
c.prototype.Vsd=function(){this.active=!1;this.superClass.Vsd.call(this)};c.prototype.isAnalysis=function(){return!0};c.prototype.setAnalysis=function(b){clearTimeout(this.timer);this.active=b;V35p.commands.Vsx(CB.Vlw.Vm1,b);for(var c=0;c<this.Vs2;++c)b||void 0===this.Vs1[c]||this.Vs1[c].abort();b&&this.Vku()};c.prototype.Vrh=function(b){throw Error("Cannot set search time on analysis playing mode");};c.prototype.Vre=function(){this.setAnalysis(!0);for(var b=0;b<this.Vt2;++b)this.Vs6(b);this.Vku()};
c.prototype.pendingMoveNow=!1;c.prototype.Vr7=function(){};c.ENGINE_DELAY=100;var b=new CB.V35b;c.prototype.Vt3=new CB.V35b;c.prototype.Vku=function(){this.kernel==V35p.panelMgr.getKernel()&&(this.Vs5(),this.Vrk||(b.exec(function(){this.active&&this.kernel.game.getCurPos().hasLegals()&&this.goAll()}.bind(this),c.ENGINE_DELAY),this.Vt3.exec(function(){this.Vst();V35p.analysisEngine&&V35p.analysisEngine.Vt4(this.kernel)}.bind(this),400)))};c.prototype.Vsu=function(){!V35p.aTBLobby||!V35p.aTBLobby.isLoggedIn()||
this.Vt5&&this.Vt5.equals(this.kernel.game.getCurPos())&&!this.kernel.forceTBUpdate||(this.Vt5=ObjUtil.clone(this.kernel.game.getCurPos()),V35p.panelMgr.tbBook&&(V35p.panelMgr.tbBook.clear("Requesting moves..."),V35p.panelMgr.tbBook.V94()&&V35p.aTBLobby.Vt6(this.kernel.game.getCurPos(),!1,!1,this.kernel.ticket),this.Vt7||(this.Vt7=V35p.aTBLobby.addOnLiveBookListener(this.Vt8.bind(this))),this.Vt9||(this.Vt9=V35p.aTBLobby.addOnTBDataListener(this.Vta.bind(this))),this.Vso.runOnce(5E3),V35p.aTBLobby.Vtb(this.kernel.game.getCurPos()),
this.Vsq.isActive||this.Vsq.runOnce(15E3)),this.kernel.forceTBUpdate=!1)};c.prototype.checkLiveBook=function(){this.Vtc()?this.Vt5&&this.Vt5.equals(this.kernel.game.getCurPos())&&!this.kernel.forceTBUpdate||(this.Vt5=ObjUtil.clone(this.kernel.game.getCurPos()),V35p.aTBLobby.Vt6(this.kernel.game.getCurPos(),!1,!1,this.kernel.ticket),this.Vt7||(this.Vt7=V35p.aTBLobby.addOnLiveBookListener(this.Vt8.bind(this))),this.Vt9||(this.Vt9=V35p.aTBLobby.addOnTBDataListener(this.Vta.bind(this))),this.Vso.runOnce(5E3),
this.kernel.forceTBUpdate=!1):V35p.aTBLobby.fireOnLiveBookDisplay({ticket:this.kernel.ticket,moves:[]})};c.prototype.Vtc=function(){var b=this.kernel.getCurPos();return 6<b.getPieces().length&&16>b.getPieces().length?!1:V35p.aTBLobby.isLoggedIn()&&(6>this.Vsv||10>this.kernel.game.getMoveNo())&&(60>this.kernel.game.getMoveNo()||6>=b.getPieces().length||2550<this.kernel.game.hdr.Vhb())};c.prototype.Vt8=function(b){V35p.aTBLobby.fireOnLiveBookDisplay(b);this.Vso.stop();this.Vsv=0};c.prototype.Vta=function(){};
c.prototype.Vsp=function(){V35p.panelMgr.tbBook&&V35p.panelMgr.tbBook.Vtd(lm.FRESH_POSITION);this.Vsv++};c.prototype.Vsr=function(){V35p.aTBLobby&&V35p.aTBLobby.Vte&&V35p.panelMgr.tbBook&&V35p.aTBLobby.Vtb(this.kernel.game.getCurPos())};c.prototype.Vtf=function(){this.active&&this.kernel.game.getCurPos().hasLegals()&&this.goAll()};c.prototype.Vn5=function(){return this.Vtg?this.Vtg():CB.Vhr.Vhx};c.prototype.getMarkedSquaresOnButtonDown=function(b,c){return c&&!this.clickHintTimer.isActive()?this.Vth(b):
this.Vrv(b)};c.prototype.startClickHintTimer=function(b){this.kernel.game.getMoveOffs()<this.Vti||this.clickHintTimer.runOnce(this.Vss,function(){var c=this.Vth(b);this.kernel.boardWin.Vtj(c)}.bind(this))};c.prototype.Vrw=function(){return"hsla( 0, 0%, 55%, 0.50 )"};c.prototype.Vth=function(b){var c=[];if(CB.Piece.side(this.kernel.getCurPos().board[b])!=this.kernel.getCurPos().getSideToMove())return c;V35p.analysisEngine&&(b=V35p.analysisEngine.Vtk(b),b.forEach(function(b){for(var e=!1,k=0;!e&&k<
c.length;k++)c[k].sq==b.sq&&(e=!0);e||c.push(b)}),0!=b.length||V35p.analysisEngine.Vtl||V35p.analysisEngine.Vt4(this.kernel));return c};c.prototype.onAnalysisLine=function(b,c,g){this.kernel.game.hasTBEval||(this.kernel.getCurPos().getBTM()&&(c=-c),this.kernel.game.fireOnEval(b,c,g))};c.prototype.toggleEngine=function(){if(this.Vs9(0))return this.Vsa(0),!1;this.Vs6(0);this.Vku();return!0};return c}();"use strict";
CB.AnnoType={Vgi:2,Vgo:3,SQUARE_LIST:4,ARROW_LIST:5,DIAGRAM:6,TIME:7,Vtm:8,Vf5:9,Vtn:16,Vto:16,Vtp:17,Vtq:18,Vtr:19,Vts:20,Vtt:21,Vtu:22,Vtv:23,Vtw:24,Vtx:25,Vty:26,Vtz:27,Vu0:32,Vu1:32,Vu2:33,Vu3:34,Vu4:35,V13:36,Voq:37,Via:38,Vu5:127,Vu6:127,Vu7:127,Vu8:128,toString:function(c){for(var b in this)if(this[b]==c)return"AnnoType: "+b;return"Unknown AnnoType: "+c}};CB.Vlk={V5k:0,Vll:1,Vlm:2,Vln:3,Vlo:4,Vlp:5,Vlq:6,Vu9:8,Vua:22,Vub:165,Vuc:166,WHITE:167,BLACK:168,Vud:169};
CB.Vlr={V5k:0,EQUAL:11,UNCLEAR:13,Vlt:15,BLACK_BETTER:17,BLACK_WINS:19,WHITE_WINS:18,WHITE_BETTER:16,Vls:14,COMPENSATION:44,Vue:132,Vuf:36,Vug:40,Vuh:138,Vui:32,Vuj:146};CB.Vuk={Vul:0,Vum:1,Vun:2,Vuo:3,Vup:4};CB.AnnoType.Vgg=CB.AnnoType.Vu8|CB.AnnoType.Vgi;CB.AnnoType.Vuq=CB.AnnoType.Vu8|CB.AnnoType.SQUARE_LIST;CB.AnnoType.Vur=CB.AnnoType.Vu8|CB.AnnoType.ARROW_LIST;CB.Vus={Vut:1,Vuu:2,Vuv:4,Vuw:8,Vux:16,Vuy:32,TACTICS:64,Vug:128,Vuz:256,Vv0:512,V2g:1024,Vv1:2048,Vv2:4096,Vv3:8192,Vv4:16384,Viu:32768};
var AnnoFactory={factory:function(c){return c in this?new this[c]:null}};function AnnoRec(){}AnnoRec.readHeader=function(c){return{inxMv:c.readBEInt24(),type:c.readByte(),len:c.readBEInt16()}};AnnoRec.writeHeader=function(c,b,d,e){c.writeBEInt24(b);c.writeByte(d);c.writeBEInt16(e)};AnnoRec.ANNO_HEAD_SIZE=6;
CB.Vgh=function(){var c=function(b){this.Vv5=CB.Vuk.Vul;this.m_str=b?b:""};c.prototype.getString=function(){return this.m_str};c.prototype.Vv6=function(b){this.m_str=b};c.prototype.toString=function(){return this.m_str};c.prototype.addText=function(b){this.m_str+=b};c.prototype.write=function(b,d){var c=AnnoRec.ANNO_HEAD_SIZE+2+this.m_str.length;b.V352(c);AnnoRec.writeHeader(b,0,d,c);b.writeByte(this.Vv5||CB.Vuk.Vul);b.writeByte(0);b.writeSizedString(this.m_str)};c.prototype.read=function(b,d){this.Vv5=
d.readByte();d.readByte();this.m_str=d.readSizedString(b-2);CB.V47.V4b(this.m_str)&&(this.m_str=CB.V47.V49(this.m_str))};return c}();AnnoFactory[CB.AnnoType.Vgi]=CB.Vgh;AnnoFactory[CB.AnnoType.Vgg]=CB.Vgh;
CB.Vgp=function(){var c=function(){};c.prototype=[];c.prototype.toString=function(){return"syms"};c.prototype.Vv7=function(b){return 1<=b&&6>=b};c.prototype.Vv8=function(b){return 11<=b&&19>=b||44==b};c.prototype.addSymbol=function(b){for(var d=0;d<this.length;d++)if(this.Vv7(this[d])&&this.Vv7(b)||this.Vv8(this[d])&&this.Vv8(b)){b!=this[d]&&this.push(b);this.splice(d,1);return}for(d=0;d<this.length;d++)if(b==this[d]){this.splice(d,1);return}this.push(b)};c.prototype.hasExclusiveEval=function(b){for(var d=
0;d<this.length;d++)if(b==this[d]&&this.Vv8(b))return!0;return!1};c.prototype.getEval=function(){for(var b=0;b<this.length;b++)if(this.Vv8(this[b]))return this[b];return 0};c.prototype.write=function(b){var d=AnnoRec.ANNO_HEAD_SIZE+this.length;b.V352(d);AnnoRec.writeHeader(b,0,CB.AnnoType.Vgo,d);for(d=0;d<this.length;d++)b.writeByte(this[d])};c.prototype.read=function(b,d){for(var c=0;c<b;++c)this.push(d.readByte())};return c}();AnnoFactory[CB.AnnoType.Vgo]=CB.Vgp;
CB.Vv9={V5k:0,GREEN:1,YELLOW:2,RED:3,Vva:4};CB.Vv9.Vvb=function(c){switch(c){case "R":return CB.Vv9.RED;case "Y":return CB.Vv9.YELLOW;case "G":return CB.Vv9.GREEN;default:return CB.Vv9.V5k}};CB.Vv9.fromString=function(c){switch(c){case "R":case "LR":return CB.Vv9.RED;case "Y":return CB.Vv9.YELLOW;case "LG":case "G":return CB.Vv9.GREEN;default:return CB.Vv9.GREEN}};CB.Vv9.Vvc=function(c){switch(c){case CB.Vv9.RED:return"R";case CB.Vv9.YELLOW:return"Y";case CB.Vv9.GREEN:return"G"}return""};
CB.ColSq=function(){function c(b,d){this.field=b;this.Vvd=d}c.STRING_LEN=3;c.prototype.init=function(b){this.Vvd=CB.Vv9.GREEN;this.field=CB.Vbf.Vbk;4==b.length?(this.Vvd=CB.Vv9.fromString(b.substring(0,2)),this.field=CB.Vbf.fromString(b.substring(2,4))):3==b.length&&(this.Vvd=CB.Vv9.Vvb(b[0]),this.field=CB.Vbf.fromString(b.substring(1)))};c.readFactory=createReadFactory(c);c.prototype.read=function(b){this.Vvd=b.readByte();this.field=b.readByte();this.Vvd--;this.field--};c.prototype.write=function(b){b.writeByte(this.Vvd+
1);b.writeByte(this.field+1)};c.prototype.toString=function(){return CB.Vv9.Vvc(this.Vvd)+CB.Vbf.toString(this.field)};c.prototype.getColour=function(){switch(this.Vvd){case CB.Vv9.GREEN:return"hsla( 120, 65%, 50%, 0.75 )";case CB.Vv9.YELLOW:return"hsla( 60, 65%, 50%, 0.8 )";case CB.Vv9.RED:return"hsla( 0, 65%, 50%, 0.75 )"}};return c}();
CB.ColSqAnno=function(){var c=function(){};c.prototype=[];c.prototype.read=function(b,d){for(var c=0;c<b/2;c++){var f=new CB.ColSq(0,0);f.read(d);this.push(f)}};c.prototype.write=function(b){var d=AnnoRec.ANNO_HEAD_SIZE+2*this.length;b.V352(d);AnnoRec.writeHeader(b,0,CB.AnnoType.SQUARE_LIST,d);for(d=0;d<this.length;d++)this[d].write(b)};c.prototype.toString=function(b){b||(b=",");return this.join(b)};return c}();AnnoFactory[CB.AnnoType.SQUARE_LIST]=CB.ColSqAnno;
CB.ColArrow=function(){var c=function(b,d,c){this.from=b;this.to=d;this.Vvd=c};c.STRING_LEN=5;c.prototype.init=function(b){this.from=CB.Vbf.fromString(b.substring(1,3));this.to=CB.Vbf.fromString(b.substring(3,5));this.Vvd=CB.Vv9.Vvb(b[0])};c.readFactory=createReadFactory(c);c.prototype.read=function(b){this.Vvd=b.readByte();this.from=b.readByte();this.to=b.readByte();this.Vvd--;this.from--;this.to--};c.prototype.write=function(b){b.writeByte(this.Vvd+1);b.writeByte(this.from+1);b.writeByte(this.to+
1)};c.prototype.toString=function(){return CB.Vv9.Vvc(this.Vvd)};c.prototype.getColour=function(){switch(this.Vvd){case CB.Vv9.GREEN:return"hsla( 120, 70%, 50%, 0.90 )";case CB.Vv9.YELLOW:return"hsla( 50, 75%, 65%, 0.90 )";case CB.Vv9.RED:return"hsla( 1, 85%, 45%, 0.90 )"}};return c}();
CB.ColArrowAnno=function(){var c=function(){};c.prototype=[];c.prototype.read=function(b,d){for(var c=0;c<b/3;c++){var f=new CB.ColArrow;f.read(d);this.push(f)}};c.prototype.write=function(b){var d=AnnoRec.ANNO_HEAD_SIZE+3*this.length;b.V352(d);AnnoRec.writeHeader(b,0,CB.AnnoType.ARROW_LIST,d);for(d=0;d<this.length;d++)this[d].write(b)};c.prototype.toString=function(b){b||(b=",");return this.join(b)};return c}();AnnoFactory[CB.AnnoType.ARROW_LIST]=CB.ColArrowAnno;
AnnoFactory[CB.AnnoType.DIAGRAM]=CB.Vgh;CB.Vve=function(){var c=function(b,d){b&&(this.eval=b);d&&(this.depth=d)};c.prototype.eval=0;c.prototype.depth=0;c.prototype.toString=function(){return this.eval+"/"+this.depth};c.prototype.read=function(b,d){this.eval=d.V35l();this.type=d.V35l();this.depth=d.V35l()};return c}();AnnoFactory[CB.AnnoType.Vu2]=CB.Vve;
CB.Vp8=function(){var c=function(b){this.time=b||0};c.prototype.getString=function(){var b=this.time>>24,d=this.time>>16&255,c=this.time>>8&255,f=this.time&255,g="";0<b&&(g=b+":");0<d&&(10>d&&0<g.length&&(g+="0"),g+=d+":");10>c&&0<g.length&&(g+="0");0==d&&0==b&&10>c?(g+=c,b=Math.floor(f/10),0<b&&(g+="."+b)):(b=Math.round(c+f/50),60==b&&(b=59),g+=b);return g};c.prototype.Vvf=function(b){this.time=CB.V4q.V4r(b)};c.prototype.toString=function(){return"Time: "+Math.round(this.getTimeIn100th()/100)+"s"};
c.prototype.read=function(b,c){this.time=c.readBEInt32()};c.prototype.write=function(b){var c=AnnoRec.ANNO_HEAD_SIZE+4;b.V352(c);AnnoRec.writeHeader(b,0,CB.AnnoType.TIME,c);b.writeBEInt32(this.time)};c.prototype.getTimeIn100th=function(){return 36E4*(this.time>>24)+6E3*(this.time>>16&255)+100*(this.time>>8&255)+(this.time&255)};return c}();AnnoFactory[CB.AnnoType.TIME]=CB.Vp8;
CB.Vvg=function(){var c=function(){};c.prototype.toString=function(){return"TC=NOTIMPL"};c.prototype.read=function(b,c){for(var e=0;e<b;e++)c.readByte()};return c}();AnnoFactory[CB.AnnoType.V13]=CB.Vvg;
CB.Vvh=function(){var c=function(){this.data=[]};c.prototype.toString=function(){return"Sync"};c.prototype.read=function(b,c){for(var e=0;e<b;e++)this.data[e]=c.readByte()};c.prototype.write=function(b){var c=AnnoRec.ANNO_HEAD_SIZE+4;b.V352(c);AnnoRec.writeHeader(b,0,CB.AnnoType.Voq,c);for(var e=0,c=this.data.length;e<c;++e)b.writeByte(this.data[e])};return c}();AnnoFactory[CB.AnnoType.Voq]=CB.Vvh;
CB.Vvi=function(){var c=function(b){this.Vvj=b};c.prototype.toString=function(){return"Medal-"+this.Vvj};c.prototype.getString=function(){return this.toString()};c.prototype.getOneMedal=function(){return this.Vvj&CB.Vus.Vv0?CB.Vus.Vv0:this.Vvj&CB.Vus.Vv2?CB.Vus.Vv2:this.Vvj&CB.Vus.Vuy?CB.Vus.Vuy:this.Vvj&CB.Vus.Vv3?CB.Vus.Vv3:this.Vvj};c.prototype.read=function(b,c){this.Vvj=c.V35g()};c.prototype.write=function(b){var c=AnnoRec.ANNO_HEAD_SIZE+4;b.V352(c);AnnoRec.writeHeader(b,0,CB.AnnoType.Vu3,c);
b.V351(this.Vvj)};return c}();AnnoFactory[CB.AnnoType.Vu3]=CB.Vvi;
CB.EvalProfileAnno=function(){var c=function(b,c,e){this.first=b||0;this.last=c||0;this.Vvk=e||[];this.min=32767;this.max=-32767;this.Vvl()};c.Vvm=32767;c.prototype.Vvl=function(){for(var b=0;b<this.Vvk.length;b++)this.Vvk[b]!=c.Vvm&&(this.Vvk[b]>this.max&&(this.max=this.Vvk[b]),this.Vvk[b]<this.min&&(this.min=this.Vvk[b]))};c.prototype.Vvn=function(){return Math.max(1,this.max-this.min)};c.prototype.toString=function(){return"MoveMedal"};c.prototype.isValid=function(){return this.last>this.first};
c.prototype.read=function(b,d){this.Vvk=[];this.last=this.first=0;var e=d.readBEInt16();if(600>e){for(var f=0;f<e;f++){var g=new ArrayBuffer(4),h=new DataView(g);h.setInt8(0,d.readByte());h.setInt8(1,d.readByte());h.setInt8(2,d.readByte());h.setInt8(3,d.readByte());g=h.getInt16(2);h.getInt8(1);h=h.getInt8(0);-1==h?this.Vvk.push(c.Vvm):(1==h&&(g=0>g?-3E4+g:3E4-g),this.Vvk.push(g))}this.last=e-1}this.Vvl()};c.readFactory=createReadFactory(c);c.prototype.write=function(b){var d=AnnoRec.ANNO_HEAD_SIZE+
2+4*this.Vvk.length;b.V352(d);AnnoRec.writeHeader(b,0,CB.AnnoType.Via,d);b.writeBEInt16(this.last);for(d=0;d<this.Vvk.length;d++){var e=new ArrayBuffer(4),e=new DataView(e);this.Vvk[d]==c.Vvm?(e.setInt8(0,255),e.setInt16(2,0)):(e.setInt8(0,0),e.setInt16(2,this.Vvk[d]));e.setInt8(1,0);b.writeBEInt32(e.getInt32(0))}};return c}();AnnoFactory[CB.AnnoType.Via]=CB.EvalProfileAnno;
CB.Vvo=function(){var c=function(b){this.move=b;this.solved=!1;this.nHelpClicked=0;this.Vvp={};this.Vvp.en=={question:"",help:""}},b=["en","de","es","it"],d=[CB.V79.ENG,CB.V79.DEU,CB.V79.ESP,CB.V79.ITA];c.prototype.getQuestion=function(c){if(this.Vvp[c])return this.Vvp[c].question;for(c=0;c<b.length;c++)if(this.Vvp[b[c]])return this.Vvp[b[c]].question};c.prototype.getHelp=function(c){if(this.Vvp[c])return this.Vvp[c].help;for(c=0;c<b.length;c++)if(this.Vvp[b[c]])return this.Vvp[b[c]].help};c.prototype.toString=
function(){return"Training"};c.prototype.Vvq=function(b){b.V35g();b.V35e();for(var c=b.V35e(),d=0;d<c&&10>d;d++){var h=this.Vvr(b),k=h.ln;k&&(this.Vvp[k]||(this.Vvp[k]={}),this.Vvp[k].question=h.str)}h=b.V35e();for(d=0;d<h&&10>d;d++)this.Vvr(b);c=b.V35e();for(d=0;d<c&&10>d;d++)if(h=this.Vvr(b),k=h.ln)this.Vvp[k]||(this.Vvp[k]={}),this.Vvp[k].help=h.str;h=b.V35e();for(d=0;d<h&&10>d;d++)this.Vvr(b)};c.prototype.Vvs=function(b){b.V35e();this.Vvq(b);for(var c=b.readByte(),d=0;d<c&&60>d;d++){var h=b.readByte(),
k=b.readByte(),l=b.readByte();b.readByte();var m=b.V35e();0==d&&(this.move=new CB.Veh(h,k,l));for(h=0;h<m;h++)this.Vvr(b)}};c.prototype.Vvt=function(b){b.V35e();this.Vvq(b);for(var c=b.readByte(),d=0;d<c&&60>d;d++){b.readByte();for(var h=b.V35e(),k=0;k<h;k++)this.Vvr(b);h=b.V35e();for(k=0;k<h;k++)this.Vvr(b)}};c.prototype.read=function(b,c){c.V35e();switch(c.readByte()){case 1:this.Vvs(c);break;case 2:this.Vvt(c)}};c.prototype.write=function(c){var f=new CB.V9w;f.V352(1);f.writeByte(1);var g=f.getPos();
f.V352(0);f.V351(300);f.V352(0);var h=f.getPos();f.V352(0);for(var k=0,l=0;l<b.length;l++)this.Vvp[b[l]]&&this.Vvp[b[l]].question&&(k=this.Vvu(this.Vvp[b[l]].question,f,k,d[l]));f.Vah(h,function(){f.V352(k)});f.V352(0);var m=0,h=f.getPos();f.V352(0);for(l=0;l<b.length;l++)this.Vvp[b[l]]&&this.Vvp[b[l]].help&&(m=this.Vvu(this.Vvp[b[l]].help,f,m,d[l]));f.Vah(h,function(){f.V352(m)});f.V352(0);f.writeByte(1);f.writeByte(this.move.from);f.writeByte(this.move.to);f.writeByte(this.move.prom);f.writeByte(5);
f.V352(0);var p=f.getPos();f.Vah(g,function(){f.V352(p)});g=AnnoRec.ANNO_HEAD_SIZE+f.getSize();c.V352(g);AnnoRec.writeHeader(c,0,CB.AnnoType.Vf5,g);c.writeData(f)};c.prototype.Vvr=function(b){b.readByte();var c=b.readByte(),d=b.V35e();b=b.readSizedString(d);CB.V47.V4b(b)&&(b=CB.V47.V49(b));return{ln:CB.V79.V7e(c),str:b}};c.prototype.Vvu=function(b,c,d,h){b&&(c.writeByte(h),c.writeByte(0),c.V352(b.length),c.writeSizedString(b),d++);return d};return c}();AnnoFactory[CB.AnnoType.Vf5]=CB.Vvo;"use strict";
CB.Vvv={V5k:0,Vvw:1,Vvx:2,Vvy:3,Vvz:4,Vw0:5,Vw1:6,Vw2:7,Vw3:8,Vw4:9,Vw5:10,Vw6:11,Vw7:12,Vw8:13,Vw9:14,Vwa:15,Vwb:16,Vwc:17,Vwd:18,Vwe:19,Vwf:20,Vwg:21,Vwh:22,Vwi:23,Vwj:24,Vwk:25,Vwl:26,Vwm:27,Vwn:28,Vwo:29,Vwp:30,Vwq:31,Vwr:32,Vws:33,Vwt:34,Vwu:35,Vwv:36,Vww:37,Vwx:38,Vwy:39,Vwz:40,Vx0:41,Vx1:42,Vx2:43,Vx3:44,Vx4:45,Vx5:46,Vx6:47,Vx7:48,Vx8:49,Vx9:50,Vxa:51,Vxb:52,Vxc:53,Vxd:54,Vxe:55,Vxf:56,Vxg:57,Vxh:58,Vxi:59,Vxj:60,Vxk:61,Vxl:62,Vxm:63,Vxn:64,Vxo:65,Vxp:66,Vxq:67,Vxr:68,Vxs:69,Vxt:70,Vxu:71,
Vxv:72,Vxw:73,Vxx:74,Vxy:75,Vxz:76,Vy0:77,Vy1:78,Vy2:79,Vy3:80,Vy4:81,Vy5:82,Vy6:83,Vy7:84,Vy8:85,Vy9:86,Vya:87,Vyb:88,Vyc:89,Vyd:90,Vye:91,Vyf:92,Vyg:93,Vyh:94,Vyi:95,Vyj:96,Vyk:97,Vyl:98,Vym:99,Vyn:100,Vyo:101,Vyp:102,Vyq:103,Vyr:104,Vys:105,Vyt:106,Vyu:107,Vyv:108,Vyw:109,Vyx:110,Vyy:111,Vyz:112,Vz0:113,Vz1:114,Vz2:115,Vz3:116,Vz4:117,Vz5:118,Vz6:119,Vz7:120,Vz8:121,Vz9:122,Vza:123,Vzb:124,Vzc:125,Vzd:126,Vze:127,Vzf:128,Vzg:129,Vzh:130,Vzi:131,Vzj:132,Vzk:133,Vzl:134,Vzm:135,Vzn:136,Vzo:137,Vzp:138,
Vzq:139,Vzr:140,Vzs:141,Vzt:142,Vzu:143,Vzv:144,Vzw:145,Vuj:146,Vzx:147,Vv2:148,Vgv:149,Vzy:150,Vzz:151,V100:152,V101:153,V102:154,V103:155,V104:156,V105:157,V106:158,V107:159,V108:160,V109:161,V10a:162,V10b:163,V10c:164,V10d:165,Vuc:166,WHITE:167,BLACK:168,Vud:169};var V359={};V359[CB.Vvv.V5k]="";V359[CB.Vvv.Vvw]="!";V359[CB.Vvv.Vvx]="?";V359[CB.Vvv.Vvy]="\u203c";V359[CB.Vvv.Vvz]="??";V359[CB.Vvv.Vw0]="!?";V359[CB.Vvv.Vw1]="?!";V359[CB.Vvv.Vw2]="!";V359[CB.Vvv.Vw3]="\ue021";V359[CB.Vvv.Vw4]="";
V359[CB.Vvv.Vw5]="=";V359[CB.Vvv.Vw6]="=";V359[CB.Vvv.Vw7]="=";V359[CB.Vvv.Vw8]="\u221e";V359[CB.Vvv.Vw9]="\ue02f";V359[CB.Vvv.Vwa]="\ue02e";V359[CB.Vvv.Vwb]="\u00b1";V359[CB.Vvv.Vwc]="\ue01a";V359[CB.Vvv.Vwd]="+-";V359[CB.Vvv.Vwe]="-+";V359[CB.Vvv.Vwf]="+-";V359[CB.Vvv.Vwg]="-+";V359[CB.Vvv.Vwh]="\ue01d";V359[CB.Vvv.Vwi]="\ue01d";V359[CB.Vvv.Vwj]="\ue023";V359[CB.Vvv.Vwk]="\ue023";V359[CB.Vvv.Vwl]="\ue023";V359[CB.Vvv.Vwm]="\ue023";V359[CB.Vvv.Vwn]="\ue023";V359[CB.Vvv.Vwo]="\ue023";
V359[CB.Vvv.Vwp]="\ue02d";V359[CB.Vvv.Vwq]="\ue02d";V359[CB.Vvv.Vwr]="\ue02d";V359[CB.Vvv.Vws]="\ue02d";V359[CB.Vvv.Vwt]="\ue02d";V359[CB.Vvv.Vwu]="\ue02d";V359[CB.Vvv.Vwv]="\ue012";V359[CB.Vvv.Vww]="\ue012";V359[CB.Vvv.Vwx]="\ue012";V359[CB.Vvv.Vwy]="\ue012";V359[CB.Vvv.Vwz]="\ue013";V359[CB.Vvv.Vx0]="\ue013";V359[CB.Vvv.Vx1]="\ue004\ue000";V359[CB.Vvv.Vx2]="\ue004\ue000";V359[CB.Vvv.Vx3]="\ue000";V359[CB.Vvv.Vx4]="\ue000";V359[CB.Vvv.Vx5]="\ue000";V359[CB.Vvv.Vx6]="\ue000";V359[CB.Vvv.Vx7]="\ue01e";
V359[CB.Vvv.Vx8]="\ue01e";V359[CB.Vvv.Vx9]="\ue01e";V359[CB.Vvv.Vxa]="\ue01e";V359[CB.Vvv.Vxb]="\ue01e";V359[CB.Vvv.Vxc]="\ue01e";V359[CB.Vvv.Vxd]="\ue00f";V359[CB.Vvv.Vxe]="\ue00f";V359[CB.Vvv.Vxf]="\ue00f";V359[CB.Vvv.Vxg]="\ue00f";V359[CB.Vvv.Vxh]="\ue00f";V359[CB.Vvv.Vxi]="\ue00f";V359[CB.Vvv.Vxj]="\ue00e";V359[CB.Vvv.Vxk]="\ue00e";V359[CB.Vvv.Vxl]="\ue00e";V359[CB.Vvv.Vxm]="\ue00e";V359[CB.Vvv.Vxn]="\ue00e";V359[CB.Vvv.Vxo]="\ue00e";V359[CB.Vvv.Vxp]="\ue010\ue0181";V359[CB.Vvv.Vxq]="\ue010\ue0188";
V359[CB.Vvv.Vxr]="";V359[CB.Vvv.Vxs]="";V359[CB.Vvv.Vxt]="\ue010\ue024";V359[CB.Vvv.Vxu]="\ue010\ue024";V359[CB.Vvv.Vxv]="";V359[CB.Vvv.Vxw]="";V359[CB.Vvv.Vxx]="\ue010\ue024";V359[CB.Vvv.Vxy]="\ue010\ue024";V359[CB.Vvv.Vxz]="";V359[CB.Vvv.Vy0]="";V359[CB.Vvv.Vy1]="\ue010\ue029";V359[CB.Vvv.Vy2]="\ue010\ue029";V359[CB.Vvv.Vy3]="\ue010\ue029";V359[CB.Vvv.Vy4]="\ue010\ue029";V359[CB.Vvv.Vy5]="";V359[CB.Vvv.Vy6]="";V359[CB.Vvv.Vy7]="";V359[CB.Vvv.Vy8]="";V359[CB.Vvv.Vy9]="\ue010\ue028";
V359[CB.Vvv.Vya]="\ue010\ue028";V359[CB.Vvv.Vyb]="";V359[CB.Vvv.Vyc]="";V359[CB.Vvv.Vyd]="\ue010\ue027";V359[CB.Vvv.Vye]="\ue010\ue027";V359[CB.Vvv.Vyf]="";V359[CB.Vvv.Vyg]="";V359[CB.Vvv.Vyh]="\ue010\ue026";V359[CB.Vvv.Vyi]="\ue010\ue026";V359[CB.Vvv.Vyj]="";V359[CB.Vvv.Vyk]="";V359[CB.Vvv.Vyl]="\ue010\ue025";V359[CB.Vvv.Vym]="\ue010\ue025";V359[CB.Vvv.Vyn]="";V359[CB.Vvv.Vyo]="";V359[CB.Vvv.Vyp]="";V359[CB.Vvv.Vyq]="";V359[CB.Vvv.Vyr]="";V359[CB.Vvv.Vys]="";V359[CB.Vvv.Vyt]="";
V359[CB.Vvv.Vyu]="";V359[CB.Vvv.Vyv]="";V359[CB.Vvv.Vyw]="";V359[CB.Vvv.Vyx]="";V359[CB.Vvv.Vyy]="";V359[CB.Vvv.Vyz]="";V359[CB.Vvv.Vz0]="";V359[CB.Vvv.Vz1]="";V359[CB.Vvv.Vz2]="";V359[CB.Vvv.Vz3]="";V359[CB.Vvv.Vz4]="";V359[CB.Vvv.Vz5]="";V359[CB.Vvv.Vz6]="";V359[CB.Vvv.Vz7]="";V359[CB.Vvv.Vz8]="";V359[CB.Vvv.Vz9]="\ue010\ue01f";V359[CB.Vvv.Vza]="\ue010\ue01f";V359[CB.Vvv.Vzb]="\ue010\ue01f";V359[CB.Vvv.Vzc]="\ue010\ue01f";V359[CB.Vvv.Vzd]="";V359[CB.Vvv.Vze]="";V359[CB.Vvv.Vzf]="";
V359[CB.Vvv.Vzg]="";V359[CB.Vvv.Vzh]="\ue017";V359[CB.Vvv.Vzi]="\ue017";V359[CB.Vvv.Vzj]="\ue017";V359[CB.Vvv.Vzk]="\ue017";V359[CB.Vvv.Vzl]="\ue017";V359[CB.Vvv.Vzm]="\ue017";V359[CB.Vvv.Vzn]="\ue01c";V359[CB.Vvv.Vzo]="\ue01c";V359[CB.Vvv.Vzp]="\ue01c";V359[CB.Vvv.Vzq]="\ue01c";V359[CB.Vvv.Vzr]="\u2206";V359[CB.Vvv.Vzs]="\ue022";V359[CB.Vvv.Vzt]="\ue020";V359[CB.Vvv.Vzu]="\u2264";V359[CB.Vvv.Vzv]="=";V359[CB.Vvv.Vzw]="RR";V359[CB.Vvv.Vuj]="N";V359[CB.Vvv.Vzx]="\ue010";V359[CB.Vvv.Vv2]="\ue01f";
V359[CB.Vvv.Vgv]="\ue018";V359[CB.Vvv.Vzy]="\ue019";V359[CB.Vvv.Vzz]="\ue001";V359[CB.Vvv.V100]="\ue001";V359[CB.Vvv.V101]="\ue002";V359[CB.Vvv.V102]="\ue003";V359[CB.Vvv.V103]="\ue02b";V359[CB.Vvv.V104]="\ue02b";V359[CB.Vvv.V105]="\ue02c";V359[CB.Vvv.V106]="\ue02c";V359[CB.Vvv.V107]="\ue007";V359[CB.Vvv.V108]="\ue007";V359[CB.Vvv.V109]="\ue008";V359[CB.Vvv.V10a]="\ue008";V359[CB.Vvv.V10b]=">";V359[CB.Vvv.V10c]=">";V359[CB.Vvv.V10d]="*";V359[CB.Vvv.Vuc]="**";V359[CB.Vvv.WHITE]="";
V359[CB.Vvv.BLACK]="";V359[CB.Vvv.Vud]="";var PieceGlyphs={};PieceGlyphs[CB.Piece.PAWN]="\ue029";PieceGlyphs[CB.Piece.KNIGHT]="\ue028";PieceGlyphs[CB.Piece.BISHOP]="\ue027";PieceGlyphs[CB.Piece.ROOK]="\ue026";PieceGlyphs[CB.Piece.QUEEN]="\ue025";PieceGlyphs[CB.Piece.KING]="\ue024";var V34m={};V34m[CB.Piece.PAWN]="\u2659";V34m[CB.Piece.KNIGHT]="\u2658";V34m[CB.Piece.BISHOP]="\u2657";V34m[CB.Piece.ROOK]="\u2656";V34m[CB.Piece.QUEEN]="\u2655";V34m[CB.Piece.KING]="\u2654";V359.getText=function(c){return V359[c]};
V359.addTexts=function(c,b){var d={};d[GlyphType.MOVE_GLYPH]=d[GlyphType.PRE_GLYPH]=d[GlyphType.POST_GLYPH]="";for(var e=0,f=b.length;e<f;++e){var g=b[e],h=V359.getText(g);d[GlyphType.getType(g)]+=h}return d[GlyphType.PRE_GLYPH]+c+d[GlyphType.MOVE_GLYPH]+d[GlyphType.POST_GLYPH]};CB.V34o=ObjUtil.clone(CB.V34l);CB.V34o.arrStrPieces[CB.Piece.Vb]=CB.V34o.arrStrPieces[CB.Piece.Vc]=PieceGlyphs[CB.Piece.KING];CB.V34o.arrStrPieces[CB.Piece.Vd]=CB.V34o.arrStrPieces[CB.Piece.Ve]=PieceGlyphs[CB.Piece.QUEEN];
CB.V34o.arrStrPieces[CB.Piece.Vf]=CB.V34o.arrStrPieces[CB.Piece.Vg]=PieceGlyphs[CB.Piece.ROOK];CB.V34o.arrStrPieces[CB.Piece.Vh]=CB.V34o.arrStrPieces[CB.Piece.Vi]=PieceGlyphs[CB.Piece.BISHOP];CB.V34o.arrStrPieces[CB.Piece.Vj]=CB.V34o.arrStrPieces[CB.Piece.Vk]=PieceGlyphs[CB.Piece.KNIGHT];CB.V34o.arrStrPieces[CB.Piece.Vl]=CB.V34o.arrStrPieces[CB.Piece.Vm]="";CB.UnicodeV34o=ObjUtil.clone(CB.V34l);CB.UnicodeV34o.arrStrPieces[CB.Piece.Vb]=CB.UnicodeV34o.arrStrPieces[CB.Piece.Vc]=V34m[CB.Piece.KING];
CB.UnicodeV34o.arrStrPieces[CB.Piece.Vd]=CB.UnicodeV34o.arrStrPieces[CB.Piece.Ve]=V34m[CB.Piece.QUEEN];CB.UnicodeV34o.arrStrPieces[CB.Piece.Vf]=CB.UnicodeV34o.arrStrPieces[CB.Piece.Vg]=V34m[CB.Piece.ROOK];CB.UnicodeV34o.arrStrPieces[CB.Piece.Vh]=CB.UnicodeV34o.arrStrPieces[CB.Piece.Vi]=V34m[CB.Piece.BISHOP];CB.UnicodeV34o.arrStrPieces[CB.Piece.Vj]=CB.UnicodeV34o.arrStrPieces[CB.Piece.Vk]=V34m[CB.Piece.KNIGHT];CB.UnicodeV34o.arrStrPieces[CB.Piece.Vl]=CB.UnicodeV34o.arrStrPieces[CB.Piece.Vm]="";
var GlyphType={PRE_GLYPH:0,MOVE_GLYPH:1,POST_GLYPH:2,getType:function(c){return c<=CB.Vvv.Vw4||c>=CB.Vvv.V10d&&c<=CB.Vvv.Vud||c===CB.Vvv.Vwh||c===CB.Vvv.Vwi?GlyphType.MOVE_GLYPH:c<=CB.Vvv.Vzq||c>=CB.Vvv.Vuj?GlyphType.POST_GLYPH:GlyphType.PRE_GLYPH}};NotationLocalizations.glyphs=CB.V34o;NotationLocalizations.uglyphs=CB.UnicodeV34o;"use strict";
CB.TokenType={V5k:0,UNKNOWN:1,V10e:2,V10f:3,V10g:4,V10h:5,V10i:6,V10j:7,V10k:8,V10l:9,V10m:10,V10n:11,V10o:12,V10p:13,V10q:14,V10r:15,V3l:16,V1p:17,V10s:18,V10t:19,V5m:20,V10u:21,V10v:22,V10w:23,Vlm:24,Vlo:25,Vll:26,Vln:27,V10x:28,V10y:29};function Token(c,b){this.type=c;b&&(this.str=b)}Token.prototype.type=CB.TokenType.UNKNOWN;Token.prototype.str="";Token.prototype.toString=function(){var c=EnumToString(CB.TokenType,this.type);this.str&&(c+="("+this.str+")");return c};
function V34t(c){this.m_it=new StringIterator(c);this.m_it.Next()}V34t.prototype.m_it=new StringIterator("");V34t.prototype.m_inHeader=!1;
V34t.prototype.nextToken=function(){this.m_it.skipWhile(Char.IsWhiteSpace,!0);if(this.m_it.isEOF())return new Token(CB.TokenType.V10e);var c=this.m_it.Current();this.m_it.Next();switch(c){case "X":case "#":return new Token(CB.TokenType.V3l);case "+":return new Token(CB.TokenType.V10r);case "$":return new Token(CB.TokenType.V10q);case "*":return new Token(CB.TokenType.V10m,c);case "[":return this.m_inHeader=!0,new Token(CB.TokenType.V10f);case "]":return this.m_inHeader=!1,new Token(CB.TokenType.V10g);
case "(":return new Token(CB.TokenType.V10k);case ")":return new Token(CB.TokenType.V10l);case ".":return new Token(CB.TokenType.V10u)}if(this.m_inHeader){if(Char.IsLetterOrDigit(c))return c+=this.m_it.AcceptWhile(Char.IsLetterOrDigit,!0),new Token(CB.TokenType.V10h,c);if('"'===c)return c=this.m_it.AcceptUntil(Char.getIsChar("]"),!0),c=c.trim(),'"'===c.charAt(c.length-1)&&(c=c.slice(0,c.length-1)),new Token(CB.TokenType.V10i,c)}if("{"===c)return c=this.m_it.AcceptUntil(Char.getIsChar("}"),!0),this.m_it.skipWhile(Char.getIsChar("}"),
!0),new Token(CB.TokenType.V10j,c);if("0"===c){if(this.m_it.AcceptStr("-0-0",!0))return new Token(CB.TokenType.V10v);if(this.m_it.AcceptStr("-0",!0))return new Token(CB.TokenType.V10w);if(this.m_it.AcceptStr("-1",!0))return new Token(CB.TokenType.V10o)}if("O"===c){if(this.m_it.AcceptStr("-O-O",!0))return new Token(CB.TokenType.V10v);if(this.m_it.AcceptStr("-O",!0))return new Token(CB.TokenType.V10w)}if("1"===c){if(this.m_it.AcceptStr("-0",!0))return new Token(CB.TokenType.V10n);if(this.m_it.AcceptStr("/2-1/2",
!0))return new Token(CB.TokenType.V10p)}return Char.IsDigit(c)?(c+=this.m_it.AcceptWhile(Char.IsDigit,!0),new Token(CB.TokenType.V5m,c)):"-"===c&&this.m_it.AcceptChar("-",!0)?new Token(CB.TokenType.V10t):"?"===c?this.m_it.AcceptChar("?",!0)?new Token(CB.TokenType.Vlo):this.m_it.AcceptChar("!",!0)?new Token(CB.TokenType.V10x):new Token(CB.TokenType.Vlm):"!"===c?this.m_it.AcceptChar("?",!0)?new Token(CB.TokenType.V10y):this.m_it.AcceptChar("!",!0)?new Token(CB.TokenType.Vln):new Token(CB.TokenType.Vll):
V34t.isMoveChar(c)?(c+=this.m_it.AcceptWhile(V34t.isMoveChar,!0),new Token(CB.TokenType.V1p,c)):new Token(CB.TokenType.UNKNOWN,c)};V34t.isMoveChar=function(c){return"a"<=c&&"h">=c||"1"<=c&&"8">=c||"x"===c||"="===c||Char.IsUpperCaseLetter(c)&&CB.Piece.fromString(c)!==CB.Piece.V5k};
CB.V10z=function(){var c=function(b){this.V110=new V34t(b);this.V111=null};c.prototype.V112=function(b){this.V111||(this.V111=this.V110.nextToken());return b&&b(this.V111.type)?this.V111:null};c.V113=function(b){return function(c){return c===b}};c.prototype.pop=function(b){if(b=this.V112(b))this.V111=null;return b};c.prototype.V114=function(b){return this.pop(c.V113(b))};c.prototype.V115=function(b){return this.V112(c.V113(b))};return c}();"use strict";function PGNSubLine(){}
PGNSubLine.prototype=[];
CB.V116=function(){var c=function(b){this.V117=null;this.V11d=this.V11c=this.V11b=this.V11a=this.V119=this.V118=!1;this.V11f=this.V11e=CB.Piece.V5k;this.V11k=this.V11j=this.V11i=this.V11h=this.V11g=-1;b&&(this.V117=b,this.init(b))};c.g_regex=/^(K|Q|R|N|B)?([a-h]?)([1-8]?)(x?)([a-h])([1-8])(?:=(K|Q|R|N|B))?$/;c.prototype.init=function(b){c.g_regex.exec(b)&&(this.V11e=CB.Piece.fromString(RegExp.$1),this.V11e=CB.Piece.Vb3(this.V11e),RegExp.$2&&(this.V11g=CB.Vbf.Vdx(RegExp.$2)),RegExp.$3&&(this.V11h=
CB.Vbf.Vdy(RegExp.$3)),RegExp.$4&&(this.V11d=!0),RegExp.$5&&(this.V11i=CB.Vbf.Vdx(RegExp.$5)),RegExp.$6&&(this.V11j=CB.Vbf.Vdy(RegExp.$6)),RegExp.$7&&(this.V11f=CB.Piece.fromString(RegExp.$7),this.V11f=CB.Piece.Vb3(this.V11f)),0>this.V11h&&this.V11e===CB.Piece.V5k&&(this.V11e=CB.Piece.PAWN),0<=this.V11i&&0<=this.V11j&&(this.V11k=CB.Vbf.I(this.V11i,this.V11j)))};c.prototype.V11l=function(){this.V11c=!0};c.prototype.isNullMove=function(){return this.V11c};c.prototype.V11m=function(){this.V11b=!0};c.prototype.isLongCastling=
function(){return this.V11b};c.prototype.V11n=function(){this.V11a=!0};c.prototype.isShortCastling=function(){return this.V11a};c.prototype.setCheck=function(b){this.V118=b};c.prototype.setMate=function(b){this.V119=b};c.prototype.isTake=function(){return this.V11d};c.prototype.matches=function(b){var c=b.from;return this.V11k!==b.to||this.V11e!==CB.Piece.V5k&&(b=b.getMoved(),CB.Piece.Vb3(b)!==this.V11e)?!1:this.matchesFrom(c)};c.prototype.matchesFrom=function(b){return 0<=this.V11g&&this.V11g!==
CB.Vbf.Vdz(b)||0<=this.V11h&&this.V11h!==CB.Vbf.R(b)?!1:!0};c.prototype.getMoved=function(){return this.V11e};c.prototype.getTo=function(){return this.V11k};c.prototype.getProm=function(){return this.V11f};return c}();CB.V11o=function(){var c=function(b){this.m_strComment=b};c.prototype.m_strComment="";c.prototype.getComment=function(){return this.m_strComment};return c}();function PGNGlyph(c){this.m_glyph=c}PGNGlyph.prototype.m_glyph=0;PGNGlyph.prototype.getGlyph=function(){return this.m_glyph};
function PGNMoveNum(c,b){this.m_num=c;this.m_isBlack=b}function PGNGame(){this.m_hdrs={};this.m_mainLine=new PGNSubLine}PGNGame.prototype.m_hdrs={};PGNGame.prototype.m_mainLine=new PGNSubLine;PGNGame.prototype.getHeaders=function(){return this.m_hdrs};PGNGame.prototype.getMainLine=function(){return this.m_mainLine};
CB.V11p=function(){function c(b){switch(b){case CB.TokenType.Vlm:return CB.Vvv.Vvx;case CB.TokenType.V10x:return CB.Vvv.Vw1;case CB.TokenType.Vll:return CB.Vvv.Vvw;case CB.TokenType.V10y:return CB.Vvv.Vw0;case CB.TokenType.Vln:return CB.Vvv.Vvy;case CB.TokenType.Vlo:return CB.Vvv.Vvz;default:return CB.Vvv.V5k}}function b(b){return c(b)!==CB.Vvv.V5k}var d=function(b){this.V11q=b?b:new CB.V10z("")};d.prototype.V11r=function(){var b=new PGNGame;return this.V11s(b.m_hdrs)&&this.V11t(b)?b:null};d.prototype.V11t=
function(b){this.V11u(b.m_mainLine);var c=this.V11v();null!=c&&(b.m_hdrs.result=c);return!0};d.V11w=function(b){return b===CB.TokenType.V10o||b===CB.TokenType.V10n||b===CB.TokenType.V10p||b===CB.TokenType.V10m};d.prototype.V11v=function(){var b=this.V11q.pop(d.V11w);if(b)switch(b.type){case CB.TokenType.V10o:return CB.Vgt.BLACK_WINS;case CB.TokenType.V10n:return CB.Vgt.WHITE_WINS;case CB.TokenType.V10p:return CB.Vgt.DRAW;case CB.TokenType.V10m:return CB.Vgt.Vgv}return null};d.prototype.V11u=function(b){for(var c=
this.V11x();null!=c;c=this.V11x())b.push(c);return!0};d.prototype.V11x=function(){var b=this.V11y();return b||(b=this.V11z())||(b=this.V120())||(b=this.V121())?b:(b=this.V122())?b:null};d.prototype.V120=function(){if(this.V11q.V114(CB.TokenType.V10q)){var d=this.V11q.V114(CB.TokenType.V5m);return new PGNGlyph(Number(d.str))}return(d=this.V11q.pop(b))?(d=c(d.type),new PGNGlyph(d)):null};d.prototype.V121=function(){if(this.V11q.V114(CB.TokenType.V10k)){var b=new PGNSubLine;this.V11u(b);this.V11q.V114(CB.TokenType.V10l);
return b}return null};d.prototype.V122=function(){var b=this.V11q.V114(CB.TokenType.V10j);return b?new CB.V11o(b.str):null};d.prototype.V11y=function(){var b=this.V11q.V114(CB.TokenType.V5m);if(b){for(var c=0;this.V11q.V114(CB.TokenType.V10u);)++c;return new PGNMoveNum(Number(b.str),1<c)}return null};d.V123=function(b){return b===CB.TokenType.V1p||b===CB.TokenType.V10v||b===CB.TokenType.V10w||b===CB.TokenType.V10t};d.prototype.V11z=function(){var b=this.V11q.pop(d.V123);if(b){var c=new CB.V116;switch(b.type){case CB.TokenType.V1p:c.init(b.str);
break;case CB.TokenType.V10v:c.V11m();break;case CB.TokenType.V10w:c.V11n();break;case CB.TokenType.V10t:c.V11l()}if(b.type!==CB.TokenType.V10t){var b=null!=this.V11q.V114(CB.TokenType.V10r),e=!1;b||(e=null!=this.V11q.V114(CB.TokenType.V3l));c.setCheck(b);c.setMate(e)}return c}return null};d.prototype.V11s=function(b){for(;this.V124(b););return!0};d.prototype.V124=function(b){if(this.V11q.V114(CB.TokenType.V10f)){var c=this.V11q.V114(CB.TokenType.V10h),d=this.V11q.V114(CB.TokenType.V10i);this.V11q.V114(CB.TokenType.V10g);
c=c.str.toLowerCase();b[c]=d.str;return!0}return!1};d.V125=function(b){for(var c=new CB.ColSqAnno,d=0,e=b.length;d<e;++d){var l=b[d],m=new CB.ColSq;m.init(l);c.push(m)}return c};d.V126=function(b){for(var c=new CB.ColArrowAnno,d=0,e=b.length;d<e;++d){var l=b[d],m=new CB.ColArrow;m.init(l);c.push(m)}return c};d.V127=function(b){var c="";0<b.length&&(c=b[0]);return new CB.Vgh(c)};d.V128=function(b){b=b[0].split(":");b=3600*Number(b[0])+60*Number(b[1])+Number(b[2]);var c=new CB.Vp8;c.Vvf(100*b);return c};
d.V129=function(b){var c=.01*Number(b[0]),d=0;1<b.length&&(d=Number(b[1]));return new CB.Vve(c,d)};d.V12a=function(b){var c=new CB.Vvo;if(7<=b.length&&2==b[0].length){c.move=b[4];for(var d=0;d<b.length/7;d++)2==b[7*d].length&&(c.Vvp[b[7*d].toLowerCase()]={question:b[7*d+1],help:b[7*d+2]})}else c.move=b[3],c.Vvp.en={question:b[0],help:b[1]};c.fromPGN=!0;return c};d.V12b=function(b){var c=[];if(3<b.length){for(var d=parseInt(b[0]),e=parseInt(b[1]),l=0;l<e-d+1;l++)c.push(parseInt(b[l+2]));b=new CB.EvalProfileAnno(d,
e,c);b.fromPGN=!0;return b}};d.V12c=function(b){return new CB.Vvi(parseInt(b[0]))};var e={cal:{func:d.V126,type:CB.AnnoType.ARROW_LIST},csl:{func:d.V125,type:CB.AnnoType.SQUARE_LIST},dia:{func:d.V127,type:CB.AnnoType.DIAGRAM},eval:{func:d.V129,type:CB.AnnoType.Vu2},emt:{func:d.V128,type:CB.AnnoType.TIME},tqu:{func:d.V12a,type:CB.AnnoType.Vf5},mdl:{func:d.V12c,type:CB.AnnoType.Vu3},evp:{func:d.V12b,type:CB.AnnoType.Via}};d.V12d=/(-?(?:\d?\d\.\s?\d\d?)|(?:#\d+))\/\s?(\d+)/;d.V12e=function(b,c){if(0<=
c.indexOf("/")){var h=c.replace(/\r/g," "),h=h.replace(/\n/g," "),h=h.replace(/\s\s/g," "),k=d.V12d.exec(h);if(k){var l=k[1],l=l.replace(/\s/g,"");0!==l.indexOf("#")&&l.indexOf("-#");l=new CB.Vve(eval,Number(k[2]));b.setAnnoItem(CB.AnnoType.Vu2,l);l=k.index;k=k[0].length;c=h.substring(0,l)+h.substring(l+k)}}if(0<=c.indexOf("[%"))for(h=[],c=PGNCommand.process(c,h),l=0,k=h.length;l<k;++l){var m=h[l];if(m.m_cmd in e){var p=e[m.m_cmd],r=p.type;(m=p.func(m.m_args))&&b.setAnnoItem(r,m)}}c&&b.setAnnoItem(CB.AnnoType.Vgi,
new CB.Vgh(c))};return d}();
CB.PGN=function(){function c(b){return void 0===b?"":"?"===b?"":b}function b(b){return b&&"?"!==b}function d(d){var f=new CB.Vgz;f.Vh1(c(d.white));f.Vh2(c(d.black));f.Vh5(c(d.event));f.Vh7(c(d.site));f.Vh6(c(d.annotator));f.Vh4(c(d.eco));var g=d.result;"string"===typeof g?f.setResult(CB.Vgt.fromString(g)):f.setResult(g);f.Vh8(c(d.round));b(d.whiteelo)&&f.Vh9(parseInt(d.whiteelo));b(d.blackelo)&&f.Vha(parseInt(d.blackelo));b(d.date)&&f.Vhc(d.date);b(d.timecontrol)&&f.Vh0(e(d.timecontrol));b(d.plycount)&&
(f.plyCount=parseInt(d.plycount)+1>>1);return f}function e(b){return(b=l.exec(b))?new CB.Vkz(Number(b[1])/60,Number(b[2])):new CB.Vkz}function f(b,c){if(b.isLongCastling()){var d=c.isWTM()?CB.Veh.g_mvW000:CB.Veh.g_mvB000;if(k.V12f||c.isLegalMove(d))return ObjUtil.clone(d)}if(b.isShortCastling()&&(d=c.isWTM()?CB.Veh.g_mvW00:CB.Veh.g_mvB00,k.V12f||c.isLegalMove(d)))return ObjUtil.clone(d);if(b.isNullMove())return new CB.Veh;var f=b.getTo(),e=b.getMoved(),g=c.getSideToMove(),h=b.getProm();e!==CB.Piece.PAWN&&
(h=CB.Piece.V5k);d=[];switch(e){case CB.Piece.KNIGHT:c.getKnightAttacksTo(f,g,d);break;case CB.Piece.BISHOP:c.getBishopAttacksTo(f,g,d);break;case CB.Piece.ROOK:c.getRookAttacksTo(f,g,d);break;case CB.Piece.QUEEN:c.getQueenAttacksTo(f,g,d);break;case CB.Piece.KING:c.getKingAttacksTo(f,g,d);break;case CB.Piece.PAWN:b.isTake()?(e=c.getPiece(f),e===CB.Piece.V5k&&f===c.getEPField()&&(e=c.getEPVictimField(),e=c.getPiece(e)),e!==CB.Piece.V5k&&CB.Piece.side(e)!==g&&c.getPawnAttacksTo(f,g,d)):(e=c.getPiece(f),
e===CB.Piece.V5k&&c.getPawnMovesTo(f,g,d));break;default:return null}if(!d.length)return null;if(1===d.length&&k.V12f)return new CB.Veh(d[0],f,h);g=b.matchesFrom.bind(b);d=d.filter(g);if(!d.length)return null;if(1===d.length&&k.V12f)return new CB.Veh(d[0],f);d=d.map(function(b){return new CB.Veh(b,f)});d=c.filterLegals(d);return d.length?1===d.length?d[0]:null:null}function g(b){for(var c=["\r\n","\n","\r"],d=0,f=c.length;d<f;++d){var e=c[d];if(0<=b.indexOf(e))return e}return null}function h(b,c){for(var d=
ObjUtil.clone(b),e=new CB.Veo,g=null,k=null,l=null,m=0,p=c.length;m<p;++m){var C=c[m];if(!(C instanceof PGNMoveNum))if(C instanceof CB.V116){C=f(C,d);if(!C)break;g=d.makeMove(C);k=C;e.push(C);l&&(l.m_strComment&&0==l.m_strComment.indexOf("[%")?CB.V11p.V12e(k,l.getComment()):k.setAnnoItem(CB.AnnoType.Vgg,new CB.Vgh(l.getComment())),l=null)}else if(C instanceof PGNSubLine){if(k){d.unmakeMove(k,g);C=h(d,C);k.addLine(C);var G=e.length-1;C.setParentLine(e);C.setParentMoveIndex(G);d.makeMove(k)}}else C instanceof
CB.V11o?k?(C=C.getComment(),CB.V11p.V12e(k,C)):l=C:C instanceof PGNGlyph&&k&&((G=k.getAnnoItem(CB.AnnoType.Vgo))||(G=new CB.Vgp),G.push(C.getGlyph()),k.setAnnoItem(CB.AnnoType.Vgo,G))}for(d=0;d<e.length-1;d++)e[d].hasAnno()&&e[d].getAnno().hasTraining()&&(g=e[d].getAnno().getTraining(),k=e[d+1],g.move=new CB.Veh(k.from,k.to,k.prom));return e}var k={},l=/^(\d+)(?:\+(\d+))?$/;k.V12g=function(b){var c=b.indexOf("[");-1==c&&(c=b.indexOf("1."));0<c&&(b=b.slice(c));var c=[],d=g(b);if(null==d)return[b];
if("\r\n"===d){var f=b;if(0<=f.indexOf("\r\r")||0<=f.indexOf("\n\n"))b=b.replace(/\r\n/g,"\n"),b=b.replace(/\r/g,"\n"),d="\n"}for(var f=d+d+"[",d=2*d.length,e=0,h=b.indexOf(f,e);-1!=h&&e<b.length;h=b.indexOf(f,e))e=b.substring(e,h),c.push(e),e=h+d;e<b.length&&(b=b.substring(e),c.push(b));return c};var m=/\[(\w+)\s+\"([\s\S]*?)\"\]/g,p=/^\s*$/;k.V12h=function(b){var c=g(b);c||(c="\r\n");for(var d=new StringBuilder,f=m.lastIndex=0,e;e=m.exec(b);){var h=e.index,f=b.substring(f,h);p.test(f)||(d.append(c),
d.append(f.trim()),d.append(c),d.append(c));var f=e[1],k=e[2],k=k.replace(/\r/g," "),k=k.replace(/\n/g," ");d.appendFormat('[{0} "{1}"]',f,k);d.append(c);f=h+e[0].length}b=b.substring(f);p.test(b)||(d.append(c),d.append(b.trim()),d.append(c),d.append(c));return d.toString()};k.V12f=!0;k.Vk5=function(b){if(b){b=new CB.V10z(b);var c=(new CB.V11p(b)).V11r();if(!c)return null;var f=null;b=c.getHeaders();b.setup&&b.fen&&(f=b.fen);b=d(b);f=new CB.Position(f);c=c.getMainLine();c=h(f,c);c=new CB.Game(f,c);
c.setHeader(b);return c}return new CB.Game};k.V12i=function(b){b=new CB.V10z(b);var c={};(new CB.V11p(b)).V11s(c);return c?d(c):null};return k}();var PGN=CB.PGN;function PGNCommand(c,b){c||(c="");b||(b=[]);this.m_cmd=c;this.m_args=b}PGNCommand.prototype.init=function(c,b){this.m_cmd=c;PGNCommand.initArgs(b,this.m_args)};
PGNCommand.initArgs=function(c,b){c=c.replace(/[\n]/g," ");c=c.replace(/[\r]/g,"");var d=/(\".*?\")|([-\w\n]+),|([-:\w\n]+)$/g;d.lastIndex=0;var e;do if(e=d.exec(c)){var f=e[1]||e[2]||e[3];if(f)'"'===f[0]&&(f=f.substring(1),'"'===f[f.length-1]&&(f=f.substring(0,f.length-1))),b.push(f),d.lastIndex===e.index&&++d.lastIndex,e=0<=e.index;else break}else break;while(e)};PGNCommand.g_regexWhole=/\[%(\w+)((?:\"[^\"]*\"|[^\"\]]*)*)\]/;
PGNCommand.process=function(c,b){for(;c;){var d=PGNCommand.g_regexWhole.exec(c);if(d){var e=new PGNCommand,f=d[0];e.init(d[1],d[2]);b.push(e);c=c.substring(0,d.index)+c.substring(d.index+f.length)}else break}return c};"use strict";CB.V12j=ObjUtil.copyTo(CB.V34l,{strProm:"="},!0);
CB.V12k=function(){function c(b,c){b.appendFormat("[%{0}",c);if(arguments.length-2){b.append(" ");for(var d=2;d<arguments.length;++d){var f=arguments[d];2<d&&b.append(",");b.append(f)}}b.appendFormat("]")}function b(d,e,k){for(var l=0;l<e.length;++l){var m=e[l],p=m.getMoved(),r=d,u=k,q=0==l,t=m.getAnno();if(m.hasAnno()){var v=r,w=t[CB.AnnoType.Vgg];w&&(v.append("{"),v.append(w.getString()),v.append("} "))}v=m.getMoved();if(q||CB.Piece.side(v)===CB.Vaz.WHITE)r.append(u),r.append("."),CB.Piece.side(v)===
CB.Vaz.BLACK&&r.append(".."),r.append(" ");q=f.getMoveNota(m);r.append(q);r.append(" ");if(m.hasAnno()){q=r;if(v=t.getItem(CB.AnnoType.Vgo))for(var w=0,y=v.length;w<y;++w)q.appendFormat("${0} ",v[w]);v=t.count();t.hasItem(CB.AnnoType.Vgo)&&--v;t.hasItem(CB.AnnoType.Vgg)&&--v;if(v){q.append("{");if(w=t[CB.AnnoType.TIME]){var v=q,w=w.getTimeIn100th(),y=Math.floor(w/36E4),w=w-36E4*y,A=Math.floor(w/6E3);c(v,"emt",String.formatEx("{0}:{1}:{2}",y,A,Math.round((w-6E3*A)/100,1)))}(t=t[CB.AnnoType.Vgi])&&
q.append(t.getString());q.append("} ")}}if(m.hasLines())for(q=0;q<m.getSubLinesCount();++q)r.append("("),t=m.getLine(q),b(r,t,u),r.append(")");CB.Piece.side(p)===CB.Vaz.BLACK&&++k}}function d(b,c,d){b.appendFormat('[{0} "{1}"]',c,d);b.append("\r\n")}var e={},f=new CB.Vib(CB.V12j);e.V12l=function(c){var f=new StringBuilder,e=c.getHeader();d(f,"Event",e.getEvent());d(f,"White",e.getWhite());d(f,"Black",e.getBlack());d(f,"Site",e.getSite());d(f,"Round",e.getRoundStr());d(f,"Annotator",e.getAnnotator());
d(f,"Result",e.getCBResult().toPGNString());d(f,"Date",e.getDateStr());e.getEloWhite()&&d(f,"WhiteElo",e.getEloWhite());e.getEloBlack()&&d(f,"BlackElo",e.getEloBlack());d(f,"PlyCount",c.getMainLine().length);if(!c.isNormalInit()){d(f,"Setup",1);var l=c.getStartPos().toFEN();d(f,"FEN",l)}if(e=e.getClockParams())l=e.getStartSecs().toString(),e.incSecs&&(l+="+"+e.incSecs),d(f,"TimeControl",l);f.append("\r\n");e=1;c.isNormalInit()||(e=c.getStartPos().getMoveNum());b(f,c.getMainLine(),e);f.append(c.hdr.getCBResult().toPGNString());
f.append("\r\n");f.append("\r\n");return f.toString()};e.V12m=function(b){b=this.V12l(b);for(var c=['Site "?"','Round "?"','Date "????.??.??"','Result "*"'],d=0;d<c.length;d++)b=b.replace("/["+c[d]+"/]/ig","");b=encodeURI(b);b=b.replace(/\.%20/ig,".");b=b.replace(/%0D%0A/ig,"%20");b=b.replace(/%20%20/ig,"%20");return b=b.replace(/%20%20/ig,"%20")};return e}();"use strict";
CB.V12n=function(){var c=function(){this.nGames=0;this.games=[];this.headers=[];this.V12o=0};c.prototype.V12p=function(b){};c.prototype.incUsers=function(){this.V12o++};c.prototype.decUsers=function(){this.V12o--};c.prototype.getNUsers=function(){return this.V12o};c.prototype.V12q=function(){};c.prototype.V12r=function(){this.V12s&&this.V12s.V12r(this)};c.prototype.V12t=function(){this.V12s&&this.V12s.V12t(this)};c.prototype.V12u=function(b,c){alert("not implemented")};c.prototype.V12v=function(){return!0};
c.prototype.V12w=function(){return!1};c.prototype.V12x=function(){return!1};c.prototype.getGameCount=function(){return this.nGames};c.prototype.V12y=function(){return"Database"};c.prototype.V12z=function(){return this.V12v()};c.prototype.getHeaderJson=function(b){return{gameNo:b,white:"Not available",black:"",event:"",date:new CB.Date(0),result:"",eco:""}};c.prototype.V130=function(b,c,e){for(var f=[];c<=e&&c<=this.getGameCount();c++){var g=this.getHeaderJson(c);f.push(g)}(new Ext.util.DelayedTask).delay(100,
function(){b(f)})};c.prototype.getGame=function(b){return new CB.Game};c.prototype.loadGameAsync=function(b,c){var e=this.getGame(c);(new CB.Timer(function(){b(e)})).runOnce(10)};c.prototype.V131=function(b){};c.prototype.V132=function(){};c.prototype.setSubSet=function(b){this.V133=b};c.prototype.V134=function(){delete this.V133};c.prototype.V135=function(){return this.V133?this.V133.length:this.getGameCount()};c.prototype.getGameNoInSet=function(b){return this.V133&&b<=this.V133.length&&0<b?this.V133[b-
1]:b};c.prototype.getSetInxOfGameNo=function(b){if(this.V133)for(var c=0;c<this.V133.length;c++){if(this.V133[c]==b)return c+1}else return b};c.prototype.V136=function(b){this.headers.filter(function(b){return void 0!==b}).length==this.nGames?this.V137(b):this.V12s&&this.V12s.V138(this.V12q(),b)};c.prototype.clearFilter=function(){this.V134()};c.prototype.V137=function(b){CB.V139.V13a("Searching locally ... ",null,2E4);b=new RegExp(b,"i");for(var c=[],e=1;e<this.headers.length;e++)this.headers[e].matchesFilterVal(b)&&
c.push(this.headers[e].nGame);CB.V139.V13b();this.setSubSet(c)};return c}();"use strict";
CB.V13c=function(){var c=function(b,c){this.pgn="";this.V13d=[];this.headers=[];this.games=[];this.V13e=!1;this.V13f=c;"string"==typeof b?this.V13g(b):(this.V13h(b),this.V13i=b.name)};CB.inherit(c,CB.V12n);c.prototype.getGameCount=function(){return this.V13d.length};c.prototype.V12y=function(){return this.V13i};c.prototype.V12q=function(){return function(b){for(var c=[],e=0;e<b.length;e++){var f=this.getGame(b[e]);c.push(f)}return c}.bind(this)};c.prototype.getHeaderJson=function(b){if(0>=b)return null;
void 0===this.headers[b]&&b<this.V13d.length+1&&(this.headers[b]=PGN.V12i(this.V13d[b-1]));var c=this.headers[b];return c?(c.nGame=b,c.toJson()):this.superClass.getHeaderJson(b)};c.prototype.V130=function(b,c,e){if(this.V13e)this.V13j(b,c,e);else{var f=this.V13f;this.V13f=function(){f&&f(this);this.V13j(b,c,e)}.bind(this)}};c.prototype.V13j=function(b,c,e){for(var f=[];c<=e&&c<=this.getGameCount();c++){var g=this.getHeaderJson(c);f.push(g)}(new Ext.util.DelayedTask).delay(100,function(){b(f)})};c.prototype.getGame=
function(b){return b?PGN.Vk5(this.V13d[b-1]):new CB.Game};c.prototype.V12u=function(b,c){alert("Sorry, you cannot save into a PGN database.")};c.prototype.toString=function(){for(var b="",c=1;c<=this.getGameCount();c++)var e=this.getGame(c),e=CB.V12k.V12l(e),b=b+e;return b};c.prototype.V13g=function(b){this.V13d=PGN.V12g(b);void 0!==this.V13f&&this.V13f(this);this.V13e=!0};c.prototype.V13h=function(b){if("function"==typeof FileReader){var c=new FileReader;c.onloadend=function(){this.V13k(c)}.bind(this);
c.onerror=function(){this.V13l(c)}.bind(this);c.onprogress=function(){}.bind(this);c.onload=function(){}.bind(this);c.readAsText(b)}};c.prototype.V13k=function(b){b.result&&(this.V13d=PGN.V12g(b.result),void 0!==this.V13f&&this.V13f(this));this.V13e=!0};c.prototype.V13l=function(b){alert("Could not load file, sorry");this.V13e=!0};return c}();"use strict";CB.namespace("CB.V13m");
CB.V13m=function(){var c,b,d,e=function(b,c,d,f){this.V13n=localforage.createInstance({name:"Textures"});this.V13o=this.V13p(b);this.V13q=this.V13p(c);this.margin=this.V13p(d);this.background=this.V13p(f);this.V13r=function(){};this.V13s=function(){};this.V13q.V8m=this.V13t.bind(this);this.V13o.V8m=this.V13t.bind(this);this.margin.V8m=this.V13t.bind(this);this.background.V8m=this.V13u.bind(this);this.V13v=0;this.V13w=Array(64);this.V13x=Array(64)};e.prototype.destroy=function(){this.V13r=this.V13s=
null;this.removeAllListeners();this.V13y();e.clearCache()};e.clearCache=function(){b=c=0;d={}};e.prototype.V13z=function(){return this.V13q.loaded&&this.V13o.loaded&&this.margin.loaded};e.prototype.V140=function(b,c){try{var d=CB.Vbf.Ve3(b);if(!(0>b||63<b))return c==this.V13v?d?void 0===this.V13w[b]&&(this.V13w[b]=this.V141(b,c,d)):void 0===this.V13x[b]&&(this.V13x[b]=this.V141(b,c,d)):(this.V13v=c,this.V13w=Array(64),this.V13x=Array(64),d?this.V13w[b]=this.V141(b,c,d):this.V13x[b]=this.V141(b,c,
d)),d?this.V13w[b]:this.V13x[b]}catch(f){CB.Vjg("Tex:getSquare",f)}};e.prototype.V142=function(b,c,d,f){(c=this.V140(c,d))&&c.draw(b,f.x,f.y)};e.prototype.V143=function(b,c){var d=document.createElement("canvas");d.width=d.height=c;d=d.getContext("2d");this.V140(b,c).draw(d,0,0);d.lineWidth=Math.max(1,c/16);d.strokeStyle=this.V144();var f=c-d.lineWidth;CB.V87.V8c(d,d.lineWidth/2,d.lineWidth/2,f,f,Math.max(1,f/4));f=new CB.V8l;f.V8t(d,0,0,c,c);return f};e.prototype.V144=function(){return"hsla( 0, 10%, 10%, 0.4 )"};
var f={};CB.V145&&(f=new CB.V145);b=c=0;d={};e.prototype.V146=function(e,h,k){V35p.panelMgr.V147()&&f&&600<h&&500<k&&this.background.loaded&&(this.background.V8w(e,0,0,h,k),e=e.getImageData(0,0,h,k),f.darkenCorners(e,function(f){c=f.width;b=f.height;d=f;this.fireOnBGReady()}.bind(this)))};e.prototype.V13y=function(){f&&f.Vpj&&f.abort()};e.prototype.V148=function(f,e,k){this.background.loaded&&(c==e&&b==k?f.putImageData(d,0,0):this.background.V8w(f,0,0,e,k))};e.prototype.V149=function(b){switch(b){default:return CB.Vlw.V14a;
case CB.Vlw.V14b:return CB.Vlw.V14c;case CB.Vlw.V14d:return CB.Vlw.V14e;case CB.Vlw.V14f:return CB.Vlw.V14g;case CB.Vlw.V14h:return CB.Vlw.V14i;case CB.Vlw.V14j:return CB.Vlw.V14k;case CB.Vlw.V14l:return CB.Vlw.V14m}};e.prototype.V13p=function(b){return CB.V8l.V8r(this.V13n,b)};e.prototype.V14n=function(b){if(0!=b.url.search("blob:")){var c=CB.V87.V8e(b.image,b.width,b.height);this.V13n.setItem(b.url,c)}};e.prototype.V141=function(b,c,d){try{var f=Math.min(this.V13q.width,this.V13q.height),e=c,p=
55;CB.V5t.V64()&&(p=10);c<p?e=2*c:128<c&&(e=.5*c);if(this.V13q&&this.V13q.isValid()){var r=Math.floor((f-e)/7),u=83*CB.Vbf.Ve1(b)%7*r,q=41*CB.Vbf.Ve0(b)%7*r;0>u&&(u=0);0>q&&(q=0);var t=d?this.V14o:0,v=new CB.V8l;this.ctx&&(c==e?v.V8t(this.ctx,u,q+t,c,c):v.V8u(this.ctx,u,q+t,c,c,e,e));return v}}catch(w){CB.Vjg("Tex:cutSquare",w)}};e.prototype.V13t=function(){this.V13o.loaded&&this.V13q.loaded&&this.margin.loaded&&(this.canvas=document.createElement("canvas"),this.canvas.width=Math.max(this.V13o.width,
this.V13q.width),this.canvas.height=this.V13o.height+this.V13q.height,this.ctx=this.canvas.getContext("2d"),this.V13o.draw(this.ctx,0,0),this.V14o=this.V13o.height,this.V13q.draw(this.ctx,0,this.V14o),this.V13r&&this.V13r(),this.V14n(this.V13o),this.V14n(this.V13q),this.V14n(this.margin))};e.prototype.V13u=function(){this.V13s&&this.V13s();this.V14n(this.background)};V34y.initForListeners(e);V34y.addEvent(e,"BGReady");return e}();"use strict";
CB.V14p=function(){var c,b=function(b,c,f){this.V13n=localforage.createInstance({name:"Pieces"});b||(b="DiagramTTFritz");this.loaded=!1;this.sqSidePix=f;this.V14q=new CB.V8l;this.V8m=function(){};this.V14q=CB.V8l.V8r(this.V13n,V35p.V14r+"Pieces/"+b+c+".png");this.V14q.V8m=this.V14s.bind(this);this.V14t=Array(6);this.V14u=Array(6);this.name=b};b.prototype.destroy=function(){};b.prototype.isValid=function(){return void 0!==this.V14t[0]};b.prototype.createSprite=function(b){if(CB.Piece.side(b)==CB.Vaz.BLACK){var c=
new CB.V8y;c.V8n(this.V14u[CB.Piece.Vb3(b)-1]);c.piece=b;return c}c=new CB.V8y;c.V8n(this.V14t[CB.Piece.Vb3(b)-1]);c.piece=b;return c};b.prototype.V14v=function(){this.ctx.clearRect(0,0,this.sqSidePix,this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Vd-1)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,0,0,this.sqSidePix,this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Vj-1)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,.7*this.sqSidePix,0,.3*this.sqSidePix,.3*this.sqSidePix);this.V14q.draw(this.ctx,
(CB.Piece.Vh-1)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,.7*this.sqSidePix,.3*this.sqSidePix,.3*this.sqSidePix,.3*this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Vf-1)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,.7*this.sqSidePix,.6*this.sqSidePix,.3*this.sqSidePix,.3*this.sqSidePix);this.V14w=new CB.V8y(this.ctx);this.V14w.V8n(this.canvas.toDataURL());this.ctx.clearRect(0,0,this.sqSidePix,this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Ve-3)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,
0,0,this.sqSidePix,this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Vk-3)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,.7*this.sqSidePix,0,.3*this.sqSidePix,.3*this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Vi-3)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,.7*this.sqSidePix,.3*this.sqSidePix,.3*this.sqSidePix,.3*this.sqSidePix);this.V14q.draw(this.ctx,(CB.Piece.Vg-3)*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,.7*this.sqSidePix,.6*this.sqSidePix,.3*this.sqSidePix,.3*this.sqSidePix);this.V14x=
new CB.V8y(this.ctx);this.V14x.V8n(this.canvas.toDataURL())};b.prototype.getPromoSprite=function(b){return b==CB.Vaz.BLACK?this.V14x:this.V14w};b.prototype.V14s=function(){void 0===c&&(c=document.createElement("canvas"));this.canvas=c;this.canvas.width=this.sqSidePix;this.canvas.height=this.sqSidePix;this.ctx=this.canvas.getContext("2d");for(var b=0;6>b;b++)this.ctx.clearRect(0,0,this.sqSidePix,this.sqSidePix),this.V14q.draw(this.ctx,b*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,0,0,this.sqSidePix,
this.sqSidePix),this.V14t[b]=this.canvas.toDataURL();for(b=6;12>b;b++)this.ctx.clearRect(0,0,this.sqSidePix,this.sqSidePix),this.V14q.draw(this.ctx,b*this.sqSidePix,0,this.sqSidePix,this.sqSidePix,0,0,this.sqSidePix,this.sqSidePix),this.V14u[b-6]=this.canvas.toDataURL();this.loaded=!0;this.V14v();this.V8m();this.V14n(this.V14q)};b.prototype.V14n=function(b){if(0!=b.url.search("blob:")){var c=CB.V87.V8e(b.image,b.width,b.height);this.V13n.setItem(b.url,c)}};return b}();"use strict";
var spriteCache=[];
CB.V14y=function(){var c=function(){this.V14z=[];this.V150=[];this.V151=[]};c.clearCache=function(){spriteCache=[]};c.prototype.V152=function(b){for(var c=[0,1,2,3,3,3,10,0,0,1,2,3,3,3,10,0,0],e=CB.Piece.Vb;e<=CB.Piece.Vm;e++){void 0==this.V150[e]&&(this.V150[e]=[]);for(var f=0;f<c[e];f++)this.V150[e].push(b.createSprite(e))}this.V14w=b.getPromoSprite(CB.Vaz.WHITE);this.V14x=b.getPromoSprite(CB.Vaz.BLACK);this.sqSidePix=b.sqSidePix;this.name=b.name};c.prototype.create=function(b){this.V152(b)};c.prototype.destroy=
function(){this.V153()&&(void 0==spriteCache[this.name]&&(spriteCache[this.name]=[]),void 0==spriteCache[this.name][this.sqSidePix]&&(spriteCache[this.name][this.sqSidePix]=[]))};c.prototype.V42=function(b){for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])};c.prototype.setup=function(b,c,e){if(void 0!==b){if(this.V14z.length)for(var f=0;64>f;f++)void 0!==this.V14z[f]&&f!==e&&(this.V150[this.V14z[f].piece]&&this.V150[this.V14z[f].piece].push(this.V14z[f]),delete this.V14z[f]);for(f=0;64>f;f++){var g=
c[f];g&&f!==e&&(this.V14z[f]=this.createSprite(b,g,f),this.V14z[f].deleteBackground())}}};c.prototype.V154=function(b,c,e){if(void 0!==b&&0!=this.V150.length){for(var f=[],g=[],h=0;64>h;h+=1)0==c[h]||c[h]!=e[h]||void 0!==this.V14z[h]&&this.V14z[h].piece===c[h]||(void 0!==this.V14z[h]&&this.V155(this.V14z[h]),this.V14z[h]=this.createSprite(b,c[h],h));for(h=0;64>h;h+=1)if(0!=c[h]&&c[h]!=e[h]){var k=this.V14z[h];k||(k=this.createSprite(b,c[h],h));g.push({square:h,piece:c[h],sprite:k});delete this.V14z[h]}for(var k=
[],l=1;2>=l;l++)for(h=0;64>h;h+=1)if(0!=e[h]&&c[h]!=e[h]&&!k[h]){for(var m=!1,p=-1,r=99999,u=0;u<g.length&&!m;u++)if(void 0!=g[u]&&g[u].piece==e[h]&&(2==l||CB.Vbf.Ve1(g[u].square)==CB.Vbf.Ve1(h))){var q=CB.Vbf.V7m(g[u],h);q<r&&(r=q,p=u)}0<=p&&(this.V14z[h]=g[p].sprite,f.push(new CB.V156(e[h],this.V14z[h],g[p].square,h,V35p.V34v.V140(g[p].square,b.sqSidePix))),delete g[p],m=!0,k[h]=!0);m||2!=l||(this.V14z[h]=this.createSprite(b,e[h],h),f.push(new CB.V156(e[h],this.V14z[h],-1,h,V35p.V34v.V140(h,b.sqSidePix))))}for(u=
0;u<g.length;u++)void 0!=g[u]&&(f.push(new CB.V156(g[u].piece,g[u].sprite,g[u].square,-1,V35p.V34v.V140(g[u].square,b.sqSidePix))),this.V155(g[u].sprite),delete g[u]);return f}};c.prototype.set=function(b,c){this.V14z[c]&&this.V155(this.V14z[c]);b?this.V14z[c]=b:delete this.V14z[c]};c.prototype.V157=function(b){this.V155(b)};c.prototype.createSprite=function(b,c,e){if(this.V150[c]&&0<this.V150[c].length){for(var f,g=!1,h=0;h<this.V150[c].length;h++)e==this.V150[c][h].lastSq&&((f=this.V150[c][h])&&
(g=!0),this.V150[c].splice(h,1));g||((f=this.V150[c][0])||(f=b.createSprite(c)),this.V150[c].shift());f.piece=c;return f}return b.createSprite(c)};c.prototype.getPromoSprite=function(b){return b==CB.Vaz.BLACK?this.V14x:this.V14w};c.prototype.V158=function(b,c){this.V151[c]||(this.V151[c]=b.createSprite(c));return this.V151[c]};c.prototype.V153=function(){for(var b=0;64>b;b++)if(void 0!==this.V14z[b]&&!this.V14z[b].loaded)return!1;if(0==this.V150.length)return!1;for(b=CB.Piece.Vb;b<=CB.Piece.Vm;b++)for(var c=
0;c<this.V150[b].length;c++)if(!this.V150[b][c]||!this.V150[b][c].loaded)return!1;return!0};c.prototype.change=function(b,c){void 0!==this.V14z[c]&&this.V155(this.V14z[c]);this.V14z[c]=this.V14z[b];delete this.V14z[b]};c.prototype.Vea=function(b,c,e,f){void 0!==this.V14z[c]&&this.V155(this.V14z[c]);this.V14z[c]=this.createSprite(f,e);this.V14z[b].deleteBackground();this.V155(this.V14z[b]);delete this.V14z[b]};c.prototype.Veb=function(b,c,e){this.V14z[c]=this.V14z[b];this.V155(this.V14z[e]);delete this.V14z[e];
delete this.V14z[b]};c.prototype.V159=function(){for(var b=0;64>b;b++)void 0!==this.V14z[b]&&this.V14z[b].deleteBackground();this.V14w&&this.V14w.deleteBackground();this.V14x&&this.V14x.deleteBackground()};c.prototype.getPiece=function(b){return this.V14z[b]};c.prototype.V155=function(b){this.V150[b.piece].push(b)};c.prototype.V15a=function(b,c){return new CB.V7p(Math.floor(b.x-c/2),Math.floor(b.y-c/2),Math.floor(b.x+c/2),Math.floor(b.y+c/2))};return c}();
CB.V156=function(){var c=function(b,c,e,f,g){CBDebug.assert(void 0!==c);this.piece=b;this.sprite=c;this.sqFrom=e;this.sqTo=f;this.V15b=g};c.prototype.V15c=function(){return!1};c.prototype.deleteBackground=function(){this.sprite.deleteBackground()};c.prototype.startAnimation=function(b,c){this.debug="started";this.sprite.hide(b);var e=this.ptTo.subtract(this.ptFrom),f=new CB.V82(e.x,e.y);this.V15d=Math.floor(f.getLength()/this.sprite.w*c+.5);this.V15e=!0;5>this.V15d&&(this.V15d=5);this.V15f=new CB.V82(e.x/
this.V15d,e.y/this.V15d);this.currPos=this.ptFrom;if(-1==this.sqFrom||-1==this.sqTo)this.V15d=0};c.prototype.loaded=function(){return this.sprite&&this.sprite.loaded};c.prototype.hide=function(b){if(this.sprite){var c=!1,e=Math.floor(this.sprite.w/2);this.V15e&&-1!=this.sqFrom?void 0!==this.V15b&&(this.V15b.draw(b,this.ptFrom.x-e,this.ptFrom.y-e),this.sprite.saveBeforeMove(b,this.currPos),c=!0):-2==this.V15d&&-1==this.sqFrom&&void 0!==this.V15b&&(this.V15b.draw(b,this.ptTo.x-e,this.ptTo.y-e),this.sprite.saveBeforeMove(b,
this.currPos),c=!0);c||this.sprite.hide(b)}};c.prototype.moveToNoSave=function(b,c){this.sprite.moveToNoSave(b,c)};c.prototype.moveTo=function(b,c){this.sprite.moveTo(b,c)};c.prototype.saveBeforeMove=function(b,c){this.sprite.saveBeforeMove(b,c)};c.prototype.getMoveClipRect=function(){return this.sprite.getMoveClipRect()};c.prototype.deleteBackground=function(){this.sprite.deleteBackground()};c.prototype.displace=function(b){b=this.V15g(b);this.currPos.x+=b*this.V15f.x;this.currPos.y+=b*this.V15f.y};
c.prototype.prepNextStep=function(b){b=this.V15g(b);this.V15d-=b;this.V15e=!1;return-2>this.V15d};c.prototype.canDelete=function(){return-2>this.V15d};c.prototype.V15g=function(b){1>=this.V15d?b=1:b>this.V15d&&(b=this.V15d);return b};c.prototype.V15h=function(){return-1===this.sqTo};c.prototype.shouldHideInThisStep=function(){return-3<=this.V15d&&void 0!==this.sprite};c.prototype.hasReachedEndPos=function(){return 0>=this.V15d};c.prototype.isImmobileInThisStep=function(){return-1>=this.V15d};c.prototype.getsInvisibleAtEnd=
function(){return-2>=this.V15d&&this.V15h()};c.prototype.isStillMoving=function(){return 0<=this.V15d};return c}();"use strict";
CB.Vjl=function(){function c(b){return 0<b?1:0>b?-1:0}var b=function(b,c,d){this.from=b;this.to=c;this.rgba=d};b.prototype.draw=function(b){b.save();var d=this.boardControl.V15i(this.from),g=this.boardControl.V15i(this.to),h=CB.Vbf.Ve1(this.from),k=CB.Vbf.Ve0(this.from),l=CB.Vbf.Ve1(this.to),m=CB.Vbf.Ve0(this.to),k=c(m-k),h=c(l-h);this.boardControl.V15j?(g.x+=h*this.boardControl.nSqPix/4,g.y-=k*this.boardControl.nSqPix/4):(g.x-=h*this.boardControl.nSqPix/4,g.y+=k*this.boardControl.nSqPix/4);b.lineWidth=
Math.max(1,.09*this.boardControl.nSqPix);b.lineCap="round";this.rgba?this.V15k(b,this.rgba,d.x,d.y,g.x,g.y):(h=this.V15l(),b.strokeStyle=(new CB.HSLColor(h.h,h.s,h.l,.75)).toString(),b.fillStyle=(new CB.HSLColor(h.h,h.s,h.l,.9)).toString());this.drawArrow(b,d.x,d.y,g.x,g.y,3,1,Math.PI/8,.5*this.boardControl.nSqPix,.8*b.lineWidth);b.restore();return this.V15m()};b.prototype.V15k=function(b,c,d,h,k,l){if(c&&(c.alpha||c.hue)){d=b.createLinearGradient(d,h,k,l);var m=c.alpha;c.alpha=.15;d.addColorStop(0,
c);c.alpha=.4;d.addColorStop(.4,c);c.alpha=.55;d.addColorStop(.6,c);c.alpha=m;d.addColorStop(1,c);b.strokeStyle=d;b.fillStyle=c}else c&&0==c.search("hsla")?(m=/hsla\(\s*(\d{1,3}),\s*(\d{1,3})\%,\s*(\d{1,3})\%,\s(.+)\)/g.exec(this.rgba),d=b.createLinearGradient(d,h,k,l),h=String.f("hsla( {0}, {1}%, {2}%, {3} )",m[1],m[2],m[3],"0.15"),k=String.f("hsla( {0}, {1}%, {2}%, {3} )",m[1],m[2],m[3],"0.4"),l=String.f("hsla( {0}, {1}%, {2}%, {3} )",m[1],m[2],m[3],.55*m[4]),m=String.f("hsla( {0}, {1}%, {2}%, {3} )",
m[1],m[2],m[3],m[4]),d.addColorStop(0,h),d.addColorStop(.4,k),d.addColorStop(.6,l),d.addColorStop(1,m),b.strokeStyle=d,b.fillStyle=c):(b.fillStyle=c,b.strokeStyle=c)};b.prototype.undo=function(b){for(var d=CB.Vbf.Ve1(this.from),g=CB.Vbf.Ve0(this.from),h=CB.Vbf.Ve1(this.to),k=CB.Vbf.Ve0(this.to),l=c(k-g),m=c(h-d);d!=h||g!=k;){this.boardControl.V15n(b,CB.Vbf.I(d,g));if(0!=m&&0!=l){var p=CB.Vbf.I(d+m,g),r=CB.Vbf.I(d,g+l);0<=p&&64>p&&this.boardControl.V15n(b,p);0<=r&&64>r&&this.boardControl.V15n(b,r)}d!=
h&&(d+=m);g!=k&&(g+=l)}0<=d&&0<=g&&this.boardControl.V15n(b,CB.Vbf.I(d,g));return this.V15m()};b.prototype.V15m=function(){var b=this.boardControl.V15o(this.from);return b=b.getUnion(this.boardControl.V15o(this.to))};b.prototype.toString=function(){return"Arrow: "+CB.Vbf.toString(this.from)+"-"+CB.Vbf.toString(this.to)};var d=function(b,c,d,h,k,l,m,p){b.beginPath();b.moveTo(c,d);b.lineTo(h,k);b.lineTo(l,m);switch(p){case 0:p=Math.sqrt((l-c)*(l-c)+(m-d)*(m-d));b.arcTo(h,k,c,d,.55*p);b.fill();break;
case 1:b.lineTo(c,d);b.fill();break;case 2:b.stroke();break;case 3:b.quadraticCurveTo((c+h+l)/3,(d+k+m)/3,c,d);b.fill();break;case 4:if(l==c)p=m-d,l=(h+c)/2,h=(h+c)/2,m=k+p/5,p=k-p/5;else{p=Math.sqrt((l-c)*(l-c)+(m-d)*(m-d));h=((c+l)/2+h)/2;k=((d+m)/2+k)/2;l=(m-d)/(l-c);p=p/(2*Math.sqrt(l*l+1))/5;var r=l*p;l=h-p;m=k-r;h+=p;p=k+r}b.bezierCurveTo(l,m,h,p,c,d);b.fill()}},d=function(b,c,d,h,k,l,m,p){b.beginPath();b.moveTo(c,d);b.lineTo(h,k);b.lineTo(l,m);switch(p){case 0:p=Math.sqrt((l-c)*(l-c)+(m-d)*
(m-d));b.arcTo(h,k,c,d,.55*p);b.fill();break;case 1:b.lineTo(c,d);b.fill();break;case 2:b.stroke();break;case 3:b.quadraticCurveTo((c+h+l)/3,(d+k+m)/3,c,d);b.fill();break;case 4:if(l==c)p=m-d,l=(h+c)/2,h=(h+c)/2,m=k+p/5,p=k-p/5;else{p=Math.sqrt((l-c)*(l-c)+(m-d)*(m-d));h=((c+l)/2+h)/2;k=((d+m)/2+k)/2;l=(m-d)/(l-c);p=p/(2*Math.sqrt(l*l+1))/5;var r=l*p;l=h-p;m=k-r;h+=p;p=k+r}b.bezierCurveTo(l,m,h,p,c,d);b.fill()}};b.prototype.drawArrow=function(b,c,g,h,k,l,m,p,r,u){l="undefined"!=typeof l?l:3;m="undefined"!=
typeof m?m:1;p="undefined"!=typeof p?p:Math.PI/8;r="undefined"!=typeof r?r:10;u=u||0;var q="function"!=typeof l?d:l,t=h-c,v=k-g,w=Math.sqrt(t*t+v*v);if(0!=w){var y=Math.atan2(k-g,h-c),A=u*Math.cos(y);u*=Math.sin(y);w=(w-.76*r)/w;m&1?(t=c+t*w-A,v=g+v*w-u):(t=h,v=k);m&2?(A=c+(h-c)*(1-w),w=g+(k-g)*(1-w)):(A=c,w=g);b.save();if(this.rgba)this.V15k(b,this.rgba,A,w,t,v);else{u=b.createLinearGradient(A,w,t,v);var F=this.V15l();u.addColorStop(0,(new CB.HSLColor(F.h,F.s,F.l,.2)).toString());u.addColorStop(.2,
(new CB.HSLColor(F.h,F.s,F.l,.35)).toString());u.addColorStop(.65,(new CB.HSLColor(F.h,F.s,F.l,.55)).toString());u.addColorStop(1,(new CB.HSLColor(F.h,F.s,F.l,.9)).toString());b.strokeStyle=u}b.beginPath();b.moveTo(A,w);b.lineTo(t,v);b.stroke();b.restore();r=Math.abs(r/Math.cos(p));m&1&&(v=y+Math.PI+p,t=h+Math.cos(v)*r,v=k+Math.sin(v)*r,A=y+Math.PI-p,w=h+Math.cos(A)*r,A=k+Math.sin(A)*r,q(b,t,v,h,k,w,A,l));m&2&&(v=y+p,t=c+Math.cos(v)*r,v=g+Math.sin(v)*r,A=y-p,w=c+Math.cos(A)*r,A=g+Math.sin(A)*r,q(b,
t,v,c,g,w,A,l))}};b.prototype.V15l=function(){return{h:40,s:90,l:60}};return b}();
CB.V15p=function(){var c=function(b,c){this.sq=b;this.rgba=c};c.prototype.draw=function(b){var c=this.boardControl.V15i(this.sq);b.strokeStyle=this.rgba?b.fillStyle=this.rgba.toString():b.fillStyle="rgba( 255, 220, 10, 0.5 )";b.lineWidth=Math.max(1,this.boardControl.nSqPix/16);this.boardControl.V142(b,this.sq);var e=this.boardControl.nSqPix-b.lineWidth,f=e-0;CB.V87.V8c(b,c.x-e/2+0,c.y-e/2+0,f,f,Math.max(1,f/3.5));this.boardControl.V15q(b,this.sq);return this.V15m()};c.prototype.undo=function(b){var c=
CB.Vbf.Ve1(this.sq),e=CB.Vbf.Ve0(this.sq);this.boardControl.V15n(b,CB.Vbf.I(c,e));return this.V15m()};c.prototype.V15m=function(){return this.boardControl.V15o(this.sq)};c.prototype.toString=function(){return"Sq="+CB.Vbf.toString(this.sq)+", Clr="+this.rgba};return c}();"use strict";
CB.Vkf=function(){function c(b,c,f,g){var h=!1,k=f.event;void 0===k&&(k=f);for(f=0;f<b.length;f++)b[f]&&b[f].isInMyArea(g.x,g.y)&&(c.call(b[f],k,g),h=!0);return h}var b=function(b,c,f,g){this.cbcanvas=b;this.width=c;this.height=f;this.options=g;this.boards=[];this.V15r=[];b=CB.V5t.V6x()||CB.V5t.V6w()||CB.V5t.V6c();if(!b&&!this.V15s()){for(c=0;4>c;c++)this.V15r[c]=new CB.V15t(this.cbcanvas.canvas.parentElement,"BAreaShadow"+c),this.V15r[c].setVisible(!b&&0==c&&!V35p.V15u());this.V15r[0].setCssClass("BoardAreaShadowT");
this.V15r[1].setCssClass("BoardAreaShadowR");this.V15r[2].setCssClass("BoardAreaShadowB");this.V15r[3].setCssClass("BoardAreaShadowL")}g&&g.suppressCalcGeometry||this.Vmd();this.V15v=glSettings.addOnBoardStyleListener(function(){(new CB.Timer(function(){this.Vmd()}.bind(this))).runOnce(300)}.bind(this));V35p.V34v.V13s=this.V15w.bind(this)};b.prototype.addBoard=function(b){this.boards.push(b);b.idBoardAreaHandler=b.onReadyHandlers.add(this.onBoardReady.bind(this))};b.prototype.V15x=function(b){b=this.V15y(b);
void 0!==b&&(b=this.boards.splice(b,1),b[0]&&b[0].destroy(),this.V148(this.cbcanvas.V9p),this.cbcanvas.V15z())};b.prototype.V160=function(){return this.width/this.height};b.prototype.V161=function(){this.V162()};b.prototype.V162=function(){for(var b=0;b<this.boards.length;b++)this.boards[b]&&this.boards[b].destroy();this.boards=[];this.Vmd()};b.prototype.Vmb=function(b){this.boards=[];this.addBoard(b);this.V148(this.cbcanvas.V9p);this.Vmd()};b.prototype.Vmf=function(b){this.boards=[];this.boards.push(b);
this.Vmd();this.V148(this.cbcanvas.V9p);this.Vmd();this.cbcanvas.V15z()};b.prototype.V15y=function(b){for(var c=0;c<this.boards.length;c++)if(this.boards[c]&&this.boards[c].uniqueId==b.uniqueId)return c};b.prototype.draw=function(b){try{this.V163(b),this.V164=!1}catch(c){CB.Vjg("AreaDraw",c)}};b.prototype.V165=function(){this.cbcanvas.canvas.style.backgroundImage="url( '"+V35p.V34v.background.url+"' )"};b.prototype.drawWood=function(b){for(var c=0;c<this.boards.length;c++)this.boards[c]&&this.boards[c].drawWood(b,
this.V166())};b.prototype.V163=function(b){for(var c=0;c<this.boards.length;c++)this.boards[c]&&this.boards[c].draw(b,this.V166())};b.prototype.V148=function(b){this.V15s()?this.V164=!0:void 0!==b&&V35p.V34v.background&&V35p.V34v.background.loaded&&(V35p.V34v.V148(b,this.width,this.height),this.V164=!0)};b.prototype.beforeResize=function(){for(var b=0;b<this.boards.length;b++)this.boards[b]&&this.boards[b].beforeResize()};b.prototype.resize=function(b,c){this.width=b;this.height=c;this.Vmd()};b.prototype.Vkv=
function(){this.resize(this.width,this.height)};b.prototype.Vmd=function(){this.cbcanvas&&(this.V167&&V35p.V34v.removeOnBGReadyListener(this.V167),this.V167=V35p.V34v.addOnBGReadyListener(this.V168.bind(this)),V35p.V34v.V146(this.cbcanvas.ctx,this.width,this.height));this.boards.forEach(function(b){b.setTitleVisible(!1)});this.V169=this.boards.length;this.V16a();this.cbcanvas.V16b(!1);0===this.boards.length&&void 0!==this.cbcanvas.control&&this.cbcanvas.V15z();var b=this.cbcanvas.pixToZoom(this.width),
c=this.cbcanvas.pixToZoom(this.height),f=Math.min(c/50,10),g=Math.min(b/50,10);this.V15r&&4==this.V15r.length&&(this.V15r[0].setPosSize(0,0,b,g),this.V15r[1].setPosSize(b-g,f,f,c-2*f),this.V15r[2].setPosSize(0,c-f,b,f),this.V15r[3].setPosSize(0,f,g,c-2*f))};b.prototype.onMouseDown=function(b,e){this.boards.length&&c(this.boards,this.boards[0].onMouseDown,b,e)};b.prototype.onContextMenu=function(b,e){this.boards.length&&c(this.boards,this.boards[0].onContextMenu,b,e)};b.prototype.onMouseUp=function(b,
e){if(this.boards.length&&!c(this.boards,this.boards[0].onMouseUp,b,e)&&1==this.boards.length)this.boards[0].onMouseUp(b,e)};b.prototype.onMouseMove=function(b,e){if(this.boards.length)if(1==this.boards.length)this.boards[0].onMouseMove(b,e);else c(this.boards,this.boards[0].onMouseMove,b,e)};b.prototype.onMouseEnter=function(b,e){this.boards.length&&c(this.boards,this.boards[0].onMouseEnter,b,e)};b.prototype.onMouseLeave=function(b,e){this.boards.length&&c(this.boards,this.boards[0].onMouseLeave,
b,e)};b.prototype.V16c=function(b,c){};b.prototype.V15w=function(){this.width&&this.cbcanvas&&V35p.V34v.V146(this.cbcanvas.ctx,this.width,this.height);this.cbcanvas.V16d();void 0!==this.V16e&&this.V16e()};b.prototype.V16f=function(b){var c=this.cbcanvas.canvas.getBoundingClientRect();return new CB.V6e(b.getX()-c.left,b.getY()-c.top)};b.prototype.V16g=function(b,c,f){var g={w:10,nX:b,nY:1};if(0==b)return g;var h=Math.max(c,f);g.w=Math.round(Math.min(Math.min(c,f)-0,Math.floor(h/b-0)));if(0==g.w)return g;
h==c?(g.nX=b,g.nY=1):(g.nX=1,g.nY=b);for(var h=b,k=1;k<=b;){var l=Math.floor(Math.min(c/h-0,f/k-0));g.w<l&&(g.w=l,g.nX=h,g.nY=k);k++;h=Math.floor(b/k);b!=h*k&&h++}1==h&&1<k&&1==b?(g.h=f,g.w=c):g.h=g.w;return g};b.prototype.V16a=function(){if(0!=this.boards.length){var b=this.width,c=this.height,f=0,g=0,h=0;if(1<this.boards.length&&this.options.splitLayout){var k=this.width-this.height-0;if(Math.abs(k)>.2*Math.max(this.width,this.height)&&0<k)var g=this.width-k,l=Math.min(g,this.height),b=k,h=6,c=
l-2*h,f=1}k=this.V16g(this.boards.length-f,b,c);if(0!=k.w){var b=Math.floor((b-k.nX*k.w)/(k.nX+1)),c=Math.floor((c-k.nY*k.h)/(k.nY+1)),m=new CB.Size(k.w,k.h);if(1==this.boards.length)this.boards[0].setLeftSpace(b),this.boards[0].setPosSize(new CB.V6e(b,0),m);else for(0<f&&(this.boards[0].setLeftSpace(b),this.boards[0].setTitleVisible(!0),this.boards[0].setPosSize(new CB.V6e(0,0),new CB.Size(l,l))),l=0;l<k.nX;l++)for(var p=g+b+l*(b+k.w),r=0;r<k.nY;r++){var u=h+c+r*(c+k.w);f<this.boards.length&&(u=
new CB.V6e(p,u),this.boards[f].setLeftSpace(b),this.boards[f].setTitleVisible(!0),this.boards[f].setPosSize(u,m),f++)}}}};b.prototype.V16h=function(){this.V148(this.cbcanvas.V9p);this.cbcanvas.V15z()};b.prototype.onBoardReady=function(b){--this.V169;0>=this.V169&&(this.V148(this.cbcanvas.V9p),this.cbcanvas.V15z(),this.boards.forEach(function(b){b.setTitleVisible(!0);void 0!==b.rightWin&&b.rightWin.setVisible(!0)}),this.V169=this.boards.length)};b.prototype.V168=function(){this.V148(this.cbcanvas.V9p);
this.cbcanvas.V15z()};b.prototype.V15s=function(){return this.options?this.options.transparent:!1};b.prototype.V166=function(){return this.options?this.options.boardShadow&&this.V164:this.V164};return b}();"use strict";
CB.V16i=function(){var c=1,b=function(){this.options={}};b.prototype.init=function(b,d,e,k){this.cbcanvas||(this.cbcanvas=b,this.V16j={x:0,y:0},this.y=0,this.width=this.V16k=d,this.height=this.V16l=e,this.debugName=k,this.V15j=!1,this.allowInput=!0,this.V16m=!1,this.evaluation=0,this.V16n=!0,this.Vmd(),this.board=new CB.Ve6,this.Vk8=new CB.Vj6(this),this.V16o={},this.V16p="DiagramTTFritz",this.V16q=new CB.V14y,this.animation=new CB.Animation(this.cbcanvas),this.V16r=[],this.onReadyHandlers=new CB.V43(this),
this.nMarginW=1,V35p.V34v.V13r=this.V16s.bind(this),this.uniqueId=c++,this.animSteps={forMove:.6,forPosition:1},this.V16t=new CB.Timer(this.V16u.bind(this)))};b.prototype.destroy=function(){this.Vm9();this.destroyMessage();this.V16v();this.V16w();this.V16x();this.onReadyHandlers.remove(this.idBoardAreaHandler);this.onReadyHandlers.empty();this.V15v&&glSettings.removeOnBoardStyleListener(this.V15v);this.V16q.destroy();this.V16y&&this.V16y.destroy();this.setGame(null);this.V16m=!1;this.shouldAnimatePosChange=
this.fnBoardClick=this.fnSquareRelease=this.fnSquareChangeInMouseMove=this.fnMarkSquaresOnButtonDown=this.fnSquareClick=null};b.prototype.V16z=function(){};b.prototype.Vkh=function(){this.V15v=glSettings.addOnBoardStyleListener(this.onBoardStyle.bind(this))};b.prototype.onBoardStyle=function(b,c){V35p.V170(CB.V13m.prototype.V149(b));this.changeBoardStyle(b,c)};b.prototype.changeBoardStyle=function(b,c){this.V16p=c;this.nSqPix=0};b.prototype.setPosSize=function(b,c){var d=new CB.Size(0,0),e=new CB.Size(0,
0);if(void 0!==this.titleWin){var l=this.titleWin.V171(c.h);d.h=this.cbcanvas.pixToZoom(l)}void 0!==this.V172&&(e.h=this.cbcanvas.pixToZoom(7));d.h=this.options?d.h+(this.options.topDist||0):d.h+V35p.config.V173;e.h=this.options?e.h+(this.options.bottomDist||0):e.h+V35p.config.V174;this.V16j=new CB.V6e(Math.round(b.x+d.w),Math.round(b.y+d.h));this.width=Math.round(c.w-d.w);this.height=Math.round(c.h-d.h-e.h);this.resize(this.width,this.height)};b.prototype.beforeResize=function(){this.titleWin&&this.titleWin.setVisible(!1)};
b.prototype.resize=function(b,c){this.V175();this.width=b;this.height=c;b&&c?this.V16t.runOnce(10):this.V16t.stop();this.currPiece&&this.currPiece.deleteBackground()};b.prototype.V16u=function(){this.V16t.stop();this.V175();this.attributes=[];var b=this.nSqPix;this.Vmd();b!=this.nSqPix||void 0===this.V16y?(this.V16q.destroy(),this.V16q=new CB.V14y,this.V16y&&this.V16y.destroy(),this.V16y=new CB.V14p(this.V16p,this.nSqPix,this.nSqPix),this.V16y.V8m=this.V176.bind(this)):this.V16q.V153()&&(this.V16q.V159(),
this.onReadyHandlers.count()?this.onReadyHandlers.execute():this.cbcanvas.V15z());this.V177()?(this.titleWin.V178(this),this.titleWin.setVisible(!0)):this.titleWin&&this.titleWin.setVisible(!1);void 0!==this.messageWin&&this.messageWin.V178(this);void 0!==this.rightWin&&this.rightWin.V178(this);void 0!==this.bottomWin&&(this.bottomWin.V179(this.height,this.cbcanvas)?(this.bottomWin.setVisible(!0),this.bottomWin.V178(this)):this.bottomWin.setVisible(!1));this.V172&&(this.V172.V178(this),this.V172.setVisible(!0))};
b.prototype.Vmd=function(){var b=this.height,c=0;this.V177()&&(c=this.titleWin.V171(this.height,this.cbcanvas)+2,this.titleWin.V17a&&(c+=this.titleWin.V17a(this.height,this.cbcanvas)));var b=b-c,d=0;void 0!==this.bottomWin&&this.bottomWin.V179(this.height,this.cbcanvas)&&(d=this.bottomWin.V171(b,this.cbcanvas),this.bottomWin.V17b(d,this.cbcanvas),d+=this.bottomWin.V17a(this.height,this.cbcanvas),b-=d);var b=Math.round(b),e=this.width,l=0;void 0!==this.rightWin&&(l=this.rightWin.V17c(this.width,this.height));
e-=l;this.V16k=Math.min(e-.056*e,b);this.options&&this.options.marginDistDivisor?this.V16k-=Math.floor(this.V16k/this.options.marginDistDivisor):(window.V35p&&V35p.V15u(),this.V16k-=Math.floor(this.V16k/50));this.V16n=480<=this.V16k;this.options&&this.options.minWForCoordinates&&(this.V16n=this.V16k>=this.options.minWForCoordinates);this.nMarginW=this.V17d();this.V17e=this.V16k-2*this.nMarginW;this.V17f=this.nSqPix=Math.floor(this.V17e/8);this.nSqPix=CB.V16i.V17g(this.V17f);1>this.nSqPix&&(this.nSqPix=
1);this.V17e=8*this.nSqPix;this.V16k=this.V17e+2*this.nMarginW;this.V17h=0;this.x0=Math.floor(this.V16j.x+(this.width-this.V16k-l)/2+.5);b=c?Math.min(this.cbcanvas.zoomToPix(.8*c),(this.height-this.V16k-d)/2):(this.height-this.V16k-d)/2;this.y0=Math.floor(this.V16j.y+b);this.options&&this.options.shiftXPercent&&(this.x0=Math.floor(this.x0+this.V16k*this.options.shiftXPercent/100))};b.V17g=function(b){var c=[160,152,144,138,132,126,120,114,110,106,102,98,94,90,88,84,82,80,78,76,74,72,70,68,66,64,62,
60,58,56,54,52,50,48,46,44,42,41,40,39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,12,10,8],d;for(d=0;d<c.length;d++)if(b>=c[d]){b=c[d];break}d>=c.length&&(b=8);return b};b.prototype.V17d=function(){return this.V16n?Math.max(6,Math.round(Math.min(16,this.V16k/40))):Math.round(Math.min(12,this.V16k/60))};b.prototype.setTitleText=function(b){this.titleWin&&this.titleWin.setText(b);this.debugName=b};b.prototype.addTitle=function(b,c,d){void 0===this.titleWin&&(this.titleWin=
new CB.V17i(this,b,function(b){this.fnBoardClick(this.uniqueId);b.preventDefault()}.bind(this),"",c,function(b){d(b)}));return this.titleWin};b.prototype.V17j=function(b){this.Vm9();this.titleWin=b;this.V16u()};b.prototype.V17k=function(b,c){this.Vm9();this.V16w();this.titleWin=b;this.bottomWin=c};b.prototype.V177=function(){return window.V35p&&V35p.V15u()?this.titleWin&&210<Math.min(this.height,this.width):this.titleWin&&100<Math.min(this.height,this.width)};b.prototype.setTitleVisible=function(b){this.V177()&&
this.titleWin.setVisible(b)};b.prototype.V17l=function(){this.V172||(this.V172=new CB.V17m(this),this.V16t.runOnce(10));return this.V172};b.prototype.setLeftSpace=function(b){this.nLeftSpace=b};b.prototype.V17n=function(b){return this.V17p=this.titleWin=new CB.V17o(this,this.getOuterRect().h/16,b)};b.prototype.V17q=function(){this.V17p&&(this.V17p.destroy(),this.V17p=null,this.Vm9(),this.titleWin=null)};b.prototype.Vm9=function(){this.titleWin&&this.titleWin.destroy();delete this.titleWin};b.prototype.V16x=
function(){this.V172&&(this.V172.destroy(),delete this.V172)};b.prototype.destroyMessage=function(){this.messageWin&&this.messageWin.destroy();delete this.messageWin};b.prototype.V16v=function(){this.rightWin&&this.rightWin.destroy();delete this.rightWin};b.prototype.V16w=function(){this.bottomWin&&this.bottomWin.destroy();delete this.bottomWin};b.prototype.Vrs=function(){return this.titleWin&&this.titleWin.V17r()};b.prototype.Vrq=function(){if(this.titleWin)return this.titleWin.V17r()};b.prototype.V17s=
function(b){this.destroyMessage();return this.addMessage(b,!0,!0)};b.prototype.addMessage=function(b,c,d){if(this.messageWin||c)this.messageWin?this.messageWin.setText(b):(this.messageWin=new CB.V17t(this,b,d),this.messageWin.setVisible(!0)),this.messageWin.V178(this)};b.prototype.V17u=function(b){this.rightWin=b;this.rightWin.V178(this)};b.prototype.V17v=function(b){(this.bottomWin=b)&&this.bottomWin.V178(this)};b.prototype.markAsSelected=function(b){V35p.V15u()||this.titleWin&&this.titleWin.markAsSelected(b)};
b.prototype.onMouseEnter=function(b,c){this.V16f(c)};b.prototype.onContextMenu=function(b,c){};b.prototype.onMouseLeave=function(b,c){this.V16f(c)};var d=new CB.V35b,e=new CB.V35b;b.prototype.onMouseMove=function(b,c){var h=this.V16f(c);if(this.V16m&&this.evaluation)if(this.V17w&&this.V17w.V7z(h.x,h.y)){var k=this.evaluation.strEval+"<br/><em>"+this.evaluation.strLine+"</em>";d.exec(function(){this.V17x(new CB.V6e(b.clientX,b.clientY),k)}.bind(this),200)}else this.V17y();this.V17z&&this.V17z.V7z(h.x,
h.y)&&this._game?(k=this._game.getCurPos().getBTM()?"Black's move":"White's move",k+=", click to flip board",e.exec(function(){this.V180||this.V181(new CB.V6e(b.clientX,b.clientY),k);this.V180=!0}.bind(this),200)):this.V182()};b.prototype.onMouseUp=function(b,c){var d=this.V16f(c);this.V17z&&this.V17z.V7z(d.x,d.y)&&this.flipBoard()};b.prototype.V17x=function(b,c){this.V183("Eval",b,c,new CB.Size(190,40),e)};b.prototype.V17y=function(){this.hideToolTip("Eval",d)};b.prototype.V181=function(b,c){this.V183("ToMove",
b,c,new CB.Size(140,35),e,2500)};b.prototype.V183=function(b,c,d,e,l,m){var p=this;!p[b]&&d&&(V35p.V15u()&&(c.x=c.x-e.w-5),p[b]=new CB.V184,p[b].setText(d),p[b].setPosSize(c,e),p[b].setVisible(!0),(new CB.Timer(function(){p.hideToolTip(b,l)}.bind(p))).runOnce(m||6E3))};b.prototype.V182=function(){this.hideToolTip("ToMove",e)};b.prototype.hideToolTip=function(b,c){c.stop();this[b]&&(this[b].destroy(),delete this[b])};b.prototype.V185=function(b,c){this.V186(b,this.V15i(c));b.lastSq=c};b.prototype.V186=
function(b,c){b.moveTo(this.cbcanvas.V9p,c);this.cbcanvas.V187(b.getMoveClipRect())};b.prototype.V188=function(b){b&&(b.hide(this.cbcanvas.V9p),this.cbcanvas.V187(b.getMoveClipRect()))};b.prototype.V189=function(b,c){var d=this.V18a(b);return c.x<d.x+.7*this.nSqPix?CB.Piece.QUEEN:c.y<d.y+.3*this.nSqPix?CB.Piece.KNIGHT:c.y<d.y+.6*this.nSqPix?CB.Piece.BISHOP:CB.Piece.ROOK};b.prototype.V18b=function(b,c){for(var d=0;d<b.length;d++);d=this.V18c(b);b.length&&c&&this.cbcanvas.V187(d)};b.prototype.V18c=
function(b,c){this.attributes=this.attributes?this.attributes.concat(b):b;for(var d=null,e=0;e<b.length;e++){b[e].boardControl=this;var l=b[e].draw(c||this.cbcanvas.V9p),d=d?d.getUnion(l):l}return d};b.prototype.undoAttributes=function(){if(void 0!==this.attributes&&this.attributes.length){for(var b=null,c=0;c<this.attributes.length;c++)var d=this.attributes[c].undo(this.cbcanvas.V9p,function(b){return this.V18a(nSq)}.bind(this)),b=b?b.getUnion(d):d;this.cbcanvas.V187(b);this.attributes=[]}};b.prototype.queueBoardAttributes=
function(b,c){this.V18d=!this.V18d||c&&c.eraseQueue?b:this.V18d.concat(b);c.renderNow&&!this.V18e()&&this.V18f(c.requestAnimInRender,c.ctx)};b.prototype.V18f=function(b,c){if(this.V18d){var d=this.V18c(this.V18d,c);b&&this.cbcanvas.V187(d,!0);this.V18d=[]}};b.prototype.Vmh=function(){this.V18d=[]};b.prototype.V18e=function(){return this.V16r.length||this.animation.jobs.length};b.prototype.V18g=function(b){this.V188(this.currPiece);0<=b&&(this.V142(this.cbcanvas.V9p,b),this.currPiece.V99(this.cbcanvas.V9p),
this.V186(this.currPiece,this.V15i(b)))};b.prototype.V18h=function(b,c,d,e){if(void 0!==b){var l=d.subtract(c);this.V18i=e;this.V18j=d;this.V18k=new CB.V82(l.x/this.V18i,l.y/this.V18i);this.V18l=b;this.V18m=c;b=new CB.V7p;b.V7t(c.x,c.y,d.x,d.y);this.cbcanvas.V9q(b);this.V18n=window.requestAnimationFrame(this.V18o.bind(this))}};b.prototype.V18o=function(){this.V18l.moveTo(this.cbcanvas.V9p,this.V18m);this.V18m=0===this.V18i?this.V18j:this.V18m.add(this.V18k);this.cbcanvas.V9q(this.V18l.getMoveClipRect());
this.cbcanvas.V9s();0<this.V18i&&(this.V18n=window.requestAnimationFrame(this.V18o.bind(this)));this.V18i--};b.prototype.V18p=function(){return void 0!==this.V16y&&this.V16y.loaded&&this.V16q.V153()&&V35p.V34v.V13z()?!0:!1};b.prototype.V18q=function(b,c){if(this.V18r)this.V18s=b;else if(this.undoAttributes(),!ObjUtil.equals(b,this.board.sqs)&&1<this.nSqPix)if(this.V18p()){var d=!1;if(c&&this.V18t()){var e=this.V16q.V154(this.V16y,this.board.sqs,b);e&&e.length?(this.board.Ve9(b),this.V16r=e,this.V18u(),
this.V18v(),d=this.V18w=!0):this.V18x=b}d||(c&&this.animation.currFPS&&this.animation.currFPS++,this.board.Ve9(b),this.V18d=[],this.V18y(),this.V18w=!1);this.V18z(this.cbcanvas.V9p,!1)}else this.board.Ve9(b)};b.prototype.prepareFullRedraw=function(){delete this.currPiece;this.V190=!1;this.V175();this.cbcanvas.V191()};b.prototype.V18y=function(b){try{if(!(1>=this.nSqPix)){var c=-1;this.currPiece&&this.V190&&-1!=this.fromSq&&(c=this.fromSq);this.V16q.setup(this.V16y,this.board.sqs,c);this.V175();this.V16r=
[];this.currPiece&&this.V190&&this.currPiece.deleteBackground();delete this.V192;if(!this.draw(this.cbcanvas.V9p))return!1;this.currPiece&&this.V190&&(-1!=this.fromSq&&this.V142(this.cbcanvas.V9p,this.fromSq),this.currPiece.moveTo(this.cbcanvas.V9p,this.clickPos.add(this.V193)));this.V194(!0);this.V18f(!1);if(!b){var d=this.getOuterRect();this.currPiece&&(d=d.getUnion(this.currPiece.getMoveClipRect()));this.cbcanvas.V187(d,!0)}this.V18x=null;return!0}}catch(e){CB.Vjg("BoardRedraw",e)}};b.prototype.V18v=
function(){this.currPiece&&-1!=this.fromSq&&this.board.sqs[this.fromSq]!=this.currPiece.piece&&(delete this.currPiece,this.fromSq=-1)};b.prototype.V18t=function(){return!this.animation.currFPS||this.animation.currFPS>V35p.V195};b.prototype.V175=function(){this.animation.V9h();this.V18n&&window.cancelAnimationFrame(this.V18n)};b.prototype.V18u=function(){function b(c,d,f){return 40>c.currFPS?30>c.currFPS?20>c.currFPS?.25:.5:Math.min(1,d.forMove):3>f?d.forMove:d.forPosition}for(var c=!0,d=0;d<this.V16r.length;d++)this.V16r[d].loaded||
(c=!1);if(c){for(d=0;d<this.V16r.length;d++){var e,c=-1==this.V16r[d].sqFrom?this.V196(this.V16r[d].piece):this.V15i(this.V16r[d].sqFrom);e=-1==this.V16r[d].sqTo?this.V196(this.V16r[d].piece):this.V15i(this.V16r[d].sqTo);this.V16r[d].ptFrom=c;this.V16r[d].ptTo=e}d=this.V16r;this.V18d&&this.V18d.length&&(this.animation.V9u=function(){this.V18f(!0)}.bind(this));d.length&&this.animation.V9j(d,b(this.animation,this.animSteps,d.length),this.getOuterRect());this.V16r=[]}else setTimeout(function(){this.V18u()}.bind(this),
100)};b.prototype.draw=function(b,c){if(!isNaN(this.x0)&&1<this.nSqPix&&1<this.V17f){if(this.V163(b,c))this.V194(!1,this.cbcanvas.V9p);else return!1;void 0!==this.V197&&this.V197(this.getOuterRect())}return!0};b.prototype.drawWood=function(b,c){return this.V198(b,c)?this.V199(b):!1};b.prototype.V163=function(b,c){if(this.drawWood(b,c)&&this.V16y&&this.V16y.loaded)return this.V19a(b),!0};b.prototype.V19b=function(){return new CB.V7p(this.x0+this.nMarginW,this.y0+this.nMarginW,this.x0+this.nMarginW+
this.V17e,this.y0+this.nMarginW+this.V17e)};b.prototype.getOuterRect=function(){return new CB.V7p(this.x0,this.y0,this.x0+this.V16k,this.y0+this.V16k)};b.prototype.V198=function(b,c){if(4>this.V16k)return!0;try{return this.V18p()?(b.save(),c&&this.V19c(b,.6),V35p.V34v.margin.V8w(b,this.x0,this.y0,this.V16k,this.V16k),b.restore(),this.V16m&&this.V19d(b,c,this.evaluation),this.V16n&&this.V19e(b),this.V18z(b),!0):!1}catch(d){CB.Vjg("RawB:DrawMargin",d)}};b.prototype.V19e=function(b){b.save();var c=Math.round(.8*
this.nMarginW);b.font=c+"px Roboto, sans-serif";b.fillStyle="yellow";var d=b.measureText("A").width,e=this.x0+(this.nMarginW-d)/2,l=this.y0+this.nSqPix/2+c/2+this.nMarginW-.2*c;V35p.panelMgr&&V35p.panelMgr.viewport&&V35p.panelMgr.viewport.rtl&&(e+=8*this.nSqPix+this.nMarginW);for(var m=0;8>m;m++)this.V15j?b.fillText(m+1,e,l+m*this.nSqPix):b.fillText(8-m,e,l+m*this.nSqPix);e=this.x0+(this.nSqPix-d)/2+this.nMarginW+.1*d;l=this.y0+this.V17e+this.nMarginW+(this.nMarginW-c)/2+c-.2*c;for(m=0;8>m;m++)this.V15j?
b.fillText(String.fromCharCode(104-m),e+m*this.nSqPix,l):b.fillText(String.fromCharCode(97+m),e+m*this.nSqPix,l);b.restore()};b.prototype.V18z=function(b){if(this._game){this.V19f(b);b.save();var c=.34*this.V19g(this.getOuterRect().w),d=this.x0+2*this.nMarginW+this.V17e+.9*c,e=this.y0+this.V17e+2*this.nMarginW-c-.02*this.V17e;b.beginPath();b.arc(d,e,c,0,2*Math.PI,!1);var l=b.createRadialGradient(d-.3*c,e-.2*c,.1*c,d-.2*c,e-.2*c,c);this._game.getCurPos().getBTM()?(l.addColorStop(0,"rgba( 150, 150, 160, 1.0 )"),
l.addColorStop(1,"rgba( 60, 30, 30, 1.0 )")):(l.addColorStop(0,"rgba( 250, 250, 255, 1.0 )"),l.addColorStop(1,"rgba( 220, 220, 225, 1.0 )"));b.fillStyle=l;b.lineWidth=0;this.V19c(b,.8,2,3);b.fill();b.restore();this.V17z=new CB.V7p(d-c,e-c,d+2*c,e+2*c);this.cbcanvas.V187(this.V17z)}};b.prototype.V19g=function(b){return Math.min(Math.max(.054*b,5),30)};b.prototype.V19f=function(b){var c=this.getOuterRect(),d=.09*c.h,e=this.V19g(c.w),l=.4*d,m=new CB.V80,p=c.bottom-d,r=c.bottom,c=c.right;this.V19h=new CB.V7p(c,
p,c+e,p-d);m.push(new CB.V6e(c,p));m.push(new CB.V6e(e/8+c,l/4+p));m.push(new CB.V6e(e/2+c,l/2+p));m.push(new CB.V6e(3*e/4+c,3*l/4+p));m.push(new CB.V6e(e+c,l+p));m.push(new CB.V6e(e+c,r));m.push(new CB.V6e(c,r));b.save();m.V85(b);d=V35p.V34v.margin.V8s(b);b.fillStyle=d||"brown";b.fill();b.restore()};b.prototype.V19c=function(b,c,d,e){d=d||Math.max(1,Math.min(4,Math.round(Math.sqrt(this.V16k/60))));b.shadowOffsetX=d;b.shadowOffsetY=d;b.shadowBlur=e||3*d;b.shadowColor="rgba( 60, 30, 15, "+c+" )";return d};
b.prototype.displayEvaluation=function(b,c){var d=b!=this.V16m;this.V16m=b;this.evaluation=c;b&&d?(new CB.Timer(function(){this.V16u();delete this.V192;this.markLastMove(!0)}.bind(this))).runOnce(500):b&&(this.V19d(this.cbcanvas.V9p,!1,this.evaluation),delete this.V192,this.cbcanvas.V187())};b.prototype.setEvaluationInvalid=function(){this.V16m&&this.evaluation&&(this.evaluation.isInvalid=!0,(new CB.Timer(function(){this.V16u();delete this.V192;this.markLastMove(!0)}.bind(this))).runOnce(200))};b.prototype.V19i=
function(b){this.V16n=b};b.prototype.V19d=function(b,c,d){var e=this.getOuterRect();if(!(50>e.width)){this.evaluation=d;var l=.5*e.h,m=this.V19g(e.w),p=.15*l,r=new CB.V80,u=e.top+(e.h-l)/2,e=e.right;this.V17w=new CB.V7p(e,u,e+m,u+l);r.push(new CB.V6e(e,u));r.push(new CB.V6e(m/8+e,p/4+u));r.push(new CB.V6e(m/2+e,p/2+u));r.push(new CB.V6e(7*m/8+e,3*p/4+u));r.push(new CB.V6e(m+e,p+u));var q=u+(l-p);r.push(new CB.V6e(m+e,q));r.push(new CB.V6e(7*m/8+e,p/4+q));r.push(new CB.V6e(m/2+e,p/2+q));r.push(new CB.V6e(m/
8+e,3*p/4+q));r.push(new CB.V6e(e,q+p));b.save();r.V85(b);r=V35p.V34v.margin.V8s(b);b.fillStyle=r||"brown";c&&this.V19c(b,1);this.V19j=new CB.V7p(e,u,e+m,u+l-2*p);b.fill();c=u+p+2;u=.35*m;e+=(m-u)/5;l=new CB.V7p(e,c,e+u,c+(l-2*p-4));p=b.createLinearGradient(l.left,l.top,l.right,l.top);this.V19k(d.value,.3,143);e=new CB.Color(216.75,216.75,216.75,1);c=new CB.Color(255,255,255,1);u=new CB.Color(191.25,191.25,191.25,1);p.addColorStop(0,e.toString());p.addColorStop(.3,c.toString());p.addColorStop(1,u.toString());
b.lineWidth=l.w;b.strokeStyle=p;b.lineCap="round";this.V19c(b,1,2,3);CB.V87.V8b(b,l.left+l.w/2,l.top,l.left+l.w/2,l.bottom);b.shadowColor="black";this.V19c(b,0,0,0);this.V19l(b,0,"black",l);d.isInvalid||(d=-this.V19k(d.value,.7,333)*l.h/2+l.h/2+l.top,p=b.createLinearGradient(l.left+l.w/2,d-2,l.left+l.w/2,d+2),p.addColorStop(0,"rgba( 0, 220, 0, 1.0 )"),p.addColorStop(.4,"rgba( 0, 235, 0, 1.0 )"),p.addColorStop(1,"rgba( 0, 200, 0, 1.0 )"),b.strokeStyle=p,b.lineCap="round",b.lineWidth=Math.min(Math.max(2,
m/2),7),this.V19c(b,.6,1,2),CB.V87.V8b(b,l.left+1,d,l.right+1,d));b.restore()}};b.prototype.V19l=function(b,c,d,e){c=-this.V19k(100*c,.7,333)*e.h/2+e.h/2+e.top;b.strokeStyle=d;b.lineWidth=1;b.lineCap="";CB.V87.V8b(b,e.left,c,e.right+1,c)};b.prototype.V19k=function(b,c,d){c=(Math.pow(c,.01*Math.abs(b))-1)/(c-1)*100;c>d&&(c=d);0>b&&(c=-c);return c/d};b.prototype.V199=function(b){if(V35p.V34v.V13z()){for(var c=0;64>c;c++)V35p.V34v.V142(b,c,this.nSqPix,this.V18a(c));return!0}return!1};b.prototype.V19a=
function(b){for(var c=0;64>c;c++){var d=this.V16q.getPiece(c);!d&&0<this.board.sqs[c]&&this.V16y&&(d=this.V16q.createSprite(this.V16y,this.board.sqs[c],c));if(d){var e=this.V15i(c);d.moveToNoSave(b,e)}}};b.prototype.V15q=function(b,c){var d=this.V16q.getPiece(c);if(d){var e=this.V15i(c);d.moveToNoSave(b,e)}};b.prototype.V15n=function(b,c){if(this.board.sqs[c]){var d=this.V16q.getPiece(c);d&&(V35p.V34v.V142(b,c,this.nSqPix,this.V18a(c)),d.moveToNoSave(b,this.V15i(c)),d.setBackground(V35p.V34v.V140(c,
this.nSqPix)))}else V35p.V34v.V142(b,c,this.nSqPix,this.V18a(c))};b.prototype.V142=function(b,c){V35p.V34v.V142(b,c,this.nSqPix,this.V18a(c))};b.prototype.V16s=function(){};b.prototype.V176=function(){void 0!==this.V16y&&this.V16y.isValid()&&this.V16q.sqSidePix!==this.nSqPix&&(this.V16q.destroy(),this.V16q.create(this.V16y),this.V16q.setup(this.V16y,this.board.sqs,this.V18a.bind(this)),setTimeout(this.V19m.bind(this),300))};b.prototype.V19m=function(){V35p.V34v.V13z()&&this.V16q.V153()?(this.V18x&&
this.V18q(this.V18x,!1),this.onReadyHandlers.count()?this.onReadyHandlers.execute():this.cbcanvas.V15z()):setTimeout(this.V19m.bind(this),500)};b.prototype.isReady=function(){return V35p.V34v.V13z()&&this.V16q&&this.V16q.V153()};b.prototype.V18a=function(b){var c=Math.floor(b/8);b%=8;this.V15j?(c=Math.floor(this.x0+this.nMarginW+this.V17h+(7-c)*this.nSqPix),b=Math.floor(this.y0+this.nMarginW+this.V17h+b*this.nSqPix)):(c=Math.floor(this.x0+this.nMarginW+this.V17h+c*this.nSqPix),b=Math.floor(this.y0+
this.nMarginW+this.V17h+(7-b)*this.nSqPix));return new CB.V6e(c,b)};b.prototype.V15o=function(b){b=this.V18a(b);return new CB.V7p(b.x,b.y,b.x+this.nSqPix,b.y+this.nSqPix)};b.prototype.V15i=function(b){return this.V18a(b).add(this.V19n())};b.prototype.isInMyArea=function(b,c){var d=new CB.V7p,e=this.V17z?this.V17z.w:0;d.V7r(new CB.V6e(this.x0,this.y0),new CB.Size(this.width+e,this.height));return b>=d.left&&b<=d.right&&c>=d.top&&c<=d.bottom};b.prototype.V16f=function(b){ASSERT(void 0!==b.x);return new CB.V6e(b.x,
b.y)};b.prototype.V19o=function(b){var c=b.x-this.nMarginW-this.V17h-this.x0;b=b.y-this.nMarginW-this.V17h-this.y0;this.V15j?(c=7-Math.floor(c/this.nSqPix),b=Math.floor(b/this.nSqPix)):(c=Math.floor(c/this.nSqPix),b=7-Math.floor(b/this.nSqPix));return 0<=c&&8>c&&0<=b&&8>b?8*c+b:-1};b.prototype.V19p=function(b,c){var d=CB.Vbf.Ve1(b),e=CB.Vbf.Ve0(b),l=CB.Vbf.Ve1(c),m=CB.Vbf.Ve0(c),p=Math.max(d,l),r=Math.min(e,m),d=CB.Vbf.Vdu(Math.min(d,l),Math.max(e,m)),r=CB.Vbf.Vdu(p,r),p=this.V18a(d),r=this.V18a(r);
r.add(new CB.V6e(this.nSqPix,this.nSqPix));d=new CB.V7p;d.V7t(p.x,p.y,r.x,r.y);d.expand(this.nSqPix,this.nSqPix);return d};b.prototype.V19n=function(){return new CB.V6e(Math.floor(this.nSqPix/2),Math.floor(this.nSqPix/2))};b.prototype.V19q=function(b){return this.V18a(this.V19o(b)).add(this.V19n()).subtract(b)};b.prototype.V196=function(b){return new CB.V6e(-500,-500)};b.prototype.flipBoard=function(){this.setBlackIsBottom(!this.V15j,!0)};b.prototype.setBlackIsBottom=function(b,c){b!=this.V15j&&(this.V15j=
b,this.V175(),this.V16q.V159(),c&&(this.destroyMessage(),this.prepareFullRedraw(),this.V18y(!0)),this.cbcanvas.V15z(),this.titleWin&&this.titleWin.V19r&&this.titleWin.V19r(this),this.bottomWin&&this.bottomWin.V19r&&this.bottomWin.V19r(this))};b.prototype.V19s=function(){return this.V15j?CB.Vaz.BLACK:CB.Vaz.WHITE};b.prototype.V19t=function(b){b!==this.V19s()&&this.flipBoard()};b.prototype.V19u=function(b){this.V16o=b};b.prototype._game=null;b.prototype.setGame=function(b){this._game&&(this._game.removeOnCurPosChangedListener(this.Vmq),
this._game.removeOnChangedListener(this.Vmn),this._game.removeOnNavigateListener(this.V19v),this._game.removeOnMoveListener(this.V19w),this._game.removeOnHeaderChangedListener(this.V19x));if(this._game=b){b=this.Vmr.bind(this);var c=this.V19y.bind(this),d=this.Vmp.bind(this),e=this.V19z.bind(this),l=this.V1a0.bind(this);this.Vmq=this._game.addOnCurPosChangedListener(b);this.Vmn=this._game.addOnChangedListener(c);this.V19v=this._game.addOnNavigateListener(e);this.V19w=this._game.addOnMoveListener(l);
this.V19x=this._game.addOnHeaderChangedListener(d);this.Vmr(this._game,this._game.getCurPos(),!1);this.Vmp()}};b.prototype.getGame=function(){return this._game};b.prototype.Vmr=function(b,c,d){"undefined"==typeof d&&this.shouldAnimatePosChange&&(d=this.shouldAnimatePosChange());this.nextCurPosNoAnim&&(this.nextCurPosNoAnim=d=!1);b=!1;this.V18e()?(this._game&&this.V18q(this._game.getCurPos().board,!1),b=!0):this._game&&this.V18q(this._game.getCurPos().board,d);this.V194();b&&this.markLastMove(!1)};
b.prototype.shouldAnimatePosChange=function(){return!0};b.prototype.V19y=function(){this.Vk8.Vjf();this.V194()};b.prototype.Vmp=function(){this.titleWin&&this.titleWin.V1a1&&this.setTitleText(this._game.hdr.getStrPlayers(this.nSqPix>this.cbcanvas.zoomToPix(42)))};b.prototype.V1a0=function(b){this.Vk8.Vja()};b.prototype.V19z=function(){this.markLastMove(!1)};b.prototype.V194=function(b,c){var d=[];if(this._game){var e=this._game.getAnno(CB.AnnoType.SQUARE_LIST);if(e)for(var l=0;l<e.length;l++){var m=
new CB.V15p(e[l].field,e[l].getColour());m.fromAnno=!0;d.push(m)}if(e=this._game.getAnno(CB.AnnoType.ARROW_LIST))for(l=0;l<e.length;l++)m=new CB.Vjl(e[l].from,e[l].to,e[l].getColour()),m.fromAnno=!0,d.push(m)}0<d.length&&(l=!1,b||(l=!0,this.shouldAnimatePosChange&&(l=!this.shouldAnimatePosChange())),c&&(l=!0),this.V1a2(),this.V16y&&this.V16y.loaded||(l=!1,c=null),this.queueBoardAttributes(d,{eraseQueue:!1,renderNow:l,requestAnimInRender:l,ctx:c}))};b.prototype.markLastMove=function(b,c){if(this._game&&
this._game.mainLine.length){var d=this._game.getLastMove();d&&(d!=this.V192||c)&&(this.V192=d,d=new CB.Vjl(d.from,d.to),d.lastMove=!0,this.V1a3(),this.queueBoardAttributes([d],{eraseQueue:!1,renderNow:b||!1||!this.V18t(),requestAnimInRender:!1}))}};b.prototype.V1a3=function(){if(this.V18d){var b=this.V18d.find(function(b){return b.lastMove}),b=this.V18d.indexOf(b);0<=b&&this.V18d.splice(b,1)}};b.prototype.V1a2=function(){if(this.V18d){var b;do{b=this.V18d.find(function(b){return b.fromAnno});var c=
this.V18d.indexOf(b);0<=c&&this.V18d.splice(c,1)}while(b)}};b.prototype.Vnb=function(b,c){this.queueBoardAttributes([new CB.V15p(b,c)],{eraseQueue:!1,renderNow:!0,requestAnimInRender:!0})};b.prototype.drawArrow=function(b,c,d){this.queueBoardAttributes([new CB.Vjl(b,c,d)],{eraseQueue:!0,renderNow:!0,requestAnimInRender:!0})};b.prototype.Vtj=function(b){this.currPiece&&(this.currPiece.hide(this.cbcanvas.V9p),this.currPiece.deleteBackground());for(var c=0;c<b.length;c++)this.queueBoardAttributes([new CB.V15p(b[c].sq,
b[c].clr)],{eraseQueue:!1,renderNow:c==b.length-1,requestAnimInRender:c==b.length-1});this.currPiece&&this.currPiece.moveTo(this.cbcanvas.V9p,this.currPiece.pos)};b.prototype.V1a4=function(b){b.forEach(function(b){this.V15n(this.cbcanvas.V9p,b.sq);this.V15n(this.cbcanvas.ctx,b.sq)}.bind(this))};return b}();"use strict";
CB.Vkg=function(){var c=function(b,c,e,f,g){this.init(b,c,e,f);this.V16p=CB.V1a5[glSettings.pieceStyleId];this.V1a6=[];this.options=g};CB.inherit(c,CB.V16i);c.prototype.onMouseDown=function(b,c){if(this._game){V35p.V34v.V13y();try{if(!this.V190&&(this.V18y(),this.destroyMessage(),new CB.V4y,this.V190=!0,this.clickPos=this.V16f(c),this.V193=this.V19q(this.clickPos),void 0!==this.fnBoardClick&&this.fnBoardClick(this.uniqueId,this.clickPos,b),this.allowInput)){var e=this.V19o(this.clickPos);this.Vk8.Vjp(e);
-1!=e&&(this.V18r?this.V1a7(e):(this.currPiece=this.V1a8(e,this.clickPos.add(this.V193)),this.Vk8.Vje(e)),this.fromSq=e,this.V1a6=[],this.fnMarkSquaresOnButtonDown&&(this.V1a6=this.V1a6.concat(this.fnMarkSquaresOnButtonDown(e))),this.Vtj(this.V1a6),this.fnSquareClick&&this.fnSquareClick(e),this.currPiece&&b.preventDefault())}}catch(f){CB.Vjg("BoardDown",f)}}};c.prototype.onMouseUp=function(b,c){if(this._game)try{if(this.V16f(c),this.V190){this.V190=!1;var e=this.clickPos=this.V16f(c),f=!1;if(this.allowInput){new CB.V4y;
var g=this.V19o(e);if(-1==g){void 0!==this.currPiece&&(this.V18h(this.currPiece,e,this.V15i(this.fromSq),2),delete this.currPiece);this.fromSq=-1;this.superClass.onMouseUp.call(this,b,c);return}if(this.V18r)g!=this.fromSq&&(this.toSq=g,this.prom=0,this.V1a9(this.fromSq,this.toSq,e,!1),this.Vk8.Vjm(this.fromSq,this.toSq,this.prom));else if(void 0!==this.currPiece||this.fromSq===this.Vk8.Vjd()||0==this.board.get(g)||0<=this.fromSq&&0==this.board.get(this.fromSq)){this.Vk8.Vjh(g);if(g!==this.fromSq){var h=
this.Vk8.isLegal(this.board,this.fromSq,g);if(!h&&this.Vk8.isLegal(this.board,g,this.fromSq)&&this.Vk8.Vjx(this.board,g)){var k=g,g=this.fromSq;this.fromSq=k;h=!0;this.currPiece=this.V1a8(this.fromSq,this.V15i(this.fromSq))}h?(this.toSq=g,this.prom=0,f=this.Vk8.isPremove(this.board,this.fromSq,this.toSq),this.Vk8.Vjn(this.board.get(this.fromSq))&&(this.board.get(g)&&!f&&this.V18g(g),this.V1a9(this.fromSq,this.toSq,e,f)||this.V1aa(this.fromSq,this.toSq,f)||(f||(this.V16q.change(this.fromSq,g),this.board.change(this.fromSq,
g)),this.currPiece&&this.V185(this.currPiece,g))),this.Vk8.Vjm(this.fromSq,this.toSq,this.prom)||(this.currPiece&&(this.currPiece.moveTo(this.cbcanvas.V9p,this.V15i(this.fromSq)),this.currPiece.lastSq=this.fromSq),f=!0,this.cbcanvas.V187(this.V19p(this.fromSq,this.toSq),!0))):this.currPiece&&this.V18h(this.currPiece,e,this.V15i(this.fromSq),5);delete this.fromSq}else this.currPiece?this.V185(this.currPiece,g):this.V1ab||(k=this.Vk8.Vjq(this.board,g),k.ok&&this.Vk8.Vjm(k.from,g,0));delete this.currPiece}b.preventDefault();
this.fnSquareRelease&&this.fnSquareRelease(g)}else this.currPiece&&(this.V18h(this.currPiece,e,this.V15i(this.fromSq),5),delete this.currPiece);this.fromSq=-1;this.V18w&&this.V175();this.V1a6.length&&(this.V1a4(this.V1a6),this.V1a6=[]);this.V18y();f&&this.Vk8.Vjk()}}catch(l){CB.Vjg("BoardUp",l)}};c.prototype.onMouseMove=function(b,c){try{if(this.allowInput){this.clickPos=this.V16f(c);var e=this.V19o(this.clickPos);this.V1ac=e;var f,g;this.V1ad(this.fromSq)?(g=e,7==CB.Vbf.Ve0(g)&&(f=this.V18r||this.Vk8.isLegal(this.board,
this.fromSq,g))):this.V1ae(this.fromSq)&&(g=e,0==CB.Vbf.Ve0(g)&&(f=this.V18r||this.Vk8.isLegal(this.board,this.fromSq,g)));f?(this.currPiece&&(this.V188(this.currPiece),this.currPiece.V99(this.cbcanvas.V9p)),this.V1af(g)):(void 0!==this.V1ag&&(this.V188(this.V1ag),delete this.V1ag,this.currPiece&&this.currPiece.deleteBackground()),this.currPiece&&this.V186(this.currPiece,this.clickPos.add(this.V193)));if(void 0!==this.currPiece)b.preventDefault(),e!=this.fromSq&&this.fnSquareChangeInMouseMove&&this.fnSquareChangeInMouseMove(e);
else if(!this.V18r){f=!1;if(0<=e){var h=this.board.get(e);h===CB.Piece.V5k||!this.Vk8||this.Vk8.Vjb()!=CB.Piece.side(h)&&null!==this.Vk8.Vjb()||(b.target.style.cursor=this.V1ah?"wait":"pointer",f=!0)}f||(b.target.style.cursor=this.V1ah?"wait":"default")}}this.superClass.onMouseMove.call(this,b,c)}catch(k){CB.Vjg("BMMove",k)}};c.prototype.V1ad=function(b){return(this.board.get(b)==CB.Piece.Vl||this.V18r&&this.V18s&&this.V18s[b]==CB.Piece.Vl)&&6==CB.Vbf.Ve0(b)};c.prototype.V1ae=function(b){return(this.board.get(b)==
CB.Piece.Vm||this.V18r&&this.V18s&&this.V18s[b]==CB.Piece.Vm)&&1==CB.Vbf.Ve0(b)};c.prototype.V1a9=function(b,c,e,f){this.V1ad(b)?this.prom=this.V189(c,e):this.V1ae(b)&&(this.prom=this.V189(c,e)+CB.Vaz.Vb1);return this.prom?(f?(this.V142(this.cbcanvas.V9p,this.toSq),this.currPiece.deleteBackground(),this.cbcanvas.V187(this.V15o(this.toSq))):(this.V18r||(this.V16q.Vea(this.fromSq,this.toSq,this.prom,this.V16y),this.board.Vea(this.fromSq,this.toSq,this.prom)),this.V142(this.cbcanvas.V9p,this.toSq),this.V18r||
(this.V185(this.V16q.getPiece(this.toSq),this.toSq),this.V142(this.cbcanvas.V9p,this.fromSq))),delete this.V1ag,!0):!1};c.prototype.V1af=function(b){void 0===this.V1ag&&(this.V1ag=this.V16q.getPromoSprite(CB.Piece.side(this.board.sqs[this.fromSq])));this.V185(this.V1ag,b)};c.prototype.V1aa=function(b,c,e){var f;this.board.get(b)==CB.Piece.Vl&&4==CB.Vbf.Ve0(b)&&this.Vk8.Vjw(b,c)?f=CB.Vbf.Vdu(CB.Vbf.Ve1(c),4):this.board.get(b)==CB.Piece.Vm&&3==CB.Vbf.Ve0(b)&&this.Vk8.Vjw(b,c)&&(f=CB.Vbf.Vdu(CB.Vbf.Ve1(c),
3));return void 0!==f?(e||(this.V16q.Veb(b,c,f),this.board.Veb(b,c,f),this.V185(this.currPiece,this.toSq),this.V142(this.cbcanvas.V9p,f),this.cbcanvas.V187(this.V15o(f))),!0):!1};c.prototype.V1ai=function(b,c){this.queueBoardAttributes([new CB.Vjl(b,c,this.Vk8.Vjj())],{eraseQueue:!0,renderNow:!0,requestAnimInRender:!1})};c.prototype.V1a8=function(b,c){var e=this.V16q.getPiece(b);e&&(e.fromSq=b);void 0===e&&b!==this.Vk8.Vjd()||!e||(e.pieceName=CB.Piece.toString(this.board.get(b)),e.hasBackground()?
this.V186(e,this.clickPos.add(this.V193)):(e.pos=c,e.setBackground(V35p.V34v.V140(b,this.nSqPix))));return e};c.prototype.V1a7=function(b){this.V1aj=this.V16q.V158(this.V16y,this.V18s?this.V18s[b]:this.board.sqs[b]);var c=this.V15i(b);this.V1aj.moveTo(this.cbcanvas.V9p,c);this.cbcanvas.V187(this.V15o(b));(new CB.Timer(function(){c.x+=2;c.y+=2;this.V1aj.moveTo(this.cbcanvas.V9p,c);this.cbcanvas.V187(this.V15o(b));this.V188(this.V1aj);this.V1aj=null}.bind(this))).runOnce(100)};c.prototype.V1ak=function(b){this.V1ah=
b;this.cbcanvas.canvas.style.cursor=this.V1ah?"wait":"default"};c.prototype.test=function(){var b=["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","rnbqk2r/1p2bppp/p2p1n2/4p1B1/4P3/1NN5/PPP1BPPP/R2QK2R b KQkq - 0 8","4rk1r/pppb1ppp/2np4/8/3P4/2PBP3/PP1N2PP/R4RK1 w - - 0 15","b4rk1/p1p1qpp1/3p1n1p/4p3/4P2B/3P1N2/PRPQ1PPP/6K1 w - - 0 16","7r/3kp3/1p6/p1p1p3/3nP1p1/PPKPB1P1/5P2/R7 b - - 0 29"];this.V1al=void 0===this.V1al?0:this.V1al+1;this.V1al>b.length-1&&(this.V1al=0);this.V1am(b[this.V1al])};
c.prototype.refreshMarkedSquares=function(){this.V190&&this.fromSq&&this.fromSq==this.V1ac&&(this.V1a6&&this.V1a6.length&&this.V1a4(this.V1a6),this.V1a6=[],this.fnMarkSquaresOnButtonDown&&(this.V1a6=this.V1a6.concat(this.fnMarkSquaresOnButtonDown(this.fromSq,!0))),this.Vtj(this.V1a6))};c.prototype.V1am=function(b){b=new CB.Position(b);this.V18q(b.board)};return c}();"use strict";
CB.V1an=function(){var c=new CB.Color(220,250,190);new CB.Color(220,250,190);var b=new CB.Color(50,110,0),d=new CB.Color(140,140,100),e=function(b,c){this.background=new CB.V15t(b,"clockBG");this.V1ao=new CB.V15t(this.background,"clockW");this.V1ap=new CB.V15t(this.background,"clockB");this.config=c?c:{V1aq:1,V1ar:"black"};this.V1as(this.V1ao);this.V1as(this.V1ap);this.V1at=!1;this.Vr5=!0;this.V1ao.setText("0:00:00");this.V1ap.setText("0:00:00");this.V1au=new CB.Timer(this.V1av.bind(this));this.V1aw=
0};e.prototype.destroy=function(){this.background.destroy()};e.prototype.Vr4=function(b){this.V1at=b};e.prototype.Vqm=function(b){this.Vr5=b};e.prototype.setText=function(b,c){c?this.V1ap.setText(b):this.V1ao.setText(b)};e.prototype.V1ax=function(b){this.V1ao.setText(b)};e.prototype.V1ay=function(b){this.V1ap.setText(b)};e.prototype.setVisible=function(b){this.background.setVisible(b)};e.prototype.V1as=function(b){b.setBackgroundColor(new CB.Color(0,0,0,.5));b.setColor(new CB.Color(255,255,255,.9));
b.setBorder(this.config.V1aq,this.config.V1ar);b.setTextAlign("center");b.setFontFamily("Roboto, Helvetica, sans-serif");b.elDOM.addEventListener("mousedown",function(b){b.preventDefault()})};e.prototype.setPosSize=function(b,c,d,e){var l=new CB.V7p(0,0,Math.round(d/2),e-1),m=new CB.V7p(Math.round(d/2),0,d,e-1);this.background.setPos(b,c);this.background.setSize(d,e);this.V1ao.setPos(l.left,l.top);this.V1ao.setSize(l.getSize().w,l.getSize().h);this.V1ap.setPos(m.left,m.top);this.V1ap.setSize(m.getSize().w,
m.getSize().h);b=Math.round(.7*e);do this.V1ao.V1az(b),this.V1ap.V1az(b),--b,this.V1ao.V1b0((l.h-b)/2+2),this.V1ap.V1b0((l.h-b)/2+1);while(3<b&&(this.V1ao.V1b1()>l.w-5||this.V1ao.V1b2()>l.h-2));d=Math.max(1,Math.min(4,Math.round(Math.sqrt(d/100))));this.background.V1b3(d,5*d,"rgba( 60, 30, 20, 0.6 )")};e.prototype.Vqt=function(b){this.V1ao.setText(lm.RESULT+":");b==CB.Vgt.Vgw?this.V1ap.setText(lm.ABORTED):this.V1ap.setText(CB.Vgt.toString(b));this.V1ao.setColor(c);this.V1ap.setColor(c)};e.prototype.Vph=
function(b){this.V1ao.setText("TIME")};e.prototype.Vpk=function(b){b?(this.V1ao.setColor(d),this.V1ap.setColor(c)):(this.V1ao.setColor(c),this.V1ap.setColor(d))};e.prototype.Vql=function(b,c){var d=this.Vr2(b);c?this.V1ap.setText(d):this.V1ao.setText(d)};e.prototype.Vqy=function(b,c){};e.prototype.Vqo=function(b){this.Vqc=b};e.prototype.V1b5=function(c){this.V1au.runOnce(c||8E3);this.V1ao.setBackgroundColor(b);this.V1ap.setBackgroundColor(b)};e.prototype.V1av=function(){this.V1ao.setBackgroundColor(new CB.Color(0,
0,0,.5));this.V1ap.setBackgroundColor(new CB.Color(0,0,0,.5))};e.prototype.Vr2=function(b){0>b&&(b=new Date(0));var c="";this.Vr5&&(c=b.getUTCHours()+":");if(4E3>b.valueOf()&&!this.Vqc){var d=b.getUTCSeconds();b=Math.floor(b.getUTCMilliseconds()/100);1<b.toString().length&&(b="0");c=d+"."+b}else d=b.getUTCMinutes(),1==d.toString().length&&(d="0"+d),c+=d,d=Math.floor(b.getUTCSeconds()),1==d.toString().length&&(d="0"+d),c+=":"+d;return c};return e}();"use strict";
function LineStackItemHash(c){var b=c.getLine();c=c.getMovesToGo()|b.length<<8;0<b.length&&(c|=b[0].from<<16|b[0].to<<24);return c}function LineStackItemEq(c,b){return c.getLine()===b.getLine()&&c.getMovesToGo()===b.getMovesToGo()}CB.cbNotationDefaults={game:null,useMatBalance:!0,useDiagrams:!0,V1b6:!0,useResult:!0,V1b7:!0,useHeader:!0,V1b8:"",V1b9:"",V1ba:"",V1bb:"",V1bc:"",V1bd:"",isActive:!0,notationLocalization:null,V1be:!0};
CB.NotaElement=function(){function c(b,c,d){c.append("<span class='");c.append(d);c.append("'>");c.append(b);c.append("</span>")}var b=function(b,c,d){this.notaHeaderElement=new CB.V1bf(c);this.V1bg=new CB.V1bh(c,d);this.V1bi=0;this.panel=b;this.Vt3=new CB.V35b;this.V1bj=[];this.V1bk=c;this.V1bl=[];this.V1bm=[]};b.prototype.panel=null;b.prototype.V1bn=null;b.prototype.m_selElem=null;b.prototype.V1bo=!0;b.prototype.notaHeaderElement=null;b.prototype.V1bp=function(b,c){var d;this.V1bi=d="string"==typeof b?
b:b.id;d=CB.$("#"+d);if(this.elem=d.single()){d.parent();d.addClass("cbnota-container");this.V1bq();this.V1br(c);this.V1bs=CB.$(".nota-game",this.elem).single();d.on("dragover",this.V1bt.bind(this)).on("dragenter",this.V1bu.bind(this)).on("drop",this.V1bv.bind(this)).on("mousewheel",this.V1bw.bind(this)).on("DOMMouseScroll",this.V1bw.bind(this));CB.V1bx.V1by("touchstart")&&(d.on("touchstart",this.V1bz.bind(this)).on("touchend",this.V1c0.bind(this)).on("touchmove",this.onMouseMove.bind(this)).on("touchleave touchcancel",
this.onMouseLeave.bind(this)),this.V1c1=!0);if(CB.V1bx.V1by("mousedown"))d.on("mousedown",this.V1bz.bind(this)).on("mouseup",this.V1c0.bind(this)).on("mousemove",this.onMouseMove.bind(this)).on("mouseleave",this.onMouseLeave.bind(this)).on("dblclick",this.V16c.bind(this));CB.V5t.V6w()&&$(".nota-game").css("padding-right","50px");if(CB.V1bx.V1by("contextmenu"))d.on("contextmenu",this.onContextMenu.bind(this));d=CB.$("#nota-head-"+this.V1bk).single();this.header=new CB.V15t(d,this.V1c2(),{append:!1});
this.header.setVisible(!0);this.notaHeaderElement.V1bp(this.V1c2(),c,null,this.V1bk);c.useMatBalance&&this.createMatBalance()}};b.prototype.createMatBalance=function(){if(null===CB.$.get(this.V1c3())){var b=CB.$.get(this.V1bi);if(b){var c=CB.$("#nota-foot-"+this.V1bk).single();this.V1c4=new CB.V15t(c,this.V1c3());this.V1c4.setVisible(!0);this.V1bg.V1bp(this.V1c3())}}c=CB.$("#"+this.V1bi);b&&c.removeClass("nomat")};b.prototype.V1c2=function(){return"theheader-"+this.V1bk};b.prototype.V1c3=function(){return"thefooter-"+
this.V1bk};b.prototype.destroyMatBalance=function(){var b=CB.$("#"+this.V1c3()).single();b&&0<b.childNodes.length&&(b.removeChild(b.childNodes[0]),this.V1c4=null,CB.$("#"+this.V1bi).addClass("nomat"))};b.prototype.V1c5=function(b){(this.useMatBalance=b)?CB.$("#"+this.V1c3()).show():CB.$("#"+this.V1c3()).hide()};b.prototype.V1br=function(b){b.notationLocalization=b.notationLocalization||lm.NOTA_LOCALIZATION;this.V1bn=new CB.Vib(b.notationLocalization);this.V1c6=b.useDiagrams;void 0!==b.diagramOptions&&
(this.V1c7=b.diagramOptions);this.V1c8=b.useHeader;void 0!==b.useMatBalance&&(this.useMatBalance=b.useMatBalance);void 0!==b.useResult&&(this.V1c9=b.useResult);this.V1bo=b.isActive;this.V1ca=b;b.game&&this.setGame(b.game)};b.prototype.setOptions=function(b){this.V1br(b)};b.prototype.m_game=null;b.prototype.setGame=function(b){this.notaHeaderElement.setGame(b);this.m_game&&(this.m_game.removeOnMoveListener(this.V1cb),this.m_game.removeOnNavigateListener(this.V1cc),this.m_game.removeOnChangedListener(this.V1cd),
this.m_game.removeOnHeaderChangedListener(this.V1ce),this.m_game.removeOnAnnoChangedListener(this.V1cf),this.m_game.removeOnEvalListener(this.V1cg));this.m_game=b;this.V1cb=this.m_game.addOnMoveListener(this.Vja.bind(this));this.V1cc=this.m_game.addOnNavigateListener(this.V1ch.bind(this));this.V1cd=this.m_game.addOnChangedListener(this.V1ci.bind(this));this.V1ce=this.m_game.addOnHeaderChangedListener(this.V1cj.bind(this));this.V1cf=this.m_game.addOnAnnoChangedListener(this.V1ci.bind(this));this.V1cg=
this.m_game.addOnEvalListener(this.onEval.bind(this));this.V1ck();this.useMatBalance&&this.V1bg.setGame(b);this.notaHeaderElement.setGame(b);this.evProfileControl&&this.evProfileControl.setEvalArr(b.getEvaluationProfile())};b.prototype.setSize=function(b,c){this.notaHeaderElement.V178(b,c);this.V1cl();this.V1cm(b);this.V1ch(!0)};b.prototype.getGame=function(){return this.m_game};b.prototype.Vja=function(){this.V1ck();this.V1cn()};b.prototype.V1cj=function(){};b.prototype.V1ci=function(){this.V1ck();
this.V1cn()};b.prototype.onEval=function(b,c,d){var e;CB.V1co&&(e=CB.V1co.V1cp(c));this.evProfileControl||this.V1bg.setText(e+".")};b.prototype.V1ch=function(b){b=b||!1;var c=this.V1cq();this.V1cr(c,b);this.V1cn();this.V1cs(this);this.evProfileControl&&this.m_game.isOnMainLine()&&this.evProfileControl.V1ct(this.m_game.getPlyNum())};b.prototype.V1cu=function(b){return CB.Vgt.toString(b)};b.prototype.V1cv=function(d,e){var h=b.prototype.V1cu(d);h&&c(h,e,"cbgame-result")};b.prototype.V1cs=function(b){this.Vt3.exec(function(){b.matcontrol&&
(b.matcontrol.setPos(b.m_game.getCurPos()),b.matcontrol.render())}.bind(this),200)};b.prototype.V1cw=function(){return String.formatEx("<div class='nota-container'><div class='nota-head-container'><div class='nota-head' id='nota-head-{0}'></div></div><div class='nota-game-container'><div class='nota-ogame'><div class='nota-igame'><div class='nota-game' data-inx-game='{0}'></div></div></div></div><div class='nota-foot-container'><div class='nota-foot' id='nota-foot-{0}'></div></div></div>",this.V1bk)};
b.prototype.V1bq=function(){CB.$(this.elem).html(this.V1cw())};b.prototype.V1ck=function(){this.V1bl&&this.V1bl.forEach&&this.V1bl.forEach(function(b){b.boardArea.changeParentElDOM(null)});this.V1bm=this.V1bm.concat(this.V1bl);this.V1bl=[];"undefined"==typeof this.m_game&&(this.m_game=new CB.Game);var c=new StringBuilder,d=this.m_game.getHeader(),e=this.m_game.getMainLine(),k=this.m_game.getStartPos().getMoveNum(),l={lineCnt:0,nodeCnt:0,breakForTraining:!1};b.Vi1(this,e,0,0,k,0,c,l,0,0);this.V1c9&&
!l.breakForTraining&&this.V1cv(d.getResult(),c);CB.$(".nota-game",this.elem).html(c.toString());this.V1cx();(new CB.Timer(function(){this.V1cy()}.bind(this))).runOnce(30);this.V1ch(!0)};b.Vi1=function(b,c,d,e,l,m,p,r,u,q){var t=++r.lineCnt,v=0;m||c.isAnnotated()&&(v=1);0==m&&(b.useMatBalance?b.createMatBalance():b.destroyMatBalance());p.appendFormat("<span class='cbline' data-inx-line='{0}' data-inx-mv-parent = '{1}' data-level='{2}' data-commented='{3}' data-linecnt-this='{4}' data-nodecnt-this='{5}'>",
d,e,m,v,u,q);0==m&&b.createMovelessAnnoElement(c,p);d=!1;0<c.length&&(d=c[0].getSide()===CB.Vaz.WHITE);e=!0;var w=!1;u=0;for(v=c.length;u<v;++u)if(b.shouldStop(c,u)){w=!0;break}if(!w)for(u=0,v=c.length;u<v;++u){w=c[u];b.CreateMoveElements(w,u,c,l,d||e,m,p,r,t,q);if(r.breakForTraining)break;(d=!d)&&++l;e=w.hasLines()}p.append("</span>")};b.prototype.Vko=function(b){this.V1bj=b};b.prototype.shouldStop=function(b,c){for(var d=b[c],e=0;e<this.V1bj.length;e++)if(d.from==this.V1bj[e].from&&d.to==this.V1bj[e].to){var l=
this.m_game.Vi4(b,c).toFEN(),m=l.indexOf(" "),p=this.V1bj[e].fen.indexOf(" ");if(m==p&&(l=l.substr(0,m),p=this.V1bj[e].fen.substr(0,p),l==p))return!0}return!1};b.prototype.createMovelessAnnoElement=function(b,c){var d=b.getAnno();d&&(d[CB.AnnoType.Vgi]||d[CB.AnnoType.Vgg])&&d[CB.AnnoType.Vgi]&&(d=d[CB.AnnoType.Vgi].getString(),this.V1cz(d,0,0,c,0))};b.Vgc="[#]";b.prototype.V1d0=function(c,d,e,k,l,m,p){if(c){if(0>c.indexOf(b.Vgc))return this.V1cz(c,d,e,m,p);for(var r=0,u=c.indexOf(b.Vgc);0<=u;u=c.indexOf(b.Vgc,
r))0<u-r&&(r=c.substring(r,u),this.V1cz(r,d,e,m,p)),this.V1d2=this.V1d3("",d,e,k,l,m,p),r=u+b.Vgc.length;r<c.length&&(r=c.substring(r),this.V1cz(r,d,e,m,p))}};b.prototype.V1d4=function(b,c,d,e,l){b&&(e.appendFormat("<span class='cbcomment cbmedal medal-{2}' data-inx-mv='{0}' data-linecnt='{1}'>",c,l,b),e.append("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp</span>"),e.append(" "))};b.prototype.V1cz=function(b,c,d,e,l){e.appendFormat("<span class='cbcomment' data-inx-mv='{0}' data-linecnt='{1}'>",c,l);e.append(CB.V47.V4l(b));
e.append("</span>");e.append(" ")};b.prototype.V1d5=function(b,c,d,e,l,m){d=CB.V79.V7b();e.appendFormat("<span class='cbcomment cbtraining' data-inx-mv='{0}' data-linecnt='{1}'>",c,l);e.append(CB.V47.V4l(b.getQuestion(d)||lm.TRAINING_QUESTION));b.solved||(e.append('<div class="cbTrainingLinks">'),e.append(String.f('<span class="cbTrainingLink cbTrainingSolution" data-inx-mv="{0}" data-linecnt="{1}">{2}</span>',c,l,lm.TRAINING_SOLUTION)),1<=b.nHelpClicked?(e.appendFormat("<span class='cbcomment cbtraining cbtraininghelptext' data-inx-mv='{0}' data-linecnt='{1}'>",
c,l),e.append(CB.V47.V4l(b.getHelp(d)||"No help available")),e.append("</span>")):b.getHelp(d)&&e.append(String.f('<span class="cbTrainingLink cbTrainingHelp" data-inx-mv="{0}" data-linecnt="{1}">{2}</span>',c,l,lm.TRAINING_HELP)),e.append("</div>"));e.append("</span>");e.append(" ");return!b.solved};b.V1d6=function(b,d,e){if(b.length){for(var k=!0,l=0,m=b.length;l<m;++l)if(57344<=b.charCodeAt(l)){k=!1;break}if(k)d.append(b);else{for(var k=!1,p="",l=0,m=b.length;l<m;++l){var r=b[l],u="\ue000"<=r;
u===k?p+=r:(k?c(p,d,e):d.append(p),p=r,k=u)}p&&(k?c(p,d,e):d.append(p))}}};b.prototype.V1d7=function(c,d){var e=document.createElement("span");b.V1d6(c,e,"cbspec-glyph");return e};b.prototype.CreateMoveElements=function(c,d,e,k,l,m,p,r,u,q){var t=c.getAnno();t&&t[CB.AnnoType.Vgg]&&this.V1d0(t[CB.AnnoType.Vgg].getString(),d,e,t,!1,p,u);var v=k;l||this.V1d2||(v=null);this.V1d2=!1;l=this.V1bn.getMoveNota(c,v);if(t&&t[CB.AnnoType.Vgo]){for(var v=t[CB.AnnoType.Vgo],w=0;w<v.length;w++);l=V359.addTexts(l,
v)}0==d?p.appendFormat("<span class='cbmove' data-inx-mv = '{0}' data-linecnt = '{1}' data-nodecnt = '{2}'>",d,u,q):p.appendFormat("<span class='cbmove' data-inx-mv = '{0}' data-linecnt = '{1}'>",d,u);b.V1d6(l,p,"cbspec-glyph");p.append("</span>");p.append(" ");t&&(t[CB.AnnoType.SQUARE_LIST]||t[CB.AnnoType.ARROW_LIST]?p.appendFormat("<span class='cbcol-marker' data-inx-mv='{0}'> </span>",d):t[CB.AnnoType.Vu3]&&p.appendFormat("<span class='cbmedal-marker' data-inx-mv='{0}'> </span>",d));p.append(" ");
t&&t[CB.AnnoType.TIME]&&this.V1d0(t[CB.AnnoType.TIME].getString(),d,e,t,!0,p,u);t&&t[CB.AnnoType.Vu3]&&this.V1d4(t[CB.AnnoType.Vu3].getOneMedal(),d,e,p,u);t&&t[CB.AnnoType.Vgi]&&this.V1d0(t[CB.AnnoType.Vgi].getString(),d,e,t,!0,p,u);if(c.hasLines())for(c=c.getSubLines(),q=++r.nodeCnt,l=0,v=c.length;l<v;++l)b.Vi1(this,c[l],l,d,k,m+1,p,r,u,q);t&&t[CB.AnnoType.Vf5]&&(this.V1d3("Find the next move",d,e,t,!0,p,u),r.breakForTraining=this.V1d5(t[CB.AnnoType.Vf5],d,e,p,u,r));t&&t[CB.AnnoType.DIAGRAM]&&(k=
t[CB.AnnoType.DIAGRAM].getString(),this.V1d3(k,d,e,t,!0,p,u))};b.prototype.V1d3=function(c,d,e,k,l,m,p){if(this.V1c6)return l||--d,e=this.m_game.Vi4(e,d+1),this.V1ca.V1be||(k=null),k=b.V1d8(e,k),m.appendFormat("<span class='cbdia' data-fen='{0}' data-legend='{1}' data-inx-mv='{2}' data-linecnt='{3}'>",k,c,d,p),m.append("</span>"),!0};b.V1d8=function(b,c){var d=b.toFEN();c&&c[CB.AnnoType.ARROW_LIST]&&(d=d+";"+c[CB.AnnoType.ARROW_LIST].toString(";"));c&&c[CB.AnnoType.SQUARE_LIST]&&(d=d+";"+c[CB.AnnoType.SQUARE_LIST].toString(";"));
return d};b.V1d9=function(b){b=b.split(";");for(var c=new Position(b[0]),d=new Annotation,e=new ColSqAnno,l=new ColArrowAnno,m=1,p=b.length;m<p;++m){var r=b[m];if(r.length==ColSq.STRING_LEN){var u=new ColSq;u.init(r);e.push(u)}else r.length==ColArrow.STRING_LEN&&(u=new ColArrow,u.init(r),l.push(u))}0<e.length&&d.setItem(AnnoType.SQUARE_LIST,e);0<l.length&&d.setItem(AnnoType.ARROW_LIST,l);return{anno:d,position:c}};b.prototype.removeClass=function(b){for(var c=Array.prototype.slice.call(document.getElementsByClassName(b)),
d=0,e=c.length;d<e;d++){var l=c[d];l.className=l.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)","g"),"$1")}};b.prototype.V1cr=function(b,c){if(null!==b){this.m_selElem&&(CB.$(this.m_selElem).removeClass("cbcur-move"),this.m_selElem=null);var e=CB.$(this.elem);c||b?(this.m_selElem=b,CB.$(this.m_selElem).addClass("cbcur-move"),d||this.m_selElem&&(this.IsInPageVisible(this.m_selElem)||this.scrollIntoView(this.m_selElem)),d=!1):"scroll"!==e.css("overflow-y")&&window.scrollTo(notaElm.getX(),notaElm.getY())}};
b.prototype.scrollCurElemIntoView=function(){if(this.m_selElem)return this.scrollIntoView(this.m_selElem)};b.prototype.blinkCurrElem=function(){this.V1da(this.m_selElem,"blinkShort")};b.prototype.V1db=function(){this.V1da(this.m_selElem,"blinkMedium")};b.prototype.V1da=function(b,c){b&&($(b).addClass(c),(new CB.Timer(function(){$(c).removeClass(c)}.bind(this))).runOnce(600))};b.prototype.emphasizeMove=function(){this.scrollCurElemIntoView();this.V1da(this.m_selElem,"blinkAnimation")};b.prototype.scrollIntoView=
function(b){var c=b.offsetTop;b=c+b.offsetHeight;var d=this.V1bs.scrollTop,e=this.V1bs.clientHeight,l=d+e,m=this.V1bs.scrollTop;c<d?this.V1bs.scrollTop=Math.max(0,c-30):b>l&&(this.V1bs.scrollTop=b-e);c=Math.abs(this.V1bs.scrollTop-m);300<c&&this.blinkCurrElem();return 0<c};b.prototype.IsInPageVisible=function(b){var c=b.offsetTop;b=c+b.offsetHeight;var d=this.V1bs.scrollTop,e=d+this.V1bs.clientHeight;return c>=d&&b<=e};b.prototype.handleCursorDown=function(){var b=this.V1dc(this.m_selElem,!1);b&&
(this.V1cr(b),this.V1dd(b))};b.prototype.handleCursorUp=function(){var b=this.V1dc(this.m_selElem,!0);b&&(this.V1cr(b),this.V1dd(b))};b.prototype.V1dc=function(b,c){if("undefined "!=typeof $&&b){var d=$(b),e=d.data("linecnt"),l=d.data("inx-mv"),e=d.parent().find(String.f('[data-linecnt-this="{0}"][data-inx-mv-parent="{1}"]',e,l));if(e.length&&!c&&(l=$(e[0]).data("nodecnt-this"),e=$(e[0]).find(String.f('[data-nodecnt="{0}"][data-inx-mv="0"]',l)),e.length))return e[0];var m=d.offset().top,p=[],r=1E7;
$(this.elem).find(".cbmove, .cbtraininghelptext");e=function(b,d){var e=$(d).offset().top-m;(c?0>e:0<e)&&Math.abs(e)<=r&&(r=Math.abs(e),p.push(d))};c?$($(this.elem).find(".cbmove").get().reverse()).each(e):$(this.elem).find(".cbmove, .cbtraininghelptext").each(e);p.sort(function(b,c){return Math.abs($(b).offset().top-m)-Math.abs($(c).offset().top-m)});for(e=1;e<p.length;e++)if(c){if($(p[e]).offset().top<$(p[0]).offset().top){p.length=e;break}}else if($(p[e]).offset().top>$(p[0]).offset().top){p.length=
e;break}d.offset();d.width();p.sort(function(b,c){return $(b).offset().left-$(c).offset().left});return p[0]}};b.prototype.V1de=function(b,c){if("undefined "!=typeof $&&b){var d=null,e=1E7,l=0,m=$(b);$(b).prevAll().find(".cbmove").each(function(b,c){var f=$(c).offset().top-m.offset().top;if(0>f){var g=Math.abs($(c).offset().left-m.offset().left);g<e&&(f==l||!d)&&(e=g,d=c,l=f)}}.bind(this));return d}};b.prototype.V1df=null;b.prototype.V1bw=function(b){if(this.m_game&&this.V1bo){var c="undefined"!=
typeof b.wheelDelta?-b.wheelDelta:b.detail;"undefined"==typeof $&&(0>c?this.m_game.gotoPrev():this.m_game.gotoNext(),b.preventDefault())}};b.prototype.V1bz=function(b){this.V1dg=this.V1dh=new CB.V6e(b);this.V190=!0;this.V1di="touchstart"==b.type};var d;b.prototype.V1c0=function(b){this.V190=!1;this.V1dh&&2!=b.button&&10>this.V1dh.V7m(this.V1dg)&&(d=!0,this.focus(),this.V1dj(b)&&this.fireOnMoveTouched())};b.prototype.V16c=function(b){this.m_game.fireOnNotaDoubleClick()};b.prototype.onContextMenu=function(b){5;
this.V1dj(b);V35p.panelMgr.execNotaContextMenu&&(V35p.panelMgr.execNotaContextMenu(b),b.preventDefault())};b.prototype.focus=function(){V35p.panelMgr&&V35p.panelMgr.notaPanel&&V35p.panelMgr.notaPanel.focus();var b=this.V1bs;b?b.focus():alert("no parent for focus")};b.prototype.V1dk=function(b){return b?0>b?-1:1:0};var e=0<CB.V5t.V6m()&&!CB.V5t.V64();b.prototype.onMouseMove=function(b){if(this.V190&&!e){var c=(new CB.V6e(b)).subtract(this.V1dh);c.y/=Math.min(2,window.devicePixelRatio);this.V1bs.scrollTop-=
this.V1dk(c.y)*Math.pow(Math.abs(c.y),1.7)*.7;this.V1dh=new CB.V6e(b);if(0<c.y&&0==this.V1bs.scrollTop||0>c.y&&this.V1bs.scrollTop+this.V1bs.clientHeight>=this.V1bs.V1dl)return}b.preventDefault()};b.prototype.onMouseLeave=function(b){this.V190=!1};b.prototype.V1dj=function(b){if(!this.V1bo||!this.m_game)return!1;var c=this.V1dd(b.target);b.preventDefault();return c};b.prototype.V1dd=function(b){var c=b;if(!$(c).is("[data-inx-mv]")&&((c=$(c).parents("[data-inx-mv]"))&&(c=c[0]),!c))return;this.V1df=
c;var d=$(c).data("inx-mv"),e=0;++d;var l=[],m=!0,p=c.parentNode,r=b=!1;$(p).is(".cbLine ")||(p=$(c).parents(".cbline")[0]);$(c).is(".cbTrainingLink")&&(b=$(c).is(".cbTrainingSolution"),r=$(c).is(".cbTrainingHelp"));for(c=p;m;c=c.parentNode)e=Number(e),d=Number(d),l.push({inxLine:e,mvsToGo:d}),c&&c.getAttribute&&(m=CB.$(c),e=m.data("inx-line"),d=m.data("inx-mv-parent"),m=0!=m.data("level"));d=[];for(e=l.length-1;0<=e;--e)d.push(l[e]);this.m_game.gotoSimplePath(d);this.m_game.triggerOnClickInNotation();
if(b||r)if(l=this.m_game.getAnno(CB.AnnoType.Vf5)){b&&(l.solved=!0,CB.V1dm("Solution: "+this.m_game.hdr.getStrPlayers(!1,0)));r&&l.nHelpClicked++;this.V1ci();b&&this.m_game.gotoNext();if(r)for(b=0;3>b;b++)this.handleCursorDown();this.V1bs.scrollTop+=60}return!0};b.prototype.V1cn=function(){var b=this.m_selElem;if(b){var c=CB.$(b);if(!CB.$.is(b,"[data-inx-mv]")){b=c.parent("[data-inx-mv]");if(!b)return;c=CB.$(b)}var d=$("#"+this.V1bi);this.V1dn(d);c=c.data("linecnt");1<c&&(d=d.find(String.formatEx('[data-linecnt="{0}"]',
c)),d.addClass("cbcurline"),this.V1do(d,0));this.V1dp($(b))}};b.prototype.V1dn=function(b){b.find(".cbcurAlternative").removeClass("cbcurAlternative");b.find(".cbcurline").removeClass("cbcurline");b.find(".cbcurlineparent").removeClass("cbcurlineparent");for(var c=1;6>=c;c++)b.find(".cbcurnode"+c).removeClass("cbcurnode"+c)};b.prototype.V1do=function(b,c){if(b.length){var d=$(b[0]).parent("[data-inx-mv-parent]");if(d){var e=parseInt($(d).data("inx-mv-parent")),l=$(d).data("linecnt-this"),m=$(d).data("nodecnt-this"),
p=$(d).data("level");if(0<l){var r=$("#"+this.V1bi),m=r.find(String.formatEx('[data-nodecnt="{0}"]',m));1<=m.length&&(6>p?m.addClass("cbcurnode"+p):m.addClass("cbcurnode6"));l=String.formatEx('[data-linecnt="{0}"]',l);r=r.find(l);for(l=0;l<r.length;l++){var m=$(r[l]),u=parseInt(m.data("inx-mv"));u<=e&&1<p&&(u<=e-1?m.addClass("cbcurlineparent"):m.addClass("cbcurnode"+p))}this.V1do($(d),++c)}}}};b.prototype.V1dp=function(b){var c=b.data("linecnt"),d=b.data("inx-mv");b.parent().find(String.f('[data-linecnt-this="{0}"][data-inx-mv-parent="{1}"]',
c,d)).each(function(b,c){var d=$(c).data("nodecnt-this");$(c).find(String.f('[data-nodecnt="{0}"][data-inx-mv="0"]',d)).addClass("cbcurAlternative")})};b.prototype.V1cq=function(b){if(this.m_game){var c=this.m_game.Vf7();b="";for(var d=0,e=0,l=c.length;e<l;++e){b&&(b+=">");var m=c[e],p=m.mvsToGo;b+=String.formatEx("span.cbline[data-level='{2}'][data-inx-line='{0}'][data-inx-mv-parent='{1}']",m.inxLine,d,e);e===l-1&&(b+=String.formatEx(">span.cbmove[data-inx-mv ='{0}']",p-1));d=p}c=0==b.length;b=String.f("div.nota-game[data-inx-game='{0}']>",
this.V1bk)+b;return this.V1df&&CB.$.is(this.V1df,b)?this.V1df:!c&&(b=CB.$(b))&&1==b.length?b[0]:null}};b.prototype.V1cx=function(){if("undefined"!=typeof $&&V35p.panelMgr.V1dq){var b=180;V35p.panelMgr.getDiagHeight&&(b=V35p.panelMgr.getDiagHeight($(this.elem).width()));var c=0;$("#"+this.V1bi).find(".cbdia").each(function(d,e){if(0==$(e).find("div").length){$(e).width(1.1*b);$(e).height(b);var l=this.V1bm.pop();this.gameKernel=new CB.Vjy(V35p.panelMgr);var m={kernel:this.gameKernel,diagramDiv:e};
m.kernel.setPlayingMode(V35p.panelMgr.V1dq(m.kernel));m.kernel.fnInitGame=function(){return function(b,c){c.boardWin&&(c.boardWin.allowInput=!1);b.reset();if(e){var d=e.dataset.fen;d&&(d=new CB.Position(d),b.assign(new CB.Game(d)))}}}();var p=this.V1dr("diagarea",c);$(p).width(b);$(p).height(b);e.appendChild(p);l?(m.boardArea=l.boardArea,m.boardArea.changeParentElDOM(p),m.kernel.setBoardWin(m.boardArea.canvas.control.boards[0]),m.kernel.initGame()):(m.boardArea=new CB.V1ds(p),m.boardArea.createCanvas(m.kernel,
{topDist:0,bottomDist:0,marginDistDivisor:26,shiftXPercent:-1.65,minWForCoordinates:220,transparent:!0,boardShadow:!1}),m.kernel.releaseCommandHandlers());m.boardArea.setSize(p.offsetWidth,p.offsetHeight);m.boardArea.setVisible(!0);this.V1bl.push(m);this.V1dt(e,d);c++}}.bind(this))}};b.prototype.V1cl=function(){"undefined"!=typeof $&&$("#"+this.V1bi).find(".cbdia").each(function(b,c){this.V1dt(c,b)}.bind(this))};b.prototype.V1dt=function(b,c){if(b&&"undefined"!=typeof $){var d=$(b).find("#diagarea"+
c),e=d[0],l=d.width(),d=d.height();e&&this.V1bl[c]&&this.V1bl[c].boardArea&&this.V1bl[c].boardArea.setSize(l-1,d)}};b.prototype.V1cy=function(){if(CB.V1du){var b=$("#"+this.V1bi),c=$("#idEvCanvas-"+this.V1bk),d=this.m_game.getEvaluationProfile();if(d&&d.isValid())if(c.length)this.evProfileControl.setEvalArr(d);else{var c=b.find(".nota-game"),e=c.height();0==e&&(e=b.height());b.find(".nota-foot-container");var l=document.createElement("div");l.id="idEvCanvas-"+this.V1bk;l.className="cbevprofile";450<
CB.V5t.zoomToPix(e)||CB.V5t.V64()&&CB.V5t.V6h()||900<window.innerHeight?($(l).insertBefore(b.find(".nota-foot-container")),l.style.margin="0",l.style.boxShadow=""):c.append(l);this.V1dv=b=new CB.V1ds(l);b.setVisible(!0);var m=this;b.createCanvas({createControl:function(b,c,e,f){m.evProfileControl=new CB.V1du(b,c,e,"EvlProfile",f,function(b){m.m_game.gotoIndex(Math.min(b,m.m_game.mainLine.length));m.IsInPageVisible(m.m_selElem)||m.scrollIntoView(m.m_selElem)});m.evProfileControl.setEvalArr(d);return m.evProfileControl}},
{});this.evProfileControl&&this.V1dv&&this.V1dv.setSize(this.V1dw,this.V1dx())}else this.evProfileControl&&this.evProfileControl.reset()}};b.prototype.V1dx=function(){var b=66;1150<window.innerHeight?b=80:800>window.innerHeight&&(b=600>window.innerHeight?45:55);return b};b.prototype.V1cm=function(b){this.V1dw=b-26;b=$("#idEvCanvas-"+this.V1bk).width();this.V1dv&&(this.V1dv.setSize(b,this.V1dx()),this.V1dw=b)};b.prototype.V1dr=function(b,c){var d=document.createElement("div");d.id=b+c;d.className=
b;return d};b.prototype.isActive=function(){return this.V1bo};b.prototype.V1dy=function(b){this.V1bo=b};b.prototype.V1bt=function(b){b.preventDefault()};b.prototype.V1bu=function(b){b.preventDefault()};b.prototype.V1bv=function(b){if(this.V1bo){b.preventDefault();b=b.dataTransfer;var c=b.files;c.length?this.V1dz(c[0]):(b=b.getData("text"))&&this.V1e0(b)}};b.prototype.V1dz=function(b){if("function"==typeof FileReader){var c=new FileReader;c.onloadend=function(){this.V1e1(c)}.bind(this);c.readAsText(b)}};
b.prototype.V1e1=function(b){this.V1e0(b.result)};b.prototype.V1e0=function(b){this.m_game.merge&&this.m_game.merge(PGN.Vk5(b))};V34y.initForListeners(b);V34y.addEvent(b,"MoveTouched");return b}();CB.NotaElement.factory=function(c,b,d,e,f){b=new CB.NotaElement(b,e||0,f);null==d&&(d=CB.cbNotationDefaults,d.useMatBalance=V35p.panelMgr.useMatBalanceDefault());b.V1bp(c,d);V35p.panelMgr&&(V35p.panelMgr.V1e2=b);return b};"use strict";
CB.V1bf=function(){var c={},b=function(b){this.w=500;this.h=400;this.V1e3(300,200);this.V1bi=0;this.Vt3=new CB.V35b;this.V1e4=V35p.V1e5+"Buttons/Person.jpg";this.V1e6=V35p.V1e5+"Flags/Flags16/United nations.png";this.V1e8=this.V1e7="";this.V1bk=b};b.prototype.V1e9=null;b.prototype.panel=null;b.prototype.V1bn=null;b.prototype.m_selElem=null;b.prototype.V1bo=!0;b.prototype.V1ea=[null,null];b.prototype.V1eb=[null,null];b.prototype.V1ec=function(b,c){return 380>b||240>c};b.prototype.V1ed=function(b,c){return 300>
b||150>c&&500>b};b.prototype.V1ee=function(b,c){return 290>b||130>c&&360>b||80>c};b.prototype.V1ef=function(b,c){return 220>b||90>c&&300>b||70>c};b.prototype.V1eg=function(b,c){return 140>b||70>c};b.prototype.V1eh=function(){return!this.V1ee(this.w,this.h)};b.prototype.resetPlayerCache=function(){};b.prototype.V1e3=function(b,c){this.w=b;this.h=c;var g;if(this.V1ei)if(this.V1ej){var h=String.formatEx(d,this.V1ej);g='<div class="cbgame-header" id="ourheaderinside" ><table class="scroll notaTable" id="ourheader"><td width="0%"><span class="cbplayerportrait">'+
h+'</span></td><td width="0%"><span class="cbnota-title">'+this.V1ei+'</span></td><td width="0%"><span class="cbplayerportrait">'+h+"</span></td></table></div>"}else g='<div class="cbgame-header" id="ourheaderinside" ><span class="cbnota-title">'+this.V1ei+"</span></div>";else g=this.V1eg(b,c)?'<div class="cbgame-header-tiny" id="ourheaderinside"  style="visibility:hidden;display:none;" ></div>':this.V1ef(b,c)?'<div class="cbgame-header-tiny" id="ourheaderinside" ><table class="notaTable" id="ourheader"><tr><span class="cbmain-header-verycompact"><td width="45%" class="cbplayerwhite"><span class="cbplayertiny">{white.list}</span></td><tpl if="{black}"><td width="10%" class="cbresult"><span >{resultStr}</span></td><td width="45%" class="cbplayerblack"><span class="cbplayertiny">{black.list}</span></td></tpl></tr></table></div>':
this.V1ee(b,c)?'<div class="cbgame-header-verycompact" id="ourheaderinside" ><table class="notaTable" id="ourheader"><tr><span class="cbmain-header-verycompact"><td width="45%" class="cbplayerwhite"><span class="cbplayer">{white.list}</span><tpl if="{eloWhStr}"><span class="cbelocompact">{eloWhStr}</span></tpl></td><tpl if="{black}"><td width="10%" class="cbresult"><span >{resultStr}</span></td><td width="45%" class="cbplayerblack"><span class="cbplayer">{black.list}</span><tpl if="{eloBlStr}"><span class="cbelocompact">{eloBlStr}</span></tpl></td></tpl></tr></table></div>':
this.V1ed(b,c)?'<div class="cbgame-header-morecompact" id="ourheaderinside" ><table class="scroll notaTable" style="table-layout:fixed" id="ourheader"><tr><span class="cbmain-header"><td colspan="2"class="cbflagwhite-morecompact"><span class="cbplayernation">{country[0]}</span></td><td colspan="9" class="cbplayerwhite"><span class="cbplayer" >{white.list}</span><tpl if="{eloWhStr}"><span class="cbelocompact">{eloWhStr}</span></tpl></td><tpl if="{black}"><td colspan="2" class="cbresult"><span >{resultStr}</span></td><td colspan="9"  class="cbplayerblack"><span class="cbplayer">{black.list}</span><tpl if="{eloBlStr}"><span class="cbelocompact">{eloBlStr}</span></tpl></td></tpl><td colspan="2" class="cbflagblack-morecompact"><span class="cbplayernation">{country[1]}</span></td></tr></table></div>':
this.V1ec(b,c)?'<div class="cbgame-header-compact" id="ourheaderinside" ><table class="scroll notaTable" style="table-layout:fixed" id="ourheader"><tr><span class="cbmain-header"><td colspan="9"class="cbplayerwhite"><span class="cbplayer" >{white.list}</span><tpl if="{eloWhStr}"><span class="cbelocompact">{eloWhStr}</span></tpl></td><tpl if="{black}"><td colspan="2" class="cbresult"><span >{resultStr}</span></td><td colspan="9"  class="cbplayerblack"><span class="cbplayer">{black.list}</span><tpl if="{eloBlStr}"><span class="cbelocompact">{eloBlStr}</span></tpl></td></tpl></tr><tr><td colspan="2" class="cbflagwhite"><span class="cbplayernation">{country[0]}</span></td><td colspan="1" class="cbfide cbfidecompact"><span>{titleWhStr}</span></td><td colspan="14" style="text-align:center"><tpl if="{event.event}"><span class="cbevent">{event.event}</span></tpl></td><td colspan="1" class="cbfide cbfidecompact"><span>{titleBlStr}</span></td><td colspan="2" class="cbflagblack"><span class="cbplayernation">{country[1]}</span></td></tr></table></div>':
'<div class="cbgame-header" id="ourheaderinside" ><table class="scroll notaTable" id="ourheader" style="table-layout:fixed" ><tr><span class="cbmain-header"><td  class="cbplayerportrait" colspan="3" rowspan="2"><span >{portrait[0]}</span></td><td class="cbplayerwhite" colspan="8"><span class="cbplayer">{white}</span><tpl if="{eloWhStr}"><span class="cbelo">{eloWhStr}</span></tpl></td><tpl if="{black}"><td colspan="2" class="cbresult"><span >{resultStr}</span></td><td class="cbplayerblack" colspan="8"><span class="cbplayer">{black}</span><tpl if="{eloBlStr}"><span class="cbelo">{eloBlStr}</span></tpl></td><td class="cbplayerportrait" colspan="3" rowspan="2"><span>{portrait[1]}</span></td></tpl></tr><tr><td colspan="2" class="cbflagwhite" ><span class="cbplayernation">{country[0]}</span></td><td colspan="1" class="cbfide"><span>{titleWhStr}</span></td><td colspan="12" class="cbtourndata"><tpl if="{event.event}"><span class="cbevent">{event.event}</span></tpl><tpl if="{uniquePlace}"><br/><span class="cbsite">{uniquePlace}</span></tpl><tpl if="{event.dt}"><span class="cbeventdate">{dateStr}</span></tpl><tpl if="{annotator}"><span class="cbannotator">{annotatorStr}</span></tpl></td><td colspan="1" class="cbfide"><span>{titleBlStr}</span></td><td colspan="2" class="cbflagblack"<span class="cbplayernation">{country[1]}</span></td></tr></table></div>';
this.headerTemplate=function(){return String.formatEx(g,this)}};var d="<img src='{0}' alt='' height='24' width='24'>";b.prototype.V1ek=function(c){c=c||new CB.Vgz;this.V1el=ObjUtil.clone(c);this.V1el.resultStr=b.V1cu(this.V1el.getResult());this.V1el.portrait=[null,null];this.V1el.country=[null,null];this.V1el.title=[null,null];return this.headerTemplate&&this.headerTemplate.apply?this.headerTemplate.apply(this.V1el):" --- "};b.prototype.V1em=function(b,c){this.V1en("");-1==this.V1el.event.event.search(this.V1el.event.site)&&
(this.V1el.uniquePlace=this.V1el.event.site);-1!=this.V1el.annotator.search("Robot");this.V1el.annotator="";this.V1eh()&&b&&(this.V1en(b.eco),this.V1el.eloWhStr=0<b.eloWh?b.eloWh:"",this.V1el.eloBlStr=0<b.eloWh?b.eloBl:"",this.V1el.annotatorStr=b.annotator?"["+b.annotator+"]":"","[ChessBase]"==this.V1el.annotatorStr&&(this.V1el.annotatorStr=""),this.V1el.annotatorStr||(this.V1el.dateStr=b.date.toLocaleString()),this.V1eo(this.V1el),this.V1ep(),this.V1el.titleWhStr=this.V1eq(this.V1el,0),this.V1el.titleBlStr=
this.V1eq(this.V1el,1),this.V1er=!1);if(c){if(this.headerTemplate&&this.headerTemplate.apply)return this.headerTemplate.apply(this.V1el)}else if(this.V1es.apply)return this.V1es.apply(this.V1el);return b?b.toString():null};b.prototype.V1eq=function(b,c){if(b.title&&CB.V1et)return CB.V1et.Vds(b.title[c])};b.prototype.V1ep=function(){if(CB.LoginMode){for(var b=!1,d=this.V1el.getBlackKey(),d=[this.V1el.getWhiteKey(),d],g=CB.Vaz.WHITE;g<=CB.Vaz.BLACK;++g){var h=c[d[g]];h&&h.answered?(this.V1el.country[g]=
h["country"+this.V1eu()],this.V1el.title[g]=h.title,g==CB.Vaz.WHITE?this.V1e7=this.V1el.white:this.V1e8=this.V1el.black):(this.V1el.country[g]=String.formatEx("<img src='{0}' alt='' height='16' width='16'>",this.V1e6),b=this.V1er&&(!h||!h.requested));h&&h.answered?(this.V1el.portrait[g]=h["portrait"+this.V1ev()],!this.V1el.portrait[g]&&h.portrait32&&(this.V1el.portrait[g]=h.portrait32)):this.V1el.portrait[g]=String.formatEx("<img src='{0}' alt='' height='24' width='24' style='display:none'>",this.V1e4)}b&&
this.Vt3.exec(function(){this.V1ew()}.bind(this),500)}};b.prototype.V1eo=function(b){b.white.last=b.white.last.replace("-"," ");b.black.last=b.black.last.replace("-"," ");var c=b.white.first.search(/\./);0<c&&b.white.first&&(b.white.first=b.white.first.slice(0,c));c=b.black.first.search(/\./);0<c&&b.black.first&&(b.black.first=b.black.first.slice(0,c));b.getWhiteKey=function(){var b=this.white.last;this.white.first&&(b+=this.white.first.slice(0,1));return b};b.getBlackKey=function(){var b=this.black.last;
this.black.first&&(b+=this.black.first.slice(0,1));return b}};b.prototype.V1ew=function(){var b=this.m_game.getHeader();this.V1eo(b);var d=function(){if(V35p.playerLobby&&V35p.playerLobby.isLoggedIn()){this.V1e7=b.getWhite();this.V1e8=b.getBlack();var d=b.date.getYear();d||(d=CB.Date.getThisYear());b.white.last&&(V35p.playerLobby.V1ex(b.white.first,b.white.last,b.eloWh,d,this.V1ey.bind(this)),c[b.getWhiteKey()]||(c[b.getWhiteKey()]={}),c[b.getWhiteKey()].requested=!0);b.black.last&&(V35p.playerLobby.V1ex(b.black.first,
b.black.last,b.eloBl,d,this.V1ez.bind(this)),c[b.getBlackKey()]||(c[b.getBlackKey()]={}),c[b.getBlackKey()].requested=!0)}else console.log("NoPB: "+b.white.last+"-"+b.black.last)}.bind(this);V35p.playerLobby&&V35p.playerLobby.isLoggedIn()?d():(new CB.Timer(d,4E3)).runOnce()};b.prototype.V1f0=function(d,f){if(d&&d.player){var g=d.player.getFirstName(),h=d.player.getLastName(),k=h;if(g){var l=g.charAt(g.length-1);"0"<=l&&"9">=l&&(g=g.slice(0,firtsName.length-1));k+=g.slice(0,1)}c[k]||(c[k]={});c[k].answered=
!0;var m=d.player,p=new CB.V5n(0);this.V1ea[f]=m;m.m_NewCBPlayer&&(l=m.m_NewCBPlayer.m_HighData.m_aNation,p=new CB.V5n(l),l=m.m_NewCBPlayer.m_HighData.m_aTitle,this.V1el.title[f]=l,c[k].title=l,l=this.V1f1(),l.forEach(function(b){var d;d=V35p.V1e5+String.formatEx("Flags/Flags{0}/{1}.png",b,p.V5s());d=String.formatEx("<img src='{1}' alt='' height='{0}' width='{0}' style='vertical-align: {2};border:none;box-shadow:none' >",b,d,"middle");b==this.V1eu()&&(this.V1e6=V35p.V1e5+String.formatEx("Flags/Flags{0}/United nations.png",
b),this.V1el.country[f]=d);c[k]["country"+b]=d}.bind(this)));(l=d.pic)?(this.V1eb[f]="string"===typeof l?l:b.V1f2(l),l=[34,40,48,64,80,100,120],l.forEach(function(b){var d=this.V1el.date.year;d||(d=CB.Date.getThisYear());d=String.formatEx("<a href='http://pbserver.chessbase.com/Player?name={4},{5}&year={6}&ref=JSReader' target='_blank'><img class = 'cbplayerimage' src='{0}' alt='{4}' height='{2}' width='{3}'  playid='{1}' ></a>",this.V1eb[f],f,b*Math.SQRT2,b,h,g,d);b==this.V1ev()&&(this.V1el.portrait[f]=
d);c[k]["portrait"+b]=d}.bind(this))):this.V1ec(this.w,this.h)||this.V1ed(this.w,this.h)||(m=this.V1ev(),34==m||40==m?m=32:64<m&&(m=64),l=V35p.V1e5+String.formatEx("Flags/Flags{0}/{1}.png",m,p.V5s()),l=String.formatEx("<img src='{1}' alt='' height='{0}' width='{0}' style='vertical-align: {2};border:none;box-shadow:none' >",m,l,"top"),this.V1el.portrait[f]=c[k]["portrait"+m]=l,this.V1el.country[f]="",this.V1f1().forEach(function(b){this.V1el.country[f]=" ";c[k]["country"+b]=" "}.bind(this)))}};b.prototype.V1eu=
function(){return 500>this.w||400>this.h?400>this.w||300>this.h?16:24:750<this.w&&560<this.h?48:32};b.prototype.V1f1=function(){return[16,24,32,48,64]};b.prototype.V1ev=function(){return 380<this.w&&260<this.h?450<this.w&&360<this.h?550<this.w&&450<this.h?650<this.w&&520<this.h?900<this.w?1E3<this.w?120:100:80:64:48:40:34};b.prototype.V1ey=function(b){this.V1f0(b,CB.Vaz.WHITE);this.V1cs(100)};b.prototype.V1ez=function(b){this.V1f0(b,CB.Vaz.BLACK);this.V1cs(100)};b.V1f2=function(b){return CB.Vaa.V1f3(b,
"image/jpeg")};b.prototype.V1bp=function(b,c){this.V1bi=b;this.V1br(c);var d=CB.$("#"+b);if(CB.V1bx.V1by("touchstart"))d.on("touchend",this.V1c0.bind(this));if(CB.V1bx.V1by("mousedown"))d.on("mouseup",this.V1c0.bind(this));this.V1ck()};b.prototype.V1br=function(b){b.notationLocalization||(b.notationLocalization=CB.V34l);this.V1bn=new CB.Vib(b.notationLocalization);this.V1c8=b.useHeader;this.V1c9=b.useResult;this.V1bo=b.isActive;this.V1ca=b;b.game&&this.setGame(b.game)};b.prototype.setOptions=function(b){this.V1br(b)};
b.prototype.m_game=null;b.prototype.setGame=function(b){this.m_game&&(this.m_game.removeOnMoveListener(this.V1cb),this.m_game.removeOnNavigateListener(this.V1cc),this.m_game.removeOnChangedListener(this.V1cd),this.m_game.removeOnHeaderChangedListener(this.V1ce));if(this.m_game=b)this.V1cb=this.m_game.addOnMoveListener(this.Vja.bind(this)),this.V1cc=this.m_game.addOnNavigateListener(this.V1f4.bind(this)),this.V1cd=this.m_game.addOnChangedListener(this.V1f5.bind(this)),this.V1ce=this.m_game.addOnHeaderChangedListener(this.V1cj.bind(this)),
this.V1er=!0;this.V1ck()};b.prototype.getGame=function(){return this.m_game};b.prototype.Vja=function(){};b.prototype.V1f5=function(){};b.prototype.V1cj=function(b){var c=null;this.m_game&&(c=this.m_game.getHeader());if(this.V1e7!==c.getWhite()||this.V1e8!==c.getBlack())this.V1er=!0;b&&b.recalc&&(b=$("#notaEl").width(),c=$("#notaEl").height(),null==b&&(b=$("#notaEl"+this.V1bk).width(),c=$("#notaEl"+this.V1bk).height()),this.V1e3(b,c));this.V1ck()};b.prototype.V1f4=function(b){};b.V1cu=function(b){return b==
CB.Vgt.Vgw?"-":CB.Vgt.toString(b)};b.prototype.V1en=function(b){3==b.length&&(this.V1el.eco=lm[b+"_ECO"])};b.prototype.V1cs=function(b){this.Vt3.exec(function(){this.V1f6();delete this.V1er}.bind(this),b)};b.prototype.V1ck=function(){var b=null;this.m_game&&(b=this.m_game.getHeader(),b.white.list=b.white.getListStr(1),b.black.list=b.black.getListStr(1));this.V1ek(b,!0);b=this.V1em(b,!0);CB.$("#theheader-"+this.V1bk).html(b)};b.prototype.V1f6=function(){var b=null;this.m_game&&(b=this.m_game.getHeader());
b=this.V1em(b,!0);CB.$("#theheader-"+this.V1bk).html(b)};b.prototype.focus=function(){};b.prototype.onMouseMove=function(b){b.preventDefault()};b.prototype.V1f7=function(b,c,d){"undefined"!==typeof Ext&&b&&!glSettings.inDialog()&&CB.Vn8&&CB.Vn8.V1f8(b,c,d)};b.prototype.V1c0=function(b){};b.prototype.V1dj=function(b){if(!(!this.V1bo||600>window.innerHeight||700>window.innerWidth)){var c=b.target;CB.$.is(c,"[playid]")&&(c=CB.$(c).attr("playid"),this.V1f7(this.V1ea[c],0,this.V1eb[c]));b.preventDefault()}};
b.prototype.isActive=function(){return this.V1bo};b.prototype.V1dy=function(b){this.V1bo=b};b.prototype.V1bt=function(b){b.preventDefault()};b.prototype.V1bu=function(b){b.preventDefault()};b.prototype.resize=function(b,c){CB.DOM.resize(this.V1bi,b,c)};b.prototype.V1f9=function(b,c){this.V1ei=b;this.V1ej=c;this.V1e3(this.w,this.h);this.V1f6()};b.prototype.V178=function(b,c){this.w=b;this.h=c;this.V1e3(b,c);this.V1er=!0;this.V1f6()};return b}();
CB.V1bf.factory=function(c,b){var d=new CB.V1bf(b);d.V1bp(c,CB.cbNotationDefaults);return V35p.panelMgr.notaHeaderElement=d};"use strict";
CB.V1bh=function(){var c=function(b,c){this.V1bi=0;this.Vt3=new CB.V35b;this.V1fa=[];this.V1bk=b;this.ticket=c};c.prototype.panel=null;c.prototype.V1fb=function(b){return this.V1fc(b)};c.prototype.getPiece=function(b){return(CB.Vaz.toString(CB.Piece.side(b))+CB.Piece.toString(b)).toLowerCase()};c.V1fd='<span class="piece-{0}"></span>';c.V1fe="</div>";c.prototype.V1ff=function(){var b;b='<a href="'+(V35p?V35p.V1fg(V35p.V358.V1fh):"https://database.chessbase.com")+'" class="footer-book" id="footer-book{0}"></a><div class="footer-eval" id="footer-eval{0}"></div>';
return b+'<div class="mat-balance">'};c.prototype.V1fc=function(b){V35p&&V35p.config.V8o&&(c.V1fd='<span style="background-image: url( {1}Media/Buttons/{0}-16px.png );"></span>');for(b=0;6>b;b++);var d=String.formatEx(this.V1ff(),this.V1bk);for(b=0;6>b;b++)if(0<this.V1fa[b+1])for(var e=0;e<this.V1fa[b+1];e++)d+=String.formatEx(c.V1fd,this.getPiece(b+1),CB.V5o());for(b=0;6>b;b++)if(0>this.V1fa[b+1])for(e=0;e<Math.abs(this.V1fa[b+1]);e++)d+=String.formatEx(c.V1fd,this.getPiece(b+9),CB.V5o());return d+=
c.V1fe};c.prototype.V1fi=function(){CB.$("#thefooter-"+this.V1bk).addClass("notafooter-container")};c.prototype.V1fj=function(){CB.$("#thefooter-"+this.V1bk).addClass("notafooter-container")};c.prototype.V1bp=function(b){this.V1fi();this.V1bi=b;this.update()};c.prototype.V1br=function(b){this.V1ca=b;b.game&&this.setGame(b.game)};c.prototype.setOptions=function(b){this.V1br(b)};c.prototype.m_game=null;c.prototype.setText=function(b){CB.$("#footer-eval"+this.V1bk).text(b)};c.prototype.setGame=function(b){this.m_game&&
(this.m_game.removeOnMoveListener(this.V1cb),this.m_game.removeOnNavigateListener(this.V1cc),this.m_game.removeOnChangedListener(this.V1cd));if(this.m_game=b)this.V1cb=this.m_game.addOnMoveListener(this.Vja.bind(this)),this.V1cc=this.m_game.addOnNavigateListener(this.V1f4.bind(this)),this.V1cd=this.m_game.addOnChangedListener(this.V1f5.bind(this))};c.prototype.getGame=function(){return this.m_game};c.prototype.Vja=function(){this.update()};c.prototype.V1f5=function(){this.update()};c.prototype.V1f4=
function(b){!this.V1fk&&V35p.aTBLobby&&(this.V1fk=V35p.aTBLobby.addOnLiveBookDisplayListener(this.Vt8.bind(this)));this.update()};c.prototype.update=function(){for(var b=[],c=0;16>c;c++)b[c]=0;if(null!==this.getGame())for(var e=this.getGame().getCurPos(),c=0;64>c;c++)b[e.board[c]]++;for(c=1;7>c;c++)this.V1fa[c]=b[c]-b[c+8];this.V1ck()};c.prototype.V1cs=function(){this.Vt3.exec(function(){this.V1ck()}.bind(this),200)};c.prototype.V1ck=function(){var b=new StringBuilder;this.V1fl()&&CB.$(".footer-eval").text("");
var c=this.V1fb(!1);c.length&&b.append(c);CB.$("#thefooter-"+this.V1bk).html(b.toString());b=(b=CB.$("#notaparent"+this.V1bk))&&b.single()&&360<b.single().clientHeight;this.V1fl()||b?CB.$("#thefooter-"+this.V1bk).show():CB.$("#thefooter-"+this.V1bk).hide()};c.prototype.V1fl=function(){for(var b=0;6>b;b++)if(0!=this.V1fa[b+1])return!0;return!1};c.prototype.focus=function(){};c.prototype.V1bt=function(b){b.preventDefault()};c.prototype.V1bu=function(b){b.preventDefault()};c.prototype.resize=function(b,
c){CB.DOM.resize(this.V1bi,b,c)};c.prototype.Vt8=function(b){if(b&&(!this.ticket||this.ticket==b.ticket)){for(var c=0,e=0;e<b.moves.length;e++)c+=b.moves[e].getNGames();c?CB.$("#footer-book"+this.V1bk).text(lm.LIVE_BOOK+": "+c+" "+lm.GAMES):CB.$("#footer-book"+this.V1bk).text("")}};return c}();CB.V1bh.factory=function(c,b){var d=new CB.V1bh(b);d.V1bp(c,CB.cbNotationDefaults);return V35p.panelMgr.V1bh=d};"use strict";
CB.V17t=function(){var c=new CB.Color(0,0,0,.25),b=new CB.Color(255,255,250,.95),d=1,e=function(b,c,e){e=e||!1;this.uniqueId=d++;this.background=new CB.V15t(document.body,"bMessageBG"+this.uniqueId);this.background.V1fm(99999);this.V1fn=new CB.V15t(this.background,"bMessageText"+this.uniqueId);CB.$(this.background.elDOM).addClass("board-msg");e&&CB.$(this.background.elDOM).addClass("modal");b.messageWin=this;this.V1fn.setText(c||"Empty Board Message");this.background.elDOM.addEventListener("mousedown",
function(c){e||(b.destroyMessage(),c.preventDefault())});this.V1fn.elDOM.addEventListener("mousemove",function(b){b.preventDefault()})};e.prototype.destroy=function(){this.background.destroy()};e.prototype.setText=function(b){this.V1fn.setText(b)};e.prototype.setVisible=function(b){this.background.setVisible(b)};e.prototype.V178=function(d){var e=d.cbcanvas.getBoundingClientRect(),h=new CB.V7p(e.left,e.top,e.left+e.width,e.top+e.height);d.cbcanvas.pixToZoomRect&&(h=d.cbcanvas.pixToZoomRect(d.getOuterRect()));
var k=2;d.nSqPix&&(k=d.nSqPix);var l=Math.round(.7*h.w),m=Math.round(l/11),p=1;50<this.V1fn.getText().length&&(m*=2.1,p=2);this.background.setPos((h.w-l)/2+h.left+e.left,(h.h-m)/2+h.top+e.top-m/2-(k-m)/2+window.pageYOffset);this.background.setSize(l,m);this.V1fn.setPos(0,0);this.V1fn.setSize(l,m);d.cbcanvas.pixToZoom&&this.V1fn.setBorder(d.cbcanvas.pixToZoom(2),new CB.Color(0,0,0,.7));this.V1fn.setBackgroundColor(c);this.V1fn.setColor(b);400<l?this.V1fn.setFontFamily("Roboto, Merriweather, Helvetica, sans-serif; font-stretch: expanded"):
250>l&&this.V1fn.setFontFamily("Roboto, Merriweather, Helvetica, sans-serif; font-stretch: condensed");d=Math.max(5,.9*m/p);do this.V1fn.V1az(d),--d;while(5<d&&this.V1fn.V1b1()>.95*l&&this.V1fn.V1b2()>.95*m);this.V1fn.V1fo()};return e}();"use strict";
CB.Vk4=function(){var c=function(){this.V1fp=!0};c.prototype._game=null;c.prototype.setGame=function(b){this._game&&this._game.removeOnMoveListener(this.V1fq);(this._game=b)&&!V35p.config.isSilentBoard&&(this.V1fq=this._game.addOnMoveListener(this.V1a0.bind(this)))};c.prototype.getGame=function(){return this._game};c.prototype.enable=function(b){this.V1fp=b};c.prototype.V1fr={};c.prototype.V1fr[CB.Vaz.WHITE]=!0;c.prototype.V1fr[CB.Vaz.BLACK]=!0;c.prototype.V1fs=function(b,c){this.V1fr[b]=c};c.prototype.V1a0=
function(){var b=this._game.getCurPos(),c=this._game.getLastMove();c&&this.V1fp&&V35p.V1ft.Vja(c,b)};return c}();"use strict";
CB.V1fu=function(){var c=function(b){this.V1fv=b;this.queue=new CB.V1fw;this.V1fx=[];this.newGame=this.V1fy("Board/newgame");this.V1fz=[];for(b=1;11>=b;b++)this.V1fz.push(this.V1fy("Board/move"+b));this.V1g0=[];for(b=1;2>=b;b++)this.V1g0.push(this.V1fy("Board/moveStrong"+b));this.V1g1=[];for(b=1;15>=b;b++)this.V1g1.push(this.V1fy("Board/capture"+b));this.V1g2=[];this.V1g2.push(this.V1fy("Board/CaptStrong"));this.V1g3=this.V1fy("Board/castle");this.V1g4=[];for(b=1;5>=b;b++)this.V1g4.push(this.V1fy("Server/winapplause"+
b));this.V1g4.push(this.V1fy("Server/cheer1"));this.V1g4.push(this.V1fy("Server/cheer2"));this.V1g4.push(this.V1fy("Server/cheer3"));this.V1g4.push(this.V1fy("Server/cheer5"));this.V1g5=this.V1fy("Server/clapping");this.V1g6=this.V1fy("Server/draw");this.V1g7=this.V1fy("Server/remis");this.V1g8=this.V1fy("Server/ping2");this.V1g9=this.V1fy("Server/ringbellonce");this.V1ga=this.V1fy("Server/ChallengeBell");this.V1gb=[];for(b=1;16>=b;b++)this.V1gb.push(this.V1fy("Server/punch"+b));this.V1gc=[];for(b=
1;8>=b;b++)this.V1gc.push(this.V1fy("Server/grunt"+b));this.V1gd=[];for(b=1;9>=b;b++)this.V1gd.push(this.V1fy("Server/MyError"+b));this.V1ge=[];for(b=1;5>=b;b++)this.V1ge.push(this.V1fy("Server/OppError"+b));this.V1gf=[];for(b=1;5>=b;b++)this.V1gf.push(this.V1fy("Server/Cheer"+b));var c=["Plop","CluckCluck","FistInHand","Snap"],e=["Marseillaise","Yes","SoftClapClap"],f=["Cluck","DoubleSnap","Drawlips"],g=["CuckooWhistle","Moan","Moan2"],h=["Exhale","sharpinhale","sssinhale"];this.punishCap=[];for(b=
0;b<c.length;b++)this.punishCap.push(this.V1fy("Server/Feedback/"+c[b]));this.punishNoCap=[];for(b=0;b<e.length;b++)this.punishNoCap.push(this.V1fy("Server/Feedback/"+e[b]));this.bestCap=[];for(b=0;b<f.length;b++)this.bestCap.push(this.V1fy("Server/Feedback/"+f[b]));this.bestNoCap=[];for(b=0;b<g.length;b++)this.bestNoCap.push(this.V1fy("Server/Feedback/"+g[b]));this.V1gg=[];for(b=0;b<h.length;b++)this.V1gg.push(this.V1fy("Server/Feedback/"+h[b]));this.V1gh=this.V1fy("Server/Aooga")};c.prototype.Vs5=
function(){this.queue.Vs5()};c.prototype.V1gi=function(){this.V1fx.forEach(function(b){b.load()});this.V1fx=[]};c.prototype.Vja=function(b,c){this.queue.Vs5();b.isTake()?b.isStrong?this.V1gj():this.V1gk():b.isCastling()?this.V1gl():b.isStrong?this.V1gm():this.V1gn()};c.prototype.V1gn=function(){this.queue.push(this.V1fz[Math.floor(Math.random()*this.V1fz.length)])};c.prototype.V1gm=function(){this.queue.push(this.V1g0[Math.floor(Math.random()*this.V1g0.length)])};c.prototype.V1gk=function(){this.queue.push(this.V1g1[Math.floor(15*
Math.random())])};c.prototype.V1gj=function(){this.queue.push(this.V1g2[Math.floor(Math.random()*this.V1g2.length)])};c.prototype.V1gl=function(){this.queue.push(this.V1g3)};c.prototype.V1go=function(){this.queue.push(this.V1g4[Math.floor(9*Math.random())])};c.prototype.V1gp=function(){this.queue.push(this.V1g5)};c.prototype.V1gq=function(){this.queue.push(this.V1g8)};c.prototype.V1gr=function(){this.queue.push(this.V1ga)};c.prototype.V1gs=function(){this.queue.push(this.V1g9)};c.prototype.V1gt=function(){this.queue.push(this.V1gb[Math.floor(14*
Math.random())])};c.prototype.V1gu=function(){this.queue.push(this.V1gc[Math.floor(8*Math.random())])};c.prototype.V1gv=function(){this.queue.push(this.V1gd[Math.floor(9*Math.random())])};c.prototype.V1gw=function(){this.queue.push(this.V1ge[Math.floor(5*Math.random())])};c.prototype.V1gx=function(){this.queue.push(this.V1gf[Math.floor(5*Math.random())])};c.prototype.V1gy=function(){this.queue.push(this.punishCap[Math.floor(Math.random()*this.punishCap.length)])};c.prototype.V1gz=function(){this.queue.push(this.punishNoCap[Math.floor(Math.random()*
this.punishNoCap.length)])};c.prototype.V1h0=function(){this.queue.push(this.bestCap[Math.floor(Math.random()*this.bestCap.length)])};c.prototype.V1h1=function(){this.queue.push(this.bestNoCap[Math.floor(Math.random()*this.bestNoCap.length)])};c.prototype.V1h2=function(){this.queue.push(this.V1gg[Math.floor(Math.random()*this.V1gg.length)])};c.prototype.V1h3=function(){CB.V79.V7c()==CB.V79.DEU?this.queue.push(this.V1g7):this.queue.push(this.V1g6)};c.prototype.V1h4=function(){this.queue.push(this.newGame)};
c.prototype.V1h5=function(){this.queue.push(this.V1gh)};c.prototype.V1fy=function(b){b=new CB.V1h6(this.V1fv+b,null,!0);this.V1fx.push(b);return b};return c}();"use strict";
CB.V1h7=function(){var c=function(b){this.config=b||{};this.config.V1h8=150;this.height=20};c.prototype.V171=function(b,c){return this.V1h9(b,c)};c.prototype.V1h9=function(b,c){var e=c.zoomToPix(this.config.hMax);return Math.min(e,b/this.config.hScale)};c.prototype.V17b=function(b,c){this.height=c.pixToZoom(b)};c.prototype.V179=function(b,c){return b>c.pixToZoom(this.config.V1h8)};c.prototype.V17a=function(b,c){return c?c.zoomToPix(this.config.spacing):0};c.prototype.V1ha=function(b){var c=b.cbcanvas.canvas.getBoundingClientRect(),
e=b.cbcanvas.pixToZoomRect(b.getOuterRect());e.h=this.height;var f=b.cbcanvas.pixToZoom(b.getOuterRect().h);e.move(c.left,c.top+f+b.cbcanvas.pixToZoom(this.config.spacing)-1);return e};return c}();
CB.BoardURL=function(){var c=1,b=function(d,e){b.superClass.call(this,e);this.uniqueId=c++;this.background=new CB.V15t(document.body,"bBottomBG"+this.uniqueId);this.url=new CB.V15t(this.background,"bBottomURL"+this.uniqueId);this.url.V1hb(d.url,d.linkText,"BoardBottomURL",!0)};CB.inherit(b,CB.V1h7);b.prototype.V178=function(b){var c=this.V1ha(b),f=c.w;this.config.rightAlign&&(f-=b.nMarginW);this.background.setPos(c.left,c.top);this.background.setSize(f,c.h);this.url.setPos(0,0);this.url.setSize(f,
c.h);this.url.elDOM.className="BoardBottomURL";this.url.V1az(c.h);this.url.V1az(Math.max(3,c.h));this.config.rightAlign?this.url.V1hc():this.url.V1fo();V35p.config.V1hd&&(this.url.V1he.style.color="Black")};b.prototype.destroy=function(){this.background.destroy()};b.prototype.setVisible=function(b){this.background.setVisible(b)};return b}();
CB.BoardDoubleURL=function(){var c=1,b=function(d,e){b.superClass.call(this,e);this.uniqueId=c++;this.background=new CB.V15t(document.body,"bBottomURLBG"+this.uniqueId);this.urlLeft=new CB.V15t(this.background,"bBottomURLLeft"+this.uniqueId);this.urlLeft.V1hb(d.urlLeft,d.linkTextLeft,"BoardBottomURL",!0);this.urlRight=new CB.V15t(this.background,"bBottomURLRight"+this.uniqueId);this.urlRight.V1hb(d.urlRight,d.linkTextRight,"BoardBottomURL",!0)};CB.inherit(b,CB.V1h7);b.prototype.V178=function(b){var c=
this.V1ha(b);b=b.cbcanvas.pixToZoom(b.nMarginW);var f=c.w,f=f-2*b;this.background.setPos(c.left,c.top);this.background.setSize(f,c.h);f/=2;this.urlLeft.setPos(b,0);this.urlLeft.setSize(f,c.h);this.urlLeft.elDOM.className="BoardBottomURL";this.urlLeft.V1az(Math.max(4,c.h));this.urlLeft.V1hf();this.urlRight.setPos(f+b,0);this.urlRight.setSize(f,c.h);this.urlRight.elDOM.className="BoardBottomURL";this.urlRight.V1az(Math.max(4,c.h));this.urlRight.V1hc();if(V35p.config.V1hd||V35p.config.transparent)this.urlLeft.V1he.style.color=
"Black",this.urlRight.V1he.style.color="Black"};b.prototype.destroy=function(){this.background.destroy()};b.prototype.setVisible=function(b){this.background.setVisible(b)};return b}();"use strict";
CB.V17i=function(){var c=new CB.Color(0,0,0,.3),b=new CB.Color(210,255,170,.75),d=new CB.Color(255,255,220,.9),e=1,f=function(b,f,k,l,m,p){this.board=b;this.uniqueId=e++;this.background=new CB.V15t(b.cbcanvas.canvas.parentNode,"bTitleBG"+this.uniqueId);m||(this.clock=new CB.V1an(this.background));this.V1fn=new CB.V15t(this.background,"bTitleText"+this.uniqueId);CB.V139&&!V35p.V15u()&&(this.V1hg=new CB.CloseButton(this.background,"bCloseBtn"+this.uniqueId,this.V1hh.bind(this)));b.titleWin=this;this.V1hi=
f;this.V1fn.setText(l||"Waiting for game...");$(this.V1fn.elDOM).on("click",k);$(this.V1fn.elDOM).on("dblclick",p);this.clock&&($(this.clock.background.elDOM).on("click",k),$(this.clock.background.elDOM).on("dblclick",p));this.V1fn.setBackgroundColor(c);this.V1fn.setColor(d);this.V1fn.setFontFamily('"Roboto Condensed", "Roboto", "Arial Narrow", sans-serif');$(this.V1fn).css("cursor","pointer");this.h=Math.round(b.cbcanvas.pixToZoom(this.V1h9(b.height)))};f.prototype.destroy=function(){this.background.destroy()};
f.prototype.V1a1=!0;f.prototype.setText=function(b){this.V1fn.setText(b);if(this.textW){b=this.V1hj();do this.V1fn.V1az(b),--b,this.V1fn.V1b1(),this.V1fn.V1b2();while(4<b&&(this.V1fn.V1b1()>this.textW-4||this.V1fn.V1b2()>this.h-2))}};f.prototype.setVisible=function(b){this.background.setVisible(b)};f.prototype.V1hk=!1;f.prototype.markAsSelected=function(e){this.V1hk!=e&&((this.V1hk=e)?(this.V1fn.setBackgroundColor(b),this.V1fn.setColor("black")):(this.V1fn.setBackgroundColor(c),this.V1fn.setColor(d)))};
f.prototype.V17r=function(){return this.clock};f.prototype.V1hj=function(){if(this.board){var b=Math.round(this.board.cbcanvas.pixToZoom(this.V1h9(this.board.height))),b=Math.round(.65*b);8>b&&(b=8);return b}return 16};f.prototype.V171=function(b,c){return this.V1h9(b)};f.prototype.V1h9=function(b){var c=this.board?this.board.cbcanvas.zoomToPix(36):36;return Math.min(c,b/16)};f.prototype.V178=function(b){this.board=b;b.cbcanvas.canvas.getBoundingClientRect();var c=b.cbcanvas.pixToZoomRect(b.getOuterRect()),
d=Math.round(b.cbcanvas.pixToZoom(this.V1h9(b.height))),e=d+1,f=this.V1hj();this.h=d;c.move(-1,-this.h);c.h=this.h;this.btnW=this.V1hg?e:0;CB.V5t.V64()&&this.V1hg&&this.btnW<CB.V5t.pixToZoom(26)&&(this.btnW=CB.V5t.pixToZoom(26));this.V1hm=this.clock?Math.min(260,.4*c.w):0;c.w--;this.textW=c.w-this.V1hm-this.btnW;this.background.setPos(c.left,c.top);this.background.setSize(c.w,c.h);d=Math.max(1,Math.min(4,Math.round(Math.sqrt(c.w/100))));this.background.V1b3(d,8*d,"rgba( 60, 30, 20, 0.5 )");this.clock&&
this.clock.setPosSize(0,0,this.V1hm,this.h);this.V1fn.setPos(this.V1hm,0);this.V1fn.setSize(this.textW,this.h);this.V1fn.setBorder(b.cbcanvas.pixToZoom(1),new CB.Color(0,0,0,1));this.markAsSelected(this.V1hk);this.V1fn.V1fo();do this.V1fn.V1az(f),--f,this.V1fn.V1b1(),this.V1fn.V1b2();while(4<f&&(this.V1fn.V1b1()>this.textW||this.V1fn.V1b2()>this.h-2));this.V1fn.V1b0(!0);this.V1hg&&(this.V1hg.setPos(c.w-this.btnW,this.h-this.btnW),this.V1hg.setSize(this.btnW,this.btnW))};f.prototype.V1hh=function(b){void 0!==
this.V1hi&&this.V1hi(b)};return f}();"use strict";
CB.V1hn=function(){var c=function(b,c,e,f){this.cbcanvas=b;this.boardArea=new CB.Vkf(b,c,e,f);this.width=c;this.height=e;this.V15v=glSettings.addOnBoardStyleListener(this.onBoardStyle.bind(this));this.Vkb=V35p.commands.Vkc(this)};c.prototype.destroy=function(){glSettings.removeOnBoardStyleListener(this.V15v);V35p.commands.Vke(this.Vkb)};c.prototype.onKeyDown=function(b){var c=!0;switch(b.getKey()){default:c=!1;break;case b.TAB:this.V1ho()}return c};c.prototype.onBoardStyle=function(b,c){V35p.V170(CB.V13m.prototype.V149(b));
for(var e=0;e<this.boardArea.boards.length;e++)this.boardArea.boards[e].onBoardStyle(b,c);this.boardArea.Vmd()};c.prototype.addBoard=function(b,c,e){0==this.boardArea.boards.length&&this.boardArea.V16h();e||b.addTitle(function(){return this.V1hi(b,c)}.bind(this),!1,function(b){return this.V16c(b)}.bind(this));V35p.V15u()&&V35p.useBottomURL&&V35p.GetBottomURLData&&100<window.innerHeight&&(b.bottomWin=new CB.BoardDoubleURL(V35p.GetBottomURLData(),{hScale:25,hMax:16,spacing:3,rightAlign:!0}));b.fnBoardClick=
this.V1hp.bind(this);e=!1;if(null!=c){b.idGame=c;for(var f=0;!e&&f<this.boardArea.boards.length;f++)e=this.boardArea.boards[f].idGame==c}e||this.boardArea.addBoard(b)};c.prototype.V15x=function(b){b&&(this.cbcanvas.V16b(!0),this.boardArea.V15x(b),this.boardArea.Vmd(),this.V1hq())};c.prototype.V161=function(){this.V162()};c.prototype.V162=function(){this.boardArea.V162();this.cbcanvas.V15z();this.V148(this.cbcanvas.V9p)};c.prototype.V1hr=function(b){this.notation=b};c.prototype.beforeResize=function(){this.boardArea.beforeResize()};
c.prototype.resize=function(b,c){this.width=b;this.height=c;this.boardArea.resize(b,c);this.V1hq()};c.prototype.V1hq=function(){if(this.V1hs){var b=this.V1ht(this.V1hs);b&&b.markAsSelected(!0)}};c.prototype.draw=function(b){this.boardArea.draw(b)};c.prototype.V163=function(b){this.boardArea.V163(b)};c.prototype.V148=function(b){this.boardArea.V148(b)};c.prototype.V16h=function(){};c.prototype.V1hu=function(){this.boardArea.Vmd();this.V1hq()};c.prototype.Vmd=function(){this.boardArea.Vmd()};c.prototype.onMouseDown=
function(b,c){if(!V35p.lobby.boardAreaClickHandler||0!=b.button&&"undefined"!=typeof b.button)this.boardArea.onMouseDown(b,c);else V35p.lobby.boardAreaClickHandler(b)};c.prototype.onMouseUp=function(b,c){this.boardArea.onMouseUp(b,c)};c.prototype.onMouseMove=function(b,c){this.boardArea.onMouseMove(b,c)};c.prototype.onMouseEnter=function(b,c){this.boardArea.onMouseEnter(b,c)};c.prototype.onMouseLeave=function(b,c){this.boardArea.onMouseLeave(b,c)};c.prototype.V16c=function(b){if(this.V1hv){var c=
this.V1ht(this.V1hs);this.V1hv(c.idGame,b)}V35p.lobby.boardAreaDClickHandler&&0==b.button&&V35p.lobby.boardAreaDClickHandler(b)};c.prototype.Vnw=function(){};c.prototype.Vnx=function(){};c.prototype.Vny=function(){};c.prototype.Vo0=function(){};c.prototype.Vo1=function(b){};c.prototype.V1hw=function(b,c){};c.prototype.V1hi=function(b,c){this.V15x(b);void 0!==this.V1hx&&this.V1hx(c)};c.prototype.V1hp=function(b,c,e){b!=this.V1hy&&(e=this.V1ht(b),this.V1hz(e),void 0!==this.V1i0&&this.V1i0(e.idGame,
c),this.V1hy=b)};c.prototype.V1i1=function(b){b<this.boardArea.boards.length&&this.V1hz(this.boardArea.boards[b])};c.prototype.V1hz=function(b){var c=this.V1ht(this.V1hs);c&&c!==b&&c.markAsSelected(!1);b?(b.markAsSelected(!0),this.V1hs=b.uniqueId):this.V1hs=-1};c.prototype.markBoardByGameId=function(b){b=this.V1i2(b);this.V1hz(b)};c.prototype.V1ho=function(){var b=this.V1hs,c=this.boardArea.boards.findIndex(function(c){return c.uniqueId==b});0<=c&&(c+=1,c>=this.boardArea.boards.length&&(c=0));this.V1i1(c);
this.V1i0&&this.boardArea.boards[c]&&this.V1i0(this.boardArea.boards[c].idGame)};c.prototype.V1i2=function(b){return this.boardArea.boards.find(function(c){return c.idGame==b})};c.prototype.V1ht=function(b){if(b)return this.boardArea.boards.find(function(c){return c.uniqueId==b})};return c}();"use strict";
CB.V1i3=function(){var c=function(b,c){this.V1bk=b;this.fnOnEnter=c};c.prototype.V1bp=function(b,c){var e;this.V1bi=e="string"==typeof b?b:b.id;e=$("#"+e);e.addClass("cbChatContainer");e[0].style.width="100%";e[0].style.height="100%";e[0].style.position="relative";this.elem=e[0];var f=document.createElement("div");f.id=this.V1bi+"-out";var g=document.createElement("input");g.id=this.V1bi+"-in";g.placeholder="Please log in with your ChessBase Account to type chat here.";e.append(f);e.append(g);f=$(f);
g=$(g);f[0].style.width="100%";f[0].style.height="100%";f.addClass("cbChatOut");g.addClass("cbChatInp");g[0].style.position="absolute";f[0].style.width="calc( 100% - 8px) ";g.keypress(this.V1i4.bind(this));g.focus(this.onFocus.bind(this));g.blur(this.onBlur.bind(this));if(this.elem&&(f.on("mousewheel",this.V1bw.bind(this)).on("DOMMouseScroll",this.V1bw.bind(this)),CB.V1bx.V1by("touchstart")&&(f.on("touchstart",this.V1bz.bind(this)).on("touchend",this.V1c0.bind(this)).on("touchleave touchcancel",this.onMouseLeave.bind(this)),
this.V1c1=!0),CB.V1bx.V1by("mousedown")))f.on("mousedown",this.V1bz.bind(this)).on("mouseup",this.V1c0.bind(this)).on("mouseleave",this.onMouseLeave.bind(this)).on("dblclick",this.V16c.bind(this));e.resize(this.resize.bind(this));this.V1i5();e=this.V1i6()?this.V1i7():'Visit <a href="//account.chessbase.com" target="_blank">account.chessbase.com</a> to login with your free ChessBase Account and type chat below.';this.V1i8(e,"cbChatLine cbChatSeparator")};c.prototype.V1i5=function(){this.V1i8("Chat and Info",
"cbChatTitle")};c.prototype.V1i7=function(){return'<a href="https://live.chessbase.com/logon?returnurl='+encodeURIComponent(document.location)+'">Log in</a> with your free ChessBase Account and type chat below.'};c.prototype.V1i6=function(){return-1!=document.URL.search(/live.chessbase.com/i)||-1!=document.URL.search(/live.playchess.com/i)};c.prototype.V1i9=function(){return $("#"+this.V1bi+"-out")};c.prototype.V1ia=function(){return $("#"+this.V1bi+"-in")};c.prototype.resize=function(){var b=$("#"+
this.V1bi),c=$("#"+this.V1bi+"-in"),e=$("#"+this.V1bi+"-out"),b=b.height()-20-10;e[0].style.height=b+"px";e[0].style.width="100%";c[0].style.top=b+1+"px";e=e.width();c[0].style.width=e-8+"px";c[0].style.height="20px"};c.prototype.hasFocus=function(){return $("#"+this.V1bi+"-in").is(":focus")};c.prototype.onFocus=function(b){this.V1ib=!0};c.prototype.onBlur=function(b){this.V1ib=!1};c.prototype.V1i4=function(b){13==b.keyCode&&(b=this.V1ia().val())&&(this.fnOnEnter&&this.fnOnEnter(this.V1bk,b),this.V1ia().val(""))};
c.prototype.V1bz=function(b){this.V190=!0};c.prototype.V1c0=function(b){this.V190=!1};c.prototype.V16c=function(b){};c.prototype.V1bw=function(b){};c.prototype.onMouseLeave=function(b){this.V190=!1};c.prototype.add=function(b,c){if(b){var e=$("#"+this.V1bi+"-out"),f=document.createElement("div");$(f).text(b);$(f).addClass("cbChatLine");$(f).addClass(c);e.append(f);var g=e.offset().top,h=e.scrollTop(),f=$(f).offset().top;e.scrollTop(f-g+h)}};c.prototype.addKibitzChat=function(b,c,e,f,g,h){if(b||g)this.V1ic(b,
c,f,g),b=$($.parseHTML(e)).text(),f=this.V1i8(b,"cbChatLine"),$(f).addClass("cbChatSeparator"),b=$("#"+this.V1bi+"-out"),c=b.offset().top,e=b.scrollTop(),h&&(h=$(f).offset().top,b.scrollTop(h-c+e))};c.prototype.V1ic=function(b,c,e,f){var g="";c&&c.white?(g=c.white.getListStr(1),(c=c.black.getListStr(1))&&(g+="-"+c)):"String "==typeof c&&(g=c);c="";var h="cbSessionName";e&&e.idGame&&(c=String.formatEx('onClick = "V35p.panelMgr.addGameById( {0}, {1}, {2} );"',this.V1bk,e.idGame,e.mvInx),h="cbChatGameLink");
e="cbSender";b==this.user&&(e+=" cbChatUserName cbBigUserName");b=f?String.formatEx('<span class="cbSessionName {2}"{1}>{0}:</span>',g,c,h):String.formatEx('<span class="{4}">{0}:</span><span class="cbSessionName {3}"{2}>({1})</span>',b,g,c,h,e);g="cbChatOrigin";f&&(g+=" cbAutoChat");this.V1i8(b,g)};c.prototype.outLoginOk=function(b){$("#"+this.V1bi+"-out").html("");this.V1i5();this.user=b;b=String.formatEx("{0}<span class='cbChatUserName'>{1}</span>","Hello, ",b);this.V1i8(b,"cbChatLoginOk cbChatSeparator");
(b=$("#"+this.V1bi+"-in"))&&b.attr("placeholder","Type Chat Here And Press Enter")};c.prototype.inviteLogin=function(){var b=this.V1i7();this.V1i8(b,"cbChatLine")};c.prototype.V1i8=function(b,c){var e=$("#"+this.V1bi+"-out"),f=document.createElement("div");$(f).addClass(c);$(f).html(b);e.append(f);return f};return c}();CB.V1i3.factory=function(c,b,d){b=new CB.V1i3(b||0,d);b.V1bp(c);return b};"use strict";
CB.V1id=function(){var c=function(b,c,d){this.V1bk=b;this.V1ie=!1;this.fnGetKernel=c;this.ticket=d;this.V1if=CB.V1ig.V1ih();this.entries=[];this.config={minVisits:5};this.V1ii=0;this.V1ij()};c.prototype.V1bp=function(b,c){var d;this.V1bi=d="string"==typeof b?b:b.id;d=$("#"+d);d.addClass("cbBookContainer");this.elem=d[0];this.V1ik()};c.prototype.resize=function(){$(this.elem).jsGrid("option","fields",this.V1il($(this.elem).width()));$(this.elem).jsGrid("option","height","100%");$(this.elem).jsGrid("option",
"width","100%");this.V1ie||this.V1ij();$(this.elem).jsGrid("refresh")};c.prototype.V1ik=function(){$(this.elem).jsGrid({width:"400px",height:"100%",heading:!0,filtering:!1,editing:!1,inserting:!1,updateOnResize:!0,sorting:!0,autoload:!0,noDataContent:"Replay and check the LiveBook here",rowClick:function(b){},controller:{loadData:function(b){b=[];for(var c=0;c<this.entries.length;c++){var d={Move:this.entries[c].line,N:this.entries[c].getStrNGames(),Visits:this.entries[c].getStrNVisits(),Players:this.entries[c].getPlayers(),
Result:this.entries[c].getStrResult(),Elo:this.entries[c].getStrElo()};b.push(d)}return b}.bind(this)},fields:this.V1il()});this.V1im=!0};c.prototype.V1in=function(c,d){if(this.V1ii<b||this.V1io)return"-"==c?String.formatEx('<span class="jsg-liveVisits">({0})</span>',d.Visits):c;var g="https://live.chessbase.com/logon?returnurl="+encodeURIComponent(document.location);return String.formatEx('<a class="jsg-premiumRequired" href="{0}">Login</a>',g)};c.prototype.V1ip=function(b,c){if(this.V1ii<d||this.isPremium)return b;
if(this.V1io)return String.formatEx('<a class="jsg-premiumRequired" href="{0}">Premium Required</a>',"https://account.chessbase.com/en/matrix");var g="https://live.chessbase.com/logon?returnurl="+encodeURIComponent(document.location);return String.formatEx('<a class="jsg-premiumRequired" href="{0}">Premium Required</a>',g)};c.prototype.V1il=function(b){if(380>(b||400))return[{name:"Move",type:"text",width:30,css:"jsg-liveMove"},{name:"N",type:"number",width:25,css:"jsg-liveNGames",itemTemplate:this.V1in.bind(this)},
{name:"Result",type:"number",width:25,css:"jsg-liveResult"},{name:"Elo",type:"number",width:20,css:"jsg-liveElo"}];b=[{name:"Move",type:"text",width:18,css:"jsg-liveMove"},{name:"N",type:"number",width:16,css:"jsg-liveNGames",itemTemplate:this.V1in.bind(this)},{name:"Result",type:"number",width:10,css:"jsg-liveResult"},{name:"Elo",type:"number",width:8,css:"jsg-liveElo"}];return b=b.concat([{name:"Players",type:"text",width:50,css:"jsg-livePlayers",itemTemplate:this.V1ip.bind(this)}])};c.prototype.V94=
function(){return $(this.elem).is(":visible")};var b=12,d=8;c.prototype.Vt8=function(b){if(!this.ticket||this.ticket==b.ticket)if(this.entries=[],$(this.elem).jsGrid("option","noDataContent","Position not in LiveBook"),!this.V94())this.lbInfo=b;else if(this.fnGetKernel()&&this.fnGetKernel().getCurPos){if(b.moves.length){var c=b.moves,d=this.fnGetKernel().getCurPos(),h=d.getSideToMove();6>=d.getPieces().length&&(b.sorted||CB.V1iq.V1ir(c,h==CB.Vaz.BLACK));if(!this.fnGetKernel())return;this.V1ii=this.fnGetKernel().getCurPos().getPlyNum();
for(c=d=0;c<b.moves.length;c++)d+=b.moves[c].getNVisits();this.V1if=CB.V1ig.V1ih();d=6>=this.fnGetKernel().getCurPos().getPieces().length;this.entries=[];for(c=0;c<b.moves.length;c++)if(h=b.moves[c],d||this.V1is(h)){var k=h.getMoveRecord(),h={line:this.V1it(b.position,k),nGames:h.m_performanceStats.getNGames(),Result:Math.round(h.m_performanceStats.getFPercent(b.position.isBTM()))+"%",elo:Math.round(h.m_performanceStats.getSortEloAv()),from:k.from,to:k.to,players:[],eval:h.getNEval(),nVisits:h.getNVisits(),
getStrElo:function(){return this.elo?this.elo:""},getStrNGames:function(){return this.nGames?this.nGames.toLocaleString(CB.V79.V7a(),{maximumFractionDigits:0}):"-"},getStrNVisits:function(){return this.nVisits?this.nVisits.toLocaleString(CB.V79.V7a(),{maximumFractionDigits:0}):""},getPlayers:function(){for(var b=[],c=0;c<this.players.length&&4>c;c++){var d=this.players[c].name;1600<window.innerWidth&&0==b.length&&this.players[c].year&&(d+=" ("+this.players[c].year+")");b.push(d)}return b.join(", ")},
getStrResult:function(){if(this.nGames)return this.Result;var b=this.eval;if(29750<Math.abs(b)){var c="#"+(3E4-Math.abs(b));0>b&&(c="-"+c);return c}c="";0<b&&(c="+");return c+(.01*b).toFixed(2)}};this.entries.push(h)}this.entries=this.entries.sort(function(b,c){return c.nGames==b.nGames?c.nVisits-b.nVisits:c.nGames-b.nGames});this.searchOnlineDB()}$(this.elem).jsGrid("loadData")}};c.prototype.V1is=function(b){var c=this.config.minVisits||2;return(0<b.getNGames()||300>this.V1if-b.m_nTimeStamp||b.isMyMove)&&
(b.getNVisits()>=c||b.hasEval())};c.prototype.searchOnlineDB=function(){if(V35p.onlineLobby&&V35p.panelMgr.V1iu&&V35p.panelMgr.V1iu()){var b=new CB.V1iv;b.setSearchBoard(this.fnGetKernel().game.getCurPos().board,this.fnGetKernel().game.getCurPos().getSideToMove());b.setUseBoard(!0);V35p.onlineLobby.search(b,100,this.fnGetKernel().game.getMoveNo())}};c.prototype.V1iw=function(b){if(this.V94()){for(var c=!1,d=0;d<this.entries.length;d++)this.entries[d].players=[];for(var h=0;h<b.length;h++)if(b[h].nFlags&
CB.OnlineEntryEnum.V1ix&&V35p.onlineLobby.V1iy<b[h].aGame.getCurLine().length)for(var k=b[h].aGame.getCurLine()[V35p.onlineLobby.V1iy],d=0;d<this.entries.length;d++)if(this.entries[d].from==k.from&&this.entries[d].to==k.to){var l="",m=0,p=b[h].aGame.hdr.date.year;V35p.onlineLobby.V1iy&1?(l=b[h].aGame.hdr.black.getListStr(0),m=b[h].aGame.hdr.eloWh):(l=b[h].aGame.hdr.white.getListStr(0),m=b[h].aGame.hdr.eloBl);for(var r=!1,u=0;!r&&u<this.entries[d].players.length;u++)r=this.entries[d].players[u].name==
l;if(!r){this.entries[d].players.push({name:l,elo:m,year:p});c=!0;break}}if(c){for(d=0;d<this.entries.length;d++)this.entries[d].players=this.entries[d].players.sort(function(b,c){return c.elo-b.elo}).filter(function(b){return 2400<b.elo}),8<this.entries[d].players.length&&(this.entries[d].players.length=8),this.entries[d].players=this.entries[d].players.sort(function(b,c){return c.year==b.year?c.elo-b.elo:c.year-b.year});$(this.elem).jsGrid("render")}}};c.prototype.V1it=function(b,c){for(var d=this.V1iz(ObjUtil.clone(b),
c),h=new CB.Vib(CB.V34l),k="",l=this.fnGetKernel().game.getStartPos().getBTM(),m=0;m<d.length;m++){var p=h.getMoveNota(d[m]),r=h.getStrMoveNumInLine(m,this.fnGetKernel().getCurPos().getPlyNum(),l),k=k+(r+p);m<d.length-1&&(k+=" ")}return k};c.prototype.V1iz=function(b,c){var d=[];b.isLegalMove(c)&&(b.preCalcCtx(c),b.makeMove(c),b.postCalcCtx(c,!0),d.push(c));return d};c.prototype.V1j0=function(b){};c.prototype.V1j1=function(b){this.isPremium=3==b.type;this.V1io=2==b.type||3==b.type};c.prototype.V1ij=
function(){V35p.aTBLobby&&(this.V1ie=!0,V35p.aTBLobby.addOnLiveBookDisplayListener(this.Vt8.bind(this)));V35p.onlineLobby&&V35p.onlineLobby.addOnGamesListener(this.V1iw.bind(this));V35p.addOnAccountTypeListener(this.V1j1.bind(this))};return c}();CB.V1id.factory=function(c,b,d,e){b=new CB.V1id(b||0,d,e);b.V1bp(c);return b};"use strict";
CB.V1du=function(){var c=function(b,c,f,g,h,k){this.init(b,c,f,g);this.options=h;this.gotoMove=k;this.nMove=0},b=1;c.prototype.V161=function(){};c.prototype.reset=function(){this.evArr&&(this.evArr.first=0,this.evArr.last=1,this.evArr.Vvk=[CB.EvalProfileAnno.Vvm,CB.EvalProfileAnno.Vvm]);this.V18y()};c.prototype.V18y=function(){this.cbcanvas.V15z()};c.prototype.setEvalArr=function(b){b?(this.evArr=ObjUtil.clone(b),this.cbcanvas.V15z()):this.reset()};c.prototype.init=function(c,e,f,g){this.debugName=
g;this.cbcanvas=c;this.Vmd();this.uniqueId=b++;this.V16t=new CB.Timer(this.V16u.bind(this))};c.prototype.resize=function(b,c){this.width=b;this.height=c;b&&c?this.V16t.runOnce(5):this.V16t.stop()};c.prototype.Vmd=function(){};c.prototype.V16u=function(){this.width&&this.height&&this.cbcanvas.V15z()};c.prototype.onMouseDown=function(b,c){};c.prototype.onMouseUp=function(b,c){var f=(c.x-this.V7m())/this.V1j2();this.gotoMove(Math.floor(f))};c.prototype.onMouseMove=function(b,c){};c.prototype.V16c=function(b,
c){};c.prototype.onMouseEnter=function(b,c){};c.prototype.onMouseLeave=function(b,c){};c.prototype.V163=function(b){};c.prototype.V1ct=function(b){this.nMove=b;this.width&&this.height&&this.cbcanvas.V15z()};c.prototype.draw=function(b){this.evArr&&(this.V1j3(b),this.V1j4(b),this.V1j5(b),this.V1j6(b),this.V1j7(b))};c.prototype.V7m=function(){return Math.max(2,this.height/16)};c.prototype.V1j8=function(){return Math.ceil((this.height-2*this.V7m())/2)};c.prototype.V1j9=function(){var b=this.evArr.Vvn()/
2,b=Math.floor(100*(b/100+1));200>b&&(b=200);1200<b&&(b=1200);return b};c.prototype.V1ja=function(b){if(32767==b)return 0;var c=this.V1j9(),f=0<b?1:0>b?-1:0;Math.abs(b)>c&&(b=c);b=0==b?0:Math.abs(b);c=Math.abs(c);return(this.height-2*this.V7m())/2*(b/c)*f};c.prototype.V1j3=function(b){if(this.width&&this.height){var c=b.createLinearGradient(0,0,this.width,this.height);c.addColorStop(0,"hsla( 0, 0%,  97%, 1.0 )");c.addColorStop(1,"hsla( 0, 0%, 99%, 1.0 )");b.fillStyle=c;CB.V87.fillRect(b,new CB.V7p(0,
0,this.width,this.height))}};c.prototype.V1j4=function(b){var c=this.V7m(),f=this.V1j8()+1,g=this.width-this.V7m();b.strokeStyle="black";b.lineWidth=2;b.lineCap="round";CB.V87.V8b(b,c,f,g,f)};c.prototype.V1j5=function(b){var c=this.V7m()-2,f=this.V7m(),g=f+this.height-2*this.V7m();b.strokeStyle="black";b.lineWidth=2;b.lineCap="round";CB.V87.V8b(b,c,f,c,g)};c.prototype.V1j2=function(){if(!this.evArr)return 1;var b=Math.max(30,this.evArr.last+1);return Math.max(1,(this.width-2*this.V7m())/b)};c.prototype.V1j7=
function(b){var c=(this.nMove+0)*this.V1j2()+this.V7m(),f=new CB.V7p(c,0,c+this.V1j2(),0+this.height);b.fillStyle="hsla( 30, 3%, 30%, 0.16 )";CB.V87.fillRect(b,f);f=this.cbcanvas.zoomToPix(10);b.font=String.formatEx("{0}px Roboto",f);b.fillStyle="black";var g=this.evArr.Vvk[this.nMove-this.evArr.first],h=.27*this.height,f=this.V1j8()-h;0<=g&&(f=this.V1j8()+h);h="";"undefined"!=typeof g&&g!=CB.EvalProfileAnno.Vvm&&(h=(g/100).toFixed(2),h+=", "+CB.V1co.V1cp(g));if(h){var g=b.measureText(h).width,k=
-this.V1j2();c+k+g>this.width&&(k=this.width-g-c-5);b.fillText(h,c+k,f)}};c.prototype.V1j6=function(b){var c=this.V1j2();b.strokeStyle="hsla( 0, 0%, 0%, 0.4 )";b.fillStyle="green";b.lineWidth=1;for(var f=0;f<this.evArr.last-this.evArr.first+1;f++){var g=Math.round((this.evArr.first+f)*c+this.V7m()),h=Math.round(g+c),k=this.V1j8(),l=this.evArr.Vvk[f],m=this.V1ja(l);m&&(b.fillStyle=0>m?28E3<Math.abs(l)?"hsla( 0, 30%, 30%, 1.0 )":"red":28E3<Math.abs(l)?"hsla( 120, 30%, 25%, 1.0 )":"green",l=Math.round(this.V1j8()-
m),l<k&&(m=l,l=k,k=m),g=new CB.V7p(g,k,h,l),CB.V87.fillRect(b,g),b.strokeStyle="black",CB.V87.V8a(b,g))}};return c}();CB.V1jb={V1jc:1101,V1jd:1102,V1je:1103,V1jf:1104,V1jg:1105,V1jh:1106,V1ji:1107,V1jj:1108,V1jk:1109,V1jl:1110,V1jm:1111,V1jn:1112,V1jo:1113,V1jp:1114,V1jq:1115,V1jr:1116,V1js:1117,toString:function(c){for(a in CB.V1jb)if(CB.V1jb[a]==c)return a;return c}};
CB.V1jt=function(){var c=function(b,c,e,f){this.V1ju=void 0!==b?b:CB.V1jb.V1jc;this.V1jv=void 0!==c?c:0;this.V1jw=void 0!==e?e:0;this.V1jx=void 0!==f?f:0};c.prototype.V35j=function(b){b.V35f(this.V1ju);b.V35f(this.V1jv);b.V35f(this.V1jw);b.V35f(this.V1jx);b.V35f(83);b.V35f(0);b.V35h(0);b.V35f(0);b.V35f(0)};c.prototype.toString=function(){return this.V1jy(this.V1ju)+" "+this.V1jz()};c.prototype.V1jz=function(){var b=this.V1jv+"."+this.V1jw;this.V1jx&&(b+="."+this.V1jx);CB.V5t.V63()&&(b+="c");CB.V5t.V6y()&&
8<=CB.V5t.V62()&&(b+="e");CB.V5t.V64()&&(b+="m");return b};c.prototype.V1jy=function(b){switch(b){default:return CB.V1jb.toString(b);case CB.V1jb.V1jc:return"Playchess";case CB.V1jb.V1jd:return"LiveBlitz";case CB.V1jb.V1je:return"OnlineDB";case CB.V1jb.V1jf:return"Openings";case CB.V1jb.V1jh:return"Fritz";case CB.V1jb.V1jj:return"MyGames";case CB.V1jb.V1k0:return"Training";case CB.V1jb.V1jp:return"Endgames";case CB.V1jb.V1jq:return"Live";case CB.V1jb.V1jr:return"Reader";case CB.V1jb.V1js:return"Play"}};
c.prototype.V1k1=function(){return this.V1ju<<48|this.V1jv<<32|this.V1jw<<16|this.V1jx};return c}();
CB.V1k2={V5k:0,V1k3:17,V1k4:42,V1k5:7001,V1k6:7002,V1k7:7003,V1k8:7004,V1k9:7005,V1ka:7006,V1kb:7007,V1kc:7008,V1kd:7009,V1ke:7010,V1kf:7011,V1kg:7012,V1kh:7013,V1ki:7014,V1kj:7015,V1kk:7016,V1kl:7017,V1km:7018,V15:7020,V1kn:7021,V1ko:7022,Viu:7030,V1kp:7040,V1kq:7041,V1kr:7042,V1ks:7050,V1kt:7051,V1ku:7052,V1kv:7053,V1kw:7054,V1kx:7055,V1ky:7056,V1kz:7057,V1l0:7060,V1l1:7061,V1l2:7062,V1l3:7070,V1l4:7071,V1l5:7072,V1l6:7073,V1l7:7074,V1l8:7075,V1l9:7076,V1la:7077,V1lb:7078,V1lc:7079,V1ld:7080,V1le:7081,
V1lf:7082,V1lg:7083,V1lh:7084,V1li:7085,V1lj:7086,V1lk:7087,V1ll:7088,V1lm:7089,V1ln:7090,V1lo:7091,V1lp:7092,V1lq:7100,V1lr:7101,V1ls:7102,V1lt:7103,V1lu:7104,V1lv:7105,V1lw:7106,V1lx:7107,V1ly:7108,V1lz:7109,V1m0:7110,V1m1:7111,V1m2:7112,V1m3:7113,V1m4:7200,TERABRAIN_USER:7300,V1m5:7301,V1m6:7302,V1m7:7303,V1m8:7304,V1m9:7305,TERABRAIN_BOOKINFO:7306,V1ma:7307,V1mb:7400,V1mc:7401,V1md:7402,V1me:7403,toString:function(c){for(var b in this)if(this[b]==c)return"SockMsg:"+b;return"Unknown SockMsg: "+
c},Vlu:function(c){return"SockMsgId="+c}};
CB.Vat=function(){var c=function(b){this.type=b||CB.V1k2.V5k;this._init()};c.prototype.getType=function(){return this.type};c.prototype.setType=function(b){this.type=b};c.prototype.getUserType=function(){return this.userType};c.prototype.setUserType=function(b){this.userType=b};c.prototype.getIdReceiver=function(){return this.Vaw};c.prototype.setIdReceiver=function(b){this.Vaw=b};c.prototype.V353=function(){return this.Vav};c.prototype.V356=function(b){this.Vav=b};c.prototype.setVal=function(b){this.nVal=
b};c.prototype.getVal=function(){return this.nVal};c.prototype.address=function(b,c){this.Vav=b;this.Vaw=c};c.prototype.getBuf=function(){return this.buf};c.prototype.fillSendArrBuf=function(b){var c=16;b&&(c+=4);var c=new ArrayBuffer(c+this.buf.Va0()),e=new DataView(c);e.setInt16(0,this.type);e.setInt32(2,this.nVal);e.setInt32(6,this.Vav);e.setInt16(10,this.userType);e.setInt32(12,this.Vaw);b?(e.setInt32(16,this.msgId),this.buf.Va1(e,20)):this.buf.Va1(e,16);return c};c.prototype.V1mf=function(b){if(16<=
b.byteLength){var c=new DataView(b);this.type=c.getInt16(0);this.nVal=c.getInt32(2);this.Vav=c.getInt32(6);this.userType=c.getInt16(10);this.Vaw=c.getInt32(12);20<=b.byteLength&&(this.buf.Va3(c,16),this.buf.rewind())}else throw Error("Illegal Message received");};c.prototype.toString=function(){var b="",c;for(c in CB.V1k2)if(this.type==CB.V1k2[c]){b+=c;break}this.userType&&(b+=", usr="+this.userType);b+=", sender="+this.Vav+", receiver="+this.Vaw;this.buf.getSize()&&(b+=", bufsize="+this.buf.getSize());
return b};c.prototype._init=function(){this.nVal=this.Vav=this.Vaw=this.userType=0;this.buf=new CB.V9w;this.msgId=0};return c}();CB.LoginMode={NORMAL:1,GUEST:2};CB.V1mg={V1mh:0,V1mi:1,Vo:2,V1mj:3};CB.V1mk={V1ml:32,V1mm:128};
CB.V1mn=function(){var c=function(b,c,e,f,g,h){this.strName=b;this.strPass=c;this.V1mo=e;this.version=V35p.versionCode;this.guid=f;this.language=CB.V79.V7a();this.V1mp=CB.V5t.V6i();this.V1mq="";this.V1mr=document.referrer;this.token=g||"";this.app=h||"";this.flags=0;this.documentUrl=""};c.prototype.V34w=function(b){var c=new CB.Vat(CB.V1k2.V1k6);c.address(CB.V1mt.UNKNOWN,CB.V1mt.V1mu);c.getBuf().V35h(this.V1mo);this.version.V35j(c.getBuf());var e=this.strName;CB.V47.V4c(e)&&!CB.V47.V4b(e)&&(e=CB.V47.V48(e));
var f=this.strPass;CB.V47.V4c(f)&&!CB.V47.V4b(f)&&(e=CB.V47.V48(f));c.getBuf().V34s(e);c.getBuf().V34s(f);this.guid.V35j(c.getBuf());c.getBuf().V34p(this.language);c.getBuf().V34p(navigator.platform);c.getBuf().V35h(this.V1mp);c.getBuf().V34s(this.V1mq);c.getBuf().V34p(this.token);c.getBuf().V34s(0<this.V1mq.length?this.V1mr:"");c.getBuf().V34p(this.app);b&&(this.flags|=CB.V1mk.V1mm);c.getBuf().V35h(this.flags);c.getBuf().V34p(navigator.appVersion);c.getBuf().V34p(this.documentUrl);return c};return c}();
"use strict";CB.V1mv=function(){var c=function(){this.nId=CB.V1mt.V5k;this.V1my=this.V1mx=this.V1mw=0;this.strUserId=this.strToken="";this.V355=0};c.prototype.fromSocketsMsg=function(b){b.getBuf().rewind();this.V1mw=b.getBuf().V35k();this.V1mx=b.getBuf().V35k();this.nId=b.getBuf().V35k();this.V1mz=b.getBuf().V35k();this.strToken=b.getBuf().V34q(200);this.V355=b.getBuf().V35l();this.strUserId=b.getBuf().V34q(200)};return c}();
CB.ChatData=function(){var c=function(){this.Vaw=this.Vav=CB.V1mt.V5k;this.V1n1=this.V1n0=0;this.strMsg="";this.V1n2=0;this.V1n3="";this.V1n5=this.flags=this.V1n4=0;this.V1n6=[];this.token=0};c.prototype.V1n7={ITALIC:1,UNDERLINE:2,UTF8:256,AUTOMATIC:4096,TO_GROUP:8192,TO_OBSERVERS:16384,TO_CHANNEL:32768,TO_INDIVIDUALS:65536,TO_OBSERVERSANDPLAYERS:131072,TO_SESSION:262144};c.prototype.V34w=function(){var b=new CB.Vat(CB.V1k2.V15);b.address(this.Vav,this.Vaw);var c=b.getBuf();c.V35f(this.V1n0);c.V35f(this.V1n1);
c.V34p(this.strMsg);c.V35f(this.V1n2);c.V34p(this.V1n3);c.V35h(this.V1n4);c.V35h(this.V1n5);c.V35h(this.flags);if(this.V1n8()){c.V35h(this.V1n6.length);for(var e=0;e<this.V1n6.length;e++)c.V35h(this.V1n6[e])}c.V351(this.token);return b};c.prototype.fromSocketsMsg=function(b){var c=b.getBuf();this.Vaw=b.getIdReceiver();this.Vav=b.V353();c.rewind();this.V1n0=c.V35l();this.V1n1=c.V35l();try{this.strMsg=c.V34q(1E3)}catch(f){CB.Vjg("Chat Msg Len exception, sender="+this.Vav)}this.V1n2=c.V35l();try{this.V1n3=
c.V34q(210)}catch(f){CB.Vjg("Chat Sender exception, msg="+this.strMsg+", sender="+this.Vav)}this.V1n4=c.V35k();this.V1n5=c.V35k();this.flags=c.V35k();if(this.V1n8()){b=c.V35k();for(var e=0;e<b&&500>e;e++)this.V1n6.push(c.V35k())}this.token=c.V35g()};c.prototype.toString=function(){var b="";0<this.V1n3.length&&(b+="<em>"+this.V1n3+":</em> ");return b+=this.strMsg};c.prototype.V1n8=function(){return 0!=(this.flags&this.V1n7.TO_INDIVIDUALS)};c.prototype.V1n9=function(b){CB.V4o(this,this.V1n7.TO_INDIVIDUALS,
b)};c.prototype.V1na=function(){return CB.V4p(this.flags,this.V1n7.TO_SESSION)};c.prototype.V1nb=function(b){CB.V4o(this,this.V1n7.TO_SESSION,b)};c.prototype.V1nc=function(){return CB.V4p(this.flags,this.V1n7.TO_OBSERVERS)};c.prototype.V1nd=function(b){CB.V4o(this,this.V1n7.TO_OBSERVERS,b)};c.prototype.V1ne=function(){return this.V1n4};c.prototype.V1nf=function(b){this.V1n4=b};c.prototype.V1ng=function(b){CB.V4o(this,this.V1n7.AUTOMATIC,b)};c.prototype.V1nh=function(){return 0!=(this.flags&this.V1n7.AUTOMATIC)};
c.prototype.V1ni=function(b){b.length?(this.Vaw=b[0],this.V1n6=b):(this.Vaw=b,this.V1n6.push(b))};c.prototype.V1nj=function(){window.chat=new c;chat.V1n1=2;chat.V1n0=1;chat.V1n2=3;chat.V1n4=4;chat.V1n5=5;chat.strMsg="Hello World!";chat.V1n3="Doktor Schiwago";var b=chat.V34w();window.chat2=new c;chat2.fromSocketsMsg(b);return chat2.strMsg!==chat.strMsg?"test failed":"test OK"};return c}();CB.V1mt={V5k:0,UNKNOWN:0,V1mu:1};CB.V1nk={CONNECTING:0,V1nl:1,V1nm:2,V1nn:3};
CB.V1no=function(){var c=function(b,c){this.V1np=CB.V1mt.V5k;this.uris=[].concat(c);this.V1nq=0;V35p&&void 0!=V35p.config.nBridge&&V35p.config.nBridge<this.uris.length&&(this.V1nq=V35p.config.nBridge);this.wsUri=this.uris[this.V1nq];this.msgsWaitingToSend=new CB.V1nr;this.msgsWaitingToSendNoId=new CB.V1nr;this.V1ns=function(b){};this.onClose=function(b){};this.isFirstConnect=!0;this.firstConnectTries=0;this.V1nt=function(){};this.onServerDown=function(){};this.lobby=b;this.V34u=0;this.error=!1;this.V1nu=
new CB.V4y;this.weAreAliveTicker=new CB.V4y;this.tryTimer=new CB.Timer(this.V1nv.bind(this));this.V1nw=200;this.V1nx=0};c.prototype.open=function(){try{this.socket=new WebSocket(this.wsUri);var b=this;this.error=!1;this.socket.onopen=function(){for(;!b.msgsWaitingToSendNoId.empty();)b.socket.readyState==CB.V1nk.V1nl?b.sendMessage(b.msgsWaitingToSendNoId.pop(),!0):b.msgsWaitingToSendNoId.pop();for(;!b.msgsWaitingToSend.empty();)b.socket.readyState==CB.V1nk.V1nl?b.sendMessage(b.msgsWaitingToSend.pop(),
!1):b.msgsWaitingToSend.pop();this.V1nw=200;(new CB.Timer(function(){b.lobby.onConnect()})).runOnce(20)};this.socket.onclose=function(c){5;b.onClose(b);if(void 0!==b.onBroken)b.onBroken();1E3<c.Code&&(V35p.V1ny(b.lobby.getName()+"-Close="+c.Code),console.log("Close: "+closeCodes[c.Code]))};this.socket.onerror=function(c){console.log(b.wsUri);b.isFirstConnect&&1<b.uris.length&&4>++b.firstConnectTries?(b.switchConnection(),b.open()):(b.error=!0,b.onSocketError(b))};this.socket.onmessage=function(c){b.tryTimer.stop();
if(c.data instanceof ArrayBuffer){var e=new CB.Vat;try{e.V1mf(c.data)}catch(f){EXCEPTION(f.toString())}b.V34k(e);b.weAreAliveTicker.start()}else console.log("RESPONSE: "+c.data);b.V34u=0}}catch(c){CB.Vjg("Conn",c)}};c.prototype.close=function(){this.socket&&this.socket.close();this.tryTimer.stop()};c.prototype.Vrb=function(){return this.socket&&this.socket.readyState==CB.V1nk.V1nl};c.prototype.V1nz=function(){return this.socket&&this.socket.readyState==CB.V1nk.CONNECTING};c.prototype.onSocketError=
function(){this.isFirstConnect?(this.onServerDown(),this.lobby.V1o0&&this.lobby.V1o0.stop(),this.tryTimer.runPeriodic(3E4)):(this.V1nt(),this.tryTimer.runPeriodic(this.V1nw))};c.prototype.V34k=function(b){this.isFirstConnect=!1;var c=!0;switch(b.getType()){default:c=!1;break;case CB.V1k2.V1k8:this.V1o1(b);break;case CB.V1k2.V1k5:c=!1}c||this.lobby.V1o2(b)};c.prototype.V1o1=function(b){var c=new CB.V1mv;c.fromSocketsMsg(b);this.V1np=c.nId;this.lobby.V1o3(c);this.V1ns(this)};c.prototype.sendMessage=
function(b,c){if(!b.getType()||!this.socket)throw Error("Sending invalid sockMsg");b.msgId=c?0:++this.V1nx;b.getIdReceiver()==CB.V1mt.V5k&&b.setIdReceiver(CB.V1mt.V1mu);b.V356(this.V1np);if(this.socket.readyState==CB.V1nk.V1nl){this.socket.binaryType="arraybuffer";var e=b.fillSendArrBuf(!c);this.socket.send(e)}else this.socket.readyState==CB.V1nk.CONNECTING?c?this.msgsWaitingToSendNoId.push(b):this.msgsWaitingToSend.push(b):this.socket.readyState!=CB.V1nk.V1nm&&this.socket.readyState!=CB.V1nk.V1nn&&
(this.error=!0,this.onSocketError())};c.prototype.V1o4=function(b){this.socket&&1==this.socket.readyState&&(console.log("SENT: "+b),this.socket.send(b))};c.prototype.V1o5=function(){this.close()};c.prototype.V1nv=function(){this.tryTimer.runPeriodic(1E4);this.socket&&this.socket.readyState!=CB.V1nk.V1nl&&this.error&&(this.V34u+=1,1<=this.V34u&&(this.isFirstConnect||6<this.V34u)&&this.switchConnection(),this.lobby.V1o6&&this.lobby.V1o6(!0,1==this.V34u?2E3:6E3,!0),5<this.V34u&&this.tryTimer.runPeriodic(5E4+
3E4*Math.random()))};c.prototype.switchConnection=function(){this.V1nq++;this.V1nq>=this.uris.length&&(this.V1nq=0);this.wsUri=this.uris[this.V1nq];console.log("Switch Conn: "+this.wsUri);this.lobby.V1o7&&this.lobby.V1o7(this.V1nq)};return c}();
CB.V1o8=function(){var c=function(b){this.guid=new CBGuid;this.password=this.userName="";this.V1o9=!0;var c="ClientGUID"+b,e=null,f=window;f.localStorage?e=f.localStorage:f.sessionStorage&&(e=f.sessionStorage);if(e&&e[c]){b=JSON.parse(e[c]);for(var g in b)this.guid[g]=b[g]}else this.guid=new CBGuid,this.guid.fromRandom(b),e&&(e[c]=JSON.stringify(this.guid))};c.prototype.toString=function(){return"User="+this.userName+", mode="+this.loginMode};c.prototype.V1ob=function(){this.save("user",this.userName)};
c.prototype.V1oc=function(){this.userName=this.load("user")};c.prototype.V1od=function(){var b=null,c=window;c.sessionStorage?b=c.sessionStorage:c.localStorage&&(b=c.localStorage);return b};c.prototype.V1oe=function(b,c,e){this.room=b;this.set("room",b);this.set("roomurl",c);this.set("banner",e)};c.prototype.V1of=function(){this.room="";this.set("room","");this.set("roomurl","");this.set("banner","");this.set("gradient","")};c.prototype.V1og=function(b,c){this.set("banner",b);this.set("gradient",
c)};c.prototype.V1oh=function(b){this.set("seek",b)};c.prototype.Val=function(b,c){this.V1od()[c]=b};c.prototype.get=function(b){return this.V1od()[b]||""};c.prototype.set=function(b,c){this.V1od()[b]=c};c.prototype.load=function(b){return window.localStorage?window.localStorage[b]||"":""};c.prototype.save=function(b,c){window.localStorage&&(window.localStorage[b]=c)};c.prototype.V1oi=function(){return this.get("kibitz")};c.prototype.V1oj=function(){if(!CB.V5t.V64()){var b=this.get("layout");return b&&
0<=b.search("engine")}};c.prototype.V1ok=function(){return this.get("layout")};c.prototype.V1ol=function(){return this.V1oi()&&this.V1om()};c.prototype.V1om=function(){var b=this.get("layout");return b&&0<=b.search("nomenu")};c.prototype.V1on=function(){var b=this.get("layout");return b&&0<=b.search("noplayers")};c.prototype.V1oo=function(){var b=this.get("layout");return b&&0<=b.search("nolists")};c.prototype.V1op=function(){var b=this.get("layout");return b&&0<=b.search("nochat")};c.prototype.noBook=
function(){var b=this.get("layout");return b&&0<=b.search("nobook")};c.prototype.V1oq=function(){var b=this.get("layout");return b&&0<=b.search("nonota")};c.prototype.V1or=function(){return this.get("room")};c.prototype.V1os=function(){return this.get("roomurl")};c.prototype.V1ot=function(){return this.get("banner")};c.prototype.V1ou=function(){return this.get("gradient")};c.prototype.V1ov=function(){return this.get("play")};c.prototype.V1ow=function(){return this.get("play")};c.prototype.V1ox=function(){var b=
{banner:this.V1ot(),gradient:this.V1ou(),room:this.V1or(),roomUrl:this.V1os()};this.V1oy(b)};c.prototype.V1oz=function(){var b=this.V1p0();b&&(this.V1p1(),this.V1og(b.banner,b.gradient))};c.prototype.V1oy=function(b){b=JSON.stringify(b);window.localStorage&&(window.localStorage.AcrossLogin=b)};c.prototype.V1p1=function(b){window.localStorage&&delete window.localStorage.AcrossLogin};c.prototype.V1p0=function(){if(window.localStorage){var b=window.localStorage.AcrossLogin;if(b)return JSON.parse(b)}};
c.prototype.V1p2=function(b){this.V1p3="";b||CB.DOM.V1p4("AccountName64");CB.DOM.V1p4("AccountToken");CB.DOM.V1p4("AccountMode");CB.DOM.V1p5("CBCOMMON","")};c.prototype.V1p6=function(){CB.DOM.V1p5("CBCOMMON","")};c.prototype.V1p7=function(){this.V1o9&&this.V1p3&&CB.DOM.V1p5("AccountToken",this.V1p3)};c.prototype.V1p8=function(){CB.DOM.V1p4("AccountToken");this.V1p3=""};c.prototype.V1p9=function(){return this.userName&&"guest"!=this.userName&&(this.V1p3||this.password)};c.prototype.V1pa=function(b){!this.V1p3&&
this.password&&this.loginMode==CB.LoginMode.NORMAL&&(new CB.Timer(function(){(new CB.V1pb(b)).pwLogin(this.userName,this.password,function(b){b&&b.Token&&(this.V1p3=unescape(b.Token),this.V1p7(),CB.DOM.V1pc(this.userName),CB.DOM.V1p5("AccountMode",CB.LoginMode.NORMAL))}.bind(this))}.bind(this))).runOnce(100)};return c}();"use strict";CB.namespace("CB.Server.V1pd");CB.Server.V1pd={V1pe:0,V1pf:1,V1pg:2,V1ph:3};CB.namespace("CB.Server.V1pi");
CB.Server.V1pi=function(){var c=function(){this.Vte=!1;this.V1pj=12E3;this.V1pk=5E3;this.V1pl=[];this.V1pm=!0;this.name="...";this.V1po=this.V1pn=0;this.V1pp=!0};c.prototype.create=function(b,c,d,e,l){this.V1pq=new CB.Timer(this.V1pr.bind(this));this.user=c;this.V1ps=CB.V47.V48(c);this.pass=d;this.conn=new CB.V1no(this,b);this.loginMode=e;this.token=l;this.V1pt=CB.V53();this.V34u=0;this.V1pu=new CB.Timer;this.V1pv=3E3;this.conn.V1nt=this.V1pw.bind(this);this.conn.onServerDown=this.V1px.bind(this);
this.V1py=!1;e!=CB.LoginMode.GUEST&&CB.DOM.V1pc(c);this.V1o0=new CB.Timer(this.V1pz.bind(this))};c.prototype.V1px=function(b){if(void 0!==this.onServerDown)this.onServerDown();this.Vte=!1};c.prototype.V1pw=function(b){void 0!==this.V1q0&&this.V1q0();this.Vte=!1;this.V1q1()};c.prototype.getName=function(){return"Connector"};c.prototype.V1q2=function(b,c,d,e){this.V1pq&&this.V1pq.stop();this.V1q4=this.V1q3=!1;this.V1pq=new CB.Timer(this.V1pr.bind(this));this.Vrb()&&this.Vte&&this.logOff();this.V1q5();
this.user=b;this.V1ps=CB.V47.V48(this.user);this.pass=c;this.token=e;this.loginMode=d;this.V1pt=CB.V53();this.V34u=0;this.V1pu=new CB.Timer;this.V1pv=3E3;(new CB.Timer(this.V1q6())).runOnce(100);d!=CB.LoginMode.GUEST&&CB.DOM.V1pc(b)};var b=new CB.V35b;c.prototype.V1q7=function(){b.exec(function(){this.loginMode=this.pass?CB.LoginMode.NORMAL:CB.LoginMode.GUEST;this.V1q2(this.user,this.pass,this.loginMode,this.token);this.V34u++;this.V1pu.stop()}.bind(this),10*this.V34u)};c.prototype.V1q6=function(){this.conn.close();
this.Vte=!1;this.V1q8()};c.prototype.V1q8=function(){this.conn&&(this.V1py=this.Vte=!1,this.conn.open(),this.V1q9(lm.CONNECTING,"LogBold"),this.V1o0.runPeriodic(this.V1pj),this.V1pn++)};c.prototype.Vrb=function(){return this.conn?this.conn.Vrb():!1};c.prototype.V1nz=function(){return this.conn?this.conn.V1nz():!1};c.prototype.isLoggedIn=function(){return this.V1py&&this.Vrb()};c.prototype.wasLoggedIn=function(){return!this.V1pm&&!this.Vrb()};c.prototype.V1ms=function(){return!1};c.prototype.V1qa=
function(){this.V1q9(this.V1qb(),"LogGreen","conn");var b=V35p.V34z.guid;CB.V5t.V6c()&&b.fromRandom(10);b=this.V1qc(b,!0);this.V1qd(b);this.V1qe(b.V34w(this.V1ms()));this.V1q4=!1};c.prototype.V1qf=function(){if(!this.Vte){this.V1py=!1;this.V1q9(this.V1qb(),"LogGreen","conn");var b=this.V1qc(V35p.V34z.guid,!1);this.V1qd(b);this.V1qe(b.V34w(this.V1ms()));this.V1q4=!1}};c.prototype.V1qd=function(b){};c.prototype.V1qc=function(b,c){return c?new CB.V1mn("Guest","Pass",CB.LoginMode.GUEST,b):new CB.V1mn(this.user,
this.pass,CB.LoginMode.NORMAL,b,this.token)};c.prototype.V1p2=function(){V35p.V34z&&V35p.V34z.V1p2(!0)};c.prototype.V1qb=function(){return"Waiting for Server"};c.prototype.logOff=function(){this.V1o0&&this.V1o0.stop();if(this.Vte&&this.Vrb()){var b=new CB.Vat(CB.V1k2.V1k7);b.address(this.conn.V1np,CB.V1mt.V1mu);b.buf.V35h(0);this.send(b);this.loginMode=CB.LoginMode.GUEST}this.V1qh()};c.prototype.V1qh=function(){this.V1o0&&this.V1o0.stop();this.Vte=this.V1py=!1;this.V1q4=!0};c.prototype.V1q5=function(){};
c.prototype.V1qi=function(){V35p.V34z&&V35p.V34z.V1ox&&V35p.V34z.V1ox();this.logOff(!0);window.location.replace(V35p.V1qj())};c.prototype.V1qk=function(){this.V1ql("Sorry, cannot reach the "+this.name+"V1qm. It is in maintenance. Please try again in 15 minutes.","LogBold");this.conn.close();this.V1p2()};var d=new CB.V35b;c.prototype.V1o6=function(b,c,e){if(this.V1q3)this.V1q9(lm.PLEASE_LOGIN_SHORT);else if(this.conn&&this.conn.error&&!this.conn.Vrb()&&this.V1q8(),this.Vte||e)50<this.V1po++||d.exec(function(){this.V1qn(CB.V1k2.V1kp);
b||this.V1ql("Testing Connection to Server");this.V1pt=CB.V53();this.V1pq.isActive()||this.V1pq.runOnce(c||6E3);this.V1pp=b;this.V1o0.runPeriodic(this.V1pj)}.bind(this),500)};c.prototype.V1pr=function(){this.V1q9(lm.RECONNECT);this.V1q8()};c.prototype.V1pz=function(){var b=this.conn.weAreAliveTicker.V52();b>this.V1qo()&&(this.V1o6(!0,this.V1qp(),!0),b>this.V1qo()+this.V1o0.V4v()&&this.V1q1(b))};c.prototype.V1q1=function(b){};c.prototype.V1qp=function(){return 6E3};c.prototype.V1qo=function(){return 2E4};
c.prototype.V1qq=function(){var b=CB.V53()-this.V1pt;this.V1pv=b/2;this.V1pp||(this.V1ql("Ping="+b+"ms"),V35p.V1ft.V1gq(),this.V1q9("Server OK"));this.V1qr&&this.V1qr(b);this.V1pq.stop();this.V1po=0};c.prototype.V1qs=function(){this.V1qn(CB.V1k2.V1kj)};c.prototype.V1qt=function(b){this.V1qn(CB.V1k2.V1kb,b);this.V1pt=CB.V53()};c.prototype.V1qu=function(b){this.conn.tryTimer.stop();var c="Possibly for maintenance.";switch(b.getBuf().V35k()){case CB.Server.V1pd.V1pf:c="Administrator action.";break;case CB.Server.V1pd.V1pe:c=
"Planned server maintenance in progress.";break;case CB.Server.V1pd.V1pg:c="Double Login.";break;case CB.Server.V1pd.V1ph:c="User inactive."}V35p.config.V1qv||this.V1qw(c);this.V1q3=!0;this.V1qh()};c.prototype.V1qw=function(b){this.V1q9("Server logged you off: "+b,"LogForceLogOff")};c.prototype.V1qx=function(){};c.prototype.V1qy=function(){return this.conn.V1np};c.prototype.V1qz=function(){return void 0!==this.V1r0?this.V1r0:0};c.prototype.V1qg=function(){return this.V1r1?this.V1r1.V1qg():this.loginMode==
CB.LoginMode.NORMAL&&this.Vte?!1:!0};c.prototype.isPremium=function(){return this.V1qg?!1:this.V1r1.isPremium()};c.prototype.V1r2=function(){};c.prototype.onConnect=function(){this.V1r2();this.V1pk=5E3;this.V1pq.stop();this.loginMode!=CB.LoginMode.NORMAL||V35p.V1r3()?this.V1qa():this.V1qf()};c.prototype.V1o3=function(b){this.Vte=!0;this.V34u=0;this.V1pu.stop();this.V1pm=!1;this.V355=b.V355;b.strToken&&!V35p.V34z.V1p3&&(V35p.V34z.V1p3=b.strToken,V35p.V34z.V1p7());b.strUserId&&"guest"!=b.strUserId.toLowerCase()&&
(this.user=CB.V47.V49(b.strUserId),V35p.V34z.userName=this.user,this.V1ps=b.strUserId,this.loginMode==CB.LoginMode.NORMAL&&CB.DOM.setCodedCookie("AccountBackName64",this.user));this.V1r4(b);if(V35p.panelMgr.onLoggedIn)V35p.panelMgr.onLoggedIn(this.loginMode==CB.LoginMode.NORMAL);this.V1pl.forEach(function(b){this.send(b)}.bind(this));this.V1pl=[]};c.prototype.V1r4=function(){};c.prototype.V1r5=function(b){var c=!0;switch(b.getType()){default:c=!1;break;case CB.V1k2.V1k5:this.V1qs();break;case CB.V1k2.V1kd:this.V1qk();
break;case CB.V1k2.V1k9:case CB.V1k2.V1kg:this.V1r6();break;case CB.V1k2.V1ki:this.V1r7();break;case CB.V1k2.V1ke:this.V1r8();break;case CB.V1k2.V1kk:this.V1r9();break;case CB.V1k2.V1kl:this.V1ra();break;case CB.V1k2.V1kq:this.V1qq(b);break;case CB.V1k2.V1kb:this.V1rb(b);break;case CB.V1k2.V1kc:this.V1rc(b);break;case CB.V1k2.V1kf:this.V1qu(b);break;case CB.V1k2.V1kh:this.V1rd(b);case CB.V1k2.V1km:}return c};c.prototype.V1r6=function(){this.V1q9("Sorry, your account '"+this.user+"' or your password is not valid.",
"LogError");this.Vte=!1;this.V1p2();this.V1pq.stop();this.V1o0.stop();if(this.onInvalidPassword)this.onInvalidPassword();else alert("Sorry, your password is not valid")};c.prototype.V1r7=function(){this.V1q9("Sorry, your account is currently locked. Please wait one hour...","LogError");this.Vte=!1;this.V1p2();alert("Account currently locked.")};c.prototype.V1rd=function(b){b.getBuf().V35k();var c=b.getBuf().V34q(200);this.token=c;this.V355=b.getBuf().V35k();b=b.getBuf().V34q(200);V35p.V34z.V1p3=c;
b&&(this.user=V35p.V34z.userName=CB.V47.V49(b),this.V1ps=b);V35p.V34z.V1p7();CB.DOM.V1p5("AccountMode","1");this.V1re&&this.V1re()};c.prototype.V1r8=function(){this.V1q9("Already logged on: "+this.user+". Please log off or wait a few minutes.","LogBold");alert("Already logged on: "+this.user);CB.V139&&CB.V139.V13b()};c.prototype.V1ra=function(){CB.V139&&CB.V139.V13b()};c.prototype.V1r9=function(){CB.V139&&CB.V139.V13b();this.V1pu.stop();this.V1o0.stop()};c.prototype.V1rf=function(){this.Vte&&(this.logOff(),
window.location.replace(V35p.V1rg()+"?user="+V35p.V34z.userCoded+"&token="+V35p.V34z.V1p3))};c.prototype.V1rh=function(){return!0};c.prototype.V1ql=function(b,c,d){this.V1rh()||(void 0===c&&(c="LogIntoChat"),V35p.panelMgr.V1ri&&b&&V35p.panelMgr.V1ri(b.toString(),c,d))};c.prototype.V1q9=function(b,c,d){this.V1ql(b,c,d);V35p.panelMgr.V1q9&&V35p.panelMgr.V1q9(b)};c.prototype.V1rb=function(b){this.V1qn(CB.V1k2.V1kc,b.V353())};c.prototype.V1rc=function(b){var c=CB.V53()-this.V1pt;this.V1ql("Ping "+this.V1rj.V1rk[b.V353()]+
"="+c+"ms","clsPing");this.V1pq.stop();this.V1rl&&b.V353()!=this.V1qz()&&this.V1rl(b.V353())};c.prototype.V1rm=function(b){};var e={};c.prototype.V1qn=function(b,c){e=new CB.Vat(b);var d=c;d||(d=CB.V1mt.V1mu);e.address(this.V1qy(),d);this.send(e)};c.prototype.send=function(b,c){if(!this.V1q3&&!this.V1q4)try{0==b.V353()&&b.V356(this.V1qy()),0==b.getIdReceiver()&&b.setIdReceiver(CB.V1mt.V1mu),this.conn.sendMessage(b,!this.V1ms()),this.conn.error&&this.V1q9(this.name+" not connected...","LogCAPError"),
this.conn.error&&c&&this.V1pl.push(b),this.conn.Vrb()||this.V1rn()}catch(d){this.V1rn()}};c.prototype.V1qe=function(b){try{0==b.V353()&&b.V356(this.V1qy()),0==b.getIdReceiver()&&b.setIdReceiver(CB.V1mt.V1mu),this.conn.sendMessage(b,!0),this.conn.Vrb()||this.V1rn()}catch(c){this.V1rn()}};c.prototype.V1rn=function(){this.V1pu.isActive()||this.V1ro||(this.V1pu.runOnce(Math.min(6E4,this.V1pk+1E3*this.V34u),function(){this.V1o6(!0)}.bind(this)),this.V34u++,3==this.V34u&&this.V1rp())};c.prototype.V1rp=
function(){};return c}();"use strict";
CB.V1rq=function(){var c=function(b,c,e){this.cloudId=b;this.V12s=this.V1rr=e;this.nGames=c;this.V1rs=[];this.V1rt=[];this.V1ru=[];this.idHeaderListener=this.V1rr.addOnHeadersChangedListener(this.V1rv.bind(this));this.V1rw=this.V1rr.addOnGameChangedListener(this.V1rx.bind(this));this.V1ry=this.V1rr.addOnGamesChangedByGameNoListener(this.V1rz.bind(this));this.V1s0=this.V1rr.addOnHeadersChangedByGameNoListener(this.V1rz.bind(this));this.V1s1=this.V1rr.addOnGameAppendedListener(this.V1s2.bind(this));this.V1s3=
this.V1rr.addOnChangeLoginListener(this.V1q5.bind(this));this.V1s4=this.V1rr.addOnReorganizedListener(this.V1s5.bind(this));this.V1s6=this.V1rr.addOnDeletedListener(this.V1s7.bind(this));this.V1s8=this.V1rr.V1s9(this.cloudId)};CB.inherit(c,CB.V12n);c.prototype.destroy=function(){this.V1rr.removeOnHeadersChangedListener(this.idHeaderListener);this.V1rr.removeOnGameChangedListener(this.V1rw);this.V1rr.removeOnGamesChangedByGameNoListener(this.V1ry);this.V1rr.removeOnHeadersChangedByGameNoListener(this.V1s0);
this.V1rr.removeOnGameAppendedListener(this.V1s1);this.V1rr.removeOnChangeLoginListener(this.V1sa);this.V1rr.removeOnReorganizedListener(this.V1sb);this.V1rr.removeOnDeletedListener(this.V1sc);this.V1rs=[]};c.prototype.toString=function(){return this.V1s8.title+"/"+this.cloudId};c.prototype.V12v=function(){return!1};c.prototype.V12w=function(){return!0};c.prototype.V12x=function(){return this.V1s8&&this.V1s8.type==CB.V1sd.V1se};c.prototype.V12p=function(b){void 0===b.idHeaderListener&&(b.idHeaderListener=
this.addOnGameHeadersChangedListener(b.onGameHeadersChanged.bind(b)));void 0===b.idDBLengthListener&&(b.idDBLengthListener=this.addOnDBLengthListener(b.onDBLengthListener.bind(b)));void 0===b.idDBDeletedListener&&(b.idDBDeletedListener=this.addOnDBDeletedListener(b.onDBDeletedListener.bind(b)));b.removeListeners=function(){this.removeOnGameHeadersChangedListener(b.idHeaderListener);this.removeOnDBLengthListener(b.idDBLengthListener);this.removeOnDBDeletedListener(b.idDBDeletedListener);delete b.idHeaderListener;
delete b.idDBLengthListener;delete b.idDBDeletedListener}.bind(this)};c.prototype.V1sf=function(){this.headers=[];this.V1rs=[];this.V1rt=[];this.V1ru=[]};c.prototype.getGameCount=function(){return this.nGames};c.prototype.setSubSet=function(b){this.superClass.setSubSet.call(this,b);this.fireOnDBLength(this.V135())};c.prototype.V134=function(){this.superClass.V134.call(this,arguments);this.fireOnDBLength(this.getGameCount())};c.prototype.V12q=function(){return this.cloudId};c.prototype.V12y=function(){return"Cloud: "+
CB.V47.V49(this.V1s8.owner+" - "+this.V1s8.title)};c.prototype.getHeaderJson=function(b){if(1>b||b>this.nGames)ASSERT(0);else{var c;void 0===this.headers[b]?(this.V1rs[b]||(this.V1rs[b]=1,this.V1rr.V1sg(this.cloudId,b)),c=new CB.Vgz,this.fillPlaceHolderHeader(c,b),c.nGame=b,this.headers[b]=c,void 0===this.headers[b].loadCnt?this.headers[b].loadCnt=0:this.headers[b].loadCnt++):c=this.headers[b];return c.toJson()}};c.prototype.V130=function(b,c,e){e>this.V135()&&(e=this.V135());if(!this.V1sh(c,e)){var f=
this;b={first:c,last:e,jsons:[],callback:b,count:0,calls:1,complete:function(){return this.count==this.last-this.first+1},addHeader:function(b){var c=f.getSetInxOfGameNo(b.nGame);c>=this.first&&c<=this.last&&!this.jsons[c-this.first]&&(this.jsons[c-this.first]=b.toJson(),this.count++)},timeOut:function(){for(var b=0;b<this.last-this.first+1;b++)if(!this.jsons[b]){var c=new CB.Vgz;f.fillPlaceHolderHeader(c,f.getGameNoInSet(b+1));this.jsons[b]=c.toJson()}try{for(b=0;b<this.calls;b++)this.callback(this.jsons)}catch(d){}this.timeout=
!0}};this.V1rt.push(b);b.timer=new CB.Timer(b.timeOut.bind(b));for(e<c?b.timer.runOnce(100):b.timer.runOnce(1E4);c<=e&&c<=this.V135();c++)if(b=this.getGameNoInSet(c)){if(!this.V1rs[b]&&(this.V1rs[b]=1,this.V1rr.V1sg(this.cloudId,b),void 0===this.headers[b])){var g=new CB.Vgz;this.fillPlaceHolderHeader(g);g.nGame=b;this.headers[b]=g}this.headers[b].loadCnt=0}}};c.prototype.V1sh=function(b,c){for(var e=0;e<this.V1rt.length;e++){var f=this.V1rt[e];if(f&&f.first<=b&&f.last>=c&&!f.timeout)return this.V1rt[e].calls++,
!0}return!1};c.prototype.V1rv=function(b){for(var c=0;c<b.length;c++)b[c].header.loadCnt=void 0!==this.headers[b[c].nGame]?++this.headers[b[c].nGame].loadCnt:0,this.headers[b[c].nGame]=b[c].header,this.V1rs[b[c].nGame]=0;for(var e=0;e<this.V1rt.length;e++)if(this.V1rt[e])for(c=0;c<b.length;c++)this.V1rt[e].addHeader(b[c].header);for(e=0;e<this.V1rt.length;e++)if(this.V1rt[e]&&this.V1rt[e].complete()){c=this.V1rt[e];this.V1rt[e].timer.stop();try{for(var f=0;f<c.calls;f++)this.V1rt[e].callback(this.V1rt[e].jsons)}catch(g){}delete this.V1rt[e]}c=
!1;for(e=0;c&&e<this.V1rt.length;e++)this.V1rt[e]&&this.V1rt[e].timeout&&(c=!1);c&&(this.V1rt=[]);this.fireOnGameHeadersChanged(b)};c.prototype.fillPlaceHolderHeader=function(b,c){b.white=new CB.PlayerData("Waiting for Server...");b.loadCnt=0;b.nGame=c};c.prototype.getGame=function(b){return new CB.Game};c.prototype.loadGameAsync=function(b,c){if(!(c>this.getGameCount())){var e=this,f={gameNo:c,game:new CB.Game,callback:b,loaded:!1,setGame:function(b){b.getGameNo()==c&&(this.game=b,this.loaded=!0)},
timeOut:function(){for(var b=0;b<this.last-this.first+1;b++)if(!this.jsons[b]){var c=new CB.Vgz;e.fillPlaceHolderHeader(c);this.game.setHeader(c);this.loaded=!0}this.callback(this.game);this.timeout=!0}};f.timer=new CB.Timer(f.timeOut.bind(f));f.timer.runOnce(1E4);this.V1ru.push(f);this.V1rr.loadGame(this.cloudId,c)}};c.prototype.V1rx=function(b){if(b.cloudId==this.cloudId){for(var c=0;c<this.V1ru.length;c++)this.V1ru[c]&&this.V1ru[c].setGame(b.game);for(c=0;c<this.V1ru.length;c++)this.V1ru[c]&&this.V1ru[c].loaded&&
(this.V1ru[c].timer.stop(),this.V1ru[c].callback(this.V1ru[c].game),delete this.V1ru[c]);this.V9t(this.V1ru)}};c.prototype.V1rz=function(b){if(b.cloudId==this.cloudId){for(var c=this.nGames,e=0;e<b.gameNos.length;e++)b.gameNos[e]>this.nGames&&(this.nGames=b.gameNos[e]);this.nGames>c&&this.V134();for(e=0;e<b.gameNos.length;e++)b.gameNos[e]<=this.nGames&&this.V1rr.V1sg(this.cloudId,b.gameNos[e])}};c.prototype.V1s2=function(b){b.cloudId==this.cloudId&&(this.nGames++,this.V1rs=[],this.V134())};c.prototype.V1q5=
function(){this.fireOnDBDeleted()};c.prototype.V1s5=function(b){b.cloudId==this.cloudId&&(this.nGames=b.nNewLen,this.V1rs=[],this.fireOnDBLength(this.nGames))};c.prototype.V1s7=function(b){b.cloudId==this.cloudId&&this.fireOnDBDeleted()};c.prototype.V131=function(b){if(this.headers[b]){var c=!this.headers[b].deleted;this.headers[b].setDeleted(c);void 0===this.headers[b].loadCnt?this.headers[b].loadCnt=0:this.headers[b].loadCnt++;var e=new CB.Server.V1si(this.cloudId,b,0,this.headers[b]);this.fireOnGameHeadersChanged([e]);
this.V1rr.V1sj(this.cloudId,[b],[c])}};c.prototype.V1sk=function(b){for(var c=[],e=[],f=0;f<b.length;f++){var g=b[f];if(this.headers[g]){var h=!this.headers[g].deleted;this.headers[g].setDeleted(h);void 0===this.headers[g].loadCnt?this.headers[g].loadCnt=0:this.headers[g].loadCnt++;var k=new CB.Server.V1si(this.cloudId,g,0,this.headers[g]);this.fireOnGameHeadersChanged([k]);c.push(g);e.push(h)}}this.V1rr.V1sj(this.cloudId,c,e)};c.prototype.V132=function(){this.V1sf();this.V1rr.V1sl(this.cloudId)};
c.prototype.V9t=function(b){for(var c=!1,e=0;c&&e<b.length;e++)b[e]&&b[e].timeout&&(c=!1)};c.prototype.V12u=function(b,c){if("number"==typeof b)this.V1rr.V1sm(b,this.cloudId,c);else if("function"==typeof b){var e=b(c);this.V1rr.V1sn(this.cloudId,e)}};V34y.initForListeners(c);V34y.addEvent(c,"GameHeadersChanged");V34y.addEvent(c,"DBLength");V34y.addEvent(c,"DBDeleted");return c}();"use strict";CB.V1sd={V5k:0,V1so:1,V1sp:2,V1sq:3,V1sr:4,V1ss:5,V1st:6,V1su:7,V1sv:8,V1se:9};
CB.V1sw=function(){var c=function(){this.V1sx.V1sy=this.V1sx.CLOUDDBITEM_MAY_VIEW|this.V1sx.CLOUDDBITEM_MAY_LOAD|this.V1sx.CLOUDDBITEM_MAY_SAVE|this.V1sx.CLOUDDBITEM_MAY_ADMIN|this.V1sx.CLOUDDBITEM_OWNER};c.prototype.V1sx={CLOUDDBITEM_SHARED:1,CLOUDDBITEM_MAY_VIEW:131072,CLOUDDBITEM_MAY_LOAD:262144,CLOUDDBITEM_MAY_SAVE:524288,CLOUDDBITEM_MAY_ADMIN:1048576,CLOUDDBITEM_OWNER:2097152};c.prototype.fromDataBuf=function(b){b.beginSizedRead();this.name=b.V34q(100);this.title=b.V34q(200);this.owner=b.V34q(100);
this.nGames=b.V35k();this.V1sz=b.V35c();this.V1t0=b.V35k();this.cloudId=b.readUint64();this.V1t1=b.V35i();this.V1t2=b.V35c();this.flags=b.V35k();this.type=b.V35k();b.endSizedRead()};c.prototype.toString=function(){return this.name+", "+this.title+", "+this.owner+", nGames="+this.nGames+", type="+this.type};c.V1t3=-1;c.V1t4=-2;c.V1t5=-3;c.V1t6=0;c.V1t7=8;return c}();
CB.V1t8=function(){var c=function(){this.items=[]};c.prototype.size=function(){return this.items.length};c.prototype.fromDataBuf=function(b){this.items=[];for(var c=b.V35g(),e=0;e<c&&200>e;e++){var f=new CB.V1sw;f.fromDataBuf(b);this.items.push(f)}};c.prototype.V1t9=function(b){for(var c=0;c<this.items.length;c++)if(this.items[c].cloudId==b)return this.items[c]};c.prototype.V1ta=function(b){for(var c=0;c<this.items.length;c++)if(this.items[c].type==b)return this.items[c].cloudId;return 0};c.prototype.V1tb=
function(b){for(var c=0;c<this.items.length;c++)if(this.items[c].cloudId==b){this.items.splice(c,1);break}};c.prototype.V1tc=function(b){for(var c=0;c<this.items.length;c++)if(this.items[c].name.toLowerCase()==b.toLowerCase())return!0;return!1};return c}();CB.V1td=function(){var c=function(b){this.game=b;this.time=new CB.V5h(0)};c.prototype.V35j=function(b){this.game.hdr.compactToDataBuf(b);b.V35h(0);this.game.writeGameOnly2(b);this.time.V35j(b)};return c}();"use strict";CB.namespace("CB.Server.V1te");
CB.Server.V1te=function(){var c=function(b,c,e){this.cloudId=b;this.nGame=c;this.dateAndTime=e};c.prototype.fromDataBuf=function(b){b.beginSizedRead();this.cloudId=b.V35g();b.V35g();this.nGame=b.V35k();this.dateAndTime=new CB.V5h;this.dateAndTime.fromDataBuf(b);b.endSizedRead()};c.prototype.V35j=function(b){b.beginSizedWrite();b.V351(this.cloudId);b.V351(0);b.V35h(this.nGame);void 0===this.dateAndTime&&(this.dateAndTime=new CB.V5h(0));this.dateAndTime.V35j(b);b.endSizedWrite()};c.prototype.setEquals=
function(b){return this.cloudId==b.cloudId&&this.nGame==b.nGame&&this.dateAndTime==b.dateAndTime};c.prototype.setGreater=function(b){return this.cloudId==b.cloudId?this.nGame==b.nGame?this.dateAndTime>b.dateAndTime:this.nGame>b.nGame:this.cloudId>b.cloudId};return c}();CB.Server.V1tf={V1tg:0,V1th:1,V1ti:2,V1tj:3};
CB.Server.V1si=function(){var c=function(b,c,e,f){this.cloudId=b;this.nGame=c;this.eType=e;this.header=f};c.prototype.fromDataBuf=function(b){b.beginSizedRead();this.cloudId=b.V35k();this.nGame=b.V35k();this.eType=b.V35k();switch(this.eType){case CB.Server.V1tf.V1tg:this.header=new CB.Vgz,this.header.compactFromDataBuf(b),(new CB.V5h).fromDataBuf(b)}b.endSizedRead()};return c}();"use strict";CB.namespace("CB.Server.CloudManager");
CB.V1tk={V5k:0,V1tl:1600,V1tm:1601,V1tn:1602,V1to:1603,V1tp:1604,V1tq:1605,V1tr:1606,V1ts:1607,V1tt:1608,V1tu:1609,V1tv:1610,V1tw:1611,V1tx:1612,V1ty:1613,V1tz:1614,V1u0:1615,V1u1:1616,V1u2:1617,V1u3:1618,V1u4:1619,V1u5:1620,V1u6:1621,V1u7:1622,V1u8:1623,V1u9:1624,V1ua:1625,V1ub:1626,V1uc:1627,V1ud:1628,V1ue:1629,V1uf:1630,V1ug:1631,V1uh:1632,V1ui:1633,V1uj:1634,V1uk:1635,V1ul:1636,V1um:1637,V1un:1638,V1uo:1639,UPLOAD_GAME:1640,V1up:1641,V1uq:1642,V1ur:1643,V1us:1644,V1ut:1645,V1uu:1647,V1uv:1648,
V1uw:1649,V1ux:1650,toString:function(c){for(var b in this)if(this[b]==c)return b;return"Unknown CloudUserMsgId: "+c},Vlu:function(c){return"CloudId="+c}};CB.V1uy={V1uz:1,V1v0:2,V1v1:4,V1v2:8,V1v3:16,V1v4:32,V1v5:64,V1v6:128,V1v7:256,WHITE:6,BLACK:9,V1p:12,Vub:3};
CB.Server.CloudManager=function(){var c=function(){this.V1v8=new CB.Vai;this.V1v9=new CB.Timer;this.V1va=0;this.V1vb={};this.V1vc=new CB.Vao(function(b){this.send(b)}.bind(this));this.V1vd=new CB.Vao(function(b){this.send(b)}.bind(this));this.V1ve=!1;this.V1vh=this.V1vf=CB.V1vg.V5k;this.name="cloud"};CB.inherit(c,CB.Server.V1pi);c.prototype.V1vi=function(b,c,f,g,h){this.create(b,c,f,g,h)};c.prototype.getName=function(){return"CloudMgr"};c.prototype.V1q5=function(){this.fireOnChangeLogin();this.V1vj();
V35p.setLoggedIn(this.isLoggedIn())};c.prototype.V1re=function(){this.V1ql("Connected to CloudServer","","conn");this.V1py=!0;V35p.shouldRequestCloudDBsOnLogin()?this.V1vk():CB.V139&&CB.V139.V13b();this.loginMode!=CB.LoginMode.GUEST&&(V35p.setLoggedIn(!0),V35p.panelMgr.getKernel()&&this.V1vl(V35p.panelMgr.getKernel().getCurPos()),V35p.config.V1vm||V35p.panelMgr.showMessage(String.formatEx(lm.LOGIN_WELCOME,this.user),2E3));V35p.V1vn(this.V355)};c.prototype.V1r4=function(){!V35p.config.V1vm&&CB.V139&&
CB.V139.V13a("Requesting databases ... ",null,5E3)};c.prototype.V1qh=function(){this.superClass.V1qh.apply(this,arguments)};c.prototype.V1ql=function(b,c,f){5};c.prototype.V1vo=function(b){};c.prototype.test=function(){};c.prototype.V1o2=function(b){if(!this.V1r5(b))try{switch(b.getType()){default:TRACE("Unhandled: "+b.toString());break;case CB.V1k2.V1l2:this.V1ql("Connected to CloudServer");this.V1py=!0;alert("Default Groups not expected...");break;case CB.V1k2.V1mb:this.V1vp(b);break;case CB.V1k2.V1kg:this.V1p2()}}catch(c){b=
CB.V1k2.Vlu(b.getType()),CB.Vjg(b,c)}};c.prototype.V1vq=function(b){V35p.panelMgr.V1ri(chat.toString())};c.prototype.isLoggedIn=function(){return this.V1py&&this.Vrb()};c.prototype.V1vp=function(b){try{switch(b.getUserType()){default:TRACE("Unhandled Cloud Msg: "+b.toString());break;case CB.V1tk.V1tm:this.V1vr(b);break;case CB.V1tk.V1to:this.V1vs(b);break;case CB.V1tk.V1tq:this.V1vt(b);break;case CB.V1tk.V1tt:this.V1vu(b);break;case CB.V1tk.V1ts:this.V1vv(b);break;case CB.V1tk.V1tu:case CB.V1tk.V1u9:this.V1vw(b);
break;case CB.V1tk.V1ua:this.V1vx(b);break;case CB.V1tk.V1tv:this.V1vy(b);break;case CB.V1tk.V1tw:this.V1vz(b);break;case CB.V1tk.V1ty:break;case CB.V1tk.V1ue:this.V1w0(b);break;case CB.V1tk.V1tz:this.V1w1(b);break;case CB.V1tk.V1u2:this.V1w2(b);break;case CB.V1tk.V1u4:this.V1w3(b);break;case CB.V1tk.V1u7:this.V1w4(b);break;case CB.V1tk.V1uc:this.V1w5(b);break;case CB.V1tk.V1uh:this.V1w6(b);break;case CB.V1tk.V1uk:this.V1w7(b);break;case CB.V1tk.V1um:this.V1w8(b);break;case CB.V1tk.V1ut:this.V1w9(b);
break;case CB.V1tk.V1uu:this.V1wa(b);break;case CB.V1tk.V1uv:this.notifyMyMovesChanged(b)}}catch(c){b=CB.V1tk.Vlu(b.getUserType()),CB.Vjg(b,c)}};c.prototype.V1wb=function(b){};c.prototype.V1vk=function(){var b=new CB.Vat(CB.V1k2.V1mb);b.setUserType(CB.V1tk.V1tl);var c=this.user;this.loginMode==CB.LoginMode.GUEST&&(c="Guest");b.getBuf().V34p(c);b.getBuf().V35h(CB.V5t.V6i());this.send(b)};c.prototype.V1vr=function(b){CB.V139&&CB.V139.V13b();this.cloudDBItemList=new CB.V1t8;this.cloudDBItemList.fromDataBuf(b.getBuf());
var c=b.getBuf().V35g(),f=b.getBuf().V35g(),g=b.getBuf().V35g(),h=b.getBuf().V35g();b.getBuf().V35g();this.V1ql("Received Databases... qKB="+c+", siz= "+f+", maxDB="+g+", lastDBId="+h);V35p.config.V1vm||(0!=h&&this.V1ve?this.V1wc(h,!0):V35p.panelMgr.openDatabasePanel&&V35p.panelMgr.selectCloudDatabase(this.user,this.cloudDBItemList,this.V1wc.bind(this)));this.V1ve=!1};c.prototype.V1s9=function(b){return this.cloudDBItemList.V1t9(b)};c.prototype.V1wc=function(b,c){if(0<=b){this.V1va&&this.V12t(this.V1va);
var f=this.cloudDBItemList.V1t9(b);if(f){var g=this.openCloudDatabase(f);V35p.panelMgr.V1wd(g);c&&("Clipboard"==f.name||"CloudClip"==f.name)&&V35p.panelMgr.gameKernel&&V35p.panelMgr.gameKernel.Vmy(g,g.nGames);this.V1we&&((new CB.Timer(this.V1we)).runOnce(100),this.V1we=null)}this.V1va=b;this.V1wf(b)}else this.V1va=0};c.prototype.V1wg=function(b){this.V1we=b};c.prototype.V1wh=function(b){if(b=this.cloudDBItemList.V1t9(b))return this.openCloudDatabase(b)};c.prototype.openCloudDatabase=function(b){if(void 0!==
this.V1vb[b.cloudId])return this.V12r(this.V1vb[b.cloudId]),this.V1vb[b.cloudId];b=new CB.V1rq(b.cloudId,b.nGames,this);this.V12r(b);return b};c.prototype.V12r=function(b){void 0==this.V1vb[b.cloudId]&&(this.V1vb[b.cloudId]=b);this.V1vb[b.cloudId].incUsers()};c.prototype.V12t=function(b){"object"===typeof b?b=b.cloudId:ASSERT("number"===typeof b);void 0!==this.V1vb[b]&&(this.V1vb[b].decUsers(),0>=this.V1vb[b].getNUsers()&&(this.V1vb[b].destroy(),delete this.V1vb[b]))};c.prototype.V1vj=function(){for(var b in this.V1vb)this.V1vb.hasOwnProperty(b)&&
(this.V1vb[b].destroy(),delete this.V1vb[b])};c.prototype.V1wf=function(b){var c=new CB.Vat(CB.V1k2.V1mb);c.setUserType(CB.V1tk.V1tx);c.getBuf().V351(b);c.getBuf().V351(0);this.send(c)};c.prototype.V1wi=function(b){if(this.cloudDBItemList.V1tc(b))alert(b+" exists.");else if(!this.V1qg()){var c=new CB.Vat(CB.V1k2.V1mb);c.setUserType(CB.V1tk.V1u1);c.getBuf().V34p(b);c.getBuf().V35h(CB.V5t.V6i());V35p.V34z.guid.V35j(c.getBuf());this.send(c)}};c.prototype.V1w2=function(b){var c=b.getBuf().V35k();b.getBuf().V35g();
b.getBuf().V35g();b.getBuf().V34q(100);switch(c){case CB.V1sw.V1t3:alert("Name Exists");break;case CB.V1sw.V1t4:alert("Disk Space insufficient");break;case CB.V1sw.V1t5:alert("Too many databases ");break;case CB.V1sw.V1t6:this.V1vk()}};c.prototype.V1wj=function(){V35p.panelMgr.selectCloudDatabase(this.user,this.cloudDBItemList,this.V1wk.bind(this))};c.prototype.V1wk=function(b){if(b&&CB.Vn8){var c=this.V1s9(b);if(c){var f="<strong>"+CB.V47.V49(c.title)+"</strong>",f=f+("</br></br>"+c.nGames+" games"),
f=f+("</br></br> Owner="+CB.V47.V49(c.owner));CB.Vn8.V1wl("Please confirm deletion of this database:",f,function(c){if("yes"==c||"ok"==c)c=new CB.Vat(CB.V1k2.V1mb),c.setUserType(CB.V1tk.V1u3),c.getBuf().V351(b),c.getBuf().V351(0),this.send(c),this.V1wm=!1,this.fireOnDeleted({cloudId:b}),this.V12t(b),this.V1va==b&&(this.V1va=0)}.bind(this))}}};c.prototype.V1w3=function(b){var c=b.getBuf().V35g();b.getBuf().V35g();b.getBuf().V34q(100);this.cloudDBItemList.V1tb(c)};c.prototype.V1vs=function(b){b=this.V1vc.Vas(b,
CB.V1k2.V1mb,CB.V1tk.V1u0,function(b){var c=new CB.Server.V1si;c.fromDataBuf(b);return c});b.overhead.V35o();this.V1ql("Received Multiple Headers: "+b.vec.length);for(var c=[],f=0;f<b.vec.length;f++)for(var g=0;g<b.vec.length&&1E3>g;g++){var h=b.vec[g];switch(h.eType){default:throw"URTyp";case CB.Server.V1tf.V1tg:c.push(h);case CB.Server.V1tf.V1ti:case CB.Server.V1tf.V1th:case CB.Server.V1wn:}}c.length&&this.fireOnHeadersChanged(c)};c.prototype.V1sg=function(b,c,f){void 0==c&&alert("nGame");this.V1v8.Vaj(new CB.Server.V1te(b,
c,f));40<this.V1v8.size()?this.V1wo():this.V1v9.runOnce(500,this.V1wo.bind(this))};c.prototype.V1wo=function(){var b=new CB.Vat(CB.V1k2.V1mb);b.setUserType(CB.V1tk.V1tn);b.getBuf().V35h(this.V1v8.size());for(var c=0;c<this.V1v8.size()&&100>c;c++)this.V1v8.Vak()[c].V35j(b.getBuf());this.send(b);this.V1v8.clear()};c.prototype.loadGame=function(b,c,f){f=new CB.Vat(CB.V1k2.V1mb);f.setUserType(CB.V1tk.V1tp);f.getBuf().V351(b);f.getBuf().V351(0);f.getBuf().V35h(c);(new CB.V5h(0)).V35j(f.getBuf());this.send(f)};
c.prototype.V1vt=function(b){var c=b.getBuf().V35g();b.getBuf().V35g();var f=b.getBuf().V35k();b=this.V1wp(b.getBuf());b.replaceDBId=c;b.replaceGameNo=f;this.fireOnGameChanged({cloudId:c,game:b})};c.prototype.V1vu=function(b){var c=b.getBuf().V35g();b.getBuf().V35g();for(var f=b.getBuf().V35k(),g=[],h=0;h<f&&1E3>h;h++){var k=b.getBuf().V35k();g.push(k)}this.fireOnGamesChangedByGameNo({cloudId:c,gameNos:g})};c.prototype.V1vv=function(b){var c=b.getBuf().V35g();b.getBuf().V35g();for(var f=[],g=b.getBuf().V35k(),
h=0;h<g&&100>h;h++)f.push(b.getBuf().V35k());this.fireOnHeadersChangedByGameNo({cloudId:c,gameNos:f})};c.prototype.V1vw=function(b){CB.V139&&CB.V139.V13b();var c=b.getBuf().V35g();b.getBuf().V35g();if(b.getBuf().V35k()){b=b.getBuf().V35k();var f=this.cloudDBItemList.V1t9(c);f&&(f.nGames=b);this.fireOnReorganized({cloudId:c,nNewLen:b})}};c.prototype.V1vx=function(b){CB.V139&&CB.V139.V13b();var c=b.getBuf().V35g();b.getBuf().V35g();b.getBuf().V34q(100);b=b.getBuf().V35k();this.V1we=null;var f=this.cloudDBItemList.V1t9(c);
f&&(f.nGames=b);this.fireOnReorganized({cloudId:c,nNewLen:b})};c.prototype.V1vy=function(b){var c=b.getBuf().V35g();b.getBuf().V35g();this.fireOnDeleted({cloudId:c});this.V12t(c)};c.prototype.V1sj=function(b,c,f){var g=new CB.Vat(CB.V1k2.V1mb);g.setUserType(CB.V1tk.V1u5);g.getBuf().V351(b);g.getBuf().V351(0);g.getBuf().V35h(c.length);for(b=0;b<c.length;b++)g.getBuf().V35h(c[b]),g.getBuf().V35n(f[b]);V35p.V34z.guid.V35j(g.getBuf());(new CB.V5h(0)).V35j(g.getBuf());this.send(g)};c.prototype.V1sl=function(b){if(!this.V1qg()){var c=
new CB.Vat(CB.V1k2.V1mb);c.setUserType(CB.V1tk.V1u6);c.getBuf().V351(b);c.getBuf().V351(0);V35p.V34z.guid.V35j(c.getBuf());this.send(c);(b=this.cloudDBItemList.V1t9(b))&&CB.V139&&CB.V139.V13a("Cleaning Up "+b.name,null,2E4)}};c.prototype.V1w4=function(b){CB.V139&&CB.V139.V13b();var c=b.getBuf().V35g();b.getBuf().V35g();b.getBuf().V34q(100);b=b.getBuf().V35k();this.V1we=null;var f=this.cloudDBItemList.V1t9(c);f&&(f.nGames=b);this.fireOnReorganized({cloudId:c,nNewLen:b})};c.prototype.V1sm=function(b,
c,f){var g=new CB.Vat(CB.V1k2.V1mb);g.setUserType(CB.V1tk.V1u8);g.getBuf().V351(b);g.getBuf().V351(0);g.getBuf().V351(c);g.getBuf().V351(0);V35p.V34z.guid.V35j(g.getBuf());g.getBuf().V35h(f.length);for(b=0;b<f.length;b++)g.getBuf().V35h(f[b]);this.send(g);CB.V139&&CB.V139.V13a("Copying games ... ",null,2E4)};c.prototype.V138=function(b,c){var f=new CB.Vat(CB.V1k2.V1mb);f.setUserType(CB.V1tk.V1ub);f.getBuf().V351(b);f.getBuf().V351(0);f.getBuf().V357(c);V35p.V34z.guid.V35j(f.getBuf());this.send(f);
CB.V139&&CB.V139.V13a("Searching on Server ... ",null,2E4)};c.prototype.V1w5=function(b){CB.V139&&CB.V139.V13b();var c=b.getBuf().V35g();b.getBuf().V35g();for(var f=b.getBuf().V35k(),g=[],h=0;h<f&&1E4>h;h++){var k=b.getBuf().V35k();g.push(k)}(b=this.cloudDBItemList.V1t9(c))&&this.openCloudDatabase(b).setSubSet(g)};c.prototype.V1vz=function(b){b.getBuf().V35g();b.getBuf().V35g()};c.prototype.V1w1=function(b){b.getBuf().V35g();b.getBuf().V35g();this.V1vk()};c.prototype.V1wp=function(b){var c=new CB.Game,
f=new CB.Vgz;f.compactFromDataBuf(b);b.V35k();c.readGameOnly2(b);c.setHeader(f);return c};c.prototype.V1wq=function(b,c){c.hdr.compactToDataBuf(b);b.V35h(0);c.writeGameOnly2(b);return c};c.prototype.V1wr=function(b,c){if(this.V1va){var f=new CB.Vat(CB.V1k2.V1mb);f.setUserType(CB.V1tk.V1tr);f.getBuf().V351(this.V1va);f.getBuf().V351(0);void 0!==c?f.getBuf().V35h(c):f.getBuf().V35h(0);V35p.V34z.guid.V35j(f.getBuf());(new CB.V5h(0)).V35j(f.getBuf());this.V1wq(f.getBuf(),b);if(void 0===c){var g=this.V1wh(this.V1va);
g&&(b.replaceDBId=this.V1va,b.replaceGameNo=g.getGameCount()+1)}this.send(f);void 0!==c?this.fireOnGamesChangedByGameNo({cloudId:this.V1va,gameNos:[c]}):this.fireOnGameAppended({cloudId:this.V1va})}};c.prototype.V1ws=function(b){this.V1wt(b)?this.V1wr(b,b.replaceGameNo):this.V1wr(b)};c.prototype.V1wt=function(b){return b.replaceDBId&&b.replaceDBId==this.V1va&&0<b.replaceGameNo};c.prototype.V1sn=function(b,c){for(var f=[],g=0;g<c.length;g++)f.push(new CB.V1td(c[g]));g=new CB.V9w;g.writeFakeInt64(b);
V35p.V34z.guid.V35j(g);c.length&&(CB.V139&&CB.V139.V13a("Saving Games ... ",null,1E3),this.V1vd.Vau(this.V1qy(),CB.V1mt.V1mu,f,2E4,CB.V1k2.V1mb,CB.V1tk.V1ud,g,function(b,c){c.V35j(b)}))};var b=new CB.V35b;c.prototype.V1w0=function(c){c=this.V1vd.Vay(c);var e=this.cloudDBItemList.V1t9(this.V1va);e&&(e.nGames+=c,b.exec(function(){CB.V139&&CB.V139.V13b();this.fireOnReorganized({cloudId:this.V1va,nNewLen:e.nGames})}.bind(this),2E3))};c.prototype.V1wu=function(b,c){var f=this.V1wv(CB.V1tk.V1uf);this.V1wq(f.getBuf(),
b);f.getBuf().V35h(c);f.getBuf().V35h(CB.V5t.V6i());this.send(f)};c.prototype.V1ww=function(b,c){var f=this.V1wv(CB.V1tk.V1uo);this.V1wq(f.getBuf(),b);f.getBuf().V35h(c);var g=CB.V1uy.V1v1;this.V1wx(!0)&&(g=CB.V1uy.V1v2);f.getBuf().V35h(g);f.getBuf().V35h(CB.V5t.V6i());this.send(f)};c.prototype.V1wy=function(b,c){var f=this.V1wv(CB.V1tk.V1up);this.V1wq(f.getBuf(),b);f.getBuf().V34p(CB.V47.V48(c));var g=CB.V1uy.V1v1;this.V1wx(!0)&&(g=CB.V1uy.V1v2);f.getBuf().V35h(g);f.getBuf().V35h(CB.V5t.V6i());this.send(f)};
c.prototype.V1wz=function(b,c,f){var g=this.V1wv(CB.V1tk.V1uq);b.write(g.getBuf());c.write2(g.getBuf());g.getBuf().V35n(f);g.getBuf().V35h(CB.V5t.V6i());this.send(g)};c.prototype.uploadToMyMoves=function(b){var c=this.V1wv(CB.V1tk.UPLOAD_GAME);this.V1wq(c.getBuf(),b);c.getBuf().V35h(CB.V5t.V6i());this.send(c)};c.prototype.makeMainMoveOrder=function(b){var c=this.V1wv(CB.V1tk.V1un);this.V1wq(c.getBuf(),b);c.getBuf().V35h(CB.V5t.V6i());this.send(c)};c.prototype.V1x0=function(b,c){var f=this.V1wv(CB.V1tk.V1ui);
b.write(f.getBuf());delete c.annos;(new CB.Veh(c.from,c.to,c.prom)).write2(f.getBuf());f.getBuf().V35h(CB.V5t.V6i());this.send(f)};c.prototype.V1x1=function(b,c,f){var g=this.V1wv(CB.V1tk.V1ul);b.write(g.getBuf());c.write2(g.getBuf());g.getBuf().V35h(f);g.getBuf().V35h(CB.V5t.V6i());this.send(g)};c.prototype.V1w8=function(b){var c=b.getBuf().V35g();b.getBuf().V35k();this.V1x2();V35p.panelMgr.blockLiveBookUpdates(CB.V1x3.V1x4);1<c&&V35p.panelMgr.showMessage(c+" "+lm.MOVES_UNMARKED,4E3)};c.prototype.V1w9=
function(b){var c=b.getBuf().V35g();b.getBuf().V35k();V35p.panelMgr.showMessage(c+" "+lm.MOVES_UNLEARNED,4E3)};c.prototype.V1x5=function(b,c,f){var g=this.V1wv(CB.V1tk.V1us);b.write(g.getBuf());c.write2(g.getBuf());g.getBuf().V35h(f);g.getBuf().V35h(CB.V5t.V6i());this.send(g)};c.prototype.V1wa=function(b){};c.prototype.V1vl=function(b,c,f){var g=this.V1wv(CB.V1tk.V1ug);b.write(g.getBuf());g.getBuf().V35n(c?!0:!1);g.getBuf().writeInt(f||0);g.getBuf().V35h(CB.V5t.V6i());this.send(g,!0)};c.prototype.V1w6=
function(b){var c=new CB.Position;c.read(b.getBuf());for(var f=b.getBuf().V35k(),g=[],h=[],k=0;k<f&&200>k;k++){var l=new CB.Veh;l.read2(b.getBuf());var h=b.getBuf().V35g(),m=b.getBuf().V35k(),p=b.getBuf().readUint8(),r=b.getBuf().V34q(300),u=b.getBuf().readUint8(),q=b.getBuf().V35e(),t=b.getBuf().readUint8();g.push({move:l,visits:h,flags:m,eval:p,correct:u,txt:r,date:q,learnPercent:t})}f={count:0,total:0,drilled:0,learned:0,quote:0,toString:function(){return"Stats: cnt="+this.count+", total="+this.total+
", drilled="+this.drilled+", learned="+this.learned},getPercent:function(){return this.total?Math.round(100*this.quote/this.total):0}};f.count=b.getBuf().V35g();f.total=b.getBuf().V35g();f.drilled=b.getBuf().V35g();f.learned=b.getBuf().V35g();f.quote=b.getBuf().readFloat64();this.fireOnMyMoves({position:c,moves:g,stats:f})};c.prototype.loadMyMoves=function(b,c){this.V1x6=c;V35p.panelMgr.blockLiveBookUpdates&&V35p.panelMgr.blockLiveBookUpdates(CB.V1x3.V1x7);var f=this.V1wv(CB.V1tk.V1uj);f.getBuf().V35h(b);
this.V1wq(f.getBuf(),c);f.getBuf().V35h(CB.V5t.V6i());this.send(f)};c.prototype.V1x2=function(){this.V1x6||(this.V1x6=new CB.Game);this.loadMyMoves(this.V1vh,this.V1x6)};c.prototype.V1w7=function(b){var c=this.V1wp(b.getBuf()),f=b.getBuf().V35g();5;b=b.getBuf().V35k();var g;switch(b){case CB.V1vg.Vbe:g="Both Colors";break;case CB.V1vg.WHITE:g="White";break;case CB.V1vg.BLACK:g="Black"}c.hdr.white=new CB.PlayerData("","My Moves");c.hdr.black=new CB.PlayerData("",g);0==f?(c="No Marked Moves Found.",
b!=CB.V1vg.Vbe&&(c=g+" - "+c),V35p.panelMgr.showMessage(c,5E3),V35p.panelMgr.shakeMarkButton(),c=new CB.Game):V35p.panelMgr.stopShakeMarkButton();V35p.panelMgr.loadGame(c);V35p.panelMgr.setLayoutMyMoves(!0,b==CB.V1vg.BLACK);this.V1vh=this.V1vf=b;V35p.panelMgr.blockLiveBookUpdates(CB.V1x3.V1x8)};c.prototype.notifyMyMovesChanged=function(b){V35p.notifyMyMovesChanged()};c.prototype.V1x9=function(b,c){var f=this.V1wv(CB.V1tk.V1ur);b.write(f.getBuf());f.getBuf().V35h(c);f.getBuf().V35h(CB.V5t.V6i());this.send(f)};
c.prototype.V1xa=function(){var b=this.V1wv(CB.V1tk.V1uw);b.getBuf().V35h(CB.V5t.V6i());this.send(b)};c.prototype.Vrd=function(b){var c=this.V1wv(CB.V1tk.V1ux);this.V1wq(c.getBuf(),b);c.getBuf().V35h(CB.V5t.V6i());this.send(c)};c.prototype.V1wv=function(b){var c=new CB.Vat(CB.V1k2.V1mb);c.setUserType(b);b=this.user;this.loginMode==CB.LoginMode.GUEST&&(b="Guest");c.getBuf().V34p(CB.V47.V48(b));return c};c.prototype.Vnu=function(){this.V1vf=-1};c.prototype.V1xb=function(){return 0<=this.V1vf};c.prototype.V1wx=
function(b){switch(this.V1vf){default:return!1;case CB.V1vg.Vbe:return!0;case CB.V1vg.BLACK:return b;case CB.V1vg.WHITE:return!b}};c.prototype.V1qw=function(b){var c=V35p.panelMgr.getKernel();c&&c.boardWin&&c.boardWin.addMessage("Server logged you off: "+b,!0)};V34y.initForListeners(c);V34y.addEvent(c,"HeadersChanged");V34y.addEvent(c,"HeadersChangedByGameNo");V34y.addEvent(c,"GameChanged");V34y.addEvent(c,"GamesChangedByGameNo");V34y.addEvent(c,"GameAppended");V34y.addEvent(c,"ChangeLogin");V34y.addEvent(c,
"Reorganized");V34y.addEvent(c,"Deleted");V34y.addEvent(c,"MyMoves");return c}();"use strict";CB.namespace("CB.DOM");CB.DOM.get=function(c){return document.getElementById(c)};CB.DOM.V1xc=function(c,b){var d=document.createTextNode(c),e=document.createElement("div");void 0!==b&&(e.className=b);document.body.appendChild(e);e.appendChild(d);void 0!==CB.V1xd?document.body.insertBefore(e,CB.V1xd):document.body.appendChild(e)};
CB.DOM.add=function(c,b,d){var e=document.createElement("div");b&&b.length?(b=document.createElement(b),b.innerText=c):b=document.createTextNode(c);void 0!==d&&(e.className=d);e.appendChild(b);document.body.appendChild(e)};CB.DOM.V1xe=function(c,b,d){var e=document.createElement("div"),f=document.createElement("a");f.href=c;f.target="_blank";b&&b.length&&(f.textContent=b);void 0!==d&&(e.className=d);e.appendChild(f);document.body.appendChild(e)};
CB.DOM.V1xf=function(){var c=document.createElement("br");document.body.appendChild(c)};CB.DOM.insertBefore=function(c,b,d){c=document.createTextNode(c);var e=document.createElement("div");e.className=void 0!==d?d:"Text";document.body.appendChild(e);e.appendChild(c);void 0!==document.getElementById(b)?document.body.insertBefore(e,document.getElementById(b)):document.body.appendChild(e)};
CB.DOM.V1xg=function(c){for(var b=document.cookie.split(";"),d=0;d<b.length;d++){var e=b[d].split("="),f=e[0].trim(),e=1<e.length?e[1]:"";if(f==c)return decodeURIComponent(e)}return""};CB.DOM.codeAccountName=function(c){return CB.V47.base64.encode(CB.V47.V4m(c))};CB.DOM.V1pc=function(c){"guest"!=c&&this.setCodedCookie("AccountName64",c)};CB.DOM.V1xh=function(c){return this.getCodedCookie("AccountName64",c)};CB.DOM.setCodedCookie=function(c,b){CB.DOM.V1p5(c,this.codeAccountName(b))};
CB.DOM.getCodedCookie=function(c,b){var d=CB.DOM.V1xg(c),d=CB.V47.base64.V4f(d);b&&(d=CB.V47.V4n(d),d=d.replace("%25","%"),d=d.replace("%20"," "));return d};CB.DOM.V1p5=function(c,b){var d=new Date,e;b?(d.setYear(d.getFullYear()+1),e=d.toGMTString()):e="Thu, 01 Jan 1970 00:00:01 GMT";d=".chessbase.com";-1!=document.URL.search(/localhost/i)&&(d="localhost");e=c+"="+encodeURIComponent(b)+";expires="+e+";path=/;";d.length&&(e+="domain="+d+";");document.cookie=e};
CB.DOM.V1p4=function(c){CB.DOM.V1p5(c,"")};CB.DOM.V1xi=function(c,b){void 0!==c&&(c.className=0<c.className.length?c.className+(" "+b):b)};CB.DOM.V1xj=function(c,b){void 0!==c&&(c.className=c.className.replace(new RegExp("\b"+b+"\b"),""))};CB.DOM.resize=function(c,b,d){if("string"===typeof c||"number"===typeof c)c=document.getElementById(c);void 0!==c&&(c.style.width=b,c.style.height=d)};CB.DOM.setText=function(c,b){c&&("undefined"==typeof c.textContent?c.innerText=b:c.textContent=b)};
function textOut(c,b){CB.V1xk||(CB.DOM.add(c,"",b),void 0!==CB.V1xd&&CB.V1xd.scrollIntoView())}function TRACE(c){V35p.config.debug&&textOut(c,"LogTrace")}function EXCEPTION(c,b){var d=c;void 0!==b&&(d+=" ("+b+")");textOut(d,"LogException")}function CHAT(c){textOut(c,"LogChat")}
CB.V5p=function(){var c={},b;c.V1xl=function(){if(void 0===b){var c=document.createElement("style");c.setAttribute("media","screen");c.appendChild(document.createTextNode(""));document.head.appendChild(c);b=c.sheet}return b};c.V1xm=function(b){var c=document.createElement("style");c.id=b;c.setAttribute("media","screen");c.appendChild(document.createTextNode(""));document.head.appendChild(c);return c.sheet};c.V5q=function(b,d){try{void 0!==c.V1xl().addRule?c.V1xl().addRule(b,d):c.V1xl().insertRule(b+
" { "+d+" }",c.V1xl().cssRules.length)}catch(g){CB.Vjg("CSS:addRules",g)}};c.V1xn=function(b,c){return"background-image:linear-gradient( to right,"+b+","+c+")"};c.V1xo=function(){return"display:block;margin-left:auto;margin-right:auto;text-align:center"};c.getHeader=function(b,c,d){return d?"<"+b+' style="'+d+'">'+c+"</"+b+">":"<"+b+">"+c+"</"+b+">"};c.V1xp=function(b){for(var d=c.V1xl(),g=0;g<d.cssRules.length;++g)if(d.cssRules[g].type==window.CSSRule.KEYFRAMES_RULE&&d.cssRules[g].name==b)return d.cssRules[g];
g=CB.V5t.V6v()?"-webkit-":"";void 0===d.insertRule?d.addRule("@"+g+"keyframes "+b+"{ 0% { top: 10px } 100% { top: 30px } }"):d.insertRule("@"+g+"keyframes "+b+"{ 0% { top: 10px } 100% { top: 30px } }",d.cssRules.length);for(g=0;g<d.cssRules.length;++g)if(d.cssRules[g].type==window.CSSRule.KEYFRAMES_RULE&&d.cssRules[g].name==b)return d.cssRules[g];return null};var d={};c.V1xq=function(b){b=[].concat(b);for(var c=0;c<b.length;c++)1<b[c].length&&void 0==d[b[c]]&&(CB.V5p.V1xl().insertRule("."+b[c]+"{ background-image: url( "+
V35p.config.V1xr()+b[c]+".png ) !important; }",0),d[b[c]]=1)};return c}();"use strict";
CB.$=function(){function c(b){var c=document.createElement("div");c.innerHTML=b;return c.childNodes}function b(b){l.prototype[b]=function(){return this.arr[b].apply(this,arguments)}}function d(b){l.prototype[b]=function(c){this.on(b,c)}}var e=/^#(\w|-)+$/,f=/^.(\w|-)+$/,g=/^\w+$/,h=/^\[(\w|-)+\]$/,k=/^<.*>$/,l=function(b,d){var f=[];if(null!=b&&""!=b)if("string"===typeof b){d=d||document;var h=(new l(d)).single();b=b.trim();b.startsWith(">")?(f=b.replace(">","").trim(),f=(new l(f,h)).arr.filter(function(b){return b.parentNode==
h})):e.test(b)?(b=b.substring(1),f=(f=document.getElementById(b))?[f]:[]):g.test(b)?f=h.getElementsByTagName(b):k.test(b)?f=c(b):h&&(f=h.querySelectorAll(b,h))}else"object"===typeof b&&(f=b.proloJQ?b.arr:[b]);this.length=f.length;this.arr=[];for(var m=0;m<f.length;++m)this[m]=f[m],this.arr.push(f[m]);this.proloJQ=!0};b("indexOf");b("find");b("findIndex");b("find");b("some");b("every");b("map");b("filter");b("reduce");b("forEach");l.prototype.single=function(){return 1===this.arr.length?this.arr[0]:
null};l.prototype.first=function(){return this.arr[0]};l.prototype.last=function(){return this.arr[this.arr.length-1]};l.prototype.addClass=function(b){this.forEach(function(c){c.classList.add(b)});return this};l.prototype.removeClass=function(b){b?this.forEach(function(c){c.classList.remove(b)}):this.forEach(function(b){b.className=""});return this};l.prototype.toggleClass=function(b){this.forEach(function(c){c.classList.toggle(b)});return this};l.prototype.hide=function(){this.forEach(function(b){if("none"!==
b.style.display){var c=b.style.display;b.oldDisplay="none"!=c?c:"block";b.style.display="none"}})};l.prototype.show=function(){this.forEach(function(b){b.style.display&&"none"!==b.style.display||(b.style.display=b.oldDisplay||"block",delete b.oldDisplay)})};l.prototype.V1xs=function(b){this.forEach(function(c){c.style.display=b})};l.prototype.toggle=function(b){b?this.show():this.hide()};l.prototype.parent=function(b){for(var c=this.single().parentNode;null!=c;c=c.parentNode)if(r.is(c,b))return c;
return null};l.prototype.on=function(b,c){this.forEach(function(d){d.addEventListener(b,c)});return this};l.prototype.off=function(b,c){this.forEach(function(d){d.removeEventListener(b,c)});return this};d("mousemove");d("mousedown");d("mouseup");d("click");l.prototype.html=function(b){if(void 0===b)return this.single().innerHTML;this.forEach(function(c){c.innerHTML=b});return this};l.prototype.text=function(b){if(void 0===b)return this.single().textContent?this.single().textContent:this.single().innerHTML;
this.forEach(function(c){c.textContent?c.textContent=b:c.innerText=b});return this};l.prototype.prependTo=function(b){var c=(new l(b)).single();this.forEach(function(b){c.insertBefore(b,c.firstChild)})};l.prototype.prepend=function(b){var c=new l(b);this.forEach(function(b){c.prependTo(b)})};l.prototype.appendTo=function(b){var c=(new l(b)).single();this.forEach(function(b){c.appendChild(b)});return this};l.prototype.append=function(b){var c=new l(b);this.forEach(function(b){c.appendTo(b)});return this};
l.prototype.insertBefore=function(b){var c=new l(b);this.forEach(function(b){c.forEach(function(c){c.parentNode&&c.parentNode.insertBefore(b,c)})});return this};l.prototype.empty=function(){this.html("");return this};l.prototype.remove=function(){this.forEach(function(b){b.parentNode&&b.parentNode.removeChild(b)});return this};l.prototype.attr=function(b,c){if(void 0===c){var d=this.single().attributes[b];return d?d.value:null}this.forEach(function(d){d.setAttribute(b,c)});return this};l.prototype.data=
function(b,c){return this.attr("data-"+b,c)};var m=/^[+-]?(([0-9]*\.[0-9]+)|[0-9]+)/,p="marginTop marginBottom marginLeft marginRight paddingTop paddingBottom paddingLeft paddingRight height width minHeight minWidth maxHeight maxWidth borderWidth left top bottom right".split(" ");l.prototype.css=function(b,c){if(b&&"object"==typeof b&&!c){for(var d in b)b.hasOwnProperty(d)&&this.css(d,b[d]);return this}var e=minusToCamel(b);if(void 0===c)return this.arr.length?getComputedStyle(this.arr[0])[e]:null;
this.forEach(function(b){var d=c;null==d&&(d="");var d=d.toString(),f;f=d;var g=m.exec(f);g?(g=g[0],f=f.substring(g.length),f={val:parseFloat(g),unit:f}):f=null;f&&!f.unit&&(d+=0<=p.indexOf(e)?"px":"");b.style[e]=d});return this};l.prototype.position=function(){return{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}};var r=function(b,c){return ObjUtil.isFunction(b)&&!c?(r.addOnReadyListener(b),null):new l(b,c)};V34y.initInstForListeners(r);V34y.addInstEvent(r,"Ready");(new l(document)).on("DOMContentLoaded",
function(b){r.fireOnReady()});r.is=function(b,c,d){return b?c?f.test(c)?(c=c.replace(".",""),b.classList&&b.classList.contains(c)):e.test(c)?(c=c.replace("#",""),b.id===c):g.test(c)?b.tagName==c:h.test(c)?(c=c.replace("[",""),c=c.replace("]",""),b.attributes&&b.hasAttribute(c)):0<=r(c,d).indexOf(b):!0:!1};r.get=function(b){return r("#"+b).single()};r.set=function(b,c){r("#"+b).single().innerHTML=c};r.fn=l.prototype;return r}();"use strict";
CB.V1bx=function(){var c=0,b={append:!0},d=function(d,e,h,k){d&&(void 0===this.elDOM&&(this.elDOM=document.createElement(d)),d=k||{},d=ObjUtil.copyTo(b,d,!0),this.uniqueId||(this.uniqueId=++c),this.V1xu=[],this.V1xv=!1,void 0!==e?e instanceof CB.V1bx?(this.V1xw=e.elDOM,e.addChild(this),this.V1xv=!0):this.V1xw=e:this.V1xw=document.body,this.elDOM.id=h?h:"CBEl"+this.uniqueId,this.debug=this.elDOM.id,e=d.append,this.V1xw&&(e?this.V1xw.appendChild(this.elDOM):this.V1xw.insertBefore(this.elDOM,this.V1xw.firstChild)),
this.style=this.elDOM.style,this.setVisible(!1))};d.prototype.destroy=function(){this.V1xx||(this.V1xu.forEach(function(b,c){this.V1xu[c]&&this.V1xu[c].destroy()}.bind(this)),void 0!==this.V1xy&&this.elDOM.removeChild(this.V1xy.V1xz().dom),this.V1xw.removeChild(this.elDOM),this.V1xx=!0)};d.prototype.changeParentElDOM=function(b){if(this.V1xv)throw"!Change parent ElDom on Child El ";this.V1xw&&this.V1xw.contains(this.elDOM)&&this.V1xw.removeChild(this.elDOM);(this.V1xw=b)&&this.V1xw.appendChild(this.elDOM)};
d.prototype.addChild=function(b){this.V1xu[b.uniqueId]=b};d.prototype.removeChild=function(b){delete this.V1xu[b.uniqueId]};d.prototype.V1y0=function(){this.V1xu.forEach(function(b,c){this.V1xu[c]&&this.V1xu[c].destroy()}.bind(this));this.V1xu=[]};d.prototype.setVisible=function(b){this.style.visibility=b?"visible":"hidden";this.V1xu.forEach(function(c,d){this.V1xu[d]&&this.V1xu[d].setVisible(b)}.bind(this));void 0!==this.V1xy&&(b?this.V1xy.show():this.V1xy.hide())};d.prototype.V94=function(){return"visible"==
this.style.visibility};d.prototype.V1y1=function(b){this.setPos(b.topLeft.x,b.topLeft.y);this.setSize(b.w,b.h)};d.prototype.V1y2=function(){this.style.position="relative"};d.prototype.setPos=function(b,c){b=Math.floor(b);c=Math.floor(c);this.x=b;this.y=c;this.style.position="absolute";this.style.left=Math.round(b)+"px";this.style.top=Math.round(c)+"px"};d.prototype.setSize=function(b,c){b=Math.floor(b);c=Math.floor(c);this.w=b;this.h=c;this.elDOM.width=b;this.elDOM.height=c;this.style.width=b+"px";
this.style.height=c+"px";void 0!==this.V1xy&&(this.V1xy.V1y3(b),this.V1xy.V1y4(c));this.V1y5&&(this.style.lineHeight=c+"px");this.V178()};d.prototype.V178=function(){};d.prototype.V1y4=function(b){this.h=b=Math.floor(b);this.style.height=b+"px";void 0!==this.V1xy&&this.V1xy.V1y4(b)};d.prototype.setPosSize=function(b,c,d,e){this.setPos(b,c);this.setSize(d,e)};d.prototype.V1fm=function(b){this.style.zIndex=b};d.prototype.setBorder=function(b,c,d){b=Math.floor(b);this.style.borderWidth=b+"px";void 0!==
c&&(this.style.borderColor=c);this.style.borderStyle=void 0!==d?d:"solid"};d.prototype.setCssClass=function(b){this.elDOM.className=b};d.prototype.V1b3=function(b,c,d){this.style.boxShadow=b+"px "+b+"px "+c+"px 0px "+d};d.prototype.V1y6=function(b){b=Math.floor(b);this.style.borderRadius=b+"px"};d.prototype.setBackgroundColor=function(b){this.V1y7=b.toString();this.style.backgroundColor=b.toString()};d.prototype.setColor=function(b){this.style.color=b.toString()};d.prototype.V1y8=function(b){this.style.margin=
b+"px"};d.prototype.V1y9=function(b){this.style.padding=b+"px"};d.prototype.V1fm=function(b){this.style.zIndex=b};d.prototype.V1ya=function(b){this.V1xy=b};d.V1yb=function(b,c){b.style.pointerEvents=c?"all":"none"};d.prototype.V1yc=function(b){this.elDOM.addEventListener("click",b)};d.prototype.V1yd=function(b,c){this.elDOM.addEventListener(b,c)};d.addClass=function(b,c){if(!b.className||0>b.className.indexOf(c))b.className+=" "+c};d.removeClass=function(b,c){b.className=b.className.replace(c,"");
b.className=b.className.replace(/\s+/g," ")};var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};d.V1by=function(b){var c=document.createElement(e[b]||"div");b="on"+b;var d=b in c;d||(c.setAttribute(b,"return;"),d="function"==typeof c[b]);return d};d.prototype.V1ye=function(){this.elDOM.style.background="#101010";this.elDOM.style.backgroundImage="url( "+CB.V5o()+"Media/Chess/OrangeBrighterSoft.jpg )";this.elDOM.style.backgroundSize="100% 100%";this.elDOM.style.backgroundRepeat=
"no-repeat";this.elDOM.style.backgroundPosition="bottom left"};return d}();"use strict";
CB.V15t=function(){var c=function(b,c,e){CB.V15t.superClass.call(this,"div",b,c,e)};CB.inherit(c,CB.V1bx);c.prototype.V1yf=function(b,c,e){void 0===this.V1yg?(this.V1yg=document.createElement("img"),this.V1yg.setAttribute("src",b),this.V1yg.setAttribute("flag","alternate text"),this.V1yg.setAttribute("height",e+"px"),this.V1yg.setAttribute("width",c+"px"),this.elDOM.appendChild(this.V1yg)):this.V1yg.setAttribute("src",b)};c.prototype.setCssClass=function(b){this.elDOM.className=b};c.prototype.setText=
function(b){"undefined"!=typeof b&&(void 0===this.V1yh&&(this.V1yh=document.createElement("span"),this.V1yh.style.display="inline-block",this.elDOM.appendChild(this.V1yh),this.V1yh.style.cursor="pointer"),b=b.toString(),b.replace(/</g,"("),b.replace(/>/g,")"),this.V1yh.textContent?this.V1yh.textContent=b:this.V1yh.innerText?this.V1yh.innerText=b:this.V1yh.innerHTML=b)};c.prototype.setTextAlign=function(b){this.style.textAlign=b;this.V1yh&&(this.V1yh.textAlign=b)};c.prototype.getText=function(){if(this.V1yh){if(this.V1yh.textContent)return this.V1yh.textContent;
if(this.V1yh.innerText)return this.V1yh.innerText}return""};c.prototype.V1fm=function(b){this.style.zIndex=b};c.prototype.V1az=function(b){if(b)void 0!==this.V1he?this.V1he.style.fontSize=Math.round(b)+"px":(this.V1yh&&(this.V1yh.style.fontSize=Math.round(b)+"px"),this.style.fontSize=Math.round(b)+"px",this.V1hl=Math.round(b),this.V1yi&&this.V1fo());else throw Error("FontSize = 0");};c.prototype.setFontFamily=function(b){this.style.fontFamily=b;this.V1yh&&(this.V1yh.style.fontFamily=b)};c.prototype.V1yj=
function(b){this.style.fontWeight=b};c.prototype.V1b0=function(b){void 0===this.V1yh&&this.setText(" ");void 0!==this.V1yh&&(this.V1yh.style.verticalAlign=b,this.V1yh.style.display="inline-block",this.V1yh.style.lineHeight="normal",void 0!==this.h&&(this.style.lineHeight=this.h+"px"))};c.prototype.V1fo=function(){this.setTextAlign("center");this.V1b0("middle");this.V1yi=!0;this.style.display="block";this.V1y5=!0};c.prototype.V1hc=function(){this.V1yk("right")};c.prototype.V1hf=function(){this.V1yk("left")};
c.prototype.V1yk=function(b){this.setTextAlign(b);this.V1b0("middle");this.V1yi=!1;this.style.display="block"};c.prototype.V1b1=function(){return void 0!==this.V1yh?this.V1yh.clientWidth:0};c.prototype.V1b2=function(){return void 0!==this.V1yh?this.V1yh.clientHeight:0};c.prototype.V1yl=function(){$(this.elDOM).hover(function(){$(this).css("filter","brightness(108%)")},function(){$(this).css("filter","brightness(100%)")})};c.prototype.V1hb=function(b,c,e,f){void 0===this.V1he&&(this.V1he=document.createElement("a"),
this.elDOM.appendChild(this.V1he));this.V1he.href=b;this.V1he.target="_blank";c&&c.length&&(this.V1he.textContent?this.V1he.textContent=c:this.V1he.innerText=c);e&&e.length&&(this.V1he.className=e);f&&this.V1he.setAttribute("onclick","if ( typeof ( ga ) !== 'undefined' && CB.V5t.runsOnChessBaseDomain() ) ga( 'send', 'event', 'link', "+('"'+c+'"')+");")};return c}();"use strict";
CB.V184=function(){var c=new CB.Color(255,255,248,.95),b=new CB.Color(0,0,0,.9),d=1,e=function(){this.uniqueId=d++;this.background=new CB.V15t(document.body,"bTTipBG"+this.uniqueId);this.V1fn=new CB.V15t(this.background,"bSTTipText"+this.uniqueId);this.background.elDOM.style.zIndex=99999;this.V1fn.setBackgroundColor(c);this.V1fn.setColor(b);this.V1fn.setFontFamily("Roboto, Helvetica, sans-serif")};e.prototype.destroy=function(){this.background.destroy()};e.prototype.setText=function(b){this.V1fn.setText(b)};
e.prototype.setVisible=function(b){this.background.setVisible(b)};e.prototype.setPosSize=function(b,c){var d=Math.max(8,Math.round(.4*c.h)),e=new CB.V7p(b.x,b.y,b.x+c.w,b.y+c.h),l=c.w,m=(e.w-l)/2;e.w=l;e.move(m,0);this.background.setPos(b.x,b.y);this.background.setSize(c.w,c.h);e=Math.max(1,Math.min(4,Math.round(Math.sqrt(c.w/100))));this.background.V1b3(e,8*e,"rgba( 60, 30, 20, 0.3 )");this.V1fn.setPos(0,0);this.V1fn.setSize(c.w,c.h);this.V1fn.setBorder(1,new CB.Color(0,0,0,.5));this.V1fn.V1y6(4);
this.V1fn.V1fo();do this.V1fn.V1az(d),--d;while(4<d&&(this.V1fn.V1b1()>l||this.V1fn.V1b2()>c.h-3))};return e}();"use strict";
CB.CanvasElement=function(){var c=function(b,c){CB.CanvasElement.superClass.call(this,"canvas",b,c);this._uniqueId=c};CB.inherit(c,CB.V1bx);c.prototype.setCssClass=function(b){this.elDOM.className=b};c.prototype.V1yn=function(b,c){this.elDOM.width=b;this.elDOM.height=c};c.prototype.render=function(){};c.prototype.V1ye=function(){this.elDOM.style.background="#101010";this.elDOM.style.backgroundImage="url( "+CB.V5o()+"Media/Chess/OrangeBrighterSoft.jpg )";this.elDOM.style.backgroundSize="100% 100%";
this.elDOM.style.backgroundRepeat="no-repeat";this.elDOM.style.backgroundPosition="bottom left"};return c}();"use strict";
CB.V1ds=function(){var c=1,b=function(b){this.uniqueId=c++;this.background=new CB.V15t(b,"aCanvParentBG"+this.uniqueId);this.background.V1y2();this.V1yo=new CB.CanvasElement(this.background,"aCanvParentCanvas"+this.uniqueId)};b.prototype.createCanvas=function(b,c){return this.canvas=new CB.V1yp(this.V1yo.elDOM.id,b,c)};b.prototype.changeParentElDOM=function(b){this.background.changeParentElDOM(b)};b.prototype.setVisible=function(b){this.background.setVisible(b)};b.prototype.setPosSize=function(b,
c,f,g){this.background.setPosSize(b,c,f,g);this.V1yo.setPosSize(0,0,f,g);this.canvas&&this.canvas.resize(f,g)};b.prototype.setSize=function(b,c){this.background.setSize(b,c);this.V1yo.setSize(b,c);this.canvas&&this.canvas.resize(b,c)};b.prototype.V1ye=function(){this.background.V1ye()};return b}();"use strict";CB.namespace("CB.UIElement");
CB.UIElement=function(){var c=function(b,c,e){CB.UIElement.superClass.call(this,b,c,e);this.elDOM&&(this.elDOM.className="cb-button",this.elDOM.addEventListener("mousedown",this.onMouseDown.bind(this)),this.elDOM.addEventListener("mouseup",this.onMouseUp.bind(this)),this.elDOM.addEventListener("mouseover",this.V1yq.bind(this)),this.elDOM.addEventListener("mouseleave",this.onMouseLeave.bind(this)))};CB.inherit(c,CB.V1bx);c.prototype.setText=function(b){b.replace(/</g,"(");b.replace(/>/g,")");this.elDOM.innerHTML=
b};c.prototype.V1yr=function(b){this.elDOM.disabled=!b};c.prototype.V1ys=function(){return!this.elDOM.disabled};c.prototype.V1yd=function(b){this.elDOM.addEventListener("click",function(c){b(c)})};c.prototype.setBackgroundColor=function(b){this.V1y7=b.toString();this.style.backgroundColor=b.toString()};c.prototype.V1yt=function(b){this.V1yu=b.toString()};c.prototype.V1yv=function(b){this.V1yw=b.toString()};c.prototype.onMouseDown=function(){this.V1yw&&(this.style.backgroundColor=this.V1yw)};c.prototype.onMouseUp=
function(){this.V1yu?this.style.backgroundColor=this.V1yu:this.V1y7&&(this.style.backgroundColor=this.V1y7)};c.prototype.V1yq=function(){this.V1yu&&(this.style.backgroundColor=this.V1yu)};c.prototype.onMouseLeave=function(){this.V1y7&&(this.style.backgroundColor=this.V1y7)};c.prototype.setColor=function(b){this.style.color=b.toString()};return c}();"use strict";CB.namespace("CB.Button");
CB.Button=function(){var c=function(b,c,e){b&&(CB.Button.superClass.call(this,"button",b,c),this.elDOM.className=e||"cb-button")};CB.inherit(c,CB.V1bx);c.prototype.V1yf=function(b){this.style.backgroundImage="url( "+b+")";this.style.backgroundRepeat="no-repeat";this.style.backgroundPosition="center"};c.prototype.V1yd=function(b){this.elDOM.addEventListener("click",b)};c.prototype.setText=function(b){var c=this.elDOM;c&&("undefined"==typeof c.textContent?c.innerText=b:c.textContent=b)};c.prototype.V1yr=
function(b){this.elDOM.disabled=!b};return c}();
CB.CloseButton=function(){var c=function(b,c,e){CB.CloseButton.superClass.call(this,b,c,"cb-CloseButton");this.V1yh=document.createElement("span");this.V1yh.style.display="inline-block";"undefined"!=typeof this.V1yh.textContent?this.V1yh.textContent="X":this.V1yh.innerText="X";this.V1yh.style.textAlign="centered";this.V1yh.style.verticalAlign="middle";this.V1yh.style.cursor="default";this.V1yh.style.fontFamily="Roboto, Helvetica, sans-serif";this.elDOM.appendChild(this.V1yh);e&&this.V1yd(e)};CB.inherit(c,
CB.Button);c.prototype.V178=function(){var b=Math.round(.8*this.h);this.style.fontSize=b+"px";this.V1yh.style.fontSize=b+"px";this.V1yh.style.lineHeight=this.h+"px"};return c}();"use strict";CB.namespace("CB.CheckBox");
CB.CheckBox=function(){var c=function(b,c){CB.CheckBox.superClass.call(this,"form",b,c);this.V1yx=this.elDOM.id+"-chk";this.V1yy='<input type="checkbox" id='+this.V1yx+" />";this.elDOM&&(this.elDOM.innerHTML=this.V1yy)};CB.inherit(c,CB.V1bx);c.prototype.V1yz=function(b){var c=document.getElementById(this.V1yx);c.checked=c.defaultChecked=b};c.prototype.V1z0=function(){return document.getElementById(this.V1yx).checked};c.prototype.V1yr=function(b){document.getElementById(this.V1yx).disabled=!b};c.prototype.V1ys=
function(){return!document.getElementById(this.V1yx).disabled};c.prototype.setText=function(b){b.replace(/</g,"(");b.replace(/>/g,")");this.elDOM&&(this.elDOM.innerHTML=this.V1yy+b)};return c}();"use strict";
CB.V1yp=function(){var c=function(b,c,e){this.canvas=document.getElementById(b);if(null===this.canvas)throw Error("ID "+b+" not found.");this.ctx=this.canvas.getContext("2d");this.V1z1(b);this.V1z2(b);this.idDOM=b;this.V1z3=this.V1z4();this.control=c.createControl(this,this.canvas.width,this.canvas.height,e);if(c.onControlReady)c.onControlReady(this.control);this.V16t=new CB.Timer(this.V16u.bind(this))};c.prototype.V1z5=function(){this.V16t.stop();this.el&&null!=this.el.destroy&&this.el.destroy();
this.control.V161()};c.prototype.V8b=function(b,c){this.ctx.beginPath();this.ctx.moveTo(b.x,b.y);this.ctx.lineTo(c.x,c.y);this.ctx.stroke()};c.prototype.V1z6=function(b,c,e,f){void 0!==f&&(this.ctx.fillStyle=f);void 0!==e&&(this.ctx.font=e+"px sans serif");this.ctx.fillText(c,b.x,b.y)};c.drawEllipse=function(b,c,e,f,g){b.save();b.beginPath();b.translate(c-f,e-g);b.scale(f,g);b.arc(1,1,1,0,2*Math.PI,!1);b.restore();b.lineWidth=5;b.stroke()};c.prototype.resize=function(b,c){5>b&&(b=5);5>c&&(c=5);this.V1z7||
(this.control&&this.control.beforeResize&&this.control.beforeResize(),this.V16t.runOnce(10,function(){this.V16u(b,c)}.bind(this)))};c.prototype.V1z8=function(b){this.V1z7=b};c.prototype.onMouseDown=function(b){var c=this.V1z9(b);(new CB.V7p).V7q(this.canvas.getBoundingClientRect());this.control.onMouseDown(b,c);return!1};c.prototype.onContextMenu=function(b){var c=this.V1z9(b);(new CB.V7p).V7q(this.canvas.getBoundingClientRect());if(this.control.onContextMenu)this.control.onContextMenu(b,c);b.preventDefault();
return!1};c.prototype.onMouseUp=function(b){var c=this.V1z9(b);this.control.onMouseUp(b,c);return!1};c.prototype.onMouseMove=function(b){var c=this.V1z9(b);this.control.onMouseMove(b,c);return!1};c.prototype.V1bw=function(b){};c.prototype.V16c=function(b){var c=this.V1z9(b);this.V16f(c);this.control.V16c(b,c)};c.prototype.onMouseEnter=function(b){var c=this.V1z9(b);this.control.onMouseEnter(b,c)};c.prototype.onMouseLeave=function(b){var c=this.V1z9(b);this.control.onMouseLeave(b,c)};c.prototype.V1za=
function(b){if(!this.isDefaultPrevented(b)){b.touches&&(this.V1zb=b.touches[0].clientX,this.V1zc=b.touches[0].clientY);var c=this.V1z9(b);this.control.onMouseDown(b,c)}};c.prototype.V1zd=function(b){if(!this.isDefaultPrevented(b)){delete this.V1zb;var c=this.V1z9(b);this.control.onMouseUp(b,c)}};c.prototype.V1ze=function(b){if(!this.isDefaultPrevented(b)){var c=this.V1z9(b);this.control.onMouseMove(b,c);delete this.V1zb}};c.prototype.isDefaultPrevented=function(b){return void 0!==b.parentEvent&&void 0!==
b.parentEvent.browserEvent?b.parentEvent.browserEvent.defaultPrevented:b.defaultPrevented};c.prototype.V1zg=function(b){delete this.V1zb};c.prototype.V1zh=function(b){delete this.V1zb};c.prototype.onKeyDown=function(b){};c.prototype.V1zi=function(b){};c.prototype.V1zj=function(b){};c.prototype.V1z9=function(b){return b.touches&&b.touches.length?new CB.V6e(this.V1zk(b.touches[0].pageX),this.V1zl(b.touches[0].pageY)):b.changedTouches&&b.changedTouches.length?new CB.V6e(this.V1zk(b.changedTouches[0].pageX),
this.V1zl(b.changedTouches[0].pageY)):new CB.V6e(this.V1zk(b.pageX),this.V1zl(b.pageY))};c.prototype.V1zk=function(b){return(b-this.canvas.getBoundingClientRect().left-window.pageXOffset)*this.V1z3};c.prototype.V1zl=function(b){return(b-this.canvas.getBoundingClientRect().top-window.pageYOffset)*this.V1z3};c.prototype.V1zm=function(b){return this.canvas.getBoundingClientRect().left-window.pageXOffset+b/this.V1z3};c.prototype.V1zn=function(b){return this.canvas.getBoundingClientRect().top-window.pageYOffset+
x/this.V1z3};c.prototype.zoomToPix=function(b){return this.V1z3?b/this.V1zo:b};c.prototype.pixToZoom=function(b){return this.V1z3?b/this.V1z3:b};c.prototype.zoomToPix=function(b){return this.V1z3?b*this.V1z3:b};c.prototype.V1zp=function(b){var c=this.zoomToPix(b.left),e=this.zoomToPix(b.top);return new CB.V7p(c,e,c+b.w*this.V1z3,e+b.h*this.V1z3)};c.prototype.pixToZoomRect=function(b){var c=this.pixToZoom(b.left),e=this.pixToZoom(b.top);return new CB.V7p(c,e,c+b.w/this.V1z3,e+b.h/this.V1z3)};c.prototype.V16f=
function(b){var c=this.canvas.getBoundingClientRect();return new CB.V6e(b.getX()-c.left,b.getY()-c.top)};c.prototype.getBoundingClientRect=function(){var b=this.canvas.getBoundingClientRect();return new CB.V7p(b.left,b.top,b.right,b.bottom)};c.prototype.V1am=function(b){};c.prototype.V1z2=function(b){b=CB.$.get(b);b=CB.$(b);CB.V1bx.V1by("touchstart")&&(b.on("touchstart",this.V1za.bind(this)),b.on("touchend",this.V1zd.bind(this)),b.on("touchmove",this.V1ze.bind(this)),b.on("touchcancel",this.V1zh.bind(this)),
b.on("touchleave",this.V1zg.bind(this)));CB.V1bx.V1by("mousedown")&&(b.on("mousedown",this.onMouseDown.bind(this)),b.on("mouseup",this.onMouseUp.bind(this)),b.on("mousemove",this.onMouseMove.bind(this)),b.on("mousewheel",this.V1bw.bind(this)),b.on("mouseenter",this.onMouseEnter.bind(this)),b.on("mouseleave",this.onMouseLeave.bind(this)),b.on("dblclick",this.V16c.bind(this)));if(CB.V1bx.V1by("contextmenu"))b.on("contextmenu",this.onContextMenu.bind(this));b.on("keydown",this.onKeyDown.bind(this));
b.on("keyup",this.V1zi.bind(this));b.on("keypress",this.V1zj.bind(this))};c.prototype.V1z1=function(b){this.buffer=document.createElement("canvas");this.buffer.width=this.canvas.width;this.buffer.height=this.canvas.height;this.V9p=this.buffer.getContext("2d")};c.prototype.V9r=function(b){this.clipRect=this.clipRect?this.clipRect.V7y(b):b};c.prototype.V9s=function(){this.ctx.save();this.clipRect?CB.V87.clipRect(this.ctx,this.clipRect):CB.V87.clipRect(this.ctx,new CB.V7p(1,1,this.canvas.width-1,this.canvas.height-
1));this.ctx.globalCompositeOperation="copy";try{this.ctx.drawImage(this.buffer,0,0)}catch(b){}this.ctx.restore();delete this.clipRect;this.V1zq=!1};c.prototype.V1zr=function(){var b=this.ctx.globalCompositeOperation;this.ctx.globalCompositeOperation="copy";this.ctx.drawImage(this.buffer,0,0);this.ctx.globalCompositeOperation=b;this.V1zq=!1;delete this.clipRect};c.prototype.V9q=function(b){this.clipRect=this.clipRect?this.clipRect.getUnion(b):b};c.prototype.V191=function(){this.V1zs&&window.cancelAnimationFrame(this.V1zs);
this.V1zt&&window.cancelAnimationFrame(this.V1zt)};c.prototype.V16b=function(b){this.V1zu=b};c.prototype.V187=function(b,c){if(!(this.V1zu||1>this.canvas.width||1>this.canvas.height))if(b){if(this.V9q(b),!this.V1zq||c)this.V1zq=!0,c&&window.cancelAnimationFrame(this.V1zs),this.V1zs=window.requestAnimationFrame(this.V9s.bind(this))}else if(!this.V1zq||c)this.V1zq=!0,c&&window.cancelAnimationFrame(this.V1zt),this.clipRect=new CB.V7p(1,1,this.canvas.width,this.canvas.height),this.V1zt=window.requestAnimationFrame(this.V9s.bind(this))};
c.prototype.V1zv=function(){this.control.V163(this.V9p)};c.prototype.V16d=function(){this.control&&this.control.drawWood&&this.control.drawWood(this.V9p)};c.prototype.V16u=function(b,c){b=Math.floor(b);c=Math.floor(c);this.V1zw(b,c)||(this.clipRect=this.V1zx=new CB.V7p(0,b,0,c),this.V1z3=1,this.V1zy(this.canvas,b,c),this.V1zy(this.buffer,b,c),this.control&&this.control.resize(b,c))};c.prototype.V1zy=function(b,c,e){b.width=c;b.height=e;b.style.width=c+"px";b.style.height=e+"px"};c.prototype.V1zw=
function(b,c){return 1!=this.V1z4()?(this.clipRect=this.V1zx=new CB.V7p(0,b,0,c),this.V1z3=this.V1z4(),this.V1zz(this.canvas,this.ctx,b,c,this.V1z3),this.V1zz(this.buffer,this.V9p,b,c,this.V1z3),this.control.resize(b*this.V1z3,c*this.V1z3),!0):!1};c.prototype.V1z4=function(){var b=window.devicePixelRatio,b=Math.min(3,b);CB.V5t.V74(b);return b};c.prototype.V1zz=function(b,c,e,f,g){b.width=Math.round(e*g);b.height=Math.round(f*g);b.style.width=e+"px";b.style.height=f+"px"};c.prototype.V200=function(){return this.ctx.webkitBackingStorePixelRatio||
this.ctx.mozBackingStorePixelRatio||this.ctx.msBackingStorePixelRatio||this.ctx.oBackingStorePixelRatio||this.ctx.backingStorePixelRatio||1};c.prototype.V73=function(){alert(0);return window.devicePixelRatio};c.prototype.hide=function(){this.canvas.style.visibility="hidden"};c.prototype.show=function(){this.canvas.style.visibility="visible"};c.prototype.V15z=function(){this.V1zu||(delete this.clipRect,this.control&&this.control.draw(this.V9p),this.V187(new CB.V7p(1,1,this.canvas.width-1,this.canvas.height-
1),!0))};return c}();
(function(){for(var c=0,b=["ms","moz","webkit","o"],d=0;d<b.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[b[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[d]+"CancelAnimationFrame"]||window[b[d]+"CancelRequestAnimationFrame"];for(d=0;d<b.length&&!window.cancelAnimationFrame;++d)window.cancelAnimationFrame=window[b[d]+"CancelAnimationFrame"]||window[b[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,
d){var g=(new Date).getTime(),h=Math.max(0,16-(g-c)),k=window.setTimeout(function(){b(g+h)},h);c=g+h;return k});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(b){clearTimeout(b)})})();"use strict";
CB.Vam=function(){var c=function(){window.localStorage?this.V1oa=window.localStorage:window.sessionStorage&&(this.V1oa=window.sessionStorage)};c.prototype.save=function(b,c){c&&void 0!==this.V1oa&&(this.V1oa[b]=JSON.stringify(c))};c.prototype.load=function(b){if(void 0!==this.V1oa&&this.V1oa[b]&&"undefined"!==this.V1oa[b])return JSON.parse(this.V1oa[b])};return c}();"use strict";
CB.V1h6=function(){var c=1,b=function(b,e,f){this.audio=document.createElement("audio");var g=this.V202();this.ok=!1;g?(this.url=b+g,this.audio.addEventListener("canplay",this.V203.bind(this),!1),this.audio.addEventListener("canplaythrough",this.V204.bind(this),!1),this.audio.addEventListener("ended",this.V205.bind(this),!1),this.audio.addEventListener("error",this.V8q.bind(this),!1),this.audio.addEventListener("abort",this.V8q.bind(this),!1),this.audio.src=b+g,this.V201=e,this.V207=this.V206=!1,
this.uniqueId=c++,f?this.audio.preload="none":(this.audio.load(),this.ok=!0,this.audio.preload="metadata")):this.url="!format!"};b.prototype.load=function(){this.audio.load();this.ok=!0};b.prototype.toString=function(){return this.url};b.prototype.play=function(){this.audio.play()};b.prototype.pause=function(){this.audio.pause()};b.prototype.V203=function(){};b.prototype.V204=function(){};b.prototype.V205=function(){this.V201&&this.V201(this.uniqueId)};b.prototype.V8q=function(){};b.prototype.V202=
function(){if(this.audio.canPlayType){var b=this.audio.canPlayType("audio/mpeg");if(""!=b)return".mp3";b=this.audio.canPlayType("audio/ogg");if(""!=b)return".ogg"}return""};return b}();
CB.V1fw=function(){var c=function(){this.queue=[];this.Vpe=0};c.prototype.push=function(b){var c=b;"string"==typeof b&&(c=new CB.V1h6(b));c.V201=this.V208.bind(this);c.ok&&(this.queue.push(c),console.log("Push: "+c.url));1==this.queue.length&&c.play()};c.prototype.Vs5=function(){console.log("Audio stop all");this.V209&&this.V209.pause();for(var b=0;b<this.queue.length;b++)this.queue[b]&&this.queue[b].pause();this.queue=[];delete this.V209};Object.defineProperty(c.prototype,"length",{get:function(){return this.queue.length},
set:function(b){this.queue.length>b&&this.queue.splice(0,this.queue.length-b)},enumerable:!0});c.prototype.V208=function(b){for(var c=0;c<this.queue.length;c++)if(this.queue[c]&&this.queue[c].uniqueId==b){c<this.queue.length-1&&this.queue[c+1].play();this.queue.splice(c,1);break}};return c}();"use strict";
CB.V1nr=function(){var c=function(){this.V20a=0;this.queue=[]};c.prototype={getLength:function(){return this.queue.length-this.V20a},empty:function(){return 0==this.queue.length},push:function(b){this.queue.push(b)},pop:function(){if(0!=this.queue.length){var b=this.queue[this.V20a];2*++this.V20a>=this.queue.length&&(this.queue=this.queue.slice(this.V20a),this.V20a=0);return b}},front:function(){return 0<this.queue.length?this.queue[this.V20a]:void 0}};return c}();"use strict";
CB.Vaa={Vad:function(c,b){for(var d=0,e=0,f=0,g=0;g<b.length;g++){var h=b[g].charCodeAt(0);if(63>h||126<h)return 1;h-=63;2>=e?(f|=h<<2-e,e+=6,8<=e&&(e-=8,c[d++]=f&255,f=0)):(e-=2,f|=h>>e,c[d++]=f&255,f=h<<8-e)}return d},Vab:function(c,b){var d="";if(0<b){for(var e=[],f=0,g=0,h=0;g<b;)2>=h?(e[f++]=63+(c[g]>>2-h&63)&255,h+=6,8<=h&&(g++,h-=8)):(h-=2,e[f]=c[g]<<h&63,g++,g<b?e[f]|=c[g]>>8-h&63:h=0,e[f++]+=63);for(g=e[f]=0;g<f;g++)d+=String.fromCharCode(e[g])}else d="";return d},V20b:function(c){for(var b=
"",d,e,f,g,h,k,l=0;l<c.length;)d=c[l++],e=c[l++],f=c[l++],g=d>>2,d=(d&3)<<4|e>>4,h=(e&15)<<2|f>>6,k=f&63,isNaN(e)?h=k=64:isNaN(f)&&(k=64),b=b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k);return b},V1f3:function(c,b){var d=this.V20b(c);
return"data:"+b+";charset=utf-8;base64,"+d}};"use strict";CB.V20c={V20d:1,V20e:2,V20f:3};CB.V20g=function(){var c={MATE_VALUE:3E4,MATE_THRESHOLD:28E3,MOVE_VALUE:28E3,MOVE_THRESHOLD:26E3};c.V20h=-c.MATE_VALUE;c.V20i=c.MATE_VALUE;c.V20j=function(b){return 0>b?-c.MATE_VALUE-b:c.MATE_VALUE-b};c.V20k=function(b){return b>-c.MATE_THRESHOLD||b<c.MATE_THRESHOLD?-1:0>b?b-c.MATE_THRESHOLD:c.MATE_THRESHOLD-b};return c}();
CB.V20l=function(){var c={EV_TOTALLY_WINNING:200,EV_WINNING:140,EV_ADVANTAGE:70,EV_SLIGHT_ADVANTAGE:25};c.EV_TOTALLY_LOSING=-c.EV_TOTALLY_WINNING;c.EV_LOSING=-c.EV_WINNING;c.EV_DISADVANTAGE=-c.EV_ADVANTAGE;c.EV_SLIGHT_DISADVANTAGE=-c.EV_SLIGHT_ADVANTAGE;c.getGlyph=function(b){return b>=c.EV_WINNING?CB.Vvv.Vwd:b>=c.EV_ADVANTAGE?CB.Vvv.Vwb:b>c.EV_SLIGHT_ADVANTAGE?CB.Vvv.Vw9:b>=c.EV_SLIGHT_DISADVANTAGE?CB.Vvv.Vw7:b>c.EV_DISADVANTAGE?CB.Vvv.Vwa:b>c.EV_LOSING?CB.Vvv.Vwc:CB.Vvv.Vwe};return c}();
CB.V20m={V20n:"Clear Hash",V20o:"MultiPV",V20p:"Ponder"};
CB.Vs4=function(){var c={getPosString:function(b){var c="position startpos ";b.isNormalInit()||(c="position fen "+b.getStartPos().toFEN());b=b.getCurLineCut();0<b.length&&(c+="moves ");for(var f=0;f<b.length;++f)c+=b[f].toString()+" ";return c},getGoString:function(b){var c=new StringBuilder;c.append("go ");b=b||{};b.depth?c.appendFormat("depth {0} ",b.depth):b.moveTime&&c.appendFormat("movetime {0} ",Math.round(b.moveTime));b.wTime&&c.appendFormat("wtime {0} ",Math.round(b.wTime));b.bTime&&c.appendFormat("btime {0} ",
Math.round(b.bTime));(b.infinite||ObjUtil.isEmpty(b))&&c.appendFormat("infinite ");return c.toString()},getSetOptionString:function(b,c){var f=String.formatEx("setoption name {0}",b);"undefined"!==typeof c&&(f+=String.formatEx(" value {0}",c));return f}},b=function(c,e,f){this.url=c;this.worker=null;this.V20q=!1;this.V20r=f||null;this.Vs0=e;this.V20s=[];this.cur=null;this.lines=[];this.V20t={name:"",author:""};this.V20u=!1;this.Vs0&&(this.V20v=setInterval(this.V20w.bind(this),b.POOL_TIMEOUT));this.V20x=
CB.Vs4._createPreDefaultOptions();this.id=++b.engineCount};b.engineCount=0;b._createPreDefaultOptions=function(){var b={};b[CB.V20m.V20o]=1;b[CB.V20m.V20p]="false";return b};b.prototype.V20y=function(){return this.V20r};b.prototype.setTag=function(b){this.V20r=b};b.prototype.V20z=function(){CBDebug.assert(null!=this.worker);CBDebug.assert(this.V20q);this.V20q=!1;this.worker.terminate();this.worker=null};b.prototype.V210=function(b){b=b.split(" ");var c=CB.Veh.fromString(b[1]),f;"ponder"==b[2]&&(f=
CB.Veh.fromString(b[3]));this.V20q=!1;this.fireOnBestMove(this,{move:c,ponder:f})};b.prototype.V211=function(b){for(var c=b.split(" "),f=b=null,g=null,h=1,k=null,l=null,m=null,p=null,r=null,u=null,q=CB.V20c.V20f,t=!1,v=1;v<c.length;++v)switch(c[v]){case "depth":b=parseInt(c[++v]);break;case "seldepth":f=parseInt(c[++v]);break;case "nps":l=parseInt(c[++v]);break;case "nodes":m=parseInt(c[++v]);break;case "score":var w=c[++v],g=parseInt(c[++v]);switch(w){case "mate":t=!0}break;case "time":p=parseInt(c[++v]);
break;case "currmovenumber":u=parseInt(c[++v]);break;case "currmove":w=c[++v];r=CB.Veh.fromString(w);break;case "lowerbound":q=CB.V20c.V20d;break;case "upperbound":q=CB.V20c.V20e;break;case "multipv":h=parseInt(c[++v]);break;case "pv":for(k=[],++v;v<c.length;++v)if(w=c[v],CB.Veh.isValidString(w))k.push(CB.Veh.fromString(w));else{--v;break}}f=f||b;b&&this.fireOnInfo(this,b,f,m,l,p);r&&this.fireOnCurMove(this,u,r);k&&(this.lines[h-1]=k,c=ObjUtil.clone(k),this.fireOnLine(this,b,f,q,t,g,h,c,{handicap:0,
analysis:this.V212&&this.V212.infinite}))};b.g_regexMeta=/^id (\w+) (.*)$/i;b.prototype.V213=function(c){this.V20u||(c=b.g_regexMeta.exec(c))&&c.length&&(this.V20t[c[1]]=c[2])};b.prototype.V214=function(b){this.V20u||(this.V20u=!0,this.fireOnUCIInfo(this))};b.prototype.V215=function(b){"readyok"!==b&&("uciok"===b?this.V214():b.startsWith("id")?this.V213(b):b.startsWith("option")||(b.startsWith("bestmove")?this.V210(b):b.startsWith("info")&&this.V211(b)))};b.prototype.V216=function(b){this.V217=!1;
this.V215(b.data)};b.prototype.V1d1=function(b){this.worker&&this.worker.postMessage(b)};b.POOL_TIMEOUT=2E3;b.prototype.V20s=[];b.prototype.V218=function(){if(0==this.V20s.length)try{return new Worker(this.url)}catch(b){alert("Engine: "+b)}return this.V20s.pop()};b.prototype.V20w=function(){this.V20s.length>=this.Vs0||this.V219()};b.prototype.V219=function(){console.log("Engine: "+this.url);try{CB.Vs4.V21a?this.V21b(function(b){this.V20s.push(b)}.bind(this)):this.V20s.push(new Worker(this.url))}catch(b){CB.Vjg("Engine "+
this.url,b)}};b.prototype.V21c=function(){try{this.worker=this.V218(),this.worker.onmessage=this.V216.bind(this),this.V1d1("uci"),this.V1d1("isready"),this.V21d()}catch(b){CB.Vjg("Start this.url",b)}};b.prototype.go=function(b,e){this.V212=e||{infinite:!0};this.stop();this.V20q=!0;this.fireOnSearchStart();if(!this.worker&&!this.V217){this.V217=!0;if(CB.Vs4.V21a){this.V21b(function(b){return function(d){this.V217=!1;this.worker=d;this.worker.onmessage=this.V216.bind(this);this.V1d1("uci");this.V1d1("isready");
this.V21d();d=c.getPosString(b);var e=c.getGoString(this.V212);this.cur=ObjUtil.clone(b.getCurPos());this.lines=[];this.V1d1(d);this.V1d1(e)}.bind(this)}.call(this,b));return}this.V21c()}var f=c.getPosString(b),g=c.getGoString(this.V212);this.cur=ObjUtil.clone(b.getCurPos());this.lines=[];this.V1d1(f);this.V1d1(g)};b.prototype.getCurPos=function(){return this.cur};b.prototype.V21e=function(){return this.lines};b.prototype.getBestMove=function(){return 0==this.lines.length||0==this.lines[0].length?
null:this.lines[0][0]};b.prototype.stop=function(){this.worker&&this.V20q&&this.V20z()};b.prototype.getName=function(){return this.V20t.name};b.prototype.isCalculating=function(){return this.V20q};b.prototype.V21f=function(){};b.prototype.newGame=function(){this.worker&&!this.V20q&&this.V1d1("ucinewgame");this.fireOnNewGame()};b.prototype.dispose=function(){if(this.Vs0){if(this.V20s.length)for(var b=0;b<this.V20s.length;++b)this.V20s[b].terminate();clearInterval(this.V20v)}this.removeAllListeners()};
b.prototype.exit=function(){this.stop();this.dispose();this.fireOnExit()};b.prototype.V20x=null;b.prototype.V21g=function(b,e){this.V20x[b]=e;this.worker&&this.V1d1(c.getSetOptionString(b,e))};b.prototype.V21h=function(b){return this.V20x[b]};b.prototype.setMultiPV=function(b){this.V21g(CB.V20m.V20o,b)};b.prototype.getMultiPV=function(){return this.V21h(CB.V20m.V20o)};b.prototype.V21i=function(){this.V21g(CB.V20m.V20n)};b.prototype.V21j=function(b){this.V21g(CB.V20m.V20p,b?"true":"false")};b.prototype.V21k=
function(){return!1};b.prototype.V21d=function(){for(var b in this.V20x)this.V20x.hasOwnProperty(b)&&this.V1d1(c.getSetOptionString(b,this.V20x[b]))};b.prototype.V21b=function(b){$.ajax({url:"https://pgn.chessbase.com/common/chess/engine/df14/df14AjaxData.js",type:"GET",data:{},async:!0,cache:!0,processData:!1,success:function(c){c=new Blob([c],{type:"application/javascript"});c=new Worker(URL.createObjectURL(c));b(c)}})};V34y.initForListeners(b);V34y.addEvent(b,"Line");V34y.addEvent(b,"LosingLine");
V34y.addEvent(b,"CurMove");V34y.addEvent(b,"CurLine");V34y.addEvent(b,"Info");V34y.addEvent(b,"BestMove");V34y.addEvent(b,"UCIInfo");V34y.addEvent(b,"NewGame");V34y.addEvent(b,"SearchStart");V34y.addEvent(b,"Exit");V34y.addEvent(b,"Threat");return b}();"use strict";
CB.AnalysisEngine=function(){var c={},b=function(d){d=d||{};this.options=ObjUtil.copyTo(c,d,!0);this.Vs0=0;this.Vs3();this.id=++b.engineCount};b.engineCount=0;b.prototype.destroy=function(){};b.prototype.Vs3=function(){this.engine=new CB.Vs4(V35p.config.Vs8()[0],this.Vs0,0);this.V21l=this.engine.addOnLineListener(this.V21m.bind(this))};b.prototype.Vnq=function(){this.Vs1[0].isCalculating()&&this.Vs1[0].stop()};b.prototype.Vt0=function(){this.engine.stop();this.Vtl=!1};b.prototype.Vt1=function(){this.V21n()};
b.prototype.dispose=function(){this.engine.exit()};b.prototype.Vsz=function(b){b.getMarkedSquaresOnButtonDown&&(b.clickHintTimer||(b.clickHintTimer=new CB.Timer),b.kernel.boardWin.fnMarkSquaresOnButtonDown=b.getMarkedSquaresOnButtonDown.bind(b),b.startClickHintTimer&&(b.kernel.boardWin.fnSquareClick=b.startClickHintTimer.bind(b)),b.kernel.boardWin.fnSquareChangeInMouseMove=function(){b.clickHintTimer.stop()}.bind(b),b.kernel.boardWin.fnSquareRelease=function(){b.clickHintTimer.stop()}.bind(b),b.idOnLineListener=
this.addOnLineListener(b.onAnalysisLine.bind(b)),b.kernel.boardWin.idOnLineListener=this.addOnLineListener(b.kernel.boardWin.refreshMarkedSquares.bind(b.kernel.boardWin)))};b.prototype.Vsw=function(b){b.clickHintTimer&&b.clickHintTimer.stop();b.kernel.boardWin&&(b.kernel.boardWin.fnSquareClick=null,b.kernel.boardWin.fnMarkSquaresOnButtonDown=null,this.removeOnLineListener(b.kernel.boardWin.idOnLineListener));this.removeOnLineListener(b.idOnLineListener)};b.prototype.Vt4=function(b){this.V21n();this.kernel=
b;this.engine.setMultiPV(this.V21o());this.engine.go(this.kernel.game,{infinite:!0});this.Vtl=!0};b.prototype.V21o=function(){return this.V21p?this.V21p:this.kernel.game.getCurPos().V34r().length};b.prototype.Vtk=function(b){var c=[],f=CB.AnalysisEngine.linesToArray(this.V21q);f.sort(function(b,c){return c.getEval()-b.getEval()});if(!f.length)return c;var g=f[0].getEval();f.forEach(function(f){var k=f.getEval();f.getMove().from==b&&c.push({sq:f.getMove().to,clr:this.V21r(k,g),txt:g-k})}.bind(this));
return c};b.prototype.V21r=function(b,c){if(23E3<Math.abs(b))return new CB.HSLColor(0,0,0,.6);for(var f=c-b,g=.55+.15,g=[[2E4,0,95,55,1],[1E3,3,95,50,.9],[700,4,95,48,.9],[400,12,95,47,.9],[300,14,95,46,.9],[250,18,95,46,g],[200,19,95,45,.9],[170,20,90,60,.9],[140,24,90,60,.9],[120,28,90,60,.9],[100,30,90,60,.9],[90,34,90,45,.9],[80,38,90,45,g],[70,46,90,45,g],[60,50,90,45,g],[50,65,90,45,g],[40,70,90,45,.55],[30,75,90,45,.55],[20,80,90,45,.55],[15,90,90,45,.55],[10,100,90,45,.55],[7,110,90,45,.55],
[5,115,90,42,.7],[0,120,90,42,.74]],h=0;h<g.length;h++)if(f>=g[h][0])return new CB.HSLColor(g[h][1],g[h][2],g[h][3],g[h][4]);return new CB.HSLColor(CB.HSLColor.GREEN,90,40,.6)};b.prototype.V21n=function(){this.V21q={};this.V21s={};this.V21t=[];this.V21u=[];this.V21v=1;this.V21w=null};b.prototype.V21m=function(b,c,f,g,h,k,l,m){if(g==CB.V20c.V20f){if(c>this.V21v){this.V21x=0;this.V21y(ObjUtil.clone(this.V21q),this.V21v);if(this.V21v&&this.V21u[this.V21v].length){var p,r;1<this.V21u[this.V21v].length&&
(p=this.V21u[this.V21v][1],r=this.V21u[this.V21v][1].getEval());this.fireOnLine(this.V21v,this.V21u[this.V21v][0].getEval(),this.V21u[this.V21v][0],r,p)}this.V21v=c;(18<=c||(CB.V5t.V64()||CB.V5t.V6c())&&8<=c)&&this.Vt0()}h&&(k=CB.V20g.V20j(k));b=new CB.V21z(m,k);this.V21q[b.key()]=b}};b.prototype.V21y=function(b,c){this.V21t[c]=b;this.V21u[c]=CB.AnalysisEngine.linesToArray(b)};b.linesToArray=function(b){var c=[],f;for(f in b)b.hasOwnProperty(f)&&c.push(b[f]);c.sort(function(b,c){return c.getEval()-
b.getEval()});for(b=0;b<c.length;b++)c[b].lineNumber=b;c.getNLinesInEvalRange=function(b){for(var c=0,d=this[0].getEval(),e=1;e<this.length&&!(d-this[e].getEval()>b);e++)c++;return c};c.hasClearlyBest=function(b){return 1==c.length?!0:c[0].getEval()-c[1].getEval()>=b};return c};b.prototype.getBestMove=function(){if(3<this.V21v){var b=CB.AnalysisEngine.linesToArray(this.V21q);b.sort(function(b,c){return c.getEval()-b.getEval()});return b[0].getMove()}};V34y.initForListeners(b);V34y.addEvent(b,"Line");
return b}();"use strict";
CB.V1co=function(){var c=function(b){this.val=b};c.V1cp=function(b){return 2E4<b?lm.WHITE_MATES:420<b?lm.WHITE_CLEARLY_WINNING:350<b?lm.WHITE_WINNING:250<b?lm.WHITE_DECISIVE:130<b?lm.WHITE_CLEARLY_BETTER:80<b?lm.WHITE_BETTER:40<b?lm.WHITE_SLIGHTLY:22<b?lm.WHITE_EDGE:-2E4>b?lm.BLACK_MATES:-420>b?lm.BLACK_CLEARLY_WINNING:-350>b?lm.BLACK_WINNING:-250>b?lm.BLACK_DECISIVE:-130>b?lm.BLACK_CLEARLY_BETTER:-80>b?lm.BLACK_BETTER:-40>b?lm.BLACK_SLIGHTLY:-22>b?lm.BLACK_EDGE:lm.EQUAL_POS};c.prototype.toString=
function(){return c.V1cp(this.val)};return c}();CB.V21z=function(){var c=function(b,c){this.line=b;this.eval=c};c.prototype.getEval=function(){return this.eval};c.prototype.getLine=function(){return this.line};c.prototype.length=function(){return this.line.length};c.prototype.getMove=function(b){return this.line[b||0]};c.prototype.key=function(){return this.getMove().toString()};c.prototype.toString=function(){return String.formatEx("{eval}: {line}",this)};return c}();"use strict";
CB.EngineLinesElement=function(){function c(b){if(b.handicap){var c=CB.V22n.V22o(b.handicap);return String.formatEx("Handicap: {0}, {1} {2} {3}={4}s",c,lm.DEPTH,b.depth,lm.TIME,idiv(b.totalTime,1E3))}return String.formatEx(lm.ENG_SEARCH_INFO_FMT,b.depth,b.maxDepth,idiv(b.nps,1E3),idiv(b.totalTime,1E3))}function b(b){var c=CB.$(b.target),d=c.data("pv"),d=d.trim(),d=d.split(" ").map(CB.Veh.fromString),c=c.parent("[data-pos]"),c=CB.$(c),c=new CB.Position(c.data("pos")),d=new CB.Game(c,d),d=CB.V12k.V12l(d);
b.dataTransfer.setData("text",d)}function d(d,e,h){if(CB.$(".pv",d)){d.on("dragstart",b);CB.$(".pv",d).text(e.pv.lineStr);CB.$(".pvnum",d).text(e.num);if(e.evalStr&&e.handicap)CB.$(".evStr",d).text(e.evalStr);else{var k=new StringBuilder;CB.NotaElement.V1d6(e.symbol,k,"cbspec-glyph");h=k.toString();CB.$(".symbol",d).html(h)}d.data("pvnum",e.num);d.data("depth",e.depth);d.data("mv",e.pv[0].toString());k=new StringBuilder;e.handicap?k.appendFormat("{0}",e.pv[0]):e.pv.forEach(function(b){k.appendFormat("{0} ",
b)});d.data("pv",k.toString());d.removeClass("outdated");CB.$(".engine-info-text").hide();e=c(e);CB.$(".data",d).text(e)}}var e=function(b){this.V1bk=b||0;this.V220()};e.V221=e.V222="<div class='line'><div class='nota'><span class='pvnum'></span><span class='symbol'></span><span class='pv'></span></div><div class='data'></div><div class='evStr'></div></div>";e.V1xt={scrollLines:!0};e.prototype.V223=function(b){return String.f("<div class='lines-container' id='lines-container-{0}'><div class='engine-lines' id='engine-lines-{0}' ><div class='data-common' id='data-common-{0}'></div></div></div><div class='engine-info-text' id='engine-info-text-{0}'></div>",
b)};e.prototype.V1bp=function(b,c){this.options=ObjUtil.copyTo(e.V1xt,c||{},!0);this.el=b;CB.$(this.el).html(this.V223(this.V1bk));var d=CB.$("#engine-lines-"+this.V1bk,this.el);this.V224=d.single();this.V225=CB.$("#lines-container-"+this.V1bk,this.el).single();CB.$("#data-common-"+this.V1bk).html(this.options.V226||"<br/>"+lm.LOADING_ENGINE);d.on("click",this.V227.bind(this));this.V1bs=this.V225};e.prototype.V220=function(){this.V21v=this.V93=this.lastTime=this.V229=this.V228=null};e.prototype.V227=
function(b){b.preventDefault();var c=b.target;b=CB.$(c);CB.$.is(c,".line")||(c=b.parent(".line"));c&&(b=CB.$(c).data("mv"),CB.Veh.isValidString(b)&&(b=CB.Veh.fromString(b),this.fireOnMoveEntered(b)))};e.prototype.clear=function(){CB.$(".line",this.V224).remove();CB.$("#data-common-"+this.V1bk,this.V224).empty()};e.prototype.V1h4=function(){this.clear()};e.prototype.displayInfo=function(b,c){this.clear();this.V22a();this.V22b(b,c)};e.prototype.V22c=function(b){this.clear();this.V22a();this.V22b("Calculating ...",
"startSearch")};e.prototype.onExit=function(b){this.clear();this.V22a();this.V22b("Engine Stopped.","engineStopped")};e.prototype.V22d=function(b){b?$("#engine-lines-"+this.V1bk).addClass("cbEngineThreat"):$("#engine-lines-"+this.V1bk).removeClass("cbEngineThreat")};e.prototype.V22e=function(b,c,d,e,l,m){this.V228=l||this.V228;this.V229=e||this.V229;this.lastTime=m||this.lastTime};e.prototype.V22f=function(b,c,d,e,l,m,p,r,u){this.V22g();this.V22h();if(e===CB.V20c.V20f){e=b.getMultiPV();CB.$(this.V224).data("lines",
e);e=1<e;b=b.getCurPos();var q=b.toFEN();CB.$(this.V224).data("pos",q);(this.V93&&!b.equals(this.V93)||this.V21v&&this.V21v>c)&&this.clear();e||this.options.scrollLines||this.clear();e&&1==p&&CB.$(".line",this.V224).addClass("outdated");this.V93=b;this.V21v=c;CB.Game.Vi1(b,r);var t=new CB.Vib(lm.NOTA_LOCALIZATION);u.analysis||(r=r.slice(0,1));var q=t.Vil(b,r),v=m;l?(0>v&&(v=-v),v=t.Vik().strMate+v):(b.isWTM()||(v=-v),v=(v/100).toFixed(2));q=u.analysis?"("+v+") "+q:" "+q;d={id:"pv",line:r,pv:r,eval:m,
evalStr:CB.V1co?CB.V1co.V1cp(100*v)+".":"",nps:this.V228,depth:c,maxDepth:d,totalTime:this.lastTime,handicap:u.handicapStyle,analysis:u.analysis,num:p};d.pv.lineStr=q;b.isBTM()&&(m=-m);m=CB.V20l.getGlyph(m);m=V359.getText(m);d.symbol=m;this.V22i(d);this.V22j(d,e,c);e||this.V22k()}};e.prototype.V22l=function(b,c){this.V22m();this.V22b("Your Chance!","findStrong")};e.prototype.V22k=function(){this.V1bs&&(this.V1bs.scrollTop=this.V1bs.V1dl)};e.prototype.V22i=function(b){CB.$("#data-common-"+this.V1bk,
this.V224).text(c(b))};e.prototype.V22m=function(){CB.$("#engine-info-text-"+this.V1bk).show()};e.prototype.V22h=function(){CB.$("#engine-info-text-"+this.V1bk).hide()};e.prototype.V22g=function(){CB.$("#engine-info-text-"+this.V1bk).hide();CB.$("#lines-container-"+this.V1bk).show()};e.prototype.V22a=function(){CB.$("#engine-info-text-"+this.V1bk).show();CB.$("#lines-container-"+this.V1bk).hide()};e.prototype.V22b=function(b,c){CB.$("#engine-info-text-"+this.V1bk).text(b);CB.$("#engine-info-text-"+
this.V1bk).removeClass("findStrong");c&&CB.$("#engine-info-text-"+this.V1bk).addClass(c)};e.prototype.V22j=function(b,c){var h=CB.$("#data-common-"+this.V1bk,this.V224);if(c){var k=String.formatEx(".line[data-pvnum='{0}']",b.num),k=CB.$(k);0==k.length&&(k=CB.$(e.V222),k.insertBefore(h));d(k,b)}else k=CB.$(e.V222),d(k,b),k.insertBefore(h)};e.prototype.setEngine=function(b){this.engine&&(this.engine.removeOnLosingLineListener(this.V22p),this.engine.removeOnInfoListener(this.V22q),this.engine.removeOnNewGameListener(this.V22r),
this.engine.removeOnSearchStartListener(this.V22s),this.engine.removeOnExitListener(this.V22t),this.engine.removeOnThreatListener(this.V22u));if(this.engine=b)this.V21l=this.engine.addOnLineListener(this.V22f.bind(this)),this.V22p=this.engine.addOnLosingLineListener(this.V22l.bind(this)),this.V22q=this.engine.addOnInfoListener(this.V22e.bind(this)),this.V22r=this.engine.addOnNewGameListener(this.V1h4.bind(this)),this.V22s=this.engine.addOnSearchStartListener(this.V22c.bind(this)),this.V22t=this.engine.addOnExitListener(this.onExit.bind(this)),
this.V22u=this.engine.addOnThreatListener(this.V22d.bind(this))};V34y.initForListeners(e);V34y.addEvent(e,"MoveEntered");return e}();"use strict";
CB.V22v=function(){return{autoEngPanel:null,_autoShowEngine:!1,V22w:function(){return this.autoEngPanel},V22x:function(c){this._autoShowEngine!==c&&(this._autoShowEngine=c,this.toggleEnginePanel(c))},getAutoShowEngine:function(){return this._autoShowEngine},V22y:function(){this._autoShowEngine=!this._autoShowEngine;this.toggleEnginePanel(this._autoShowEngine);return this._autoShowEngine},toggleEnginePanel:function(c){V35p.commands.Vsx(CB.Vlw.V22z,c);var b=this.V230(),d=b.region,b=b.container;c?(this.autoEngPanel||
(this.autoEngPanel=CB.V231.V232(0,{h:CB.V5t.pixToZoom(.26*window.innerHeight),region:d,autoInit:!0,active:!0})),this.beforeShowAutoEngPanel(),b.contains(this.autoEngPanel)||(b.add(this.autoEngPanel),b.updateLayout())):this.autoEngPanel&&(b.remove(this.autoEngPanel,!0),this.afterHideAutoEngPanel(),this.autoEngPanel.setGame(null),this.autoEngPanel.V233(),this.autoEngPanel=null);return this.autoEngPanel},beforeShowAutoEngPanel:function(){},afterHideAutoEngPanel:function(){}}}();CB.V234=function(){}();
CB.V235=function(){return{createAutoEngineBtn:function(c){return CB.V139.V236(c,lm.ANALYSIS_ENGINE,"Engine",CB.Vlw.V22z,lm.ANALYSIS_ENGINE,CB.V237(4),"RunningEngine")},createToolBarEngineBtn:function(){return CB.V139.V238("","Engine16",CB.Vlw.V22z,lm.ANALYSIS_ENGINE)}}}();"use strict";
CB.Commands=function(){var c=function(){this.V23a=this.V239=0;this.V23b=[];this.V23c=[];this.V23d={};this.V23e=0;this.V23f={}};c.prototype.Vka=function(b){this.V239+=1;this.V23b[this.V239]=b;return this.V239};c.prototype.Vkd=function(b){delete this.V23b[b]};c.prototype.V23g=function(b,c){try{for(var e=0;e<this.V23b.length&&(void 0===this.V23b[e]||!this.V23b[e].execCommand(b,c));e++);}catch(f){e=V35p.V358.Vlu(b),CB.Vjg(e,f)}};c.prototype.onFileSelect=function(b,c){for(var e=0;e<this.V23b.length;e++)if(void 0!==
this.V23b[e]&&this.V23b[e].onFileSelect)this.V23b[e].onFileSelect(b,c)};c.prototype.onTextFieldChange=function(b,c){for(var e=0;e<this.V23b.length;e++)if(void 0!==this.V23b[e]&&this.V23b[e].onTextFieldChange)this.V23b[e].onTextFieldChange(b,c)};c.prototype.onRegisterField=function(b,c){for(var e=0;e<this.V23b.length;e++)if(void 0!==this.V23b[e]&&this.V23b[e].onRegisterField)this.V23b[e].onRegisterField(b,c)};c.prototype.V23h=function(b,c){};c.prototype.V23i=function(b){};c.prototype.Vkc=function(b){this.V23a+=
1;this.V23c[this.V23a]=b;return this.V23a};c.prototype.Vke=function(b){delete this.V23c[b]};c.prototype.V23j=function(b){try{if(0>=this.V23e)for(var c=0;c<this.V23c.length;c++)if(void 0!==this.V23c[c]&&this.V23c[c].onKeyDown(b)){b.stopEvent();break}}catch(e){CB.Vjg("KeyDown="+b.getKey(),e)}return!0};c.prototype.execCommandLine=function(b){for(var c=0;c<this.V23b.length&&(void 0===this.V23b[c]||!this.V23b[c].execCommandLine||!this.V23b[c].execCommandLine(b));c++);};c.prototype.V23k=function(){--this.V23e;
0>this.V23e&&CBDebug.assert("Shortcut counter")};c.prototype.V23l=function(){this.V23e+=1};c.prototype.V23m=function(){return this.V23f};c.prototype.Vsx=function(b,c){this.V23f={id:b,state:c};this.fireOnChecked()};c.prototype.V23n=function(b,c){this.V23f={id:b,state:c};this.fireOnEnabledChanged()};c.prototype.V23o=function(b,c){this.V23f={id:b,state:c};this.fireOnVisibleChanged()};V34y.initForListeners(c);V34y.addEvent(c,"Checked",function(){return[this.V23m()]});V34y.addEvent(c,"EnabledChanged",
function(){return[this.V23m()]});V34y.addEvent(c,"VisibleChanged",function(){return[this.V23m()]});return c}();
CB.Vlw={V5k:0,FLIP_BOARD:1,V1k:2,Vl2:3,Vl4:4,Vm1:5,V3n:6,Vm0:7,V22z:8,V23p:9,ADD_POST_TEXT:10,Vl7:11,PROMOTE_LINE:12,DELETE_LINE:13,CUT_LINE:14,MARK_GOOD:15,MARK_BAD:16,MARK_VERYGOOD:17,MARK_VERYBAD:18,MARK_INTERESTING:19,MARK_DUBIOUS:20,WHITE_WINS:30,WHITE_BETTER:31,WHITE_SLIGHTLY:32,EQUAL:33,UNCLEAR:34,BLACK_WINS:36,BLACK_BETTER:37,BLACK_SLIGHTLY:38,COMPENSATION:35,INSERT_DIAGRAM:39,Vl5:40,OPEN_PGN_DATABASE:60,Vld:63,Vla:70,Vlc:71,V23q:75,V2w:80,V23r:100,V14d:101,V14f:115,V14h:102,V14b:103,V14j:104,
V14l:105,V23s:106,V23t:107,V23u:108,V23v:109,V23w:110,V23x:111,V23y:112,V23z:113,V240:114,V241:120,V14a:200,V14e:201,V14g:202,V14i:203,V14c:204,V14k:205,V14m:206,V242:210,V243:211,V244:212,V245:213,V246:214,V247:215,Vlf:231,V29:240,Vlg:250,Vli:251,V248:260,V249:261,V1fh:262,V24a:263,V24b:264,V24c:265,V24d:266,V24e:267,V24f:268,V24g:269,LOGIN:300,LOGOUT:301,CHANGE_PASSWORD:302,V24h:303,V36:304,INVITE_FRIEND:305,V3j:306,V24i:400,V24j:400,V24k:401,V24l:402,V24m:403,V24n:404,V24o:405,V24p:406,V24q:407,
V24r:408,V24s:409,V24t:410,V24u:411,V24v:412,V24w:413,V24x:414,V24y:415,V24z:416,V250:417,V251:418,V252:419,V253:420,V254:421,V255:422,V256:423,V257:424,V258:425,V259:426,V25a:500,V1kr:9999,Vlu:function(c){return"CommandId="+c}};CB.V5o=function(){return"/Common/"};
CB.V25b={V8o:!1,Vs8:function(){5;return["/Common/Chess/Engine/df14/df14.js"]},V25c:function(){return"https://pgn.chessbase.com/common/"},V1xr:function(){return CB.V5o()+"Media/Ribbons/"},getPlaychessUris:function(){return CB.V5t.V6r()?["wss://cbridge2.chessbase.com:6008","wss://cbridge3.chessbase.com:6008","wss://cbridge4.chessbase.com:6008"]:["ws://cbridge2.chessbase.com:7000","ws://cbridge3.chessbase.com:7000","ws://cbridge4.chessbase.com:7000"]},getLiveUris:function(){return https?["wss://liveserver.chessbase.com:443"]:
["ws://liveserver.chessbase.com:7001"]},getLiveResult:function(){var c=CB.V5t.V6r();return[(c?"https":"http")+"://liveserver.chessbase.com:"+(c?6009:80)]},getDBBridgeUris:function(){return CB.V5t.V6r()?["wss://dbserver.chessbase.com:6008"]:["ws://dbserver.chessbase.com:7000"]},getCloudServerUris:function(){return CB.V5t.V6r()?["wss://cloudserver.chessbase.com:6008"]:["ws://cloudserver.chessbase.com:7000"]},getTrainingUris:function(){return CB.V5t.V6r()?["wss://trainingserver.chessbase.com:443"]:["ws://trainingserver.chessbase.com:7000",
"wss://trainingserver.chessbase.com:6008"]},V25d:function(){return CB.V5t.V6r()?["wss://pbridge.chessbase.com:6008"]:["ws://pbridge.chessbase.com:7000"]},V25e:function(){return CB.V5t.V6r()?["wss://tbridge.chessbase.com:6008"]:["ws://tbridge.chessbase.com:7000"]},getAccountUris:function(){return CB.V5t.V6r()?["https://users.chessbase.com"]:["http://users.chessbase.com"]},V25f:function(){return CB.V5t.V6r()?["https://videos.chessbase.com/"]:["http://videos.chessbase.com/"]},loginWebUrl:"http://account.chessbase.com",
createAccountWebUrl:"http://account.chessbase.com/en/create-account",resetPasswordWebUrl:"http://account.chessbase.com/en/pwd-recovery",V1hd:!1,editAccountUrl:"http://account.chessbase.com/{0}/me",V25g:"http://help.chessbase.com/Apps/{0}/index.html",V25h:function(c){return CB.V5o()+"Media/FlagsIso/"+c+"/"},V25i:!1,V173:0,V174:0,Vro:!0,debug:!0};
CB.V25j=ObjUtil.copyTo(CB.V25b,{release:!0,loginWebUrl:"http://account.chessbase.com",getPlaychessUris:function(){return CB.V5t.V6r()?["wss://cbridge2.chessbase.com:6008","wss://cbridge3.chessbase.com:6008","wss://cbridge4.chessbase.com:6008"]:["ws://cbridge2.chessbase.com:7000","ws://cbridge3.chessbase.com:7000","ws://cbridge4.chessbase.com:7000"]},getTrainingUris:function(){return CB.V5t.V6r()?["wss://trainingserver.chessbase.com:443","wss://trainingserver.chessbase.com:6008"]:["wss://trainingserver.chessbase.com:443",
"wss://trainingserver.chessbase.com:6008","ws://trainingserver.chessbase.com:7000"]},getDBBridgeUris:function(){return CB.V5t.V6r()?["wss://dbserver.chessbase.com:6008"]:["ws://dbserver.chessbase.com:7000"]},getCloudServerUris:function(){return CB.V5t.V6r()?["wss://cloudserver.chessbase.com:6008"]:["ws://cloudserver.chessbase.com:7000"]},getAccountUris:function(){return CB.V5t.V6r()?["https://users.chessbase.com"]:["http://users.chessbase.com"]},getLiveUris:function(){return["wss://liveserver.chessbase.com:443"]},
getLiveResult:function(){var c=CB.V5t.V6r();return[(c?"https":"http")+"://liveserver.chessbase.com:"+(c?6009:80)]},createAccountWebUrl:"https://account.chessbase.com/en/create-account",resetPasswordWebUrl:"http://account.chessbase.com/en/pwd-recovery",editAccountUrl:"http://account.chessbase.com/{0}/me",debug:!1},!0);
CB.ChessApp=function(){var c=function(){void 0===this.config&&(this.config=CB.V25j);this.V1e5=CB.V5o()+"Media/";this.V14r=this.V1e5+"Chess/";this.V195=16;document.onmousemove=this.V25k.bind(this);document.onkeypress=this.V25k.bind(this);this.V25l=new CB.Timer;this.V25m=new CB.V4y;this.V25n=!1;this.appName=this.V25o="ChessBase App";Window.localforage&&localforage.config({driver:localforage.INDEXEDDB,name:"ChessBase",version:1,storeName:"CBCache"})};c.prototype.V25p=function(){this.commands=new CB.Commands;
glSettings=new CB.GlobalSettings;this.V25q();this.V25l.runPeriodic(6E4,this.V25r.bind(this));this.V25s(CB.Vlw,this.V25t());this.Vk9=this.commands.Vka(this);var b=CB.V47.V4i("lang");b&&(b=CB.V79.V7d(b),glSettings.languageCommandId=glSettings.getCommandIdOfLanguage(b));"undefined"!=typeof glSettings.languageCommandId?glSettings.changeLanguage(glSettings.languageCommandId):this.changeLanguage(CB.V79.V7c());CB.V5t.V64()||V35p.V25u();window.onerror=function(b,c,d,h,k){k=0<=c.search("df14")?"Engine":"Main";
c=String.formatEx("line={0}, col={1}, obj={2}",d,h,k);CB.Vjg(b,c);"Engine"==k&&V35p&&V35p.panelMgr&&V35p.panelMgr.showMessage("Sorry, cannot load the engine, please use the Chrome Browser or Firefox")}};c.prototype.V25v=function(){glSettings.destroy()};c.prototype.V15u=function(){return!1};c.prototype.V1qj=function(){return this.config.loginWebUrl};c.prototype.V1rg=function(){return this.config.loginWebUrl+"en/me"};c.prototype.V25q=function(){glSettings.boardTextureId||(glSettings.boardTextureId=
this.V25w());var b=glSettings.boardTextureId;glSettings.boardTextureId=void 0;this.V170(b);this.V1ft=new CB.V1fu(V35p.config.V25c()+"Media/Sounds/")};c.prototype.V25w=function(){return CB.Vlw.V14a};c.prototype.V170=function(b){this.V34v&&this.V34v.destroy();if(glSettings.boardTextureId!=b)switch(b){default:b=CB.Vlw.V14a;case CB.Vlw.V14a:case CB.Vlw.V14g:case CB.Vlw.V14i:case CB.Vlw.V14c:this.V34v=new CB.V13m(this.V14r+"LightSquaresCoolerBrighterSofter.jpg",this.V14r+"DarkSquaresLessSatur.png",this.V14r+
"MarginBrighter.jpg",this.V14r+"OrangeBrighterSoftBacklightLessSatur.jpg");break;case CB.Vlw.V14e:this.V34v=new CB.V13m(this.V14r+"WhiteMarbleCut.jpg",this.V14r+"GreyMarble.jpg",this.V14r+"DarkMarginCut.jpg",this.V14r+"WhiteMarbleBack.jpg");break;case CB.Vlw.V14k:this.V34v=new CB.V13m(this.V14r+"LightSquaresCooler.png",this.V14r+"DarkSquaresOrange.png",this.V14r+"MarginBrighter.jpg",this.V14r+"OrangeBrighterSoftBacklight.jpg");break;case CB.Vlw.V14m:this.V34v=new CB.V13m(this.V14r+"LightSquaresFFTex.png",
this.V14r+"DarkSquaresFFTex.png",this.V14r+"MarginFF.png",this.V14r+"BackgroundFF.png")}glSettings.boardTextureId=b};c.prototype.V25x=function(b){return V35p.config.V25i?CB.V139.V25y(b,lm.BOARDS,"Board2DSquares",[lm.BOARD_FRITZ,lm.BOARD_CRYSTALS,lm.BOARD_CRYSTALS+" (Wood)",lm.BOARD_USCF,lm.BOARD_OLDSTYLE,lm.BOARD_HABSBURG,"-",lm.BOARD3D_FRITZ,lm.BOARD3D_MODERN,lm.BOARD3D_ROOM,lm.BOARD3D_BALLOON,lm.BOARD3D_METAL,lm.BOARD3D_FUTURE,lm.BOARD3D_BLACKWHITE],"wQFritz16 wQCrystals16 wQCrystals16 wQUSCF16 wQOldstyle16 wQHabsburg16  Fritz16 Modern16 Room16 Balloon16 Metal16 Future16 BlackWhite16".split(" "),
[CB.Vlw.V23r,CB.Vlw.V14d,CB.Vlw.V14f,CB.Vlw.V14h,CB.Vlw.V14b,CB.Vlw.V14j,null,CB.Vlw.V23s,CB.Vlw.V23t,CB.Vlw.V23u,CB.Vlw.V23v,CB.Vlw.V23w,CB.Vlw.V23x,CB.Vlw.V23y],void 0,"",CB.V237(8)):CB.V139.V25y(b,lm.BOARDS,"Board2DSquares",[lm.BOARD_FRITZ,lm.BOARD_CRYSTALS,lm.BOARD_CRYSTALS+"(Wood)",lm.BOARD_USCF,lm.BOARD_OLDSTYLE,lm.BOARD_HABSBURG],"wQFritz16 wQCrystals16 wQCrystals16 wQUSCF16 wQOldstyle16 wQHabsburg16".split(" "),[CB.Vlw.V23r,CB.Vlw.V14d,CB.Vlw.V14f,CB.Vlw.V14h,CB.Vlw.V14b,CB.Vlw.V14j],void 0,
"",CB.V237(12))};c.prototype.V25z=function(b){return!CB.V5t.V64()||1E3<window.innerWidth||1E3<window.innerHeight?CB.V139.V25y(b,lm.OTHER_TOOLS,"SwitchApp",[lm.MENU_PLAYCHESS_TOOL,"Live Chess",lm.MENU_TACTICS_TOOL,lm.MENU_VIDEO_TOOL,lm.MENU_FRITZ_TOOL,lm.MENU_OPENINGS_TOOL,lm.MENU_DATABASE_TOOL,lm.MENU_MYGAMES_TOOL,lm.MENU_FRITZ_CHESSTER_TOOL,"News"],"WebAppPlay16 WebAppLive16 WebAppTactics16 WebAppVideos16 WebAppFritz16 WebAppOpenings16 WebAppDatabase16 WebAppMyGames16 WebAppFF16 WebAppNews16".split(" "),
[CB.Vlw.V248,CB.Vlw.V249,CB.Vlw.V24d,CB.Vlw.V24f,CB.Vlw.V24b,CB.Vlw.V24e,CB.Vlw.V1fh,CB.Vlw.V24a,CB.Vlw.V24c,CB.Vlw.V24g],void 0,"",CB.V237(1)):CB.V139.V25y(b,lm.OTHER_TOOLS,"SwitchApp",[lm.MENU_PLAYCHESS_TOOL,lm.MENU_TACTICS_TOOL,lm.MENU_DATABASE_TOOL,lm.MENU_OPENINGS_TOOL,lm.MENU_VIDEO_TOOL,lm.MENU_FRITZ_TOOL],"WebAppPlay16 WebAppTactics16 WebAppDatabase16 WebAppOpenings16 WebAppVideos16 WebAppFritz16".split(" "),[CB.Vlw.V248,CB.Vlw.V24d,CB.Vlw.V1fh,CB.Vlw.V24e,CB.Vlw.V24f,CB.Vlw.V24b],void 0,"",
CB.V237(1))};c.prototype.V260=function(b){return CB.V139.V25y(b,lm.LOGIN,"Login",[lm.LOGIN,lm.LOGOUT,lm.CHANGE_PASSWORD,lm.ACCOUNT,lm.INVITE_FRIEND],["Login16","Logout16","ChangePassword16","Account16","MailGames16"],[CB.Vlw.LOGIN,CB.Vlw.LOGOUT,CB.Vlw.CHANGE_PASSWORD,CB.Vlw.V24h,CB.Vlw.INVITE_FRIEND],void 0,"",CB.V237(16))};c.prototype.V261=function(){return[CB.V79.ENG,CB.V79.DEU,CB.V79.ESP,CB.V79.NED,CB.V79.ROM,CB.V79.CHN,CB.V79.FRA,CB.V79.RUS,CB.V79.NOR,CB.V79.POL,CB.V79.ITA,CB.V79.HEB,CB.V79.CAT,
CB.V79.TRK,CB.V79.SLO,CB.V79.GRK,CB.V79.UKR,CB.V79.VIE,CB.V79.ARA,CB.V79.SER,CB.V79.LIT,CB.V79.BRA,CB.V79.FAR,CB.V79.GAL,CB.V79.CRO,CB.V79.CZE,CB.V79.HIN]};c.prototype.languageBtn=function(b){var c=this.V261(),f=CB.V79.V7h(c);f.push("Your Language Here!");var g=CB.V79.V7i(c);g.push(CB.V79.getRibbonFlagName(CB.V79.UN));c=glSettings.getLanguageCommandIds(c);c.push(CB.Vlw.V25a);b=CB.V139.V25y(b,lm.LANGUAGE,"",f,g,c,void 0,"",CB.V237(14),!0);glSettings.languageBtn=b;glSettings.languageCommandId?glSettings.changeLangButtonFlag(glSettings.languageCommandId):
b.changeFlagIcon(CB.V79.getRibbonFlagName(CB.V79.V7c()));return b};c.prototype.V262=function(b){var c=[];CB.Vn.V263&&(CB.Vn.V263[b]?c.push(CB.Vn.V263[b]):c.push(CB.Vn.V263.ENG));CB.Vn.Chess[b]?c.push(CB.Vn.Chess[b]):c.push(CB.Vn.Chess.ENG);return c};c.prototype.changeLanguage=function(b){glLoc=new CB.Va(this.V262(CB.V79.V7g(b)))};c.prototype.V25k=function(){this.V25m.start()};c.prototype.V264=function(){return 12E4<this.V25m.V52()};c.prototype.Vrp=function(){return!1};var b=!1;c.prototype.V25r=function(){this.V264()?
(this.V265&&this.V265(),b=!0):(b&&this.V266&&this.V266(),b=!1)};c.prototype.V25u=function(){"undefined"!==typeof Ext&&Ext.QuickTips.init()};c.prototype.V267=function(){var b=0;switch(V35p.versionCode.V1ju){case CB.V1jb.V1jc:b=V35p.V358.V248;break;case CB.V1jb.V1jr:b=V35p.V358.V249;break;case CB.V1jb.V1je:b=V35p.V358.V1fh;break;case CB.V1jb.V1jg:b=V35p.V358.V248;break;case CB.V1jb.V1jh:b=V35p.V358.V24b;break;case CB.V1jb.V1jj:b=V35p.V358.V24a;break;case CB.V1jb.V1k0:b=V35p.V358.V24d;break;case CB.V1jb.V1jf:b=
V35p.V358.V24e}return b};c.prototype.V1fg=function(b){var c="http://www.chessbase.com";switch(b){case V35p.V358.V248:c="http://play.chessbase.com";break;case V35p.V358.V249:c="http://live.chessbase.com";break;case V35p.V358.V24d:c="http://tactics.chessbase.com";break;case V35p.V358.V1fh:c="https://database.chessbase.com";break;case V35p.V358.V24a:c="http://mygames.chessbase.com";break;case V35p.V358.V24e:c="http://openings.chessbase.com";break;case V35p.V358.V24b:c="http://fritz.chessbase.com";break;
case V35p.V358.V24f:c="http://videos.chessbase.com";break;case V35p.V358.V24c:c=CB.V79.V7c()==CB.V79.DEU?"http://fritzundfertig.chessbase.com":"http://fritzandchesster.chessbase.com";break;case V35p.V358.V24g:c=CB.V79.V7c()==CB.V79.DEU?"http://de.chessbase.com":"http://en.chessbase.com"}return c};c.prototype.execCommand=function(b){try{var c=!0,f;switch(b){default:c=!1;break;case void 0:break;case V35p.V358.V248:case V35p.V358.V249:case V35p.V358.V1fh:case V35p.V358.V24a:case V35p.V358.V24b:case V35p.V358.V24c:case V35p.V358.V24d:case V35p.V358.V24e:case V35p.V358.V24f:case V35p.V358.V24g:f=
this.V1fg(b);break;case V35p.V358.LOGOUT:this.setLoggedIn(!1);break;case CB.Vlw.CHANGE_PASSWORD:this.V268();break;case CB.Vlw.V24h:f=String.formatEx(this.config.editAccountUrl,CB.V79.V7e(glSettings.getLanguageId()));break;case CB.Vlw.V36:this.V269();break;case CB.Vlw.INVITE_FRIEND:this.V26a();break;case CB.Vlw.V3j:this.V26b()}f&&(window.location=f+"?ref="+this.appName+"&lang="+CB.V79.V7e(glSettings.getLanguageId()))}catch(g){b=V35p.V358.Vlu(b),CB.Vjg(b,g)}return c};c.prototype.V25s=function(b,c){if(c){for(var f in b)b.hasOwnProperty(f)&&
void 0===c[f]&&(c[f]=b[f]);this.V358=c}};c.prototype.setLoggedIn=function(b){this.V25n=b;b||(V35p.V34z.V1p3="",V35p.V34z.loginMode=CB.LoginMode.GUEST,CB.DOM.V1p4("AccountToken"),CB.DOM.V1p4("AccountMode"));b||V35p.V1vn(0);this.fireOnLogin(b)};c.prototype.V268=function(){V35p.V34z.userName?CB.Vn8.V268(V35p.V34z.userName,this.V26c.bind(this),{}):alert("Please Login First")};c.prototype.V26c=function(b,c){(new CB.V1pb(V35p.V26d)).V268(V35p.V34z.userName,b,c,V35p.V34z.V1p3,this.V26e)};c.prototype.V26e=
function(b){b&&1==b.ResultType?alert("Password changed."):alert("Could not change password")};c.prototype.V26f=function(){var b=CB.DOM.V1xh(!0)||V35p.V34z.userName;return 0<b.length&&"guest"!=b};c.prototype.V269=function(){(new CB.V1pb(V35p.V26d)).getFriends(V35p.V34z.userName,V35p.V34z.V1p3,"0",this.V26g)};c.prototype.V26g=function(b){if(b&&"OK"==b.Result){for(var e=new CB.V1pb(V35p.V26d),f=[],g=0;g<b.users.length;g++){var h=new CB.V26h(b.users[g]);f.push(h)}CB.Vn8.V26i(e,"Friends",f,c.prototype.setFriends)}};
c.prototype.setFriends=function(b,e){b.setFriends(V35p.V34z.userName,V35p.V34z.V1p3,"0",e,c.prototype.V26j)};c.prototype.V26j=function(b){};c.prototype.V26a=function(){var b=this.V267(V35p.versionCode.V1ju),b=c.prototype.V1fg(b),b="mailto:%20&subject="+escape(this.V26d)+"&body="+escape("Join me using "+this.appName+" "+b);window.location.href=b};c.prototype.V26k=function(){};c.prototype.V26b=function(){var b=String.formatEx(this.config.V25g,CB.V79.V7f(glSettings.getLanguageId()));window.open(b,"_blank")};
c.prototype.V26l=function(){return this.V26m&&this.V26m.type?this.V26m.type:0};c.prototype.isPremium=function(){return 3<=this.V26l()};c.prototype.isLoggedIn=function(){return 2<=this.V26l()};c.prototype.Vki=function(){return!0};c.prototype.V26n=function(){return"undefined"!=typeof Ext};c.prototype.Vrp=function(){return this.V26n()};c.prototype.V1r3=function(){return CB.V5t.V6c()||V35p.V34z.V1om()};c.prototype.V1vn=function(b){this.V26m={name:"",type:b};switch(b){case 0:case 1:this.V26m.name="Free";
break;case 2:this.V26m.name="Standard";break;case 3:this.V26m.name="Premium"}this.fireOnAccountType(this.V26m)};c.prototype.V26o=function(b){V35p.V26p();var c=ObjUtil.clone(b);c.deleteRemaining();c.unAnnotate();c=CB.V12k.V12m(c);b=2E3<c.length?"?fen="+b.getCurPos().toFEN():"?pgn="+c;window.location="http://fritz.chessbase.com"+b+"&ref=pgn"};c.prototype.V26p=function(b){if(this.panelMgr.getKernel&&this.panelMgr.getKernel()&&CB.V12k){var c=this.panelMgr.getKernel().game,f=CB.V12k.V12l(c);if(3E3<f.length||
b)b=ObjUtil.clone(c),b.unAnnotate(),f=CB.V12k.V12l(b);CB.DOM.V1p5("CBLastGame",f);CB.DOM.V1p5("CBLastMoveIndex",c.getMoveIndex());c.replaceGameNo&&(CB.DOM.V1p5("CBLastGameNo",c.replaceGameNo),CB.DOM.V1p5("CBLastGameDBId",c.replaceDBId));V35p.V34z.save("CBLastGame",f);console.log("Save Game To Local Storage")}};c.prototype.V26q=function(){if((!V35p.urlParams||!V35p.urlParams.pgn&&!V35p.urlParams.buf64)&&this.panelMgr.getKernel&&this.panelMgr.getKernel()&&PGN){var b=CB.DOM.V1xg("CBLastGame"),c="",f=
"";b?(c=CB.DOM.V1xg("CBLastGameNo"),f=CB.DOM.V1xg("CBLastGameDBId")):b=V35p.V34z.load("CBLastGame");if(b){var g=PGN.Vk5(b);if("My Moves"!=g.hdr.white.last){c&&f&&(g.replaceGameNo=parseInt(c),g.replaceDBId=parseInt(f));this.panelMgr.getKernel().game.assign(g);var h=CB.DOM.V1xg("CBLastMoveIndex");h&&this.panelMgr.getKernel().game.gotoIndex(h)}console.log("Load Game: "+b);console.log("Move Index: "+h);return!0}}};c.prototype.V26r=function(b){V35p.V34z.userName=CB.DOM.V1xh(!0)||V35p.V34z.userName;V35p.V34z.V1p3=
CB.DOM.V1xg("AccountToken");if(V35p.V34z.V1p3&&V35p.V34z.userName&&"guest"!=V35p.V34z.userName)return(new CB.V1pb(V35p.V26d)).tokenLogin(V35p.V34z.userName,V35p.V34z.V1p3,b),!0;V35p.V34z.V1p6();5;return!1};c.prototype.V26s=function(b){return V35p.V34z.V1p9()?((new CB.V1pb(V35p.V26d)).pwLogin(V35p.V34z.userName,V35p.V34z.password,b),!0):!1};c.prototype.V26t=function(){5};c.prototype.V26u=function(){V35p.playerLobby=new CB.Server.PlayerLobby;V35p.playerLobby.create(V35p.config.V25d(),"Guest","",CB.LoginMode.GUEST);
V35p.playerLobby.V1q8()};c.prototype.V26v=function(){V35p.playerLobby&&V35p.playerLobby.logOff()};c.prototype.V26w=function(){V35p.aTBLobby=new CB.Server.TeraBrainLobby;V35p.aTBLobby.create(V35p.config.V25e(),"Guest","",CB.LoginMode.GUEST);V35p.aTBLobby.V1q8()};c.prototype.V26x=function(){V35p.aTBLobby&&V35p.aTBLobby.logOff()};c.prototype.V26y=function(){V35p.onlineLobby=new CB.Server.OnlineLobby;V35p.onlineLobby.V1vi(V35p.config.getDBBridgeUris(),"Guest","",CB.LoginMode.GUEST);V35p.onlineLobby.V1q8()};
c.prototype.V26z=function(){V35p.onlineLobby&&V35p.onlineLobby.logOff()};c.prototype.V270=function(b){b.pics?(CB.V5o=function(){return"https://pgn.chessbase.com/common/"},this.config.V8o=!0,this.V1e5=CB.V5o()+"Media/",this.V14r=this.V1e5+"Chess/"):this.config.V8o=!1;b.engine&&(CB.Vs4.V21a=12<=CB.V5t.V6m()||!CB.V5t.V6m(),this.config.Vs8=function(){return CB.Vs4.V21a?["https://pgn.chessbase.com/Common/Chess/Engine/df14/df14ajaxdata.js"]:["/Common/Chess/Engine/df14/df14.js"]})};c.prototype.V271=function(){var b=
CB.V47.V4i("user"),c=CB.V47.V4i("pass");return b.length&&c.length?(V35p.V34z.userCoded=b,b=CB.V47.base64.V4f(b),c=CB.V47.base64.V4f(c),b=CB.V47.V4n(b),V35p.V34z.userName=b,V35p.V34z.password=c,V35p.V34z.loginMode=CB.LoginMode.NORMAL,!0):!1};c.prototype.V272=function(){return!1};V34y.initForListeners(c);V34y.addEvent(c,"Login");V34y.addEvent(c,"AccountType");return c}();CB.V1a5={};CB.V1a5[CB.Vlw.V23r]="DiagramTTFritz";CB.V1a5[CB.Vlw.V14d]="DiagramTTCrystals";CB.V1a5[CB.Vlw.V14f]="DiagramTTCrystals";
CB.V1a5[CB.Vlw.V14h]="DiagramTTUSCF";CB.V1a5[CB.Vlw.V14b]="DiagramTTOldstyle";CB.V1a5[CB.Vlw.V14j]="DiagramTTHabsburg";CB.V1a5[CB.Vlw.V14l]="DiagramTTFF";CB.V1a5[CB.Vlw.V23s]="Fritz";CB.V1a5[CB.Vlw.V23t]="Modern";CB.V1a5[CB.Vlw.V23u]="Room";CB.V1a5[CB.Vlw.V23v]="Balloon";CB.V1a5[CB.Vlw.V23w]="Metal";CB.V1a5[CB.Vlw.V23x]="Future";CB.V1a5[CB.Vlw.V23y]="BlackWhite";CB.V1a5[CB.Vlw.V23z]="Character";
function buildOldBrowserLandingPage(){CB.V273("Old");CB.DOM.add("www.playchess.com","h1","NonMobiH1");CB.DOM.add("Play chess and kibitz grand master games","h3","NonMobiH3");CB.DOM.V1xf();CB.DOM.add("We are sorry, your browser needs an update.","","NonMobiBody");CB.DOM.add("Please install the latest version.","","NonMobiBody");CB.DOM.V1xf();CB.V5t.V6z()?CB.DOM.add("We recommend using Firefox for Android. Thank you!","","NonMobiBody"):CB.DOM.add("We recommend using Chrome or Firefox. Thank you!","",
"NonMobiBody");CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xe("http://www.playchess.com","www.playchess.com","NonMobiLink");CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xf();CB.DOM.V1xf();navigator.userAgent&&CB.DOM.add(navigator.userAgent,"","NonMobiBody")}
CB.Vjg=function(c,b){if("undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()){CB.V5t.V64()&&(b+=" (mob)",CB.V5t.V5x()?b+=", andr="+CB.V5t.V5x():CB.V5t.V5w()&&(b+=", ios="+CB.V5t.V5w()));var d="catch";V35p&&(b+=", ver="+V35p.versionCode.V1jz(),d+=V35p.versionCode.V1jz());ga("send","event",d,c+", "+b)}console.log(c+", "+b)};CB.V1dm=function(c){"undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()&&ga("send","event","Stats",c)};
function padInt(c,b){var d="000000000"+c;return d.substr(d.length-b)}CB.V274=function(c,b){"undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()&&ga("send","event","Replayed",c,"",padInt(b,6))};CB.V273=function(c){5;"undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()&&ga("send","event","Browser",c)};CB.V1ny=function(c){5;"undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()&&ga("send","event","Connect",c)};
CB.V275=function(){if("undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()&&(ga("send","event","Version",V35p.versionCode.toString()),glSettings&&"undefined"!=typeof glSettings.languageCommandId)){var c=glSettings.getLanguageIdOfCommandId(glSettings.languageCommandId);ga("send","event","Lang",CB.V79.V7e(c))}};CB.V276=function(c){"undefined"!==typeof ga&&CB.V5t.runsOnChessBaseDomain()&&ga("send","pageview","Goal/"+c)};"use strict";
CB.GlobalSettings=function(){var c=function(){this.Vk9=V35p.commands.Vka(this);this.Vkb=V35p.commands.Vkc(this);this.boardTextureId=CB.Vlw.V14a;this.pieceStyleId=CB.Vlw.V23r;this.V277=CB.Vlw.V23s;this.load();this.V278=!1};c.prototype.destroy=function(){V35p.commands.Vkd(this.Vk9);V35p.commands.Vke(this.Vkb);this.save()};c.prototype.save=function(){var b=new CB.Vam;b.save("pieceStyleId",this.pieceStyleId);b.save("boardTextureId",this.boardTextureId);b.save("pieceStyleId3D",this.V277);b.save("langCommandId",
this.languageCommandId)};c.prototype.load=function(){var b=new CB.Vam;this.pieceStyleId=b.load("pieceStyleId");this.V277=b.load("pieceStyleId3D");this.boardTextureId=b.load("boardTextureId");this.languageCommandId=b.load("langCommandId")};c.prototype.sendFeedback=function(b,c){(new CB.V279).send(b,c)};var b=new CB.V35b;c.prototype.execCommand=function(c){try{switch(c){case CB.Vlw.V29:glSettings.inDialog()||CB.Vn8.V27a(this.sendFeedback);break;case CB.Vlw.V24j:case CB.Vlw.V24k:case CB.Vlw.V24l:case CB.Vlw.V24m:case CB.Vlw.V24n:case CB.Vlw.V24o:case CB.Vlw.V24p:case CB.Vlw.V24q:case CB.Vlw.V24r:case CB.Vlw.V24s:case CB.Vlw.V24t:case CB.Vlw.V24u:case CB.Vlw.V24v:case CB.Vlw.V24w:case CB.Vlw.V24x:case CB.Vlw.V24y:case CB.Vlw.V24z:case CB.Vlw.V250:case CB.Vlw.V251:case CB.Vlw.V252:case CB.Vlw.V253:case CB.Vlw.V254:case CB.Vlw.V255:case CB.Vlw.V256:case CB.Vlw.V257:case CB.Vlw.V258:case CB.Vlw.V259:this.changeLanguage(c);
break;case CB.Vlw.V25a:window.open("https://docu.chessbase.com/translate.html","_blank");break;case CB.Vlw.V23r:case CB.Vlw.V14d:case CB.Vlw.V14f:case CB.Vlw.V14h:case CB.Vlw.V14b:case CB.Vlw.V14j:case CB.Vlw.V14l:this.changeBoardStyle(c);break;case CB.Vlw.V241:b.exec(this.V27b(),3E3);break;case CB.Vlw.V23s:case CB.Vlw.V23t:case CB.Vlw.V23u:case CB.Vlw.V23v:case CB.Vlw.V23w:case CB.Vlw.V23x:case CB.Vlw.V23y:case CB.Vlw.V23z:CB.V5t.V70()?this.V27c(c):(alert(lm.BROWSER_DOESNT_SUPPORT_3D),this.changeBoardStyle(CB.Vlw.V23r))}}catch(e){c=
V35p.V358.Vlu(c),CB.Vjg(c,e)}};c.prototype.onKeyDown=function(b){return!1};c.prototype.onFileSelect=function(b,c){return!1};c.prototype.V27d=function(b){V35p.panelMgr.setIsFormOpen(b)};c.prototype.inDialog=function(){return V35p.panelMgr.V27e()};c.prototype.V27c=function(b){V35p.panelMgr.deleteCanvasPanel&&(this.V278?V35p.panelMgr.deleteCanvasPanel3D():V35p.panelMgr.deleteCanvasPanel(),this.V278=!0,this.V27f=CB.V1a5[b],this.V277=b,V35p.panelMgr.addCanvasPanel3D())};c.prototype.changeBoardStyle=function(b){this.V278&&
(this.V278=!1,V35p.panelMgr.deleteCanvasPanel3D(),V35p.panelMgr.addCanvasPanel());CB.V14y.clearCache();this.V16p=CB.V1a5[b];this.pieceStyleId=b;this.fireOnBoardStyle(b,this.V16p)};c.prototype.V27b=function(){this.pieceStyleId=this.pieceStyleId?this.pieceStyleId+1:CB.Vlw.V23r+1;this.pieceStyleId>=CB.Vlw.V240&&(this.pieceStyleId=CB.Vlw.V23r);!V35p.config.V25i&&this.pieceStyleId>=CB.Vlw.V23s&&(this.pieceStyleId=CB.Vlw.V23r);this.pieceStyleId>=CB.Vlw.V23s?CB.V5t.V70()?this.V27c(this.pieceStyleId):this.changeBoardStyle(this.pieceStyleId):
this.changeBoardStyle(this.pieceStyleId)};c.prototype.changeLanguage=function(b){var c=this.languageCommandId;this.changeLangButtonFlag(b);this.languageCommandId=b;V35p.changeLanguage(this.getLanguageIdOfCommandId(b));V35p.V27g&&c!=b&&(this.save(),window.location=V35p.V27g+"?lang="+CB.V79.V7e(glSettings.getLanguageId()))};c.prototype.changeLangButtonFlag=function(b){this.languageBtn&&this.languageBtn.changeFlagIcon(CB.V79.getRibbonFlagName(this.getLanguageIdOfCommandId(b)))};c.prototype.getLanguageIdOfCommandId=
function(b){switch(b){default:alert("languageId: "+b);case CB.Vlw.V24j:return CB.V79.ENG;case CB.Vlw.V24k:return CB.V79.GER;case CB.Vlw.V24l:return CB.V79.ESP;case CB.Vlw.V24m:return CB.V79.NED;case CB.Vlw.V24n:return CB.V79.ROM;case CB.Vlw.V24o:return CB.V79.CHN;case CB.Vlw.V24p:return CB.V79.FRA;case CB.Vlw.V24q:return CB.V79.RUS;case CB.Vlw.V24r:return CB.V79.NOR;case CB.Vlw.V24s:return CB.V79.POL;case CB.Vlw.V24t:return CB.V79.ITA;case CB.Vlw.V24u:return CB.V79.HEB;case CB.Vlw.V24v:return CB.V79.CAT;
case CB.Vlw.V24w:return CB.V79.TRK;case CB.Vlw.V24x:return CB.V79.SLO;case CB.Vlw.V24y:return CB.V79.GRK;case CB.Vlw.V24z:return CB.V79.UKR;case CB.Vlw.V250:return CB.V79.VIE;case CB.Vlw.V251:return CB.V79.ARA;case CB.Vlw.V252:return CB.V79.SER;case CB.Vlw.V253:return CB.V79.LIT;case CB.Vlw.V254:return CB.V79.BRA;case CB.Vlw.V255:return CB.V79.FAR;case CB.Vlw.V256:return CB.V79.GAL;case CB.Vlw.V257:return CB.V79.CRO;case CB.Vlw.V258:return CB.V79.CZE;case CB.Vlw.V259:return CB.V79.HIN}};c.prototype.getCommandIdOfLanguage=
function(b){switch(b){default:case CB.V79.ENG:return CB.Vlw.V24j;case CB.V79.GER:return CB.Vlw.V24k;case CB.V79.ESP:return CB.Vlw.V24l;case CB.V79.NED:return CB.Vlw.V24m;case CB.V79.ROM:return CB.Vlw.V24n;case CB.V79.CHN:return CB.Vlw.V24o;case CB.V79.FRA:return CB.Vlw.V24p;case CB.V79.RUS:return CB.Vlw.V24q;case CB.V79.NOR:return CB.Vlw.V24r;case CB.V79.POL:return CB.Vlw.V24s;case CB.V79.ITA:return CB.Vlw.V24t;case CB.V79.HEB:return CB.Vlw.V24u;case CB.V79.CAT:return CB.Vlw.V24v;case CB.V79.TRK:return CB.Vlw.V24w;
case CB.V79.SLO:return CB.Vlw.V24x;case CB.V79.UKR:return CB.Vlw.V24z;case CB.V79.GRK:return CB.Vlw.V24y;case CB.V79.VIE:return CB.Vlw.V250;case CB.V79.ARA:return CB.Vlw.V251;case CB.V79.SER:return CB.Vlw.V252;case CB.V79.LIT:return CB.Vlw.V253;case CB.V79.BRA:return CB.Vlw.V254;case CB.V79.FAR:return CB.Vlw.V255;case CB.V79.GAL:return CB.Vlw.V256;case CB.V79.CRO:return CB.Vlw.V257;case CB.V79.CZE:return CB.Vlw.V258;case CB.V79.HIN:return CB.Vlw.V259}};c.prototype.getLanguageCommandIds=function(b){var c=
[];b.forEach(function(b){c.push(this.getCommandIdOfLanguage(b))}.bind(this));return c};c.prototype.V27h=function(){return this.languageCommandId&&(this.languageCommandId==CB.Vlw.V24u||this.languageCommandId==CB.Vlw.V251||this.languageCommandId==CB.Vlw.V255)};c.prototype.getLanguageId=function(){return this.languageCommandId?this.getLanguageIdOfCommandId(this.languageCommandId):CB.V79.V7c()};V34y.initForListeners(c);V34y.addEvent(c,"BoardStyle");V34y.addEvent(c,"BoardStyle3D");return c}();var glSettings;
"use strict";CB.V279=function(){var c=function(){};c.prototype.send=function(b,c){this.strAddress=b;this.strComment=c;var e=CB.LoginMode.GUEST;CB.Server.PlayerLobby?(this.aPlayerLobby=new CB.Server.PlayerLobby(V35p.config.V25d(),"Guest","",e),this.aPlayerLobby.V1q8(this.V27i,this)):alert("Thank you")};c.prototype.V27i=function(b){b.aPlayerLobby&&(b.aPlayerLobby.sendFeedback(b.strAddress,b.strComment,this.V27j),b.aPlayerLobby.logOff(),alert("Thank you"))};c.prototype.V27j=function(b){};return c}();
CB.V27k=function(){return{onLogin:function(){this.gameKernel&&this.gameKernel.game.fireOnChanged({forceUpdate:!0});this.setLoginHtml(V35p.isLoggedIn())},setLoginHtml:function(c){if(this.V27l){if(c)this.V27l.V1y4(450<window.innerHeight?28:20),Ext.apply(this.V27l,{overflowY:"auto"}),this.V27l.update('<div class="CBInfoLoggedIn">'+this.getLoggedInHtml()+"</div>"),this.V27l.V27m(this.getLoginInfoGradient()+";color:white;text-transform:uppercase");else{var b=window.innerHeight/3;this.V27n&&this.V27n.el&&
(b=this.V27n.V27o());CB.V5t.V64()&&900>window.innerHeight?this.V27l.V1y4(Math.min(b,120)):this.V27l.V1y4(Math.min(b,160));Ext.apply(this.V27l,{overflowY:"scroll"});this.V27l.update('<div class="CBInfoNotLoggedIn">'+this.getPleaseLoginHtml()+"</div>");this.V27l.V27m(CB.V5p.V1xn("rgba(254, 254,252,255)","rgba( 251, 251,247,255)")+";color:black;text-transform:none;")}this.V27l.V25n=c;V35p.V34z.V1oo()&&this.V27l.el&&this.V27l.setVisible(!1)}},getLoginInfoGradient:function(){return CB.V5p.V1xn("rgba(6, 216,19,255)",
"rgba(24, 147,23,255)")},getPleaseLoginHtml:function(c){c=CB.V5p.getHeader("h3",lm.LOGIN_PLEASE_LOGIN,"margin-top:4px");c+=this.getLoginInviteHeader()+"<br/>";if(!CB.V5t.V64()||900<window.innerHeight)c+=this.getFunctionalityText()+"<br/>",c+=lm.LOGIN_ACCOUNT_FREE+"<br/><br/>";return c+=this.genCreateAccountLink()},genCreateAccountLink:function(){return'<a href="'+V35p.config.createAccountWebUrl+'" style="color:#8B0A16">'+lm.LOGIN_CREATE_LINK+"</a>"},getLoggedInHtml:function(){return String.f(lm.LOGIN_WELCOME,
V35p.V34z.userName)},getLoginInviteHeader:function(){return String.f(lm.GENERAL_INVITE,V35p.V25o)},getFunctionalityText:function(){return lm.PLEASE_LOGIN},resizeInfoPanel:function(){var c=!1;if(this.V27l&&this.V27l.el)if(this.V27l.V25n){var b=22;450<window.innerHeight&&(b=650<window.innerHeight?30:26);this.V27l.V1y4(b);c=!0}else this.V27n&&(b=Math.min(220,Math.max(20,.3*this.V27n.V27o())),this.V27l.V1y4(b));return c}}}();
CB.V27p=function(){return{accountLogin:function(c){V35p.V34z.userName=CB.DOM.V1xh(!0)||V35p.V34z.userName;V35p.V34z.V1p3=CB.DOM.V1xg("AccountToken");if(!c&&V35p.V34z.V1p3&&V35p.V34z.userName&&"guest"!=V35p.V34z.userName)(new CB.V1pb(V35p.V26d)).tokenLogin(V35p.V34z.userName,V35p.V34z.V1p3,this.tokenLoginHandler.bind(this));else this.onRequestLogin()},onRequestLogin:function(){this.enterLoginForm()},enterLoginForm:function(c){var b=this.V25n;CB.Vn8?CB.Vn8.V27q(V35p.appName,V35p.V34z,function(){this.setLoggedIn(!1);
(new CB.V1pb(V35p.V26d)).pwLogin(V35p.V34z.userName,V35p.V34z.password,this.receiveTokenHandler.bind(this))}.bind(this),function(){CB.V139&&CB.V139.V13b();b||this.setLoggedIn(!1)}.bind(this),{infoMsg:c,guestBtn:!1,createBtn:!0,forgotBtn:!0}):b||this.setLoggedIn(!1)},tokenLoginHandler:function(c){c&&1!=c.ResultType&&!c.timeout?(this.setLoggedIn(!1),this.enterLoginForm()):c.timeout?(CB.DOM.V1p4("AccountToken"),this.setLoggedIn(!1)):(this.setLoggedIn(!0),this.onTokenLoginOk());this.V27r=!1},onTokenLoginOk:function(){},
receiveTokenHandler:function(c){if(c&&c.Token)c=unescape(c.Token),V35p.V34z.V1p3=c,V35p.V34z.V1p7(),CB.DOM.V1pc(V35p.V34z.userName),this.setLoggedIn(!0),CB.V139&&CB.V139.V13a("Logged in OK: "+V35p.V34z.userName),CB.Timer.V4s(function(){CB.V139&&CB.V139.V13b()},600),this.onTokenLoginOk();else{if(c&&1!=c.Result&&!c.timeout)this.onInvalidToken();c.timeout&&CB.DOM.V1p4("AccountToken","");this.setLoggedIn(!1);this.V27r=!1}},onInvalidToken:function(){this.enterLoginForm(String.formatEx(lm.PW_INVALID,V35p.V34z.userName))},
isLoggedIn:function(){return this.V25n||this.V27r},setLoggedIn:function(c){this.superClass.setLoggedIn.apply(this,arguments);c?document.title=this.V25o+" - "+V35p.V34z.userName:(document.title=this.V25o+" - not logged in",this.V27r=!1)}}}();"use strict";CB.V27s={V27t:0,V27u:1,V27v:16,V27w:32,V27x:64,V27y:128,V27z:256,V280:512,V281:1024,V282:4096};
CB.V1iv=function(){var c=function(){this.init()};c.prototype.V283=0;c.prototype.V284=0;c.prototype.V285="";c.prototype.V286="";c.prototype.V287="";c.prototype.V288="";c.prototype.V289="";c.prototype.V28a="";c.prototype.V28b=0;c.prototype.V28c=65535;c.prototype.V28d=0;c.prototype.V28e=3E3;c.prototype.V28f=0;c.prototype.V28g=0;c.prototype.m_board=new CB.Ve6;c.prototype.V28h=0;c.prototype.m_nFlags=CB.V27s.V27v|CB.V27s.V27w|CB.V27s.V27x|CB.V27s.V27z|CB.V27s.V280;c.prototype.init=function(b){};c.prototype.writeToDataBuffer=
function(b){b.beginSizedWrite();b.writeByte(1);b.V34p(this.V285);b.V34p(this.V286);b.V34p(this.V288);b.V34p(this.V289);b.writeInt(this.V28d);b.writeInt(this.V28e);b.writeInt(this.V28f);b.writeInt(this.V28g);b.V352(this.V28b);b.V352(this.V28c);b.writeInt(this.m_nFlags);if(this.V28i()){b.writeByte(this.V28h);for(var c=0;64>c;c++)b.writeByte(this.m_board[c])}b.V34p(this.V28a);b.endSizedWrite()};c.prototype.setSearchBoard=function(b,c,e){this.m_board=b;this.V28h=c};c.prototype.SETFLAG=function(b,c){this.m_nFlags=
c?this.m_nFlags|b:this.m_nFlags&~b};c.prototype.V28j=function(b){return 0!=(this.m_nFlags&b)};c.prototype.V28k=function(b){this.SETFLAG(CB.V27s.V281,b)};c.prototype.setUseBoard=function(b){this.SETFLAG(CB.V27s.V27u,b)};c.prototype.V28i=function(){return this.V28j(CB.V27s.V27u)};c.prototype.V28l=function(b){this.SETFLAG(CB.V27s.V27v,b)};c.prototype.V28m=function(b){this.SETFLAG(CB.V27s.V27w,b)};c.prototype.V28n=function(b){this.SETFLAG(CB.V27s.V27x,b)};c.prototype.Vh1=function(b){this.SETFLAG(CB.V27s.V27z,
b)};c.prototype.Vh2=function(b){this.SETFLAG(CB.V27s.V280,b)};c.prototype.V28o=function(b){this.SETFLAG(CB.V27s.V282,b)};c.prototype.V28p=function(b){this.V28a=b};c.prototype.parseFreeText=function(){var b="",c=this.V28a.split(" "),e=0;if(1<c.length)for(var f=0;f<c.length;f++)c[f].replace(" ",""),isNaN(c[f])?(b&&(b+=" "),b+=c[f]):e=c[f];0<e&&(this.V28a=b,this.V28d=this.V28e=e)};c.prototype.toString=function(){return"searchmask="+this.V28a+" board= "+m_board.toString()};return c}();"use strict";
CB.V28q=function(){var c=function(){this.clear()},c=function(b){this.moves=[];this.V28t=this.V28s=this.V28r="";this.V28u=0;null!=b&&(this.V28v=b.nota,this.aMove=new CB.Veh(b.from,b.to,b.prom))};c.prototype.V28u;c.prototype.nWhiteEloSum=0;c.prototype.nBlackEloSum=0;c.prototype.nWhiteEloCount=0;c.prototype.nBlackEloCount=0;c.prototype.nLosses=0;c.prototype.nDraws=0;c.prototype.nWins=0;c.prototype.nGames=0;c.prototype.nDate=0;c.prototype.V28w=0;c.prototype.V28v="?";c.prototype.moves=[];c.prototype.aMove=
new CB.Veh;c.prototype.clear=function(){nGames=nDate=nLosses=nDraws=nWins=nWhiteEloCount=nBlackEloCount=nWhiteEloSum=nBlackEloSum=0;this.moves=[]};c.prototype.getMove=function(b){return b<this.moves.length?this.moves[b]:new CB.Veh};c.prototype.V28x=function(){return this.moves.length};c.prototype.V28y=function(){return 0<this.nWhiteEloCount?Math.round(this.nWhiteEloSum/this.nWhiteEloCount):0};c.prototype.V28z=function(){return 0<this.nBlackEloCount?Math.round(this.nBlackEloSum/this.nBlackEloCount):
0};c.prototype.V290=function(b){return b==CB.Vaz.WHITE?this.V28y():this.V28z()};c.prototype.V34n=function(b,c){b.beginSizedRead();this.nGames=b.V35g();this.V28s=this.nGames.toString();this.nDate=b.V35g();this.V28u=(new CB.Date(this.nDate)).year>>9;this.nLosses=b.V35g();this.nDraws=b.V35g();this.nWins=b.V35g();b.V35g();this.nWhiteEloCount=b.V35g();this.nWhiteEloSum=b.V35i();this.nBlackEloCount=b.V35g();this.nBlackEloSum=b.V35i();var e=b.readUint8();if(0<e){var f=new CB.V291;f.init(c.board,f.FORMAT_1);
for(var g=new CB.Vib(lm.NOTA_LOCALIZATION),h=new CB.V292,k=0;k<e;++k){var l=h.V4f(b.readUint8(),k);if(0<l&&l<f.FULL_MOVE_INFO){var m=new CB.Position;c.copyTo(m);var p=new CB.Veh;f.V4f(p,l,m.getBTM());m.isLegalMove(p)&&(m.preCalcCtx(p),m.makeMove(p),m.postCalcCtx(p,!0),l=g.getMoveNota(p),p.nota=l,this.moves.push(p))}}}b.endSizedRead();return!0};return c}();"use strict";
CB.V293=function(){var c=function(){this.V294=[]};c.prototype.clear=function(){this.V294=[]};c.prototype.V34n=function(b,c){this.clear();var e=b.V35g(),f=c.toFEN(),g=new CB.Position(f);if(0<e&&(f=new CB.V28q,f.V34n(b,g),--e,0<e))for(g=0;g<f.V28x()&&0<e;++g,--e){var h=c.toFEN(),h=new CB.Position(h),k=f.getMove(g);h.preCalcCtx(k);h.makeMove(k);h.postCalcCtx(k,!0);k=new CB.V28q(k);k.V34n(b,h);this.V294.push(k)}return!0};c.prototype.V295=function(b){return this.V294[b]};c.prototype.Count=function(){return this.V294.length};
return c}();"use strict";CB.OnlineEntryEnum={V296:0,V297:1,FLAGS_ONLINE_HEADER:2,V1ix:2,toString:function(c){for(var b in this)if(this[b]==c)return"OnlneEntryId: "+b;return"Unknown OnlineEntryId: "+c}};CB.V298=function(){var c=function(){this.aGame=new CB.Game};c.prototype.aGame;c.prototype.V299;c.prototype.aDB;c.prototype.V29a;c.prototype.nFlags;return c}();"use strict";
CB.V29b=function(){var c=function(){};c.prototype.numBits=[1,6,6,5,5,5,3,1,1,6,6,5,5,5,3,1];c.prototype.theBits=[0,32,34,18,20,22,6,0,0,33,35,19,21,23,7,0];c.prototype.isUniqe=[0,255,255,255,255,255,6,14,255,255,255,255,255,255,255,255,255,255,3,11,4,12,5,13,255,255,255,255,255,255,255,255,1,9,2,10,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255];c.prototype.V29c=[90,170,153,97,156,120,48,246,217,33,251,89,244,117,179,207,138,229,61,
134,20,71,41,42,47,157,19,128,51,253,27,168,57,178,205,242,200,185,0,139,132,58,106,30,59,86,194,64,214,53,10,84,5,186,72,131,85,11,100,103,243,191,212,6,29,225,177,38,227,180,160,143,215,122,95,187,199,236,226,88,175,119,218,184,209,222,98,163,62,83,142,112,65,166,174,167,16,197,137,189,66,32,107,255,74,79,123,155,34,46,75,76,196,245,249,173,221,210,198,39,223,44,224,4,231,9,111,109,96,182,146,70,94,69,23,254,172,145,93,234,56,36,102,148,115,55,108,105,21,220,40,77,150,99,114,181,37,63,144,110,235,
158,202,211,240,101,91,149,12,43,15,68,248,125,219,7,49,67,17,206,203,193,1,171,104,232,228,113,26,247,28,129,204,147,216,80,195,165,3,140,161,116,208,183,31,241,22,130,118,78,151,82,87,121,8,252,35,192,213,133,14,45,54,50,250,176,73,126,60,201,169,25,13,92,190,233,81,230,127,135,162,152,164,141,124,154,238,239,24,136,188,237,159,52,2,18];c.prototype.HUFF_960=128;c.prototype.HUFF_CASTLE=64;c.prototype.V29d=32;c.prototype.decodeMove2=function(b,c){var e=[];e[0]=CB.Piece.QUEEN;e[1]=CB.Piece.ROOK;e[2]=
CB.Piece.BISHOP;e[3]=CB.Piece.KNIGHT;b.From=c>>6&63;b.To=c>>0&63;b.SetProm(e[c>>12&3]);b.SetMoveType(0);return!0};c.prototype.V4f=function(b,c){var e=!1,f=c.getPos()-4;c.rewind();for(var g=[],h=0;h<f;h++)g[h]=c.readUint8();if(0<f&&g[0]<=f){e=new CB.Position;0<g[0]?(HuffToPos3(e,g,f),b.setStartPosition(e),h=g[0],CBDebug.assert(!1)):(b.getStartPos().NormalInit=!0,h=1);var k=new CB.V291;for(k.init(e.board,k.FORMAT_1);h<f;){var l=new CB.Veh,m=this.V29c[g[h]]-h;++h;if(m>=k.FULL_MOVE_INFO)if(m==k.FULL_MOVE_INFO){if(h+
2>f)break;m=this.V29c[g[h]]-h;++h;m|=this.V29c[g[h]]-h<<8;++h;decodeMove2(l,m)}else break;else 0<m&&k.V4f(l,m,e.getBTM());this.V29e(e,l);b.makeMove(l);k.execute(l,e)}e=!0}return e};c.prototype.V29f=function(b,c,e){var f,g,h;varindex=0;c[index]=0;index++;c[index]=0;b.GetBTM()&&(c[index]=128);f=0;g=1;for(h=2;64>f;f++){var k=b[f]&15;g+=numBits[k];if(8<g){c[index]|=theBits[k]>>g-8;if(++h>e)return ERRCODE.EC_CANCEL;index++;c[index]=0;g-=8}c[index]|=theBits[k]<<8-g;if(8<=g){g=0;if(++h>e)return ERRCODE.EC_CANCEL;
index++;c[index]=0}}k=f=0;0<b.GetCastleRights()&&(k|=HUFF_CASTLE,f+=4);0<b.GetCPPEPFile()&&(k|=V29d,f+=3);if(0<f){if(8<g+f){if(++h>e)return ERRCODE.EC_CANCEL;index++;c[index]=0}0<b.GetCastleRights()?(c[index]|=b.GetCastleRights()&15,0<b.GetCPPEPFile()&&(c[index]|=(b.GetCPPEPFile()-1&7)<<4)):0<b.GetCPPEPFile()&&(c[index]|=b.GetCPPEPFile()-1&7)}else 0==g&&--h;c[index]=h|k;return ERRCODE.EC_OK};c.prototype.V29g=function(b,c,e){var f,g,h=0,k;for(f=0;64>f;f++)b[f]=0;f=c[h]&(HUFF_960|HUFF_CASTLE|V29d);
g=c[h]&31;if(8<g&&g<e){0<(f&HUFF_CASTLE)?(b.SetCastleRights(c[g-1]&15),0<(f&V29d)?b.setCPPEPFile((c[g-1]>>4&7)+1):b.setCPPEPFile(0)):(b.SetCastleRights(CB.Vb7.V5k),0<(f&V29d)?b.setCPPEPFile((c[g-1]&7)+1):b.setCPPEPFile(0));h++;b.SetSideToMove(0<(c[h]&128)?CB.Vaz.BLACK:CB.Vaz.WHITE);f=0;e=1;for(k=64;64>f&&e<g;f++){var l=0,m=0;do l<<=1,0<(c[h]&k)&&(l|=1),m++,k>>=1,0==k&&(k=128,h++,e++);while(255==isUniqe[l]&&6>m);if(255==isUniqe[l])break;b[f]=CB.Piece(isUniqe[l])}if(64>f)return b.SetGroundPos(),ERRCODE.EC_CANCEL}else return b.SetGroundPos(),
ERRCODE.EC_CANCEL;b.FindKings();return ERRCODE.EC_OK};c.prototype.V29e=function(b,c){b.preCalcCtx(c);b.makeMove(c);b.postCalcCtx(c,!0)};return c}();CB.V29h=function(){var c=function(){};c.prototype.numBoard=[];c.prototype.piecePos=[];return c}();
CB.V291=function(){var c=function(){this.numBoard=this.V29i.numBoard;this;piecePos=this.V29i.piecePos};c.prototype.V29j=16;c.prototype.V29k=32;c.prototype.V29l=64;c.prototype.V29m=[0,0,0,0,0,0,0,4,2,1,0,0,0,0,0,3,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,6,7,0,0,0,0,0,5,0,0,1,2,3,4,5,6,7,14,1,0,0,0,6,21,8,0,15,0,0,0,22,7,9,0,0,16,0,23,0,0,10,0,0,0,17,0,0,0,11,0,0,25,0,18,0,0,12,3,26,0,0,0,19,4,13,27,2,0,0,0,5,20,0,0,1,0,0,0,1,0,0,2,0,0,0,0,0,3,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,2];c.prototype.V29n=[0,0,0,0,0,0,0,4,2,1,0,0,0,0,0,3,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,6,7,0,0,0,0,0,5,0,0,1,2,3,4,5,6,7,14,1,0,0,0,6,21,8,0,15,0,0,0,22,7,9,0,0,16,0,23,0,0,10,0,0,0,17,0,0,0,11,0,0,25,0,18,0,0,12,3,26,0,0,0,19,4,13,27,2,0,0,0,5,20,0,0,1,0,0,0,1,0,0,2,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,2];
c.prototype.V29o=[0,0,1,1,1,1,2,0,0,0,1,1,1,1,2,0];c.prototype.V29p=[0,0,1,1,1,1,2,0,0,0,1,1,1,1,2,0];c.prototype.V29q=111;c.prototype.V29r=[0,1,9,8,15,7,63,56,57,16,48,1,2,3,4,5,6,7,8,16,24,32,40,48,56,9,18,27,36,45,54,63,15,22,29,36,43,50,57,1,2,3,4,5,6,7,8,16,24,32,40,48,56,1,2,3,4,5,6,7,8,16,24,32,40,48,56,9,18,27,36,45,54,63,15,22,29,36,43,50,57,9,18,27,36,45,54,63,15,22,29,36,43,50,57,17,10,58,49,55,62,14,23,17,10,58,49,55,62,14,23,1,2,9,57,1,2,9,57,1,2,9,57,1,2,9,57,1,2,9,57,1,2,9,57,1,2,9,
57,1,2,9,57,1,2,3,4,5,6,7,8,16,24,32,40,48,56,9,18,27,36,45,54,63,15,22,29,36,43,50,57,1,2,3,4,5,6,7,8,16,24,32,40,48,56,9,18,27,36,45,54,63,15,22,29,36,43,50,57,1,2,3,4,5,6,7,8,16,24,32,40,48,56,9,18,27,36,45,54,63,15,22,29,36,43,50,57,17,10,58,49,55,62,14,23,0,0,1,9,8,15,7,63,56,57,16,48];c.prototype.V29s=[7,6,63,15,7,6,63,15,7,6,63,15,7,6,63,15,7,6,63,15,7,6,63,15,7,6,63,15,7,6,63,15];c.prototype.V29t=[0,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,5,5,5,5,5,5,5,
5,5,5,5,5,5,5,21,21,21,21,21,21,21,21,21,21,21,21,21,21,4,4,4,4,4,4,4,4,4,4,4,4,4,4,20,20,20,20,20,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,19,19,19,19,19,19,19,19,6,6,6,6,22,22,22,22,38,38,38,38,54,54,54,54,70,70,70,70,86,86,86,86,102,102,102,102,118,118,118,118,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,37,37,37,37,37,37,37,37,37,37,37,37,37,37,36,36,36,36,36,36,36,36,36,
36,36,36,36,36,35,35,35,35,35,35,35,35,0,0,17,17,17,17,17,17,17,17,17,17];c.prototype.V29u=[0,1,11,95,53,39,111,0,0,1,11,95,53,39,111,0,0,237,143,103,67,53,115,0,0,237,143,103,67,53,115,0,0,0,171,227,199,199,119,0,0,0,171,227,199,199,119,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,127,0,0,0,0,0,0,0,127,0,0,0,0,0,0,0,131,0,0,0,0,0,0,0,131,0,0,0,0,0,0,0,135,0,0,0,0,0,0,0,135,0,0,0,0,0,0,0,139,0,0,0,0,0,0,0,139,0];c.prototype.V29v=[0,24,0,1,2,3,26,0,0,25,12,13,14,15,27,0,0,42,4,5,6,7,28,0,0,43,
16,17,18,19,29,0,0,0,8,9,10,11,30,0,0,0,20,21,22,23,31,0,0,0,0,0,0,0,32,0,0,0,0,0,0,0,33,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,35,0,0,0,0,0,0,0,36,0,0,0,0,0,0,0,37,0,0,0,0,0,0,0,38,0,0,0,0,0,0,0,39,0,0,0,0,0,0,0,40,0,0,0,0,0,0,0,41,0];c.prototype.V29w=[0,16,48,48,48,48,128,0,0,16,48,48,48,48,128,0];c.prototype.V29x=[0,32,48,48,48,48,128,0,0,32,48,48,48,48,128,0];c.prototype.moveOffs=[];c.prototype.tableOffs=[];c.prototype.V29y=[];c.prototype.V29z=[];c.prototype.V2a0=[];c.prototype.pieceOffs=[];c.prototype.pieceInx=
[];c.prototype.maxPiece=[];c.prototype.V2a1=0;c.prototype.V2a2=0;c.prototype.FORMAT_1=1;c.prototype.FULL_MOVE_INFO=235;c.prototype.V2a3=236;c.prototype.KING2_START=237;c.prototype.KING2_END=246;c.prototype.V2a4=254;c.prototype.V2a5=255;c.prototype.V2a6=function(b){return b==FULL_MOVE_INFO};c.prototype.V29i=new CB.V29h;c.prototype.numBoard=[];c.prototype.piecePos=[];c.prototype.V2a7=function(b,c){b&&b<this.maxPiece[b&CB.Piece.Vb2]&&(this.piecePos[this.pieceInx[b]]=c)};c.prototype.init=function(b,c){var e=
[],f;this.moveOffs=this.V29m;this.tableOffs=this.V29o;this.V29y=this.V29r;this.V29z=this.V29t;this.V2a0=this.V29s;this.pieceOffs=this.V29u;this.pieceInx=this.V29v;this.maxPiece=this.V29w;this.V2a1=this.V29q;for(f=0;48>f;f++)this.piecePos[f]=255;for(f=0;16>f;f++)e[f]=f;switch(c){case this.FORMAT_1:for(f=63;0<=f;f--){var g=b[f]&15;0<g?(this.numBoard[f]=e[g],e[g]<this.maxPiece[g&CB.Piece.Vb2]&&(this.piecePos[this.pieceInx[e[g]]]=f,e[g]+=16),CBDebug.assert(0<this.numBoard[f])):this.numBoard[f]=0}break;
default:for(f=0;64>f;f++)g=b[f],0<g?(this.numBoard[f]=e[g],e[g]<maxPiece[g&CB.Piece.Vb2]&&(this.piecePos[pieceInx[e[g]]]=f,e[g]+=16),CBDebug.assert(0<this.numBoard[f])):this.numBoard[f]=0}};c.prototype.V2a8=function(b,c){for(c|=uint(b&Chess.COLOUR);c<maxPiece[c&15];){if(255==piecePos[pieceInx[c]]){piecePos[pieceInx[c]]=piecePos[pieceInx[b]];break}c+=16}numBoard[piecePos[pieceInx[b]]]=c;piecePos[pieceInx[b]]=255;return 0};c.prototype.V2a9=function(b){if(b)if((b&CB.Piece.Vb2)==CB.Piece.PAWN)this.V2a7(b,
255);else if(b<this.maxPiece[b&15]){this.V2a7(b,255);for(var c=this.maxPiece[b&15]-16,e=b;e<c;e+=16){this.piecePos[this.pieceInx[e]]=this.piecePos[this.pieceInx[e+16]];if(255==this.piecePos[this.pieceInx[e]])break;this.numBoard[this.piecePos[this.pieceInx[e]]]=e;this.piecePos[this.pieceInx[e+16]]=255}if(255!=this.piecePos[this.pieceInx[c|b&15]])for(b=this.maxPiece[b&15]|b&15,e=0;64>e;e++)if(this.numBoard[e]==b){this.piecePos[this.pieceInx[b-16]]=e;this.numBoard[e]=b-16;break}}return 0};c.prototype.execute=
function(b,c){if(!b.IsNullMove){var e=b.from,f=b.to,g=this.numBoard[e],h=this.numBoard[f];g||CBDebug.assert("no piece to move");this.numBoard[f]=this.numBoard[e];this.numBoard[e]=0;this.V2a7(g,f);h&&(h&CB.Piece.Vb2)!=CB.Piece.KING&&this.V2a9(h);if(b.isCastling()||b.isProm())b.isProm()?b.IsProm()&&this.V2a8(g,b.prom):b.isCastling()&&(c.getBTM()?b.isLongCastling()?(this.V2a7(this.numBoard[CB.Vbf.Vbr],f+(CB.Vbf.Vbz-CB.Vbf.Vbr)),this.numBoard[f+(CB.Vbf.Vbz-CB.Vbf.Vbr)]=this.numBoard[CB.Vbf.Vbr],this.numBoard[CB.Vbf.Vbr]=
0):b.isShortCastling()&&(this.V2a7(this.numBoard[CB.Vbf.Vda],CB.Vbf.Vcu),this.numBoard[CB.Vbf.Vcu]=this.numBoard[CB.Vbf.Vda],this.numBoard[CB.Vbf.Vda]=0):b.isLongCastling()?(this.V2a7(this.numBoard[CB.Vbf.Vbk],f+(CB.Vbf.Vbs-CB.Vbf.Vbk)),this.numBoard[f+(CB.Vbf.Vbs-CB.Vbf.Vbk)]=this.numBoard[CB.Vbf.Vbk],this.numBoard[CB.Vbf.Vbk]=0):b.isShortCastling()&&(this.V2a7(this.numBoard[CB.Vbf.Vd3],CB.Vbf.Vco),this.numBoard[CB.Vbf.Vco]=this.numBoard[CB.Vbf.Vd3],this.numBoard[CB.Vbf.Vd3]=0));for(e=0;64>e;e++)this.numBoard[e]&&
this.numBoard[e]<this.maxPiece[this.numBoard[e]&7]&&this.piecePos[this.pieceInx[this.numBoard[e]]]!=e&&DUMP("(1) Inx corrupted: "+String(e))}};c.prototype.encode=function(b,c){CBDebug.assert(0<numBoard[b.from]);if(0<numBoard[b.from]&&numBoard[b.from]<maxPiece[b.CB.Piece.Nominal()]){var e=(b.to&56)-(b.from&56)&56|(b.To&7)-(b.From&7)&7;c=pieceOffs[numBoard[b.from]]+moveOffs[64*tableOffs[b.CB.Piece.Nominal()]+e];CBDebug.assert(c<FULL_MOVE_INFO||16<maxPiece[CB.Piece.KING]&&c>=KING2_START&&c<=KING2_END);
e=new CB.Veh;Decode(e,c,(numBoard[b.fr]&Chess.COLOUR)==Chess.COLOUR);CBDebug.assert(e.From==b.From&&e.To==b.To)}};c.prototype.V4f=function(b,c,e){CBDebug.assert(c<this.FULL_MOVE_INFO||16<this.maxPiece[CB.Piece.KING]&&c>=this.KING2_START&&c<=this.KING2_END);var f=this.V29y[c],g=this.V29z[c];e&&(g|=CB.Vaz.Vb1,(g&CB.Piece.Vb2)==CB.Piece.PAWN&&(f=this.V2a0[c-this.V2a1]));b.from=this.piecePos[this.pieceInx[g]]&63;b.to=(b.from&56)+(f&56)&56|b.from+f&7;b.prom=0;for(b=b.type=0;64>b;b++)0!=this.numBoard[b]&&
this.numBoard[b]<this.maxPiece[this.numBoard[b]&CB.Piece.Vb2]&&this.piecePos[this.pieceInx[this.numBoard[b]]]!=b&&CBDebug.assert(!1)};return c}();
CB.V292=function(){var c=function(){};c.prototype.V2ab=[115,113,245,122,119,36,91,210,93,137,56,239,159,205,160,142,246,17,125,46,62,241,57,130,39,88,11,70,204,118,173,135,54,30,199,68,154,186,55,27,168,53,175,123,52,49,129,221,206,1,73,169,18,209,58,165,183,72,31,198,251,6,63,2,101,229,136,32,60,71,41,37,110,250,197,51,43,150,105,163,238,26,191,116,249,207,208,75,215,40,158,111,120,134,234,67,176,86,121,185,124,83,240,24,89,244,13,196,223,78,38,231,103,79,171,145,184,151,149,69,188,181,161,0,195,
44,5,178,172,174,66,133,80,217,254,236,146,132,157,235,96,242,140,87,74,247,100,219,95,99,187,224,85,255,155,22,237,192,148,126,141,167,189,139,180,20,47,23,182,222,179,131,220,3,253,200,127,7,16,33,214,152,211,42,14,97,64,45,77,227,19,29,248,153,156,112,147,109,61,233,225,218,81,144,213,59,84,9,166,104,76,194,228,232,212,48,177,252,203,143,34,10,162,35,98,106,65,90,25,190,193,138,128,92,230,4,15,107,21,243,201,108,102,12,202,114,94,28,216,164,117,82,226,170,8,50];c.prototype.V2ac=[123,49,63,173,
235,126,61,177,254,207,221,26,243,106,184,236,178,17,52,190,165,238,155,167,103,228,81,39,247,191,33,58,67,179,220,223,5,71,110,24,89,70,183,76,125,187,19,166,215,45,255,75,44,41,32,38,10,22,54,205,68,198,20,62,186,226,130,95,35,119,27,69,57,50,144,87,210,188,109,113,132,202,251,101,206,152,97,143,25,104,227,6,233,8,246,148,140,185,224,149,146,64,242,112,209,78,225,237,241,197,72,91,195,1,245,0,83,250,29,4,92,98,3,43,100,18,159,176,232,46,23,171,137,131,93,31,66,9,231,163,142,160,15,219,203,115,136,
196,158,118,77,117,181,193,36,154,194,138,90,12,14,122,222,79,249,55,208,161,40,51,253,114,128,30,129,42,96,216,127,170,164,121,168,56,116,99,37,150,120,162,229,82,157,230,211,124,107,74,59,34,175,240,244,218,28,13,48,85,86,53,7,182,214,204,180,88,248,133,201,147,172,47,169,108,151,200,252,189,212,65,234,111,213,199,94,139,135,156,80,11,102,21,141,239,105,2,16,145,192,84,73,60,217,174,134,153];c.prototype.V4f=function(b,c){return this.V2ab[b-c]};c.prototype.V4f=function(b,c){return this.V2ac[b]+c};
return c}();"use strict";CB.namespace("CB.Server.OnlineLobby");CB.V2ad={V5k:0,V2ae:1350,V2af:1351,toString:function(c){for(var b in this)if(this[b]==c)return b;return"Unknown OnlineDBUserMsgId: "+c}};
CB.Server.OnlineLobby=function(){var c=function(){this.idGroup=0;this.maxGames=100;this.V1iy=0;this.name="OnlineDB"};CB.inherit(c,CB.Server.V1pi);c.prototype.V1vi=function(b,c,f,g){this.create(b,c,f,g)};c.prototype.V1vo=function(b){};c.prototype.games=[];c.prototype.statboard=new CB.Ve6;c.prototype.statside=0;var b;c.prototype.V2ag=function(c,e){if(0<this.V1qy()){V35p.panelMgr.dbBook&&V35p.panelMgr.dbBook.startupdate();b=this;b.statboard=new CB.Ve6;for(var f=0;64>f;f++)b.statboard[f]=c[f];this.statside=
e;f=new CB.Vat(CB.V1k2.V1lt);f.buf.beginSizedWrite();f.buf.writeByte(e);for(var g=0;64>g;g++)f.buf.writeByte(c[g]);f.buf.endSizedWrite();this.send(f)}};c.prototype.search=function(b,c,f){V35p.panelMgr.dbGames&&V35p.panelMgr.dbGames.startupdate();var g=new CB.Vat(CB.V1k2.V1lq);this.games=[];this.games.length=0;b.parseFreeText();b.writeToDataBuffer(g.buf);this.maxGames=c||50;this.V1iy=f||0;this.send(g)};c.prototype.getHeaders=function(b){var c=new CB.Vat(CB.V1k2.V1ls);c.buf.V351(b.length);for(var f=
0;f<b.length;f++)c.buf.V351(b[f]);this.send(c)};c.prototype.V2ah=function(b){var c=new CB.Vat(CB.V1k2.V1lr);c.setVal(1);c.buf.V351(1);c.buf.V351(b);this.send(c)};c.prototype.V2ai=function(b){var c=new CB.Vat(CB.V1k2.V1lr);c.setVal(2);c.buf.V351(b.length);for(var f=0;f<b.length;f++)c.buf.V351(b[f]);this.send(c)};c.prototype.V2aj=function(){var b=new CB.Vat(CB.V1k2.V1lu);this.send(b)};c.prototype.V1o2=function(b){if(!this.V1r5(b))try{switch(b.getType()){default:TRACE("Unhandled: "+b.toString());break;
case CB.V1k2.V1l2:this.V2aj();break;case CB.V1k2.V1lz:this.V2ak(b);break;case CB.V1k2.V1m1:this.V2al(b);break;case CB.V1k2.V1lw:this.V2am(b);break;case CB.V1k2.V1lx:this.V2an(b);break;case CB.V1k2.V1ly:this.V2ao(b);break;case CB.V1k2.Viu:this.V2ap(b)}}catch(c){CB.Vjg(CB.V1k2.Vlu(b.getType()),c)}};c.prototype.V2ao=function(b){b=b.getBuf();for(var c=[],f=b.V35g(),g=0;g<f;g++){b.beginSizedRead();var h=b.V35g(),k=new CB.V9w;if(0<h){for(var l=b.V35g(),m=0;m<l;m++)k.writeUint8(b.readUint8());l=new CB.Game;
if(!this.V1sg(l,k))break;for(k=0;k<this.games.length;k++)if(this.games[(k+g)%this.games.length].aGameNr==h){this.games[(k+g)%this.games.length].aGame.hdr=l.hdr;this.games[(k+g)%this.games.length].nFlags=CB.OnlineEntryEnum.FLAGS_ONLINE_HEADER;c.push(this.games[(k+g)%this.games.length]);break}}b.endSizedRead()}this.fireOnGames(c)};c.prototype.V2an=function(b){var c=b.getBuf(),f=c.V35g();if(1==f&&1==b.getVal())c.beginSizedRead(),b=c.V35g(),0<b&&(f=new CB.Game,this.V2aq(f,c)&&V35p.panelMgr.loadGame(f)),
c.endSizedRead();else{for(var g=[],h=0;h<f;h++){c.beginSizedRead();b=c.V35g();if(0<b){var k=new CB.Game;if(this.V2aq(k,c,b))g.push({aGame:k,aGameNr:b,nFlags:CB.OnlineEntryEnum.FLAGS_ONLINE_HEADER|CB.OnlineEntryEnum.V1ix});else break}c.endSizedRead()}this.fireOnGames(g)}};c.prototype.V2am=function(b){b=b.getBuf();var c=b.V35g();b.V35g();for(var f=0;f<c&&f<this.maxGames;f++){var g=b.V35g();if(0<g){var h=new CB.V298;h.nFlags=CB.OnlineEntryEnum.V297;h.aGameNr=g;this.games.push(h)}}if(V35p.panelMgr&&V35p.panelMgr.setGames)V35p.panelMgr.setGames(this.games);
else if(V35p.panelMgr.V1iu&&V35p.panelMgr.V1iu()){b=[];for(c=0;c<this.games.length;c++)this.games[c].nFlags==CB.OnlineEntryEnum.V297&&b.push(this.games[c].aGameNr);0<b.length&&V35p.onlineLobby.V2ai(b)}};c.prototype.V2ak=function(c){c=c.getBuf();for(var e=new CB.Position,f=0;64>f;f++)e.board[f]=b.statboard[f];e.sd=b.statside;f=new CB.V293;f.V34n(c,e);this.fireOnStatistics(f)};c.prototype.V2al=function(b){this.V2ar=b.getBuf().V35g();b=new CB.V1iv;var c,f=0;this.V2as?(c=this.V2as(),f=c.getCurPos().getPlyNum()):
c=new CB.Game;b.setSearchBoard(c.getCurPos().board,c.getCurPos().getSideToMove());b.setUseBoard(!0);this.search(b,50,f)};c.prototype.V2ap=function(b){try{switch(b.getUserType()){case CB.V2ad.V2af:this.V2at(b)}}catch(c){CB.Vjg(CB.V2au.Vlu(b.getUserType()),c)}};c.prototype.V2av=function(b,c,f){this.V2ax=c;this.V2aw=f;b=new CB.V2ay(b,CB.V2az.V2b0);c=new CB.Vat(CB.V1k2.Viu);b.write(c.buf);c.setUserType(CB.V2ad.V2ae);this.send(c)};c.prototype.V2at=function(b){var c=new CB.V2b1;c.read(b.getBuf());this.V2ax(this.V2aw,
c)};c.prototype.V2aq=function(b,c,f){try{return b.read2(c)}catch(g){console.log(g)}return!1};c.prototype.V1sg=function(b,c){try{return c.rewind(),b.hdr.read(c),!0}catch(f){CB.Vjg("OL-LH:"+f)}return!1};c.prototype.V1vq=function(b){V35p.panelMgr.V1ri(chat.toString())};c.prototype.V1wb=function(b){};V34y.initForListeners(c);V34y.addEvent(c,"Statistics");V34y.addEvent(c,"Games");return c}();"use strict";
CB.V2az={V2b2:0,V2b0:1,V2b3:2,V2b4:4,V2b5:8,toString:function(c){for(var b in this)if(this[b]==c)return"GameAutoCompleteId: "+b;return"Unknown GameAutoCompleteId: "+c}};CB.V2ay=function(){var c=function(b,c){this.V2b6=b;this.m_nFlags=c};c.prototype.write=function(b){b.beginSizedWrite();b.V35h(this.m_nFlags);b.V357(this.V2b6);b.endSizedWrite()};return c}();
CB.V2b1=function(){var c=function(){};c.prototype.read=function(b){this.data=[];b.beginSizedRead();for(var c=b.V35k(),e=0;e<c;e++){var f=b.V35a(80);this.data.push(f)}b.endSizedRead()};return c}();
CB.V2b7=function(){var c=function(){this.instance=localforage.createInstance({name:"Player"})};c.prototype.instance=null;c.prototype.V1wi=function(){};c.prototype.V2b8=function(b,c,e){e?c=this.V2b9(e)+","+this.V2ba(c):(c=b.player.player.m_NewCBPlayer.m_aKey,c=this.V2b9(c.m_sLastName)+","+this.V2ba(c.m_sFirstName));this.instance.setItem(c,b)};c.prototype.V2bb=function(b,c,e,f,g,h){b=this.V2ba(b);c=this.V2b9(c);this.instance.getItem(c+","+b).then(function(b){b?g(b):h("Player not found")})};c.prototype.V2ba=
function(b){return b?b.split(/[\s-]/gi)[0]:""};c.prototype.V2b9=function(b){return b.replace(/[\s-]/gi,"")};return c}();"use strict";CB.namespace("CB.Server.PlayerLobby");
CB.Server.PlayerLobby=function(){var c=function(){this.name="Players";this.V2bf=this.V2be=this.V2bd=0;this.V2bg={};this.V1pk=3E4;this.V2bh=new CB.V2b7;this.V2bi=[]};CB.inherit(c,CB.Server.V1pi);c.prototype.V2bi=null;c.prototype.V1q8=function(b,c){this.V2bj=b;this.superClass.V1q8.apply(this,arguments)};c.prototype.V1qf=function(){if(!this.Vte){var b=new CB.V1mn(this.user,this.pass,CB.LoginMode.NORMAL,V35p.V34z.guid);this.send(b.V34w())}};c.prototype.logOff=function(){if(this.Vte&&!this.V2bk){var b=
new CB.Vat(CB.V1k2.V1k7);b.address(this.conn.V1np,CB.V1mt.V1mu);b.buf.V35h(0);this.send(b);this.V1pq.stop();this.V2bk=!0}};new CB.V35b;c.prototype.V1qx=function(){};c.prototype.V1qy=function(){return this.conn.V1np};c.prototype.V1qz=function(){return this.V1r0};c.prototype.V1qg=function(){return this.V1r1?this.V1r1.V1qg():!0};c.prototype.onConnect=function(){this.V1pq.stop();this.loginMode==CB.LoginMode.GUEST?this.V1qa():this.V1qf()};c.prototype.sendFeedback=function(b,c,e){this.callbackFeedback=
e;e=new CB.Vat(CB.V1k2.V1m4);e.setUserType(CB.V2bl.V29);e.buf.V357(b);e.buf.V357(c);e.buf.V35h(V35p.versionCode.V1ju);e.buf.V357(CB.V79.V7a());this.send(e)};c.prototype.V2bh=null;c.prototype.V2bm=function(b){var c="";b=new Uint8Array(b);for(var e=b.byteLength,f=0;f<e;f++)c+=String.fromCharCode(b[f]);return window.btoa(c)};c.prototype.V2bn=function(b){b=window.atob(b);for(var c=b.length,e=new Uint8Array(c),f=0;f<c;f++)e[f]=b.charCodeAt(f);return e.buffer};c.prototype.V2bo=function(b,c,e){this.V2bh.V2b8({player:b,
created:new Date},c,e)};c.prototype.V1ex=function(b,c,e,f,g,h){var k=function(k){this.V2bu(b,c,e,f,function(e){this.V2bo(e,b,c);g(e)}.bind(this));h&&h()}.bind(this);this.V2bh.V2bb(b,c,e,f,function(b){var c=b.created;c.setMonth(c.getMonth()+1)>new Date?(b=b.player,c=new CB.V2bq,c.m_NewCBPlayer=new CB.V2br,c.m_NewCBPlayer.m_aKey=new CB.V2bs,c.m_NewCBPlayer.m_HighData=new CB.V2bt,c.setFirstName(b.player.m_NewCBPlayer.m_aKey.m_sFirstName),c.setLastName(b.player.m_NewCBPlayer.m_aKey.m_sLastName),c.setNation(b.player.m_NewCBPlayer.m_HighData.m_aNation),
c.setTitle(b.player.m_NewCBPlayer.m_HighData.m_aTitle),g({player:c,pic:b.pic})):k()}.bind(this),k.bind(this))};c.prototype.V2bv=function(){for(;0<this.V2bi.length;)this.V2bi.pop()()};c.prototype.V2bu=function(b,c,e,f,g){if(this.V1py){this.V2bd++;this.V2bg[this.V2bd]={fnCallback:g,elo:e,year:f,player:{},pic:null};var h=new CB.Vat(CB.V1k2.V1m4);h.setUserType(CB.V2bl.V2bw);h.buf.V351(this.V2bd);h.buf.V357(b);h.buf.V357(c);h.buf.V351(e);h.buf.V351(f);this.send(h)}else this.V2bi.push(function(){this.V2bu(b,
c,e,f,g)}.bind(this))};c.prototype.V1o2=function(b){if(!this.V1r5(b))try{switch(b.getType()){default:TRACE("Unhandled: "+b.toString());break;case CB.V1k2.V1l2:this.V1py=!0;this.V2bj&&this.V2bj();this.V2bv();this.fireOnConnected();break;case CB.V1k2.V1kd:break;case CB.V1k2.V1kg:break;case CB.V1k2.V1ke:break;case CB.V1k2.V15:this.V1vq(b);break;case CB.V1k2.V1ka:this.V1wb(b);break;case CB.V1k2.V1m4:this.V2ap(b)}}catch(c){b=CB.V1k2.Vlu(b.getType()),CB.Vjg(b,c)}};c.prototype.V2ap=function(b){try{switch(b.getUserType()){case CB.V2bl.V2bx:this.V2by(b);
break;case CB.V2bl.V2bz:this.V2c0(b)}}catch(c){b=CB.V2bl.Vlu(b.getUserType()),CB.Vjg(b,c)}};c.prototype.V2c1=function(b){this.V2c2(b)};c.prototype.V2c3=function(b){this.V2c2(b)};c.prototype.V2c4=function(b){this.V2c2(b)};c.prototype.V2c5=function(b){this.V2c2(b)};c.prototype.V2c6=function(b){b.getBuf().V35g()};c.prototype.V2c7=function(b){this.V2c2(b)};c.prototype.V2by=function(b){b=b.getBuf();var c=b.V35g(),e=new CB.V2bq;e.m_NewCBPlayer=new CB.V2br;e.m_NewCBPlayer.m_aKey=new CB.V2bs;e.m_NewCBPlayer.m_HighData=
new CB.V2bt;if(b.V35o())if(e.setFirstName(b.V35a(100)),e.setLastName(b.V35a(100)),b.readInt(),e.setNation(b.readInt()),e.setTitle(b.readShort()),0!=b.readInt()){for(var f=b.V35g(),g=[],h=0;h<f;h++)g.push(b.readUint8());this.V2bg[c].fnCallback({player:e,pic:g})}else this.V2bg[c].fnCallback({player:e})};c.prototype.V2c2=function(b){b=b.getBuf();if(1==b.V35g()){b.V35g();b.V35g();var c=new CB.V2bq;c.V34n(b);this.V2bp(c,this.me)}else{b.V35g();if(2==b.V35g())for(var e=b.V35g(),c=[],f=0;f<e;f++)c.push(b.ReadByte());
this.V2c8(c,this.me)}};c.prototype.V2c0=function(b){alert("thanks")};c.prototype.V1vq=function(b){var c=new CB.ChatData;c.fromSocketsMsg(b);c.V1na()?(b=this.V2c9.V2ca(c.V1ne()),b.length&&(c.strMsg="("+b+"): "+c.strMsg),V35p.panelMgr.V1ri(c.toString(),"LogKibitzChat")):V35p.panelMgr.V1ri(c.toString())};c.prototype.V1wb=function(b){b.getBuf().readInt();this.fireOnConnected()};c.prototype.V1ql=function(){};c.prototype.send=function(b){try{0==b.V353()&&b.V356(this.V1qy()),0==b.getIdReceiver()&&b.setIdReceiver(CB.V1mt.V1mu),
this.conn.sendMessage(b,!0)}catch(c){this.V1pu.isActive()||this.V1ro||(this.V1pu.runOnce(Math.min(6E4,5E3+1E3*this.V34u),function(){this.V1o6(!0)}.bind(this)),this.V34u++)}};V34y.initForListeners(c);c.prototype.V2cb=function(){for(var b=0;10>b;b++)switch(Math.floor(15*Math.random())){case 0:this.V1o6();break;case 1:this.V2cc(13);break;case 2:this.V2cc(14);break;case 3:this.V2cd();break;case 4:this.V2ce();break;case 5:this.V1rj.V2cf(!0);break;case 6:this.V1rj.V2cg(new CB.Vkz(3,2));break;case 7:this.V1rj.V2ch();
this.V1rj.V2ci();break;case 8:this.V1rj.V2cj();this.V1rj.V2ck();break;case 9:case 10:case 11:case 12:var c=new CB.Vat(7E3+Math.floor(100*Math.random()));c.address(this.V1qy(),CB.V1mt.V1mu);c.getType()!=CB.V1k2.V1k7&&c.getType()!=CB.V1k2.V1k6&&this.send(c);break;case 13:case 14:c=new CB.Vat(CB.V1k2.Viu),c.setUserType(1E3+Math.floor(100*Math.random())),c.address(this.V1qy(),CB.V1mt.V1mu),this.send(c)}};V34y.initForListeners(c);V34y.addEvent(c,"Connected");return c}();"use strict";
CB.V2cl=function(){var c=function(){};c.prototype.read=function(b){this.V2cm=b.V35a(100);this.V2cn=b.V35a(100);this.V2co=b.V35g();this.V2cp=b.V35g()};return c}();"use strict";
CB.V2bt=function(){var c=function(){};c.prototype.V34n=function(b){this.setDeathDate(b.V35c());this.setCurrentTitle(new CB.V1et(b.V35e()));this.setNation(b.V35e());this.V2cq(b.V35e());this.setIsMale(b.V35o())};c.prototype.setDeathDate=function(b){this.V2cr=b};c.prototype.V2cs=function(){return this.V2cr};c.prototype.getCurrentTitle=function(){return this.m_aTitle};c.prototype.setCurrentTitle=function(b){this.m_aTitle=b};c.prototype.V2ct=function(){return this.m_aNation};c.prototype.setNation=function(b){this.m_aNation=
b};c.prototype.getBornNation=function(){return this.V2cu};c.prototype.V2cq=function(b){this.V2cu=b};c.prototype.getIsMale=function(){return this.V2cv};c.prototype.setIsMale=function(b){this.V2cv=b};return c}();"use strict";
CB.V2cw=function(){var c=function(){};c.prototype.read=function(b){this.m_Titles=[];this.m_TitleDate=[];this.m_OtherNations=[];this.m_ChangeDate=[];for(var c=0;5>c;c++){var e=new CB.V1et(b.V35e());this.m_Titles.push(e);e=b.V35c();this.m_TitleDate.push(e)}this.m_ChangedBornNation=b.V35c();for(c=0;10>c;c++)e=b.V35e(),this.m_OtherNations.push(e),e=b.V35c(),this.m_ChangeDate.push(e)};c.prototype.V2cx=function(b){return m_Titles[b]};c.prototype.V2cy=function(b,c){m_Titles[b]=c};c.prototype.V2cz=function(b){return m_TitleDate[b]};
c.prototype.V2d0=function(b,c){m_TitleDate[b]=c};c.prototype.V2d1=function(){return m_ChangedBornNation};c.prototype.V2d2=function(b){m_ChangedBornNation=b};c.prototype.V2d3=function(b){return m_OtherNations[b]};c.prototype.V2d4=function(b,c){m_OtherNations[b]=c};c.prototype.V2d5=function(b){return m_ChangeDate[b]};c.prototype.V2d6=function(b,c){m_ChangeDate[b]=c};c.prototype.getMaxTitles=function(){return 5};c.prototype.getMaxNations=function(){return 10};return c}();"use strict";
CB.V2br=function(){var c=function(){this.m_aKey=new CB.V2bs};c.prototype.V34n=function(b,c){this.m_aKey=new CB.V2bs;if(0<(c&CB.V2bq.prototype.V2bc.PL_DATA_KEY)&&!this.m_aKey.V34n(b))return!1;this.m_HighData=new CB.V2bt;0<(c&CB.V2bq.prototype.V2bc.PL_DATA_HIGH)&&this.m_HighData.V34n(b);this.V2d7=new CB.V2cw;0<(c&CB.V2bq.prototype.V2bc.PL_DATA_LOW)&&this.V2d7.read(b);return!0};c.prototype.getLastName=function(){return this.m_aKey.getLastName()};c.prototype.setLastName=function(b){this.m_aKey.setLastName(b)};
c.prototype.getFirstName=function(){return this.m_aKey.getFirstName()};c.prototype.setFirstName=function(b){this.m_aKey.setFirstName(b)};c.prototype.V2d8=function(b){this.m_aKey=b};c.prototype.getKey=function(){return this.m_aKey};c.prototype.V2d9=function(){return this.m_HighData};c.prototype.V2da=function(){return this.V2d7};c.prototype.getMaxTitles=function(){return this.V2db().getMaxTitles()};c.prototype.getMaxNations=function(){return this.V2db().getMaxNations()};return c}();"use strict";
CB.V2bq=function(){var c=function(){};c.prototype.V2dc={PFN_RAW:0,PFN_ARR:1,PFN_BMP:2};c.prototype.V2bc={PL_DATA_KEY:1,PL_DATA_HIGH:2,PL_DATA_LOW:4,PL_DATA_ELO:8,PL_DATA_ONE_ELO:16,PL_DATA_PICS:32,PL_DATA_ONE_PIC:64};c.prototype.V2dd=c.prototype.V2bc.PL_DATA_KEY+c.prototype.V2bc.PL_DATA_HIGH+c.prototype.V2bc.PL_DATA_LOW+c.prototype.V2bc.PL_DATA_ELO+c.prototype.V2bc.PL_DATA_PICS;c.prototype.V34n=function(b){try{b.beginSizedRead(),this.V2de=b.V35k(),this.m_NewCBPlayer=new CB.V2br,this.m_NewCBPlayer.V34n(b,
this.V2de),this.V2df=new CB.V2dg,0<(this.V2de&this.V2bc.PL_DATA_ELO)?this.V2df.V34n(b):0<(this.V2de&this.V2bc.PL_DATA_ONE_ELO)&&this.V2df.V2dh(b),this.V2di=new CB.V2dj,0<(this.V2de&this.V2bc.PL_DATA_PICS)?this.V2di.V34n(b):0<(this.V2de&this.V2bc.PL_DATA_ONE_PIC)&&this.V2di.V34n(b),this.V2dk(b.V35c()),b.endSizedRead()}catch(c){return!1}return!0};c.prototype.V2dl=function(){return this.m_NewCBPlayer.V2dm()};c.prototype.V2dn=function(){return this.m_NewCBPlayer.V2dm().GetCBId()};c.prototype.V2do=function(b){this.m_NewCBPlayer.V2dm().SetCBId(b)};
c.prototype.V2dp=function(){return this.V2dq};c.prototype.V2dr=function(b){this.V2dq=b};c.prototype.V2ds=function(){return this.m_NewCBPlayer.V2dm()};c.prototype.V2dt=function(){return this.m_NewCBPlayer};c.prototype.V2du=function(){return this.V2df};c.prototype.V2dv=function(){return this.V2di};c.prototype.V2dw=function(){return 0<this.V2di.Count()};c.prototype.getFirstName=function(){return this.m_NewCBPlayer.getFirstName()};c.prototype.setFirstName=function(b){this.m_NewCBPlayer.setFirstName(b)};
c.prototype.V2dx=function(b){this.m_NewCBPlayer.setFirstName(b)};c.prototype.getLastName=function(){return this.m_NewCBPlayer.getLastName()};c.prototype.setLastName=function(b){this.m_NewCBPlayer.setLastName(b)};c.prototype.V2dy=function(){return this.V2dl().GetBirthDate()};c.prototype.setBirthDate=function(b){this.V2dl().setBirthDate(b)};c.prototype.getIdenticalCount=function(){return this.V2dl().getIdenticalCount()};c.prototype.V2dz=function(){return this.m_NewCBPlayer.V2d9().getCurrentTitle()};
c.prototype.setTitle=function(b){this.m_NewCBPlayer.V2d9().setCurrentTitle(b)};c.prototype.V2ct=function(){return this.m_NewCBPlayer.V2d9().GetNation()};c.prototype.setNation=function(b){this.m_NewCBPlayer.V2d9().setNation(b)};c.prototype.getBornNation=function(){return this.m_NewCBPlayer.V2d9().getBornNation()};c.prototype.V2cs=function(){return this.m_NewCBPlayer.V2d9().GetDeathDate()};c.prototype.setDeathDate=function(b){this.m_NewCBPlayer.V2d9().setDeathDate(b)};c.prototype.V2e0=function(){return this.m_NewCBPlayer.V2d9().getIsMale()};
c.prototype.setIsMale=function(b){this.m_NewCBPlayer.V2d9().setIsMale(b)};c.prototype.V2e1=function(b){this.V2de=b};c.prototype.V2e2=function(){return this.V2de};c.prototype.V2e3=function(){return this.V2e4};c.prototype.V2e5=function(b){this.V2e6=b};c.prototype.V2e7=function(){return this.V2e6};c.prototype.V2dk=function(b){this.V2e8=b};c.prototype.V2e9=function(){return this.V2e8};return c}();"use strict";
CB.V2bs=function(){var c=function(b,c){this.m_nIdenticalCount=0;this.V2ea=-1;this.m_sFirstName=b;this.m_sLastName=c};c.prototype.write=function(b){b.V357(this.m_sLastName);b.V357(this.m_sFirstName);b.V350(this.m_aBirthDate);b.V352(this.m_nIdenticalCount);b.V351(this.V2ea)};c.prototype.V34n=function(b){this.m_sLastName=b.V35a(100);this.m_sFirstName=b.V35a(100);this.m_aBirthDate=b.V35c();this.m_nIdenticalCount=b.V35e();this.V2ea=b.V35g();return!0};c.prototype.Vds=function(){var b=m_sLastName;return b+=
", "+m_sFirstName};c.prototype.V2eb=function(){for(var b=0,c=0;c<m_sLastName.Length;c++)b+=m_sLastName[c];for(c=0;c<m_sFirstName.Length;c++)b+=m_sFirstName[c];b+=m_aBirthDate.GetYear();return b+=m_nIdenticalCount};c.prototype.getFirstName=function(){return this.m_sFirstName};c.prototype.setFirstName=function(b){this.m_sFirstName=b};c.prototype.getLastName=function(){return this.m_sLastName};c.prototype.setLastName=function(b){this.m_sLastName=b};c.prototype.V2dy=function(){return this.m_aBirthDate};
c.prototype.setBirthDate=function(b){this.m_aBirthDate=b};c.prototype.getIdenticalCount=function(){return this.m_nIdenticalCount};c.prototype.V2ec=function(b){this.m_nIdenticalCount=b};c.prototype.V2ed=function(){this.m_nIdenticalCount++};c.prototype.V2dn=function(){return this.V2ea};c.prototype.V2do=function(b){this.V2ea=b};c.prototype.m_aBirthDate=new CB.Date;return c}();
CB.V2bl={V2ee:1300,V2ef:1301,V2eg:1302,V2eh:1303,V2ei:1304,V2ej:1305,V2ek:1306,V2el:1307,V2em:1308,V2en:1309,V2eo:1310,V2ep:1311,V2eq:1312,V2er:1313,V2es:1314,V2et:1315,V2eu:1316,V2ev:1317,V29:1320,V2bz:1321,V2bw:1322,V2bx:1323,toString:function(c){for(var b in this)if(this[b]==c)return b;return"Unknown PBUserMsgId: "+c},Vlu:function(c){return"PlUserMsgId="+c}};"use strict";
CB.V2dg=function(){var c=function(){};c.prototype.V34n=function(b){b.beginSizedRead();this.clear();var c=b.V35g();if(4096<c)return!1;if(0<c)for(var e=b.V35o(),f=0;f<c;f++){var g=new CB.V2ew(e);g.V34n(b);this.V2ex.push(g)}b.endSizedRead();return!0};c.prototype.V2dh=function(b){return this.ReadFromDataBuffer(b)};c.prototype.clear=function(){this.V2ex?this.V2ex.clear():this.V2ex=[]};c.prototype.V2ey=function(b){for(var c=this.count()-1,e="",f=0;f<b;f++){var g=c-1;if(0<=g){for(var h=this.V2ex[c].getDate().month;0<=
g&&6>Math.abs(h-this.V2ex[g].getDate().month);)g--;0<=g&&(c=this.V2ex[c].getNElo()-this.V2ex[g].getNElo(),e=10<=Math.abs(c)?0<c?"+"+e:"-"+e:"0"+e);c=g}}return e.length==b?e:""};c.prototype.V2ez=function(b){b=this.V2ex[0].getNElo();this.V2ex[0].getDate();for(var c=0;c<this.V2ex.length;c++){var e=this.V2ex[c];e.getNElo()>b&&(b=e.getNElo(),e.getDate())}return b};c.prototype.V2f0=function(b){b=this.V2ex[0].getNElo();this.V2ex[0].getDate();for(var c=0;c<this.V2ex.length;c++){var e=this.V2ex[c];e.getNElo()<
b&&(b=e.getNElo(),e.getDate())}return b};c.prototype.V2f1=function(b,c){for(var e=0,f=0,g=0;g<this.V2ex.length;g++){var h=this.V2ex[g];h.getDate().getYear()>=b&&h.getDate().getYear()<=c&&(e+=h.getNElo(),f++)}return 0<f?e/f:0};c.prototype.V2f2=function(b){b=0;0<this.V2ex.length&&(b=this.V2ex[this.V2ex.length-1].getNElo());return b};c.prototype.count=function(){return this.V2ex.length};c.prototype.get=function(b){return b<this.V2ex.length?this.V2ex[b]:new V2ew};return c}();"use strict";
CB.V2ew=function(){var c=function(b){this.bOld=b};c.prototype.V34n=function(b){b.beginSizedRead();this.V2f3=b.V35g();this.V2cp=b.V35e();this.aDate=b.V35c();this.V2f4=b.V35o();this.V2f5=new CB.V2f6;this.V2f5.V34n(b);this.V2f7=b.V35g();b.endSizedRead()};c.prototype.getDate=function(){return this.aDate};c.prototype.getNElo=function(){return this.V2f5.V2f8()};return c}();"use strict";
CB.V2f6=function(){var c=function(){};c.prototype.V34n=function(b){this.nFlags=b.V35e();this.V2f9=b.V35e();this.V2co=b.readUint8();this.V2fa=b.V35e();return!0};c.prototype.V2f8=function(){return this.V2f9};return c}();"use strict";
CB.V2dj=function(){var c=function(){};c.prototype.V34n=function(b){var c=b.V35e();this.clear();for(var e=0;e<c;e++){var f=new CB.V2fb;f.V34n(b);this.append(f)}};c.prototype.V2fc=function(b){return this.V2fd[b]};c.prototype.append=function(b){this.V2fd.push(b)};c.prototype.count=function(){return this.V2fd.Count};c.prototype.clear=function(){this.V2fd?this.V2fd.clear():this.V2fd=[]};return c}();"use strict";
CB.V2fb=function(){var c=function(){};c.prototype.V34n=function(b){this.V2fe=b.V35g();this.aDate=b.V35c();this.V2ff=b.V35e();this.sName=b.V34q(100);this.V2fg=b.V34q(100);this.V2fh=b.V34q(100);this.V2fi=b.V35o()};c.prototype.writeToDataBuffer=function(b){b.V351(this.V2fe);b.V350(this.aDate);b.V352(this.V2ff);b.V34p(this.sName);b.V34p(this.V2fg);b.V34p(this.V2fh);b.V35n(this.V2fi)};return c}();"use strict";
CB.V1et=function(){var c=function(b){this.eTitleCode=b};c.prototype.Code={CBTC_NONE:0,CBTC_MARKED:1,CBTC_HGM:2,CBTC_WFM:4,CBTC_WIM:8,CBTC_FM:16,CBTC_IM:32,CBTC_WWCH:64,CBTC_WCH:128};c.prototype.Code.V2fj=c.prototype.Code.CBTC_WIM|c.prototype.Code.CBTC_WFM;c.prototype.Code.V2fk=c.prototype.Code.CBTC_IM|c.prototype.Code.CBTC_FM;c.Vds=function(b){if((b&c.prototype.Code.V2fk)==c.prototype.Code.V2fk)return"GM";if((b&c.prototype.Code.V2fj)==c.prototype.Code.V2fj)return"WGM";if(b&c.prototype.Code.CBTC_WCH)return"WCH";
if(b&c.prototype.Code.CBTC_WWCH)return"WWCH";if(b&c.prototype.Code.CBTC_WIM)return"WIM";if(b&c.prototype.Code.CBTC_WFM)return"WFM";if(b&c.prototype.Code.CBTC_IM)return"IM";if(b&c.prototype.Code.CBTC_FM)return"FM"};c.prototype.V2fl=function(){var b="";0<(eTitleCode&c.prototype.Code.CBTC_WCH)&&(b+="WCH, ");0<(eTitleCode&c.prototype.Code.CBTC_WWCH)&&(b+="WWCH, ");(eTitleCode&c.prototype.Code.V2fk)==c.prototype.Code.V2fk?b+="GM, ":0<(eTitleCode&c.prototype.Code.CBTC_IM)?b+="IM, ":0<(eTitleCode&c.prototype.Code.CBTC_FM)&&
(b+="FM, ");(eTitleCode&c.prototype.Code.V2fj)==c.prototype.Code.V2fj?b+="WGM, ":0<(eTitleCode&c.prototype.Code.CBTC_WIM)?b+="WIM, ":0<(eTitleCode&c.prototype.Code.CBTC_WFM)&&(b+="WFM, ");0<(eTitleCode&c.prototype.Code.CBTC_HGM)&&(b+="HGM, ");0<(eTitleCode&c.prototype.Code.CBTC_MARKED)&&(b+="VIP, ");return b};return c}();"use strict";
CB.V2fm=function(){var c=function(){this.V2fq=this.V2fp=this.V2fo=this.V2fn=0};c.prototype.writeToDataBuffer=function(b){b.beginSizedWrite();b.V351(this.V2fr);b.V351(this.V2fo);b.V351(this.V2fp);b.V351(this.V2fq);b.endSizedWrite();return!0};return c}();
CB.V2fs=function(){var c=function(){};c.prototype.numBits=[1,6,6,5,5,5,3,1,1,6,6,5,5,5,3,1];c.prototype.theBits=[0,32,34,18,20,22,6,0,0,33,35,19,21,23,7,0];c.prototype.isUniqe=[0,255,255,255,255,255,6,14,255,255,255,255,255,255,255,255,255,255,3,11,4,12,5,13,255,255,255,255,255,255,255,255,1,9,2,10,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255];c.prototype.HUFF_960=128;c.prototype.HUFF_CASTLE=64;c.prototype.V29d=32;c.prototype.V29f=
function(b,c,e){var f,g,h,k=0;c[k]=0;k++;c[k]=0;b.getBTM()&&(c[k]=128);f=0;g=1;for(h=2;64>f;f++){var l=b.board[f]&15;g+=this.numBits[l];if(8<g){c[k]|=this.theBits[l]>>g-8;if(++h>e)return 1;k++;c[k]=0;g-=8}c[k]|=this.theBits[l]<<8-g;if(8<=g){g=0;if(++h>e)return 1;k++;c[k]=0}}l=f=0;0<b.getCastleRights()&&(l|=this.HUFF_CASTLE,f+=4);0<b.getCPPEPFile()&&(l|=this.V29d,f+=3);if(0<f){if(8<g+f){if(++h>e)return 1;k++;c[k]=0}0<b.getCastleRights()?(c[k]|=b.getCastleRights()&15,0<b.getCPPEPFile()&&(c[k]|=(b.getCPPEPFile()-
1&7)<<4)):0<b.getCPPEPFile()&&(c[k]|=b.getCPPEPFile()-1&7)}else 0==g&&--h;c[0]=h|l;for(b=0;b<=k;b++)c[b]&=255;return 0};c.prototype.V2ft=function(b,c,e){var f,g,h=0,k;b.ep=CB.Position.NOEP;for(f=0;64>f;f++)b.board[f]=0;f=c[h]&(this.HUFF_960|this.HUFF_CASTLE|this.V29d);g=c[h]&31;if(8<g&&g<e){0<(f&this.HUFF_CASTLE)?(b.setCastleRights(c[g-1]&15),b.ep=0<(f&this.V29d)?c[g-1]>>4&7:CB.Position.NOEP):(b.setCastleRights(CB.Vb7.V5k),b.ep=0<(f&this.V29d)?c[g-1]&7:CB.Position.NOEP);h++;0<(c[h]&128)?b.setBTM(!0):
b.setBTM(!1);f=0;e=1;for(k=64;64>f&&e<g;f++){var l=0,m=0;do l<<=1,0<(c[h]&k)&&(l|=1),m++,k>>=1,0==k&&(k=128,h++,e++);while(255==this.isUniqe[l]&&6>m);if(255==this.isUniqe[l])break;b.board[f]=this.isUniqe[l]}if(64>f)return b.initStartPos(),1}else return b.initStartPos(),1;return 0};return c}();"use strict";
CB.HashPosition=function(){var c=function(b){this.m_cPos=[];for(var c=0;24>c;c++)this.m_cPos.push(0);b&&(new CB.V2fs).V29f(b,this.m_cPos,this.m_cPos.length)};c.prototype.V2fu=function(){return this.m_cPos[0]&31};c.prototype.IsSet=function(){return 0!=this.m_cPos[0]};c.prototype.Clear=function(){for(var b=0;b<m_cPos.Length;b++)this.m_cPos[b]=0};c.prototype.GetBTM=function(){return 0!=(this.m_cPos[1]&128)};c.prototype.HashPosition=function(b,c){};c.prototype.writeToDataBuffer=function(b){b.beginSizedWrite();
b.writeByteArray(this.m_cPos,this.m_cPos.length);b.endSizedWrite();return!0};c.prototype.V34n=function(b){b.beginSizedRead();for(var c=0;c<this.m_cPos.length;c++)this.m_cPos[c]=b.readByte();b.endSizedRead();return!1};c.prototype.getPosition=function(){var b=new CB.V2fs,c=new CB.Position;b.V2ft(c,this.m_cPos,this.m_cPos.length);return c};c.prototype.FillPos=function(b){};c.prototype.V2fv=function(b){};c.prototype.V2fw=function(b){};c.prototype.V2fx=function(b){};c.prototype.IsStartPosition=function(){return!1};
c.prototype.IsFinalPosition=function(){return!1};c.prototype.V2fy=function(){return m_sStartPosition};return c}();"use strict";
CB.V2fz=function(){var c=function(){this.m_nIdDiscoverer=0;this.pos=new CB.HashPosition;this.move=[]};c.V2g0=function(){for(var b=new CB.V2fz,c=0;c<CB.TBRAIN.HASH_LINE_CNT;c++)b.move.push(new CB.V2g1);return b};c.prototype.writeToDataBuffer=function(b){b.beginSizedWrite();pos.writeToDataBuffer(b);b.writeUShort(CB.TBRAIN.HASH_LINE_CNT);for(var c=0;c<CB.TBRAIN.HASH_LINE_CNT;++c)m_aMove[c].writeToDataBuffer(b);b.V35d(m_nPopularity);b.writeUnsigned(m_nIdDiscoverer);b.writeInt(m_nFlags);b.writeUnsigned(TBrainConstants.CALCTIME_REASONABLE_THRESH);
b.writeUnsigned(TBrainConstants.CALCTIME_DISCOVERY);b.writeUnsigned(TBrainConstants.CALCTIME_DONATION);b.writeUnsigned(TBrainConstants.CALCTIME_DEEP);b.writeUnsigned(m_nGames);b.wndSizedWrite();return!0};c.prototype.V34n=function(b){b.beginSizedRead();this.pos.V34n(b);for(var c=b.V35e(),e=0;e<CB.V1ig.prototype.HASH_LINE_CNT&&e<c;++e)null==this.move[e]&&(this.move[e]=new CB.V2g1),this.move[e].V34n(b);this.m_nPopularity=b.readUint64();this.m_nIdDiscoverer=b.V35g();this.m_nFlags=b.V35g();this.V2g2=b.V35g();
this.V2g3=b.V35g();this.V2g4=b.V35g();this.V2g5=b.V35g();0==this.V2g5&&(this.V2g5=V1ig.prototype.CALCTIME_DEEP);this.m_nGames=b.V35e();b.endSizedRead();return!0};c.prototype.clear=function(){for(var b=0;b<TBRAIN.HASH_LINE_CNT;++b)m_aMove[b].clear();pos.Clear();m_nGames=m_nPopularity=m_nFlags=m_nIdDiscoverer=0};c.V1it=function(b,c,e,f){f=f||3;var g="",h=[];if(c&&c.m_aLine){h=this.V2g6(ObjUtil.clone(b),c.m_aLine);b=new CB.Vib(CB.V34l);c=e.game.getStartPos().getBTM();for(var k=0;k<h.length&&k<f;k++)if(h[k].from!=
h[k].to){var l=b.getMoveNota(h[k]),m=b.getStrMoveNumInLine(k,e.getCurPos().getPlyNum(),c),g=g+(m+l);k<h.length-1&&(g+=" ")}}return{line:h,lineNota:g}};c.V2g6=function(b,c){for(var e=[],f=0;f<c.length;f++){var g=new CB.Veh(c[f]&63,c[f]>>6&63,c[f]>>12&7);b.isLegalMove(g)&&(b.preCalcCtx(g),b.makeMove(g),b.postCalcCtx(g,!0),e.push(g))}return e};c.prototype.V2g7=function(){};c.prototype.Count=function(){return TBRAIN.HASH_LINE_CNT};c.prototype.Empty=function(){return m_aMove[0].Empty()};c.prototype.FillPos=
function(b){pos.FillPos(b)};c.prototype.V2g8=function(){return pos};c.prototype.GetMove=function(b){CBDebug.assert(b<TBRAIN.HASH_LINE_CNT);return b<TBRAIN.HASH_LINE_CNT?m_aMove[b]:m_aMove[0]};c.prototype.V2g9=function(b,c){CBDebug.assert(c<TBRAIN.HASH_LINE_CNT);c<TBRAIN.HASH_LINE_CNT&&(m_aMove[c]=b)};c.prototype.V2ga=function(){return m_nPopularity};c.prototype.V2gb=function(b){m_nPopularity=b};c.prototype.V2gc=function(){return m_nGames};c.prototype.V2gd=function(){return m_nIdDiscoverer};c.prototype.V2ge=
function(b){m_nIdDiscoverer=b};c.prototype.V2gf=function(){return V28j(1)};c.prototype.V2gg=function(b){SETFLAG(1,b)};c.prototype.V2gh=function(){return V2g2};c.prototype.V2gi=function(){return V2g3};c.prototype.V2gj=function(){return V2g4};c.prototype.V2gk=function(){return V2g5};return c}();"use strict";
CB.V2gl=function(){var c=function(){this.V2gm=new CB.V2fm;this.m_nFlags=this.m_nSpeed=0};c.prototype.read=function(b){};c.prototype.V2gn=function(){return this.V2gm};c.prototype.V2go=function(){return 0<this.m_nSpeed};c.prototype.V2gp=function(){return m_nSpeed};c.prototype.V2gq=function(b){m_nSpeed=b};c.prototype.V2gr=function(){return V28j(1)};c.prototype.writeToDataBuffer=function(b){b.beginSizedWrite();this.V2gm.writeToDataBuffer(b);b.V351(this.m_nSpeed);b.V351(this.m_nFlags);b.endSizedWrite();
return!0};c.prototype.ReadFromDataBuffer=function(b){return!0};c.prototype.V2gs=function(){var b=new CBGuid;b.CreateFromHardware();return b};return c}();"use strict";
CB.ClientMachineInfo=function(){var c=function(){};CB.inherit(c,CB.V2gl);c.prototype.read=function(b){this.V2cm=b.V35a(100);this.V2cn=b.V35a(100);this.V2co=b.V35g();this.V2cp=b.V35g()};c.prototype.Init=function(){m_nSpeed=s_nSpeed;s_bInited=!0};c.prototype.V2gp=function(){s_bInited&&0!=s_nSpeed||(Init(),0==s_nSpeed&&(s_nSpeed=1E5));return s_nSpeed};return c}();"use strict";
CB.GamePerformanceStats=function(){var c=function(){};c.prototype.Vfd=function(){this.V2cn=this.V2cm="";this.m_nResultSum=this.m_nResultCount=this.m_nEloSum=this.m_nEloCount=this.V2cp=this.V2co=0};c.prototype.read=function(b){this.V2cm=b.V35a(100);this.V2cn=b.V35a(100);this.V2co=b.V35g();this.V2cp=b.V35g()};c.prototype.V2gt=function(b,d){var e=new c(b);e.m_nEloCount+=d.m_nEloCount;var f=e.m_nEloSum+d.m_nEloSum;f>uint.MaxValue-1E4?(e.m_nEloSum=uint(f/2),e.m_nEloCount/=2):e.m_nEloSum=f;var f=e.m_nResultSum+
d.m_nResultSum,g=e.m_nResultCount+d.m_nResultCount;f>uint.MaxValue-1E4||g>uint.MaxValue-1E4?(e.m_nResultSum=f/2,e.m_nResultCount=g/2):(e.m_nResultSum=f,e.m_nResultCount=g);return e};c.prototype.writeToDataBuffer=function(b){b.WriteUnsigned(m_nEloSum);b.WriteUnsigned(m_nEloCount);b.WriteUnsigned(m_nResultSum);b.WriteUnsigned(m_nResultCount)};c.prototype.V34n=function(b){this.m_nEloSum=b.V35g();this.m_nEloCount=b.V35g();this.m_nResultSum=b.V35g();this.m_nResultCount=b.V35g();return!0};c.prototype.V2gu=
function(){return 0!=m_nResultCount?500*m_nResultSum/m_nResultCount:0};c.prototype.getSortEloAv=function(){return 0!=this.m_nEloCount?this.m_nEloSum/this.m_nEloCount:0};c.prototype.getFPercent=function(b){return 0!=this.m_nResultCount?b?100-50*this.m_nResultSum/this.m_nResultCount:50*this.m_nResultSum/this.m_nResultCount:0};c.prototype.getNGames=function(){return Math.max(this.m_nEloCount,this.m_nResultCount)};return c}();"use strict";
CB.V2g1=function(){var c=function(){this.m_aLine=[0]};c.prototype.read=function(b){};c.prototype.WriteToDataBuffer=function(b){return!0};c.prototype.V34n=function(b){b.beginSizedRead();this.m_nConfidence=b.V35g();this.m_nEval=b.V35l();this.m_nDepth=b.readByte();this.m_nFlags=b.readByte();for(var c=b.V35e(),e=0;e<CB.V1ig.prototype.HASH_LINE_LEN&&e<c;++e)this.m_aLine[e]=b.V35e();this.m_nEngineId=b.V35g();this.m_nUserId=b.V35g();this.m_nTimeStamp=b.V35e();this.V2gv=b.V35e();this.m_bReasonableDepth=b.V35o();
this.m_nRankingListWeight=b.V35g();b.endSizedRead();return!0};c.prototype.Empty=function(){return!0};c.prototype.V2gw=function(b){return!1};c.prototype.V2gx=function(){for(var b=0;b<HASH_LINE_LEN;++b);return"??"};c.prototype.V2gy=function(b){m_nTimeStamp=TBrainTimeStamp.DateToUShort(b)};c.prototype.V2gz=function(){return TBrainTimeStamp.UShortToDate(m_nTimeStamp)};c.prototype.V2h0=function(b,c){return!1};c.prototype.V2h1=function(b,c){return!1};c.prototype.V2h2=function(b,c){return!0};c.prototype.V2g9=
function(b,c){return!1};c.prototype.V2h3=function(b,c){return!1};c.prototype.V2h4=function(){return 29E3<Math.Abs(m_nEval)};c.prototype.V2h5=function(b){return 0!=V2h6()?100*b/V2h6()+.5:0};c.prototype.Count=function(){return TBRAIN.HASH_LINE_LEN};c.prototype.Clear=function(){};c.prototype.GetNEval=function(){return 0};c.prototype.V2h7=function(b){m_nEval=b;SETFLAG(TBRAIN.EVAL_MOVE_NO,!1)};c.prototype.GetNMoveNo=function(){return 0};c.prototype.V2h8=function(b){m_nEval=b;SETFLAG(TBRAIN.EVAL_MOVE_NO,
!0)};c.prototype.GetNDepth=function(){return m_nDepth};c.prototype.V2h9=function(b){m_nDepth=b};c.prototype.V2ha=function(){return m_nConfidence};c.prototype.V2hb=function(b){m_nConfidence=b};c.prototype.GetMove=function(b){return 0};c.prototype.V2g9=function(b,c){};c.prototype.IsEval=function(){return!V28j(TBRAIN.EVAL_MOVE_NO)};c.prototype.IsMoveNo=function(){return V28j(TBRAIN.EVAL_MOVE_NO)};c.prototype.V2hc=function(){return m_nEngineId};c.prototype.V2hd=function(b){m_nEngineId=b};c.prototype.V2he=
function(){return m_nUserId};c.prototype.V2hf=function(b){m_nUserId=b};c.prototype.V2hg=function(){return V28j(TBRAIN.USER_IS_LOGIN)};c.prototype.V2hh=function(b){SETFLAG(TBRAIN.USER_IS_LOGIN,b)};c.prototype.V2hi=function(b){m_nTimeStamp=b};c.prototype.V2h6=function(){return V2gv};c.prototype.V2hj=function(){return m_bReasonableDepth};c.prototype.V2hk=function(b){m_bReasonableDepth=b};c.prototype.V2hl=function(){return V2gv>=TBrainConstants.CALCTIME_DISCOVERY};c.prototype.V2hm=function(){return V2gv>=
TBrainConstants.CALCTIME_DEEP};c.prototype.V2hn=function(){return m_nRankingListWeight};c.prototype.V2ho=function(b){m_nRankingListWeight=b};return c}();"use strict";
CB.V2hp=function(){var c=function(){this.m_aMachineGuid=new CBGuid;this.m_nCpus=this.m_nSecs=this.m_nFlags=0;this.m_nVariations=1;this.m_nNodes=this.m_nMoveNo=this.m_nHashSize=0;this.m_fMachineFact=this.m_fEngineFact=1};c.prototype.V2hq=function(){return 0};c.prototype.GetFCalcDepth=function(b){return 0};c.prototype.V2hr=function(){return TBServerBinder(GetFCalcDepth(uint(m_nSecs+1))*m_fEngineFact*m_fMachineFact)};c.prototype.GetNTodaysTimeStamp=function(){return TBrainTimeStamp.GetNTodaysTimeStamp()};
c.prototype.WriteToDataBuffer=function(b){b.BeginSizedWrite();m_aMachine.WriteToDataBuffer(b);b.WriteString(m_strEngine);b.WriteUnsigned(m_nFlags);pos.WriteToDataBuffer(b);m_aMove.WriteToDataBuffer(b);b.WriteUnsigned(m_nSecs);b.WriteUnsigned(m_nCpus);b.WriteUnsigned(m_nVariations);m_aMachineGuid.WriteToDataBuffer(b);b.WriteUnsigned(m_nHashSize);b.WriteData(m_cCheckSum,m_cCheckSum.Length);b.WriteInt(m_nMoveNo);b.WriteInt64(m_nNodes);b.EndSizedWrite();return!0};c.prototype.V34n=function(b){b.BeginSizedRead();
m_aMachine.ReadFromDataBuffer(b);m_strEngine=b.ReadString();m_nFlags=b.ReadUnsigned();pos.ReadFromDataBuffer(b);m_aMove.ReadFromDataBuffer(b);m_nSecs=b.ReadUnsigned();m_nCpus=b.ReadUnsigned();16<m_nCpus&&(m_nCpus=16);m_nVariations=Math.Min(64,Math.Max(1,b.ReadUnsigned()));1>m_nVariations&&(m_nVariations=1);m_aMachineGuid.ReadFromDataBuffer(b);m_nHashSize=b.ReadUnsigned();m_nMoveNo=b.ReadInt();m_nNodes=b.ReadInt64();b.EndSizedRead();return!0};c.prototype.V2hs=function(){return new CBGame};c.prototype.V2ht=
function(){return m_aMachine};c.prototype.V2hu=function(b){m_aMachine=b};c.prototype.V2hv=function(){return m_strEngine};c.prototype.V2hw=function(b){m_strEngine=b};c.prototype.V2hx=function(){return m_aMachineGuid};c.prototype.V2hy=function(b){m_aMachineGuid=b};c.prototype.V2hz=function(b){m_nSecs=b};c.prototype.V2i0=function(){return m_nSecs};c.prototype.V2i1=function(){return pos};c.prototype.V2i2=function(){return new V2i3(pos,GetNMoveNo())};c.prototype.V2i4=function(b){pos.FillPos(b);b.SetMoveNo(GetNMoveNo())};
c.prototype.V2i5=function(b){pos=new HashPosition(b);m_nMoveNo=b.GetMoveNo()};c.prototype.GetMove=function(b){return TBServerBinderm_aMove.GetMove(b)};c.prototype.GetNEval=function(){return m_aMove.GetNEval()};c.prototype.GetNMoveNo=function(){return m_nMoveNo};c.prototype.V2h8=function(b){m_nMoveNo=b};c.prototype.GetNDepth=function(){return m_aMove.GetNDepth()};c.prototype.IsEval=function(){return m_aMove.IsEval()};c.prototype.IsMoveNo=function(){return m_aMove.IsMoveNo()};c.prototype.V2i6=function(){return m_nCpus};
c.prototype.V2i7=function(b){m_nCpus=TBServerBinderr};c.prototype.V2i8=function(){return m_nVariations};c.prototype.V2i9=function(b){m_nVariations=TBServerBinderr};c.prototype.V2ia=function(b){m_fEngineFact=b};c.prototype.V2ib=function(b){m_fMachineFact=b};c.prototype.V2ic=function(b){SETFLAG(1,b)};c.prototype.V2id=function(){return V28j(1)};c.prototype.V2ie=function(b){SETFLAG(2,b)};c.prototype.V2if=function(){return V28j(2)};c.prototype.V2ig=function(b){SETFLAG(65536,b)};c.prototype.V2ih=function(){return V28j(TBServerBinderHTR.HTR_UCI_ENGINE)};
c.prototype.V2ii=function(b){SETFLAG(256,b)};c.prototype.V2ij=function(){return V28j(TBServerBinderHTR.HTR_UNRELIABLE_DATA)};c.prototype.V2ik=function(){return V28j(TBServerBinderHTR.HTR_EVAL_NORMED)};c.prototype.V2il=function(b){SETFLAG(TBServerBinderHTR.HTR_EVAL_NORMED,b)};c.prototype.V2im=function(b){};return c}();"use strict";CB.V2in=function(){return function(c,b){this.aBoard=c;this.sMove=b}}();"use strict";
CB.V2i3=function(){var c=function(b,c,e){this.pos=new CB.HashPosition(b);this.m_nMoveNo=c;this.V2iq=this.V2ip=this.V2io=0;this.m_strTag=e};c.prototype.IsSet=function(){return pos.IsSet()};c.prototype.IsStartPosition=function(){return pos.IsStartPosition()};c.prototype.IsFinalPosition=function(){return pos.IsFinalPosition()};c.prototype.V2ir=function(){return m_strTag};c.prototype.V2is=function(b){m_strTag=b};c.prototype.WriteToDataBuffer=function(b){pos.WriteToDataBuffer(b);b.BeginSizedWrite();b.WriteInt(m_nMoveNo);
b.WriteString(m_strTag);b.EndSizedWrite()};c.prototype.ReadFromDataBuffer=function(b){if(!pos.ReadFromDataBuffer(b))return!1;b.BeginSizedRead();m_nMoveNo=b.ReadInt();m_strTag=b.ReadString();var c=0<=m_nMoveNo;b.EndSizedRead();return c};c.prototype.CreatePosition=function(){var b=pos.CreatePosition();b.SetMoveNo(m_nMoveNo);return b};return c}();"use strict";CB.TBRAIN={HASH_LINE_LEN:3,HASH_LINE_CNT:3,V2it:63,EVAL_MOVE_NO:1,USER_IS_LOGIN:2,V2iu:4,V2iv:8,V2iw:16};
CB.V1ig=function(){var c=function(){this.move=new CB.Veh;this.m_performanceStats=new CB.GamePerformanceStats;this.m_nFlags=0};c.prototype.HASH_LINE_LEN=3;c.prototype.HASH_LINE_CNT=3;c.prototype.CALCTIME_DEEP=370;c.prototype.getMoveRecord=function(){return this.move};c.prototype.getLine=function(b){CBDebug.assert(b<CB.TBRAIN.HASH_LINE_LEN);return b<CB.TBRAIN.HASH_LINE_LEN?m_aLine[b]:0};c.prototype.getLine=function(b,c){CBDebug.assert(c<CB.TBRAIN.HASH_LINE_LEN);m_aLine[c]=b};c.prototype.getNEval=function(){return this.m_nEval};
c.prototype.V2ix=function(){return this.m_nTimeStamp};c.prototype.V2iy=function(b){m_nTimeStamp=b};c.prototype.hasEval=function(){return CB.V4p(this.m_nFlags,1)||0!=this.m_nEval};c.prototype.V2iz=function(b){this.m_nFlags=b?this.m_nFlags|1:this.m_nFlags&-2};c.prototype.V2j0=function(){};c.prototype.V2j1=function(b){};c.prototype.V2j2=function(){return m_performanceStats};c.prototype.getNGames=function(){return this.m_performanceStats.getNGames()};c.prototype.V2j3=function(){return this.m_performanceStats.getSortEloAv()};
c.prototype.V2j4=function(b){this.move=b;this.m_nFlags=this.m_nTimeStamp=this.m_nEval=0;this.m_aLine=[];this.m_performanceStats.Vfd()};c.prototype.writeToDataBuffer=function(b){b.BeginSizedWrite();b.WriteInt64(m_nVisits);b.WriteBYTE(this.move.V2aa);b.WriteBYTE(this.move.toSq);b.WriteBYTE(this.move.V2j5);b.WriteBYTE(this.move.V2j6);b.WriteShort(this.m_nEval);b.WriteUShort(this.m_nTimeStamp);b.WriteShort(this.m_nFlags);this.m_performanceStats.WriteToDataBuffer(b);b.EndSizedWrite()};c.prototype.V34n=
function(b){b.beginSizedRead();this.m_nVisits=b.V35i();this.move.from=b.readUint8();this.move.to=b.readUint8();this.move.V2j5=b.readUint8();this.move.prom=b.readUint8();this.m_nEval=b.V35l();this.m_nTimeStamp=b.V35e();this.m_nFlags=b.V35l();this.m_performanceStats.V34n(b);this.m_aLine=[];for(var c=0;c<CB.V1ig.prototype.HASH_LINE_LEN;++c){var e=b.V35e();this.m_aLine.push(e)}b.endSizedRead();return!0};c.prototype.V2j7=function(){return TBrainTimeStamp.UShortToDate(m_nTimeStamp)};c.prototype.getNVisits=
function(){return this.m_nVisits};c.V1ih=function(){var b=new CB.Date;b.V5d();b.setYear(b.getYear()-1945);return b.V5e()};c.prototype.toString=function(){return this.move.toString()+", N="+this.getNGames()+",ev="+this.m_nEval};return c}();"use strict";
CB.V1iq=function(){var c=function(){this.moves=[]};c.prototype.writeToDataBuffer=function(b){b.BeginSizedWrite();b.WriteInt(GetNFormat());b.WriteUnsigned(Count);for(var c=0;c<Count;c++)this[c].WriteToDataBuffer(b);b.EndSizedWrite()};c.prototype.V34n=function(b){b.beginSizedRead();b.readInt();this.clear();for(var c=b.readInt(),e=0;e<c;e++){var f=new CB.V1ig;f.V34n(b);this.add(f)}b.endSizedRead();return!0};c.prototype.clear=function(){this.moves=[]};c.prototype.count=function(){return this.moves.length};
c.prototype.add=function(b){this.moves.push(b)};c.prototype.get=function(b){return this.moves[b]};c.prototype.V2j8=function(){return 2};c.prototype.V2j9=function(){for(var b=0,c=0;c<this.moves.length;c++)this.moves[c].getNGames()>b&&(b=this.moves[c].getNGames());return b};c.V1ir=function(b,c){b.sort(function(b,f){return c?b.m_nEval-f.m_nEval:f.m_nEval-b.m_nEval})};c.prototype.V2ja=function(b){if(0==this.moves.length)return b;for(var c=this.moves[0].m_nEval,e=0;e<this.moves.length;e++)if(50>Math.abs(this.moves[e].m_nEval-
c)){if(this.moves[e].move.equals(b))return b}else break;return this.moves[0].move};return c}();"use strict";
CB.V2jb=function(){var c=function(){};c.prototype.V2jc=function(){return m_strName};c.prototype.V2jd=function(){return m_aRank};c.prototype.V2je=function(b){m_aRank=b};c.prototype.V2jf=function(){return m_nAccountAgeDays};c.prototype.V2jg=function(b){m_nAccountAgeDays=b};c.prototype.V2jh=function(){return V28j(1)};c.prototype.V2ji=function(){return V28j(2)};c.prototype.V2jj=function(){return V28j(4)};c.prototype.V2jk=function(){return m_aGeoCoords};c.prototype.V2jl=function(){return m_nFlags};c.prototype.V2jm=
function(){return m_nUFDFlags};return c}();"use strict";
CB.V2jn=function(){var c=function(){this.pos=new CB.HashPosition;this.moveList=new CB.V1iq};c.prototype.read=function(){};c.prototype.V2jo=function(b){b=b.GetPDataBuf();b.Rewind();ReadFromDataBuffer(b)};c.prototype.writeToDataBuffer=function(b){b.beginSizedWrite();pos.writeToDataBuffer(b);b.V35d(m_nVisits);moveList.writeToDataBuffer(b);b.wndSizedWrite()};c.prototype.V34n=function(b){b.beginSizedRead();this.pos.V34n(b);this.m_nVisits=b.V35i();this.moveList.V34n(b);b.endSizedRead();return!0};c.prototype.toString=
function(){return""};c.prototype.V2jp=function(){var b=new TeraBrainMessage(SocketsMessageType.TERABRAIN_BOOKINFO);WriteToDataBuffer(b.GetPDataBuf());return b};c.prototype.getNVisits=function(){return m_nVisits};c.prototype.V2jq=function(){return this.moveList};c.prototype.V2jr=function(b){moveList=b};c.prototype.V2js=function(){return pos};return c}();"use strict";CB.namespace("CB.Server.TeraBrainLobby");
CB.Server.TeraBrainLobby=function(){var c=function(){this.V2jt=this.idGroup=0;this.V2ju=!1;this.V2jv=0;this.V2jx=this.V2jw=!1;this.V2jy=0;this.V2k1=this.V2k0=this.V2jz=!1;this.V2k2=1;this.V2k3=!1;this.m_nEngineId=this.V2k4=0;this.V2k5=[];this.V2k6={};this.V2k7=new CB.Timer(function(){this.V2k8()}.bind(this),2E3);this.name="TBrain";this.V2k9=new CB.V2ka};CB.inherit(c,CB.Server.V1pi);c.prototype.execCommand=function(b){if(!this.Vte)return!1;switch(b){case CB.V2kb.V2kc:this.V1o6(!0)}};c.prototype.V1qx=
function(){};c.prototype.V1qd=function(b){b.documentUrl=document.URL;V35p.isAnyPlugin||(b.documentUrl+=" (off)")};c.prototype.V1r4=function(b){this.V2ke&&this.V2ke()};c.prototype.request=function(b,c,e,f,g,h,k){this.V2jz||(this.V2kf=new CB.ClientMachineInfo,c=new CB.V2kg(c,e,this.V2kf),c.setIsNormedEval(!0),c.setCountVisit(!f),c.setConfirmRequested(g),c.setIsHumanServerGame(h),c.setIsMultiRequest(k),f=c.V2jp(),f.setVal(b),this.send(f))};c.prototype.Vtb=function(b){this.Vte&&(this.request(1,b,3,!0,
!1,!0),this.V2k7.runOnce(2E3))};c.prototype.V2bu=function(b,c,e){this.Vte&&(this.V2k6[b]=e,this.request(b,c,3,!0,!1,!0))};c.prototype.Vt6=function(b,c,e,f,g){if(this.Vte){var h=this.V2k9.V1ym(b);this.request(f||1,b,2,h,e,c,g)}};c.requestHotPosition=function(){var b=new CB.TeraBrainMessage(SocketsMessageType.TERABRAIN_USER);b.setUserType(TeraBrainUserMsgType.TBUSER_REQ_HOTPOSITION);this.send(b)};c.prototype.V2kh=function(b){var c=new CB.Vat(CB.V1k2.TERABRAIN_USER);c.setUserType(CB.TeraBrainUserMsgType.V2ki);
c.buf.V351(b.length);for(var e=0;e<b.length;e++)c.buf.V351(b[e]);this.send(c)};c.prototype.V1o2=function(b){if(!this.V1r5(b))switch(b.getType()){default:TRACE("Unhandled: "+b.toString());break;case CB.V1k2.V1l2:this.V2kj();break;case CB.V1k2.V15:break;case CB.V1k2.TERABRAIN_BOOKINFO:this.V2kk(b);break;case CB.V1k2.V1ma:this.V2kl(b);break;case CB.V1k2.TERABRAIN_USER:this.V2ap(b)}};c.prototype.V2ap=function(b){switch(b.getUserType()){case CB.TeraBrainUserMsgType.V2km:this.V2kn(b);break;case CB.TeraBrainUserMsgType.V2kq:this.V2kr(b)}};
c.prototype.V2kk=function(b){this.V2l6=new CB.V2jn;this.V2l6.V34n(b.getBuf());var c=this.V2l6.pos.getPosition();this.fireOnLiveBook({position:c,moves:this.V2l6.moveList.moves,ticket:b.getVal(),tbInfo:this.V2l6})};c.prototype.V2kr=function(b){this.fireOnLiveBook({moves:[],ticket:b.getVal()})};c.prototype.V2kj=function(){this.V1py=!0;this.V2l7?(this.V2l7(),this.V2l7=null):this.Vtb(new CB.Position)};c.prototype.V2kl=function(b){this.V2k7.stop();this.V2l8=new CB.V2fz;this.V2l8.V34n(b.getBuf());for(var c=
[],e=0;e<CB.V1ig.prototype.HASH_LINE_CNT;++e)null==this.V2k5[this.V2l8.move[e].m_nEngineId]?c.push(this.V2l8.move[e].m_nEngineId):this.V2l8.move[e].EngineName=this.V2k5[this.V2l8.move[e].m_nEngineId];0<c.length?this.V2kh(c):(c=this.V2l8.pos.getPosition(),V35p.panelMgr.tbPanel&&V35p.panelMgr.tbPanel.update(c,this.V2l8),this.V2k6[b.getVal()]&&(this.V2k6[b.getVal()](b.getVal(),this.V2l8),delete this.V2k6[b.getVal()]),this.fireOnTBData({position:c,table:this.V2l8}))};c.prototype.V2k8=function(){this.V2l8||
(this.V2l8=new CB.V2fz);var b=CB.V2fz.V2g0();V35p.panelMgr.tbPanel&&V35p.panelMgr.tbPanel.update(this.V2l8.pos.getPosition(),b)};c.prototype.V2kn=function(b){for(var c=b.getBuf().V35g(),e=0;e<c;e++){b.getBuf().beginSizedRead();var f=b.getBuf().V34q(255),g=b.getBuf().V35g();this.V2k5[g]=f;b.getBuf().readFloat64();b.getBuf().endSizedRead()}for(b=0;b<CB.V1ig.prototype.HASH_LINE_CNT;++b)this.V2l8.move[b].EngineName=this.V2k5[this.V2l8.move[b].m_nEngineId];b=this.V2l8.pos.getPosition();V35p.panelMgr.tbPanel&&
(V35p.panelMgr.tbPanel.update(b,this.V2l8),this.V2k7.stop(),this.fireOnTBData({position:b,table:this.V2l8}))};c.prototype.V2l9=function(){var b=new TeraBrainMessage(SocketsMessageType.TERABRAIN_USER);b.SetUserType(TeraBrainUserMsgType.TBUSER_CHESSSERVER_LOGIN);var c=b.GetPDataBuf();c.WriteString(m_strUsername);c.WriteString(m_strPassword);V2la();m_sMachineGuid.IsZero()?CBDebug.assert(!1):(this.m_sMachineGuid.WriteToDataBuffer(c),this.send(b))};c.prototype.V2lb=function(b){b=new TeraBrainMessage(SocketsMessageType.TERABRAIN_USER);
b.SetUserType(TeraBrainUserMsgType.TBUSER_CHESSSERVER_LOGOUT);var c=b.GetPDataBuf();this.V2la();m_sMachineGuid.IsZero()?CBDebug.assert(!1):(this.m_sMachineGuid.WriteToDataBuffer(c),Send(b));this.V2ju=!1;V2lc()};c.prototype.V2lc=function(){this.V2jv=0;this.V2jw=!1;this.m_nUserId=0};c.prototype.V2la=function(){m_sMachineGuid.IsZero();return m_sMachineGuid};c.prototype.V2he=function(){return m_nUserId};c.prototype.V2ld=function(){return m_nEngineId};c.prototype.V2le=function(){return!0};c.prototype.V2lf=
function(){return!1};c.prototype.V2lg=function(){return 30};c.prototype.V1vq=function(b){var c=new CB.ChatData;c.fromSocketsMsg(b);c.V1na()?(b=this.V2c9.V2ca(c.V1ne()),b.length&&(c.strMsg="("+b+"): "+c.strMsg),V35p.panelMgr.V1ri(c.toString(),"LogKibitzChat")):V35p.panelMgr.V1ri(c.toString())};V34y.initForListeners(c);c.prototype.V2cb=function(){for(var b=0;10>b;b++);};V34y.initForListeners(c);V34y.addEvent(c,"LiveBook");V34y.addEvent(c,"TBData");V34y.addEvent(c,"LiveBookDisplay");return c}();
CB.TeraBrainUserMsgType={V2ki:1400,V2km:1401,V2lh:1402,V2ko:1403,V2li:1404,V2lj:1420,TBUSER_CHESSSERVER_LOGIN:1421,TBUSER_CHESSSERVER_LOGOUT:1422,V2kw:1423,V2kp:1424,TBUSER_REQ_HOTPOSITION:1425,V2kq:1426,V2lk:1427,V2ky:1428,V2ll:1429,V2lm:1430,V2kz:1431,V2ln:1432,V2l0:1433,V2lo:1434,V2l1:1435,V2lp:1436,V2l2:1437,V2lq:1438,V2l3:1439,V2kt:1440,V2lr:1441,V2ku:1442,V2ls:1443,V2kv:1444,V2ks:1445,V2lt:1460,V2kx:1461,V2lu:1462,V2lv:1463,V2lw:1464,V2lx:1465,V2ly:1466,V2l4:1467,V2lz:1468,V2l5:1469,V2m0:1480,
V2m1:1481,V2m2:1481,V2m3:1482,toString:function(c){for(var b in this)if(this[b]==c)return b;return"Unknown TBUserMsgId: "+c}};"use strict";
CB.V2kg=function(){var c=function(b,c,e){this.V2m4=c;this.V2m5=new CB.HashPosition(b);this.V2m6=e;this.m_nMoveNo=b.getMoveNum();this.V2m7=!0;this.V2m9=this.V2m8=!1;this.m_nFlags=0};c.V2ma=function(){return this.V2m4==TeraBrainRequestType.TBREQUEST_LB_POSINFO};c.prototype.V2mb=function(){return this.V2m4==TeraBrainRequestType.TBREQUEST_LB_ALLMOVES};c.prototype.V2mc=function(){return this.V2m4==TeraBrainRequestType.TBREQUEST_SEARCH_INFO};c.prototype.V2md=function(){return this.V2m4==TeraBrainRequestType.TBREQUEST_LB_UPLOADONLY};
c.prototype.V2me=function(){return this.V2m5};c.prototype.getMoveNo=function(){return this.m_nMoveNo};c.prototype.V2mf=function(b){this.m_nMoveNo=b};c.prototype.V2mg=function(){return new CB.V2i3(GetHashPos(),GetMoveNo())};c.prototype.V2mh=function(){return this.V2m7};c.prototype.setCountVisit=function(b){this.V2m7=b||!1};c.prototype.V2mi=function(){return this.V2m8};c.prototype.setConfirmRequested=function(b){this.V2m8=b||!1};c.prototype.V2mj=function(){return this.V2m9};c.prototype.setIsHumanServerGame=
function(b){this.V2m9=b||!1};c.prototype.V2mk=function(){return this.V28j(1)};c.prototype.setIsNormedEval=function(b){this.SETFLAG(1,b)};c.prototype.setIsMultiRequest=function(b){this.SETFLAG(2,b)};c.prototype.SETFLAG=function(b,c){this.m_nFlags=c?this.m_nFlags|b:this.m_nFlags&~b};c.prototype.V28j=function(b){return 0!=(this.m_nFlags&b)};c.prototype.V2jo=function(b){b=b.getPDataBuf();b.rewind();this.V34n(b)};c.prototype.V2jp=function(){var b=new CB.Vat(CB.V1k2.V1m8);this.writeToDataBuffer(b.buf);
return b};c.prototype.writeToDataBuffer=function(b){b.beginSizedWrite();b.V351(this.V2m4);this.V2m5.writeToDataBuffer(b);this.V2m6.writeToDataBuffer(b);b.V351(this.m_nMoveNo);b.V35n(this.V2m7);b.V35n(this.V2m8);b.V35n(this.V2m9);b.V351(this.m_nFlags);b.endSizedWrite()};c.prototype.V34n=function(b){b.BeginSizedRead();this.V2m4=TeraBrainRequestType(b.ReadInt());this.V2m5.ReadFromDataBuffer(b);this.V2m6.ReadFromDataBuffer(b);this.m_nMoveNo=b.ReadUint32();this.V2m7=b.ReadBool();this.V2m8=b.ReadBool();
this.V2m9=b.ReadBool();this.m_nFlags=b.ReadUint32();b.EndSizedRead();return!0};return c}();"use strict";
CB.TBrainTimeStamp=function(){var c=function(){};c.prototype.UShortToDate=function(b){var c=b&31,e=b>>5&15;b=1945+(b>>9&127);return new CBDate(Math.Min(CBDate.Today().GetDate(),(new CBDate(b,e,c)).GetDate()))};c.prototype.DateToUShort=function(b){var c=Math.Max(1945,b.GetYear());return ushort(b.GetDay()|b.GetMonth()<<5|c-1945<<9)};c.prototype.GetNTodaysTimeStamp=function(){return DateToUShort(CBDate.Today())};return c}();"use strict";
CB.V2ka=function(){var c=function(){this.set=new CB.Vai;this.V2ml=0;this.V1fp=!0};c.prototype.save=function(){(new CB.Vam).save("posns_trackCnt",this.V2ml);this.set.save("posns",function(b){return 200>this.V2ml-b.lastSeenAt}.bind(this))};c.prototype.load=function(){this.V2ml=(new CB.Vam).load("posns_trackCnt")||0;this.set.load("posns",function(b){if(b){var c=new CB.Position;c.V42(b.pos);c=new CB.V2mm(c);c.cnt=b.cnt;c.lastSeenAt=b.lastSeenAt;return c}})};c.prototype.V1ym=function(b){if(this.V1fp){this.V2ml++;
if(this.set.contains(new CB.V2mm(b)))return b=this.set.get(new CB.V2mm(b)),b.inc(),b.lastSeenAt=this.V2ml,!0;b=new CB.V2mm(b);b.lastSeenAt=this.V2ml;this.set.Vaj(b)}return!1};c.prototype.V2mn=function(b){b=this.set.get(new CB.V2mm(b));return void 0!==b&&0!=b.cnt?this.V2ml-b.lastSeenAt:-1};return c}();
CB.V2mm=function(){var c=function(b){this.pos=ObjUtil.clone(b);this.lastSeenAt=this.cnt=0};c.prototype.setEquals=function(b){return this.pos.setEquals(b.pos)};c.prototype.setGreater=function(b){return this.pos.setGreater(b.pos)};c.prototype.inc=function(){this.cnt++};return c}();CB.namespace("CB.Server.V2mo");CB.Server.V2mp={V2mq:1,V2mr:2,V2ms:4,V2mt:8};
CB.Server.V2mo=function(){var c=function(){this.V2n1=this.V2n0=this.V2mz=this.V2my=this.V2mx=this.V2mw=this.V2mv=this.V2f7=this.V2mu=this.nId=0;this.strText=this.strName="";this.V2n4=this.V2n3=this.V2mu=this.V2n2=this.V2f9=0;this.V2n5=new CB.V7j;this.V2n6=new CB.Server.Vpu};c.prototype.fromDataBuf=function(b){this.nId=b.V35k();this.V2mu=b.V35k()&65535;this.V2f7=b.V35k();this.V2mv=b.readUint8();this.V2n7=b.readUint8();this.V2mx=b.readUint8();this.V2my=b.readUint8();this.V2mz=b.readUint8();this.V2n0=
b.readUint8();this.V2n1=b.V35l();this.strName=b.V34q(200);this.strText=b.V34q(200);this.V2f9=b.V35k();this.V2n2=b.V35k();b.V35k();this.V2n5.fromDataBuf(b);this.V2n3=b.V35l();this.V2n4=b.V35l();b.beginSizedRead();this.V2n6.fromDataBuf(b);b.endSizedRead();return!0};c.prototype.V1qg=function(){return(this.V2f7&15)==CB.Server.V2n8.GUEST};c.prototype.isPremium=function(){return this.V2n3==CB.Server.V2mp.V2ms};return c}();CB.namespace("CB.Server.V2n9");
CB.Server.V2n9=function(){var c=function(){this.items=[]};c.prototype.fromSocketsMsg=function(b){b=b.getBuf();for(var c=b.V35k(),e=0;e<c;e++){var f=new CB.Server.V2mo;f.fromDataBuf(b)&&this.items.push(f)}};c.prototype.get=function(b){return this.items[b]};c.prototype.count=function(){return this.items.length};c.prototype.V1nj=function(){return"NOTIMPL"};return c}();"use strict";CB.namespace("CB.Server.V2na");CB.namespace("CB.Server.V2n8");CB.namespace("CB.Server.V2nb");
CB.Server.V2n8={V5k:-1,GUEST:0,PAWN:1,KNIGHT:2,BISHOP:3,ROOK:4,QUEEN:5,KING:6,V2nc:7,V2nd:8,V2ne:9,V2nf:10,V5m:11,V5r:function(c){switch(c&15){default:case this.GUEST:return"Guest";case this.PAWN:return"Pawn";case this.KNIGHT:return"Knight";case this.BISHOP:return"Bishop";case this.ROOK:return"Rook";case this.QUEEN:return"Queen";case this.KING:return"King";case this.V2nd:return"VIP";case this.V2nc:return"topGM";case this.V2ne:return"Sysop";case this.V2nf:return"ChessBase"}},V2ng:function(c){switch(c&
15){default:case this.GUEST:return lm.GUEST;case this.PAWN:return lm.PAWN;case this.KNIGHT:return lm.KNIGHT;case this.BISHOP:return lm.BISHOP;case this.ROOK:return lm.ROOK;case this.QUEEN:return lm.QUEEN;case this.KING:return lm.KING;case this.V2nd:return"VIP";case this.V2nc:return"Top-GM";case this.V2ne:return"Sysop";case this.V2nf:return"ChessBase"}}};CB.Server.V2nb={V2nh:1,V2ni:2,V2nj:16,V2nk:32,V2nl:64,V2nm:128,V2nn:256};
CB.Server.V2na=function(){function c(b,c,d,h){1<d.length&&(b="background-image: url( ../../common/media/server/ranks"+h+"/"+c+d+h+".png ) !important;",b=V35p&&V35p.panelMgr&&V35p.panelMgr.viewport&&V35p.panelMgr.viewport.rtl?b+"background-repeat:no-repeat; background-position:right center;":b+"background-repeat:no-repeat; background-position:left center;",CB.V5p.V5q(".rnk-"+c+d,b))}var b=!1,d=function(d,f){this.rank=d;this.flags=f;if(!b){for(var g=CB.Server.V2n8.PAWN;g<=CB.Server.V2n8.KING;g++)c(void 0,
"w",CB.Server.V2n8.V5r(g),16),c(void 0,"b",CB.Server.V2n8.V5r(g),16);c(void 0,"","Guest",16);for(g=CB.Server.V2n8.V2nc;g<CB.Server.V2n8.V5m;g++)c(void 0,"",CB.Server.V2n8.V5r(g),16);c(void 0,"","Helper",16);b=!0}};d.prototype.V2no=function(b){this.rank=b&255;this.flags=b>>16};d.prototype.V2np=function(){return this.flags<<16+rank};d.prototype.V2nq=function(){return 0!==(this.flags&CB.Server.V2nb.V2nh)||0!==(this.flags&CB.Server.V2nb.V2ni)};d.prototype.V2nr=function(){return 0!=(this.flags&CB.Server.V2nb.V2nl)};
d.prototype.isPremium=function(){return 0!=(this.flags&CB.Server.V2nb.V2nm)};d.prototype.V5r=function(){return CB.Server.V2n8.V5r(this.rank)};d.prototype.V2ns=function(){var b=CB.Server.V2n8.V2ng(this.rank);return b+=this.V2nt()};d.prototype.V2nt=function(){var b="";this.flags&CB.Server.V2nb.V2nh&&(b+="+");this.flags&CB.Server.V2nb.V2ni&&(b+="+");this.flags&CB.Server.V2nb.V2nj&&(b+="*");this.flags&CB.Server.V2nb.V2nk&&(b+="*");this.flags&CB.Server.V2nb.V2nm&&(b+="!");return b};d.prototype.Vpr=function(){return this.rank==
CB.Server.V2n8.V2nf?0:this.V2nr()?256*CB.Server.V2n8.V2nd+this.flags+1:256*this.rank+this.flags+1};d.prototype.V2nu=function(){var b;if(this.V2nr())b="rnk-Helper";else switch(this.rank){default:case CB.Server.V2n8.GUEST:b="rnk-Guest";break;case CB.Server.V2n8.PAWN:case CB.Server.V2n8.KNIGHT:case CB.Server.V2n8.BISHOP:case CB.Server.V2n8.ROOK:case CB.Server.V2n8.QUEEN:case CB.Server.V2n8.KING:b="rnk-"+(this.V2nq()?"b":"w")+this.V5r();break;case CB.Server.V2n8.V2nc:case CB.Server.V2n8.V2nd:case CB.Server.V2n8.V2ne:case CB.Server.V2n8.V2nf:b=
"rnk-"+this.V5r()}return b};return d}();"use strict";CB.namespace("CB.Server.V2nv");
CB.Server.V2nw={GONE:1,V2nx:2,V2ny:4,V2nz:8,V2o0:16,CHAIRMAN:32,V2o1:8192,V2o2:32768,V2o3:65536,V2o4:131072,V2o5:262144,V2o6:524288,V2o7:16777216,IDLE:64,V2o8:128,V2o9:1048576,V2oa:256,V2ob:512,V2oc:1024,V1z:2048,V2od:4096,Vtq:16384,V2oe:4194304,V2of:8388608,toString:function(c){var b;if(c&this.GONE)b=lm.GONE;else switch(c&this.V2og&~this.V2o1){default:case this.V2nx:b="";break;case this.V2ny:b=lm.PLAYING;break;case this.V2nz:b=lm.KIBITZING;break;case this.CHAIRMAN:b=lm.CHAIRMAN;break;case this.V2o7:b=
lm.TACTICS;break;case this.V2o6:b="Registered"}c&this.V2o1&&(b.length&&(b+="/"),b+=lm.SEEKS);c&this.GONE||(c&this.IDLE&&(b.length&&(b+="/"),b+=lm.IDLE),c&this.V2ob&&!(c&this.V2ny)&&(b.length&&(b+="/"),b+=lm.PAUSE),c&this.V2od&&(b.length&&(b+="/"),b+="Centaur"),c&this.V1z&&(b.length&&(b+="/"),b+="Engine"),c&this.V2o2&&(b=lm.TOURN_DIRECTOR),c&this.V2o3&&(b="Simul Master"),c&this.V2o4&&(b="wants in"),c&this.V2o5&&(b="wants out"),c&this.V2o6&&(b="registered"),c&this.V2o9&&(b+="disconnected"));return b}};
(function(){var c=CB.Server.V2nw;c.V2og=c.V2nx|c.V2ny|c.V2nz|c.V2o7|c.V2o1|c.V2o0|c.CHAIRMAN|c.V2o4|c.V2o5|c.V2o6|c.V2o3|c.V2o2;c.PLAYERTYPE=c.V2oc|c.V1z|c.V2od;c.IDLETYPE=c.IDLE|c.V2o8|c.Vtq|c.V2o9|c.V2oe|c.V2of;c.PROMINENTTYPE=c.CHAIRMAN|c.V2o2|c.V2o3;c.NOGAMETYPE=c.V2oa|c.V2ob})();
CB.Server.V2nv=function(){var c=CB.Server.V2nw,b=!1,d=function(c){this.flags=c;if(!b){c="Idle Pause Playing Kibitzing Seeking Tactics Chairman".split(" ");for(var d=0;d<c.length;d++){var g=c[d];if(1<g.length){var h="background-image: url( ../../common/media/server/status/"+g+16+".png ) !important;",h=V35p&&V35p.panelMgr&&V35p.panelMgr.viewport&&V35p.panelMgr.viewport.rtl?h+"background-repeat:no-repeat; background-position:right center;":h+"background-repeat:no-repeat; background-position:left center;";
CB.V5p.V5q(".stat-"+g,h)}}b=!0}};d.prototype.toString=function(){return CB.Server.V2nw.toString(this.flags)};d.prototype.Vpr=function(){var b=0;if(this.flags&c.GONE)return b;b++;if(this.flags&c.CHAIRMAN)return b;b++;if(this.flags&c.V2o3)return b;b++;if(this.flags&c.V2o2)return b;b++;if(this.flags&c.V2o9)return b;b++;if(this.flags&c.V2o6)return b;b++;if(this.flags&c.V2o4)return b;b++;if(this.flags&c.V2o5)return b;b++;if(this.flags&c.V2o7)return b;b++;if(this.flags&c.V2ny)return b;b++;if(this.flags&
c.V2nz)return b;b++;if(this.flags&c.V2o1)return b;b++;if(this.flags&c.V2oa)return b;b++;if(this.flags&c.V2ob)return b;b++;if(this.flags&c.DGT_BOARD)return b;b++;if(this.flags&c.IDLE)return b;b++;return b};d.prototype.V2oh=function(b){b.isStatusChange()&&(b.status&c.V2og&&(this.flags&=~c.V2og),b.status&c.PLAYERTYPE&&(this.flags&=~c.PLAYERTYPE),b.status&c.IDLETYPE&&(this.flags&=~c.IDLETYPE),b.status&c.NOGAMETYPE&&(this.flags&=~c.NOGAMETYPE),this.flags|=b.status)};d.prototype.V2nu=function(){var b="";
if(!(this.flags&c.GONE))if(this.flags&c.IDLE)b="stat-Idle";else if(this.flags&c.V2ob&&!(this.flags&c.V2ny))b="stat-Pause";else if(this.flags&c.V2o1)b="stat-Seeking";else switch(this.flags&c.V2og){case c.V2ny:b="stat-Playing";break;case c.V2nz:b="stat-Kibitzing";break;case c.CHAIRMAN:b="stat-Chairman";break;case c.V2o7:b="stat-Tactics"}return b};return d}();"use strict";CB.namespace("CB.Server.V2oi");CB.Server.V2oj={V2ok:1,V2ol:2,V2om:4,V2on:8,V2oo:16,V2op:32};
CB.Server.V2oi=function(){var c=CB.Server.V2oj,b=function(){};b.prototype.fromDataBuf=function(b){this.flags=b.V35k();this.V2oq=b.V35l();this.Vpp=b.V35l();this.id=b.V35k();this.V28j(c.V2om)?this.V2or=b.V35k():this.V2or=0;this.V28j(c.V2on)?this.V2os=b.V35k():this.V2os=0;this.V28j(c.V2ok)&&(this.status=b.V35k());this.V28j(c.V2ol)&&(this.text=b.V34q(65))};b.prototype.V35j=function(b){b.V35h(this.flags);b.V35f(this.V2oq||0);b.V35f(this.Vpp||0);b.V35h(this.id)||0;this.V28j(c.V2om)&&b.writeInt(this.V2or);
this.V28j(c.V2on)&&b.writeInt(this.V2os);this.V28j(c.V2ok)&&b.writeInt(this.status);this.V28j(c.V2ol)&&b.V34p(this.text)};b.prototype.toString=function(){var b;b="id="+this.id;this.V28j(c.V2om)&&(b+=" val1="+this.V2or);this.V28j(c.V2on)&&(b+=" val2="+this.V2os);this.V28j(c.V2ok)&&(b+=" stat="+CB.Server.V2nw.toString(this.status));this.V28j(c.V2ol)&&(b+=" txt="+this.text);return b};b.prototype.V2ot=function(b){if("number"!=typeof b)throw Error("CDC.setStatusChange must pass a number");this.flags|=
c.V2ok;this.status=b};b.prototype.isStatusChange=function(){return this.V28j(c.V2ok)};b.prototype.V2ou=function(){return this.V28j(c.V2om)&&this.V28j(c.V2on)&&1==this.V2or};b.prototype.V2ov=function(){return this.V2ou()?this.V2os&65535:0};b.prototype.V28j=function(b){return 0!==(this.flags&b)};b.prototype.V2ow=function(){return 0!=(this.status&CB.Server.V2nw.V2o1)&&this.isStatusChange()};b.prototype.V2ox=function(){return 0!=(this.status&CB.Server.V2nw.V2ny)&&this.isStatusChange()};b.prototype.V2oy=
function(){return this.isStatusChange&&0!=(this.status&CB.Server.V2nw.V2o6)};return b}();
CB.V2au={V5k:0,V2oz:1E3,V2p0:1001,V2p1:1100,V2p2:1101,V2p3:1102,V2p4:1103,V2p5:1200,V2p6:1201,V2p7:1202,V2p8:1203,V2p9:1204,V2pa:1205,V2pb:1206,V2pc:1207,V2pd:1250,V2pe:1251,V2pf:1260,V2pg:1261,V2ph:1262,V2pi:1263,V2pj:1270,V2pk:1271,V2pl:1272,V2pm:1273,V2pn:1274,V2po:1275,V2pp:1280,V2pq:1281,V2pr:1282,V2ps:1283,toString:function(c){for(var b in this)if(this[b]==c)return"UserMsg:"+b;return"Unknown UserMsgId: "+c},Vlu:function(c){return"UserMsgId="+c}};"use strict";CB.namespace("CB.Server.V2pt");
CB.Server.V2pu={Vgx:-1,BLACKWINS:100,DRAW:101,WHITEWINS:102,V1mj:103,Vo:360,V2pv:361,V2pw:362,V2px:363,V2py:364,V2pz:365,V2q0:366,V2q1:370,V2q2:371,V2q3:372,V2q4:373,V2q5:374,V2q6:375,V2q7:376,V2q8:380,V2q9:381,V2qa:382,V2qb:383,V2qc:384,V2qd:385,V2qe:386,V2qf:388,V2qg:389,V2qh:390,V2qi:391,V2qj:500,V2qk:501,V2ql:502,V2qm:503,V2qn:504,V2qo:505,V2qp:506,V2qq:507,V2qr:508,V2qs:509,V2qt:510,V2qu:511,V2qv:512,V2qw:513,V2qx:514,V2qy:600,V1mi:601,V2qz:602,V2r0:603,V2r1:604,V2r2:605,V2r3:620,V2r4:621,V2r5:622,
V2r6:650,V2r7:651,V2r8:670,V2r9:671,V2ra:672,toString:function(c){for(var b in this)if(this[b]==c)return"GChange: "+b;return"Unknown GameStatChange: "+c}};var gsEnum=CB.Server.V2pu;
CB.Server.V2pt=function(){var c=function(b,c,e){this.type=b||CB.Server.V2pu.Vgx;this.idGame=c||0;this.idPlayer=e||0;this.num=this.flags=0};c.prototype.init=function(b,c){this.idGame=b;this.idPlayer=c;this.num=this.flags=0};c.prototype.fromDataBuf=function(b){this.idGame=b.readInt();this.type=b.readInt();this.idPlayer=b.readInt();this.num=b.readInt();this.flags=b.readShort();this.Vpp=b.readShort()};c.prototype.V35j=function(b){b.writeInt(this.idGame);b.writeInt(this.type);b.writeInt(this.idPlayer);
b.writeInt(this.num);b.writeShort(this.flags);b.writeShort(0)};c.prototype.isResult=function(){return 0<=this.type&&this.type<=CB.Server.V2pu.V1mj};c.prototype.isWatcherChange=function(){return this.type==CB.Server.V2pu.V2qy||this.type==CB.Server.V2pu.V2r1||this.type==CB.Server.V2pu.V1mi};c.prototype.isResult=function(){return this.type==CB.Server.V2pu.BLACKWINS||this.type==CB.Server.V2pu.WHITEWINS||this.type==CB.Server.V2pu.DRAW};c.prototype.getWatchersInc=function(){return this.type==CB.Server.V2pu.V2qy||
this.type==CB.Server.V2pu.V2r1?1:this.type==CB.Server.V2pu.V1mi?-1:0};c.prototype.V5e=function(){return this.num};c.prototype.toString=function(){return CB.Server.V2pu.toString(this.type)+": "+this.idGame+", player="+this.idPlayer+", flags="+this.flags};return c}();"use strict";CB.namespace("CB.Server.GameItemTypeBits");CB.Server.V2rb={UNKNOWN:0,V2p6:1,V2rc:2,V2h:4,V2rd:8,ABORTED:16,V2re:32,Vpx:64,Vpw:128,Vpv:256,V1z:512,V2od:1024,V2rf:2048,Vty:4096,Vuc:8192,V2rg:16384,V2rh:32768,V2ri:65536};
CB.Server.V2rb.V2rj=CB.Server.V2rb.V2p6|CB.Server.V2rb.V2rc|CB.Server.V2rb.V2h|CB.Server.V2rb.V2re|CB.Server.V2rb.Vuc|CB.Server.V2rb.Vty;CB.Server.V2rb.V2rk=CB.Server.V2rb.V1z|CB.Server.V2rb.V2od;CB.namespace("CB.Server.V2rl");
CB.Server.V2rl=function(){var c=function(){};c.prototype.fromDataBuf=function(b){this.white=b.V34q(100);this.type=b.V35l();this.black=b.V34q(100);this.id=b.V35k();this.idGroup=b.V35k();this.result=b.V35k();this.V2rm=b.V35k();this.V2rn=b.V35k();this.V2ro=b.V35k();this.V2rp=b.readInt();this.flags=b.readInt();this.tourn=b.V34q(100);this.eloWhite=b.V35l()&8191;this.eloBlack=b.V35l()&8191;this.round1=b.readUint8();this.round2=b.readUint8();this.V2rq=b.V35l();b.beginSizedRead();var c=b.V35k();this.watchers=
c&65535;this.moveLen=c>>22&511;this.eco=b.V35e();b.endSizedRead();this.clock=new CB.Vkz;this.clock.fromDataBuf(b);this.flags&CB.Server.V2rr.V2rs||delete this.clock};c.prototype.toString=function(){return this.white+"-"+this.black+", "+this.tourn+" ("+this.round1+")"};c.prototype.V2dz=function(){return this.white?this.white+" - ...":""};c.prototype.V2rt=function(b){b.isResult()&&(this.result=b.type-100);b.isWatcherChange()&&(this.watchers+=b.getWatchersInc())};c.prototype.isBlitz=function(){return 0!=
(this.type&CB.Server.V2rb.Vpw)};c.prototype.Vpz=function(){return 0!=(this.type&CB.Server.V2rb.Vpx)};c.prototype.isImportant=function(){return 0!=(this.type&CB.Server.V2rb.Vuc)};c.prototype.isAnalysis=function(){return 0!=(this.type&CB.Server.V2rb.V2h)};c.prototype.isBroadcast=function(){return 0!=(this.type&CB.Server.V2rb.V2rc)};c.prototype.isStream=function(){return 0!=(this.type&CB.Server.V2rb.Vty)};c.prototype.isHTTPStream=function(){return 0!=(this.type&CB.Server.V2rb.V2rf)};c.prototype.isPrivate=
function(){return 0!=(this.flags&CB.Server.V2rr.V2rh)};c.prototype.isPremium=function(){return 0!=(this.flags&CB.Server.V2rb.V2rg)};c.prototype.mightBeEngineGame=function(){var b=(this.white.match(/\d/g)||[]).length,c=(this.black.match(/\d/g)||[]).length,e=(this.black.match(/\./g)||[]).length,f=(this.black.match(/\./g)||[]).length,g=0<(this.white.match(/64/g)||[]).length&&0<(this.white.match(/bit/gi)||[]).length,h=0<(this.black.match(/64/g)||[]).length&&0<(this.black.match(/bit/gi)||[]).length;return 0<
e&&0<f&&1<b&&1<c||g||h};c.prototype.getWatcherSortVal=function(){return CB.Vgt.isFinished(this.result)?this.watchers/2:this.watchers};c.prototype.shouldRequestImmediatelyInLive=function(){return 2<this.result&&(300<this.watchers||2500<this.eloWhite&&2500<this.eloBlack)||2680<this.eloWhite||2680<this.eloBlack};return c}();
CB.Server.V2rl.V2ru=function(c,b){switch(c){case CB.Vgt.Vgu:case CB.Vgt.WHITE_WINS:case CB.Vgt.BLACK_WINS:case CB.Vgt.DRAW:return CB.Vgt.toString(c);case CB.Vgt.Vgw:return b&(CB.Server.V2rb.V2h|CB.Server.V2rb.V2rc)?lm.FINISHED:lm.ABORTED}};
CB.Server.V2rv=function(){var c=function(b){this.games=b?b:[]};c.prototype.fromDataBuf=function(b){for(var c=b.V35k(),e=0;e<c;e++){var f=new CB.Server.V2rl;f.fromDataBuf(b);this.games.push(f)}};c.prototype.V2rw=function(){if(this.games.length)return this.games[0].idGroup};c.prototype.V2rx=function(b){function c(b,d,e){if(d){for(var f=0;f<b.length;f++)if(void 0===b[f].watchers||d.getWatcherSortVal()>b[f].getWatcherSortVal()){b.splice(f,0,d);b.length>e&&b.pop();return}b.length<e&&b.push(d)}}for(var e=
[],f=0;f<this.games.length;f++)!(e.length<b||this.games[f].isImportant()||e.length&&this.games[f].watchers>e[e.length-1].watchers)||this.games[f].isStream()||this.games[f].isAnalysis()||this.games[f].mightBeEngineGame()||CB.Vgt.isFinished(this.games[f].result)&&!this.games[f].isBroadcast()||!this.games[f].isBlitz()&&!this.games[f].isBroadcast()||c(e,this.games[f],b);e.forEach(function(b,c,d){});return e};c.prototype.V2ry=function(b){function c(b,d,e){for(var f=0;f<b.length;f++)if(void 0===b[f].watchers||
d.eloWhite>b[f].eloWhite){b.splice(f,0,d);b.length>e&&b.pop();return}b.length<e&&b.push(d)}for(var e=[],f=0;f<this.games.length;f++)!(e.length<b||this.games[f].isImportant()||e.length&&this.games[f].eloWhite>e[e.length-1].eloWhite)||this.games[f].isStream()||this.games[f].isAnalysis()||CB.Vgt.isFinished(this.games[f].result)&&!this.games[f].isBroadcast()||!this.games[f].isBlitz()&&!this.games[f].isBroadcast()||c(e,this.games[f],b);e.forEach(function(b,c,d){});return e};c.prototype.V2rz=function(b,
c){for(var e=[],f=0;f<this.games.length;f++)if((this.games[f].isStream()||this.games[f].isHTTPStream())&&this.games[f].isBroadcast()&&-1==this.games[f].result){var g=!this.games[f].isPrivate();g&&(this.games[f].isPremium()&&(g=!1,c&&(g=!0)),g&&e.push(this.games[f]))}e.forEach(function(b,c,d){});f=[];for(g=0;g<e.length;g++){f.push(e[g]);var h=new CB.V2s0(f[g].id,f[g].white+" - "+f[g].black,f[g].tourn);b.push(h)}return f};c.prototype.isStream=function(b){for(b=0;b<this.games.length;b++)if(this.games[b].isStream())return!0;
return!1};c.prototype.V2s1=function(b){for(var c=[],e=0;e<this.games.length;e++)b(this.games[e])&&c.push(this.games[e]);return c.length?new CB.Server.V2rv(c):new CB.Server.V2rv(this.V2rx(4))};return c}();"use strict";CB.namespace("CB.Server.V2s2");
CB.Server.V2s2=function(){var c=function(){};c.prototype.fromDataBuf=function(b){this.idGame=b.readInt();this.type=b.readInt();this.Vpp=b.readInt();this.game=new CB.Game;this.game.fromDataBuf(b);b.beginSizedRead();this.strBanner=b.V34q(255);this.strURL=b.V34q(255);this.V2s3=b.V34q(255);b.endSizedRead()};c.prototype.V35j=function(b){b.writeInt(this.idGame)};c.prototype.toString=function(){return"GameData: "+this.idGame+", type="+this.type.toString(16)+", "+this.game.hdr.white+"-"+this.game.hdr.black};
c.prototype.isStream=function(){return 0!=(this.type&CB.Server.V2rb.Vty)};c.prototype.isBroadcast=function(){return 0!=(this.type&CB.Server.V2rb.V2rc)};c.prototype.isHTTPStream=function(){return 0!=(this.type&CB.Server.V2rb.V2rf)};c.prototype.V2s4=function(){return 0!=(this.type&CB.Server.V2rb.V2rc)};return c}();"use strict";
CB.Vov=function(){var c=function(b,c,e,f){b&&(this.move=[b.from,b.to,b.prom&7],this.moveNo=c,this.centiSecs=e,this.idGame=f);this.flags=0};c.prototype.toString=function(){return CB.Vbf.toString(this.move[0])+"-"+CB.Vbf.toString(this.move[1])};c.prototype.fromDataBuf=function(b){this.idGame=b.V35k();this.move=b.readByteArray(3);this.centiSecs=b.V35k();this.moveNo=b.V35l();this.flags=b.V35l();this.eval=b.V35k()};c.prototype.V35j=function(b){b.V35h(this.idGame);b.writeByteArray(this.move,3);b.V35h(this.centiSecs);
b.V35f(this.moveNo);b.V35f(this.flags||0);b.V35h(this.eval||0)};return c}();"use strict";CB.V2s5=function(){var c=function(){};c.prototype.fromDataBuf=function(b){this.V2s6=b.readInt();this.V2s7=b.readInt();this.Vis=b.readInt();this.flags=b.readInt()};c.prototype.getWhiteTime=function(){return this.V2s6};c.prototype.getBlackTime=function(){return this.V2s7};c.prototype.isBlack=function(){return 0!=(this.flags&1)};return c}();"use strict";CB.namespace("CB.Server.V2s8");
CB.Server.V2rr={V2re:1,V2rs:2,V2s9:4,Vl2:8,V2sa:16,V2h:32,V2sb:64,V2sc:128,V2sd:256,V2se:512,V2rh:1024,V2sf:2048,V2sg:4096,V2sh:8192,V2si:16384,V2sj:32768,V2sk:65536,V2sl:131072,V2sm:262144,V2sn:524288,V2rg:1048576,V2so:2097152,V2r8:4194304,V2sp:8388608,V2sq:16777216,V2sr:33554432,V2ss:67108864};
CB.Server.V2s8=function(){var c=1,b=function(b,e,f){this.lobby=b;this.idGame=e;this.Vjz=f;this.V2st=!1;this.V2sv=this.V2su=0;this.V2sw=!0;this.uniqueId=c++;this.V2sx=!0;this.V2sy=[];this.V2sz=[];this.V2t0=0};b.prototype.V2t1=function(){this.gameKernel&&(this.gameKernel.animateBoard=!1,this.gameKernel.destroy(),this.gameKernel=null);this.V2sv=this.V2su=0;this.V2sx=this.V2sw=!0;this.board&&(this.board.allowInput=!0)};b.prototype.V16z=function(){this.V2t1();this.board&&this.board.V16z()};b.prototype.isFinished=
function(){return this.gameKernel.isFinished()};b.prototype.V2t2=function(){this.V2sx=!this.V2sx;this.V2t3(this.V2sx);this.V2su=0};b.prototype.V2t3=function(b,c){if(this.V2sx=b)this.lobby.V2c9.V2t4(this.idGame),this.V2st=!0;this.board.allowInput=!0;V35p.commands.Vsx(CB.V2kb.V2t5,this.V2sx);c||this.gameKernel&&(b?this.gameKernel.V354.startClock():this.gameKernel.V354.stopClock())};b.prototype.V2t6=function(b){this.board=new CB.BoardControl3D(b,100,100,"FritzBoard");this.V2t4();this.V2st=!0;this.V2sw&&
this.lobby.V2c9.V2t7(this.idGame);return this.board};b.prototype.V2t8=function(b){this.board=new CB.Vkg(b,100,100,this.idGame);V35p.V15u()?this.board.animSteps={forMove:2,forPosition:2}:this.board.animSteps={forMove:2,forPosition:3};CB.V5t.V64()&&(this.board.animSteps={forMove:.6,forPosition:.5});this.board.allowInput=!0;this.V46=this.board.onReadyHandlers.add(this.onBoardReady.bind(this));return this.board};b.prototype.onBoardReady=function(){this.V2st||(this.V2t4(),this.V2st=!0,this.board.onReadyHandlers.remove(this.V46),
this.V2sw&&this.lobby.V2c9.V2t7(this.idGame))};b.prototype.onGameData=function(b){try{this.V2t9=!1;this.V2ta=new CB.V4y;this.gameKernel?this.V2sx&&(this.gameKernel.game.assign(b.game),this.gameKernel.game.gotoIndex(b.game.getMoveIndex())):(this.gameKernel=new CB.Vjy(this.Vjz,b.game),this.gameKernel.setPlayingMode(new CB.Vsl(this.gameKernel)),this.gameKernel.setBoardWin(this.board),this.gameKernel.V354.createGUIElements(this.board),this.gameKernel.animateBoard=!1,this.board.V1ab=!0,this.V2tb());this.clock?
this.gameKernel.V354.Vri(this.clock):this.gameKernel.V354.Vri(!1);this.board.debugName=b.game.hdr.getStrPlayers();this.V2sx&&(this.V2tc=this.gameKernel.game.getMoveIndex(),this.V2td());this.board.cbcanvas?this.board.setTitleText(this.gameKernel.game.hdr.getStrPlayers(this.board.nSqPix>this.board.cbcanvas.zoomToPix(46))):this.board.setTitleText(this.gameKernel.game.hdr.getStrPlayers(20));this.V2sy=[];this.V2sv=0;this.gameKernel.animateBoard="undefined"!==typeof Ext?V35p.Vki()||!Ext.isIE:V35p.Vki();
this.strBanner=b.strBanner;if((this.strURL=b.strURL)&&(V35p.V34z.V1ol()||V35p.V15u())&&V35p.config.V1hd){var c=this.strURL,f="?";-1!=c.search(RegExp("\\?","g"))&&(f="&");c+=f+"ref=link_from_playchess_com";this.board.V16w();if(V35p.V15u()){var g={urlRight:c,linkTextRight:CB.V47.V4j(this.strURL),linkTextLeft:lm.FULL_VIEW,urlLeft:"http://live.chessbase.com"};this.board.bottomWin=new CB.BoardDoubleURL(g,{hScale:24,hMax:18,spacing:0,rightAlign:!0})}else this.board.bottomWin=new CB.BoardURL({linkText:CB.V47.V4j(this.strURL),
url:c},{hScale:20,hMax:18,spacing:1});this.board.V16t.runOnce(500)}(b.isStream()||b.isHTTPStream())&&this.V2t3(!1);b.isStream()||b.isHTTPStream()||b.game.hdr.getCBResult().isFinished()&&this.V2t3(!1)}catch(h){CB.Vjg("GSess::onGameData:",h)}};b.prototype.V2tb=function(){this.gameKernel.V354.fnAcceptMove=function(){this.V2sx&&(this.V2te=!0);return!0}.bind(this);this.gameKernel.V354.fnAfterMove=function(b){this.gameKernel.game.getMoveIndex()==this.V2tc+1&&this.gameKernel.game.isOnMainLine()&&this.gameKernel.game.setAnno(CB.AnnoType.Vgg,
new CB.Vgh("Analysis:"));return!0}.bind(this)};b.prototype.V2dz=function(){if(this.gameKernel)return this.gameKernel.game.hdr.getStrPlayers(!1)};b.prototype.V2td=function(){for(var b=0;b<this.V2sy.length;b++)this.onSessionAction(this.V2sy[b],!0)};b.prototype.onSessionAction=function(b,c){if(this.V2sx)if(0<this.V2t0)b.timeStamp=this.V2t0,b.session=this,this.V2sz.push(b);else this.onProcessSessionAction(b,c);else b.gameAction.isMove()&&this.lobby.V1ql("Received a move: "+this.gameKernel.game.hdr)};
b.prototype.onProcessSessionAction=function(b,c){if(this.V2t9)this.V2sy.push(b);else{if(!this.gameKernel)return;this.V2tc!=this.gameKernel.game.getMoveIndex()&&this.gameKernel.game.gotoIndex(this.V2tc);if(b.gameAction.execute(this.gameKernel.game,b.controlMove)){if(b.gameAction.isMove()||b.gameAction.isGame())b.gameAction.isMove()&&(this.gameKernel.V354.updateClockFromGame(),this.gameKernel.game.deleteAnno(CB.AnnoType.Vgg)),this.gameKernel.markLastMove(!0,!0);this.V2sv=0;this.V2tc=this.gameKernel.game.getMoveIndex();
if(this.V2te&&this.gameKernel.game.promoteLine()){var f=this.gameKernel.game.getMoveIndex();this.gameKernel.game.unAnnotate();this.gameKernel.game.gotoIndex(f);this.V2tc=f}}else b.gameAction.isMove()&&!b.isAnEarlierMove(this.gameKernel.game)?(this.V2sv+=1,c||this.isFinished()||!(4<this.V2sv||6E3<this.V2ta.V50())||(this.V2su++,5>this.V2su&&this.V2t4())):b.gameAction.isMove()}b.gameAction.changesMoves()&&(this.V2te=!1)};b.prototype.V2t4=function(){this.V2t9=!0;this.lobby.V2c9.V2t4(this.idGame)};b.prototype.V2tf=
function(b){switch(b.type){case gsEnum.WHITEWINS:this.V2tg(CB.Vgt.WHITE_WINS);break;case gsEnum.DRAW:this.V2tg(CB.Vgt.DRAW);break;case gsEnum.BLACKWINS:this.V2tg(CB.Vgt.BLACK_WINS);break;case gsEnum.V2pv:if(this.gameKernel)this.gameKernel.V354.onTimeOverstepped(this.V2rn!==b.idPlayer)}};b.prototype.V2tg=function(b){this.isFinished()||this.gameKernel.setResult(b)};b.prototype.isFinished=function(){return!this.gameKernel||this.gameKernel.game.hdr.getCBResult().isFinished()};b.prototype.setClock=function(b){this.gameKernel&&
this.gameKernel.V354.setManualClock(b.getWhiteTime(),b.getBlackTime(),b.isBlack())};b.prototype.V2th=function(){this.V2sx&&(this.V2t3(!0),this.board&&this.board.addMessage("Reconnected",!0))};b.prototype.V1q0=function(){};b.prototype.toString=function(){return this.gameKernel?this.gameKernel.game.hdr.getStrPlayers():this.idGame};b.prototype.V2ti=function(b){this.V2t0=b;0<this.V2t0&&!this.V2tj&&(this.V2tj=setInterval(this.V2tk.bind(this),1E3))};b.prototype.V2tl=function(b){return 0<b.timeStamp&&(b.timeStamp--,
0==b.timeStamp)?!0:!1};b.prototype.execute=function(b){b.session.onProcessSessionAction(b,!0)};b.prototype.V2tk=function(){this.V2sz.forEach(function(b){CB.Server.V2s8.prototype.V2tl(b)&&(CB.Server.V2s8.prototype.execute(b),b.session.gameKernel&&b.session.gameKernel.game.updateFromExtern())})};return b}();"use strict";
CB.ManualClock=function(){var c=function(b){CB.ManualClock.superClass.call(this,b)};CB.inherit(c,CB.Vpd);c.prototype.Vrr=function(b,c,e){this.stop();b||c?(this.V1b4=this.startTime=(new Date).getTime(),0<=b&&(this.Vqp=b),0<=c&&(this.Vqq=c),0<=this.Vqp&&(this.isBlack=!1,this.update()),0<=this.Vqq&&(this.isBlack=!0,this.update()),this.isBlack=e,this.Vpf.Vpk(e),this.start()):this.Vpi()};c.prototype.Vng=function(b){CB.Vgt.isFinished(b)&&(this.stop(),this.Vpf.Vqt(b))};c.prototype.Vpk=function(b){this.isBlack=
b;this.update();this.Vpf.Vpk(b);this.Vpf.V1b5(8E3)};c.prototype.start=function(){this.Vpg.runPeriodic(1E3);this.Vpf&&(this.Vpf.V1aw&&this.Vpf.V1aw!=this.id&&(CBDebug.assert(0),TRACE("Clock Collision!")),this.Vpf.V1aw=this.id)};c.prototype.stop=function(){this.Vpg.stop();this.Vpf&&(this.Vpf.V1aw=0)};c.prototype.update=function(){var b=((new Date).getTime()-this.startTime+5)/10,c=((new Date).getTime()-this.V1b4+5)/10;this.Vpf.Vqy(new Date(10*c),this.isBlack);b=this.isBlack?this.Vqq-=b:this.Vqp-=b;this.startTime=
(new Date).getTime();0>b?this.Vpf.Vql(-1,this.isBlack):this.Vpf.Vql(new Date(10*b),this.isBlack)};return c}();"use strict";CB.Server.V2tm=function(){var c=function(b,c){this.V2tn=b||0;this.V58=c||0};c.prototype.fromDataBuf=function(b){this.V2tn=b.readInt();this.V58=b.readInt()};c.prototype.V35j=function(b){b.writeInt(this.V2tn);b.writeInt(this.V58)};c.prototype.toString=function(){return"ClockRange"};return c}();"use strict";
CB.Server.V2to=function(){var c=function(b){this.val=b||0};c.prototype.fromDataBuf=function(b){this.val=b.readShort()};c.prototype.V35j=function(b){b.writeShort(this.val)};c.prototype.V2tp=function(){return 30*(this.val>>8&255)};c.prototype.V2tq=function(){return this.val&255};c.prototype.Vpr=function(){return this.val};c.prototype.toString=function(){return this.V2tp()+"ms"};return c}();"use strict";CB.namespace("CB.Server.V2tr");
CB.Server.V2tr=function(){var c=1,b=function(b,e,f,g,h){this.lobby=b;this.idGame=g;this.ticket=e;this.requestData=f;this.V2ts=this.fnGetKernel=h;this.V2st=!1;this.V2sv=this.V2su=0;this.V2sw=!0;this.uniqueId=c++;this.V2sx=!0;this.V2sy=[];this.V2sz=[];this.V2t0=0;this.V2tt=!1};b.prototype.getKernel=function(){return this.fnGetKernel()};b.prototype.setToBackgroundKernel=function(){this.fnGetKernel().V354.deleteClock();this.V2ts().game.assign(this.fnGetKernel().game);this.fnGetKernel=this.V2ts};b.prototype.isFinished=
function(){return this.getKernel().isFinished()};b.prototype.V2t2=function(){this.V2sx=!this.V2sx;this.V2t3(this.V2sx);this.V2su=0};b.prototype.V2t3=function(b,c){if(this.V2sx=b)this.V2t4(this.idGame),this.V2st=!0;V35p.commands.Vsx(CB.V2tu.V2t5,this.V2sx);c||this.getKernel()&&(b?this.getKernel().V354.startClock():this.getKernel().V354.stopClock())};b.prototype.V2t4=function(b){b=new CB.Server.V2pt(CB.Server.V2pu.V2r0,b,this.lobby.V1qz());this.V2tv(b)};b.prototype.V2tv=function(b){var c=new CB.Vat(CB.V1k2.V1me);
c.setUserType(CB.V2au.V2p5);c.getBuf();b.V35j(c.getBuf());this.lobby.send(c)};b.prototype.onGameData=function(b){try{this.V2t9=!1;this.V2ta=new CB.V4y;if(this.V2sx){this.getKernel();var c;this.getKernel().boardWin&&void 0!==this.getKernel().boardWin.prepareFullRedraw&&(this.getKernel().boardWin.prepareFullRedraw(),c=this.getKernel().boardWin.shouldAnimatePosChange,this.getKernel().boardWin.shouldAnimatePosChange=function(){return!1});this.V2tt=!1;this.getKernel().game.assign(b.game);this.getKernel().game.gotoIndex(b.game.getMoveIndex());
this.getKernel().idGame=b.idGame;c&&this.getKernel().boardWin&&(this.getKernel().boardWin.shouldAnimatePosChange=c);this.updateBoardAttributes()}this.V2sx&&(this.V2tc=this.getKernel().game.getMoveIndex(),this.V2td());this.getKernel().markLastMove(!0,!0);this.V2sy=[];this.V2sv=0;this.V2tt=!0}catch(f){CB.Vjg("LSess::onGameData:",f)}};b.prototype.shouldAnimatePosChange=function(){return this.V2tt};b.prototype.updateBoardAttributes=function(){var b=this.getKernel().boardWin,c=this.getKernel().game;b&&
(b.cbcanvas?b.setTitleText(c.hdr.getStrPlayers(b.nSqPix>b.cbcanvas.zoomToPix(42))):b.setTitleText(c.hdr.getStrPlayers(20)),this.setClock&&this.getKernel().V354.setManualClock(this.setClock.getWhiteTime(),this.setClock.getBlackTime(),this.getKernel().game.getCurPos().getBTM()))};b.prototype.V2tb=function(){this.getKernel().V354.fnAcceptMove=function(){this.V2sx&&(this.V2te=!0);return!0}.bind(this);this.getKernel().V354.fnAfterMove=function(b){this.getKernel().game.getMoveIndex()==this.V2tc+1&&this.getKernel().game.isOnMainLine()&&
this.getKernel().game.setAnno(CB.AnnoType.Vgg,new CB.Vgh("Analysis:"));return!0}.bind(this)};b.prototype.V2dz=function(){if(this.getKernel())return this.getKernel().game.hdr.getStrPlayers(!1)};b.prototype.V2td=function(){for(var b=0;b<this.V2sy.length;b++)this.onSessionAction(this.V2sy[b],!0)};b.prototype.onSessionAction=function(b,c){if(this.V2sx)if(0<this.V2t0)b.timeStamp=this.V2t0,b.session=this,this.V2sz.push(b);else this.onProcessSessionAction(b,c);else b.gameAction.isMove()&&this.lobby.V1ql("Received a move: "+
this.getKernel().game.hdr)};b.prototype.onProcessSessionAction=function(b,c){if(this.V2t9)this.V2sy.push(b);else{if(!this.getKernel())return;this.V2tc!=this.getKernel().game.getMoveIndex()&&this.getKernel().game.gotoIndex(this.V2tc);if(b.gameAction.execute(this.getKernel().game,b.controlMove)){if(b.gameAction.isMove()||b.gameAction.isGame())b.gameAction.isMove()&&(this.getKernel().V354.updateClockFromGame(),this.getKernel().game.deleteAnno(CB.AnnoType.Vgg)),this.getKernel().markLastMove(!0,!0);this.V2sv=
0;this.V2tc=this.getKernel().game.getMoveIndex();if(this.V2te&&this.getKernel().game.promoteLine()){var f=this.getKernel().game.getMoveIndex();this.getKernel().game.unAnnotate();this.getKernel().game.gotoIndex(f);this.V2tc=f}}else b.gameAction.isMove()&&!b.isAnEarlierMove(this.getKernel().game)?(this.V2sv+=1,c||this.isFinished()||!(4<this.V2sv||this.V2ta&&6E3<this.V2ta.V50())||(this.V2su++,5>this.V2su&&this.V2t4())):b.gameAction.isMove()}b.gameAction.changesMoves()&&(this.V2te=!1)};b.prototype.V2t4=
function(){this.V2t9=!0;this.lobby.V2t4(this.idGame)};b.prototype.V2tf=function(b){switch(b.type){case gsEnum.WHITEWINS:this.V2tg(CB.Vgt.WHITE_WINS);break;case gsEnum.DRAW:this.V2tg(CB.Vgt.DRAW);break;case gsEnum.BLACKWINS:this.V2tg(CB.Vgt.BLACK_WINS);break;case gsEnum.V2pv:if(this.getKernel())this.getKernel().V354.onTimeOverstepped(this.V2rn!==b.idPlayer)}};b.prototype.V2tg=function(b){this.isFinished()||this.getKernel().setResult(b)};b.prototype.isFinished=function(){return!this.getKernel()||this.getKernel().game.hdr.getCBResult().isFinished()};
b.prototype.onSetClock=function(b){this.setClock=b;this.getKernel()&&this.getKernel().V354.setManualClock(b.getWhiteTime(),b.getBlackTime(),b.isBlack())};b.prototype.V2th=function(){this.V2sx&&this.V2t3(!0)};b.prototype.V1q0=function(){};b.prototype.toString=function(){return this.getKernel()?this.getKernel().game.hdr.getStrPlayers():this.idGame};b.prototype.V2ti=function(b){this.V2t0=b;0<this.V2t0&&!this.V2tj&&(this.V2tj=setInterval(this.V2tk.bind(this),1E3))};b.prototype.V2tl=function(b){return 0<
b.timeStamp&&(b.timeStamp--,0==b.timeStamp)?!0:!1};b.prototype.execute=function(b){b.session.onProcessSessionAction(b,!0)};b.prototype.V2tk=function(){this.V2sz.forEach(function(b){CB.Server.V2tr.prototype.V2tl(b)&&(CB.Server.V2tr.prototype.execute(b),b.session.getKernel()&&b.session.getKernel().game.updateFromExtern())})};return b}();"use strict";CB.namespace("CB.Server.V2tw");
CB.Server.V2tw=function(){var c=function(b,c,e){this.lobby=b;this.ticket=c;this.requestData=e;this.V2tx={};this.V2ty={}};c.prototype.onGameItemList=function(b){this.V2tz=b;this.requestData.onList(b)};c.prototype.addSession=function(b,c,e,f){if(this.V2tx[b])return!1;var g=new CB.Vjy;g.setPlayingMode(new CB.Vsl(g));this.V2ty[b]=g;g.Vkk(!1);var g=new CB.Server.V2tr(this.lobby,this.ticket,this.requestData,b,function(){return this.V2ty[b]}.bind(this)),h=this.V2u0(b);h&&(g.clock=h.clock);g.fnOnMove=c;g.fnOnRecentAnno=
e;g.fnOnGameData=f;this.V2tx[b]=g;return!0};c.prototype.V2u0=function(b){if(this.V2tz)for(var c=0;c<this.V2tz.games.length;c++)if(this.V2tz.games[c].id==b)return this.V2tz.games[c]};c.prototype.onInitKibitzing=function(b,c,e){if(this.V2ty[b]&&(e&&this.V2ty[e]&&this.V2tx[e].setToBackgroundKernel(),c)){e=this.V2tx[b];var f;c().boardWin&&void 0!==c().boardWin.prepareFullRedraw&&(c().boardWin.prepareFullRedraw(),f=c().boardWin.shouldAnimatePosChange,c().boardWin.shouldAnimatePosChange=function(){return!1});
c().V354.beforeGameLoad();c().game.assign(this.V2ty[b].game);c().idGame=b;c().markLastMove(!0,!0);f&&(c().boardWin.shouldAnimatePosChange=f);e.fnGetKernel=c;e.updateBoardAttributes()}};c.prototype.setSessionToBackground=function(b){b&&this.V2tx[b]&&this.V2tx[b].setToBackgroundKernel()};c.prototype.notifySessionSwap=function(b,c){if(this.V2tx[b]&&this.V2tx[c]){var e=this.V2tx[c].fnGetKernel;this.V2tx[c].fnGetKernel=this.V2tx[b].fnGetKernel;this.V2tx[b].fnGetKernel=e;this.V2tx[b].updateBoardAttributes();
this.V2tx[c].updateBoardAttributes()}};c.prototype.onGameData=function(b){this.V2tx[b.idGame]&&(this.V2tx[b.idGame].onGameData(b),b.idGame==this.V2u1&&this.V2tx[b.idGame].fnGetKernel().markLastMove(!0,!0),this.V2tx[b.idGame].fnOnMove&&this.V2tx[b.idGame].fnOnMove(b.idGame),this.V2tx[b.idGame].fnOnGameData&&this.V2tx[b.idGame].fnOnGameData())};c.prototype.onSessionAction=function(b){var c=b.idGame;this.V2tx[c]&&(this.V2tx[c].onSessionAction(b),this.V2tx[c].fnOnMove&&this.V2tx[c].fnOnMove(c,b))};c.prototype.onRecentAnno=
function(b){this.V2tx[b]&&this.V2tx[b].fnOnRecentAnno&&this.V2tx[b].fnOnRecentAnno(b)};c.prototype.onSetClock=function(b,c){if(this.V2tx[c])this.V2tx[c].onSetClock(b)};c.prototype.getPgn=function(){var b="",c;for(c in this.V2ty)this.V2ty[c].game&&this.V2ty[c].game.getMoves().length&&(b+=CB.V12k.V12l(this.V2ty[c].game));return b};return c}();"use strict";CB.namespace("CB.Server.LiveManager");
CB.V2u2={V5k:0,V2u3:801,V2u4:802,V2u5:803,V2u6:804,V2u7:805,V2u8:806,V2u9:820,V2ua:821,V2ub:822,V2uc:17,V2p7:200,V2ud:400,V2p8:21,Vlu:function(c){return"LiveMsgId="+c},toString:function(c){for(var b in this)if(this[b]==c)return b;return"Unknown LiveMsgId: "+c}};CB.V2ue={V5k:0,toString:function(c){switch(c){default:return"Msg="+c;case V5k:return"None"}}};CB.V2tu={V5k:0,V2kc:1E3,V2t5:2E3,Vlu:function(c){return"LiveCmdId="+c}};
CB.Server.LiveManager=function(){var c=function(b){this.V2uf=b;this.Vk9=V35p.commands.Vka(this);this.V1pj=2E4;this.V2ug=new CB.Timer};c.prototype.getName=function(){return"Live"};CB.inherit(c,CB.Server.V1pi);c.prototype.V1vi=function(b,c,d,h,k){V35p.panelMgr.showMessage(lm.CONNECTING);this.create(b,c,d,h,"")};c.prototype.V1q5=function(){this.fireOnChangeLogin()};c.prototype.V1r2=function(){};c.prototype.V1o7=function(b){};c.prototype.V2uh=function(b){};c.prototype.V1r4=function(b){var c=String.formatEx(lm.CONNECTED_TO_SERVER,
this.getName());this.V1ql(c,"LogGreen","conn");V35p.panelMgr.showMessage(c);this.V1py=!0;this.loginMode!=CB.LoginMode.GUEST?(b.strUserId&&(V35p.V34z.userName=CB.V47.V49(b.strUserId),this.user=CB.V47.V49(b.strUserId),this.V1ps=b.strUserId,b.strToken&&(V35p.V34z.V1p3=b.strToken,CB.DOM.V1p5("AccountMode",CB.LoginMode.NORMAL),V35p.V34z.V1p7())),document.title="Live Chess For "+this.user,V35p.setLoggedIn(!0)):(this.user="Guest"+this.V1qy(),this.V1ps="Guest"+this.V1qy());V35p.V265=this.V25r.bind(this);
V35p.V266=this.V25r.bind(this);this.V2ui();this.V2uj()};c.prototype.V2ui=function(){if(this.V1py&&this.V2tx&&this.V2tx.length){var b=new CB.Vat(CB.V1k2.V1me);b.setUserType(CB.V2u2.V2u3);var c=b.getBuf();c.writeInt(this.V2tx.length);for(var d=0;d<this.V2tx.length;d++)this.V2uk(this.V2tx[d].requestData,c),c.writeInt(this.V2tx[d].ticket),c.V35n(!1),c.V35n(this.V2tx[d].requestData.highestRoundOnly),this.V2tx[d].requested=!0;b.address(this.V1qy(),CB.V1mt.V1mu);this.send(b)}};c.prototype.V2ul=function(b){this.requestLists=
b;this.V2um=[];for(var c=0;c<b.length;c++){var d=new CB.Server.V2tw(this,b[c].ticket,b[c].requestData);this.V2um.push(d)}this.V2uj()};c.prototype.V2uj=function(){if(this.V1py&&this.V2um&&this.V2um.length){var b=new CB.Vat(CB.V1k2.V1me);b.setUserType(CB.V2u2.V2u5);var c=b.getBuf();c.writeInt(this.V2um.length);for(var d=0;d<this.V2um.length;d++)this.V2uk(this.V2um[d].requestData,c),c.writeInt(this.V2um[d].ticket),c.V35n(!1),c.V35n(this.V2um[d].requestData.highestRoundOnly),this.V2um[d].requested=!0;
try{window.location?c.V34p(window.location.hostname||""):c.V34p("")}catch(h){}b.address(this.V1qy(),CB.V1mt.V1mu);this.send(b)}};c.prototype.V2uk=function(b,c){c.V34p(b.event||"");c.V34p(b.round||"");c.V34p(b.round2||"");c.V34p(b.player||"");c.V34p(b.white||"");c.V34p(b.black||"");c.V34p(b.date||"");c.writeInt(b.kibitzRank)};c.prototype.V2un=function(b,c,d,h,k,l,m){if(this.V1py){var p=this.V2uo(c);p&&(p.addSession(b,h,l,m)&&(h=new CB.Vat(CB.V1k2.V1me),h.setUserType(CB.V2u2.V2u4),l=h.getBuf(),l.writeInt(b),
l.writeInt(c),h.address(this.V1qy(),CB.V1mt.V1mu),this.send(h)),p.onInitKibitzing(b,d,k))}};c.prototype.V2up=function(b,c){var d=new CB.Vat(CB.V1k2.V1me);d.setUserType(CB.V2u2.V2ua);var h=d.getBuf();h.writeInt(c);h.writeInt(b);d.address(this.V1qy(),CB.V1mt.V1mu);this.send(d)};c.prototype.setSessionToBackground=function(b,c){if(this.V1py){var d=this.V2uo(b);d&&d.setSessionToBackground(c)}};c.prototype.notifySessionSwap=function(b,c,d){this.V1py&&(b=this.V2uo(b))&&b.notifySessionSwap(c,d)};c.prototype.getPgn=
function(b){if(b=this.V2uo(b))return b.getPgn()};var b=!1;c.prototype.V25r=function(){V35p.V264()!=b&&(this.V2ce(),b=V35p.V264())};c.prototype.V2ce=function(){var b=0;if(this.Vte){var c=new CB.Server.V2oi,b=this.V2uq().flags;c.V2ot(b);c.id=this.V1qz();var d=new CB.Vat(CB.V1k2.V1kv);c.V35j(d.getBuf());d.address(this.V1qy(),CB.V1mt.V1mu);this.send(d);this.fireOnClientChanges([c])}return b};c.prototype.V2uq=function(){var b=CB.Server.V2nw.KIBITZING,b=V35p.V264()?b|CB.Server.V2nw.IDLE:b|CB.Server.V2nw.V2o8;
return new CB.Server.V2nv(b)};c.prototype.execCommand=function(b){if(!this.Vte&&b!=CB.Vlw.LOGIN&&b!=CB.V2tu.V2kc)return!1;try{switch(b){case CB.Vlw.LOGIN:this.V1qi();break;case CB.V2tu.V2kc:this.V1o6(!0);break;case CB.Vlw.V1kr:this.test()}}catch(c){b=CB.V2ur.Vlu(b),CB.Vjg(b,c)}};c.prototype.V1ql=function(b,c,d){};c.prototype.V1vo=function(b){};c.prototype.test=function(b){};c.prototype.V2ut=function(){this.V1ql("Stop Torture");this.V2uu&&this.V2uu.stop()};c.prototype.V1qi=function(){V35p.V34z&&V35p.V34z.V1ox()&&
V35p.V34z.V1ox()};c.prototype.V1o2=function(b){if(!this.V1r5(b))try{switch(b.getType()){default:console.log("Unhandled: "+b.toString());break;case CB.V1k2.V1me:this.V2uv(b);break;case CB.V1k2.V1ka:this.V1wb(b);break;case CB.V1k2.V15:this.V1vq(b)}}catch(c){b=CB.V1k2.Vlu(b.getType()),CB.Vjg(b,c)}};c.prototype.V1vq=function(b){var c=new CB.ChatData;c.fromSocketsMsg(b);var d=b.getBuf().V35k(),h=b.getBuf().V35k(),k=new CB.Vgz;k.compactFromDataBuf(b.getBuf());b=b.getBuf().V35k();c.V1na()||c.V1nc()?V35p.panelMgr.V2uw(c.V1n3,
k,c.strMsg,{idGame:h,ticket:d,mvInx:b},c.V1nh(),!0):V35p.panelMgr.V1ri(c.toString())};c.prototype.V2ux=function(b){var c=[];b=b.getBuf();var d=b.V35k();b.V35k();for(var h=b.V35k(),k=0;k<h;k++){b.beginSizedRead();var l={};l.sender=b.V34q(200);l.txt=b.V34q(500);l.gameId=b.V35k();l.hdr=new CB.Vgz;l.hdr.compactFromDataBuf(b);l.mvInx=b.V35k();l.autoChat=b.V35o();l.txt.length&&c.push(l);b.endSizedRead()}V35p.panelMgr.V2uy(d,c)};c.prototype.V2uz=function(b,c,d){var h=new CB.ChatData;h.Vaw=CB.V1mt.V1mu;h.Vav=
this.V1qy();h.strMsg=d;h.V1n3=b;h.V1n4=c;h.V1nb(!0);h.V1nd(!0);h.V1n1=14;b=h.V34w();b.setType(CB.V1k2.V1me);b.setUserType(CB.V2u2.V2u9);this.send(b)};c.prototype.V1qw=function(b){this.V2uf.V2v0(b)};c.prototype.V1wb=function(b){V35p.panelMgr.V2v1("Reconnected OK...");this.requestLists&&this.V2ul(this.requestLists)};var d=0;c.prototype.V2uv=function(b){0<d&&CB.Vjg("Reenter handleLiveUserMsg: ",d);d=b.getUserType();try{switch(b.getUserType()){case CB.V2u2.V2u6:this.V2v2(b);break;case CB.V2u2.V2uc:this.V2v3(b);
break;case CB.V2u2.V2p7:this.V2v4(b);break;case CB.V2u2.V2p8:this.V2v5(b);break;case CB.V2u2.V2u8:this.V2v6(b);break;case CB.V2u2.V2u9:this.V1vq(b);break;case CB.V2u2.V2ub:this.V2ux(b)}}catch(c){b=CB.V2au.Vlu(b.getUserType()),CB.Vjg(b,c)}d=0};c.prototype.V2t4=function(b){};c.prototype.V2v3=function(b){var c=new CB.Server.V2s2;c.fromDataBuf(b.getBuf());c.game.gotoIndex(c.game.getMoveIndex());b=b.getBuf().V35k();if(b=this.V2uo(b))b.onGameData(c)};c.prototype.V2v2=function(b){var c=b.getBuf();b=new CB.Server.V2rv;
b.fromDataBuf(c);c=c.readInt();if(c=this.V2uo(c))c.onGameItemList(b)};c.prototype.V2v4=function(b){var c=new CB.Vir;c.fromDataBuf(b.getBuf());b=b.getBuf().V35k();if(b=this.V2uo(b))b.onSessionAction(c)};c.prototype.V2v6=function(b){var c=b.getBuf().V35k();b=b.getBuf().V35k();if(c=this.V2uo(c))c.onRecentAnno(b)};c.prototype.V2v5=function(b){var c=new CB.V2s5;c.fromDataBuf(b.getBuf());var d=b.getBuf().V35k();b=b.getBuf().V35k();if(d=this.V2uo(d))d.onSetClock(c,b)};c.prototype.V2v7=function(b){};c.prototype.V2uo=
function(b){if(this.V2um)for(var c=0;c<this.V2um.length;c++)if(this.V2um[c].ticket==b)return this.V2um[c]};c.prototype.V1wp=function(b){var c=new CB.Game,d=new CB.Vgz;d.compactFromDataBuf(b);b.V35k();c.readGameOnly2(b);c.setHeader(d);return c};c.prototype.V2v8=function(){this.V2va(this.V2v9|NaN)};c.prototype.V2va=function(b){V35p.gameKernel.boardWin&&V35p.gameKernel.boardWin.addMessage(b,!0)};V34y.initForListeners(c);V34y.addEvent(c,"ChangeLogin");V34y.addEvent(c,"ClientChanges");return c}();
CB.Tournament=function(){var c=function(){};c.prototype.title=null;c.prototype.arcKey=null;c.prototype.player=null;c.prototype.rounds=null;c.prototype.availbeRounds=null;c.prototype.type=null;c.V2vb={V2vc:"ko",ko:"k.o.",V2vd:"tourn",swiss:"swiss",V2ve:"shev",match:"mat",team:"team"};c.prototype.getPlayerById=function(b){return this.player.filter(function(c){if(c.id==b||c.otherIds&&c.otherIds.contains(parseInt(b)))return!0})[0]};c.prototype.V2vf=function(b){b=this.rounds[b-1];for(var c=[],e,f=0;f<
b.length;f++)e=b[f],0>c.indexOf(e.white)&&c.push(e.white),0>c.indexOf(e.black)&&c.push(e.black);return c.length};c.V2vg=function(b){return c.V2vh(JSON.parse(b))};c.V2vh=function(b){var d=new c;d.title=b.Tournaments[0].t.split("_").join(" ");d.arcKey=b.Tournaments[0].k;for(var e=[],f=function(b,c){for(var d,f,g=(c.f+c.l).trim(),h=0;h<e.length;h++)if(f=e[h].lastName,d=e[h].firstName,d=(d+f).trim(),.2>CB.V7.V8(g,d,3,1,1)/Math.max(g.length,d.length))return e[h]},g=0;g<b.Players.length;g++){var h=b.Players[g],
k=f(e,h);k?(k.otherIds=k.otherIds||[],k.otherIds.push(h.i)):e.push(new CB.V2vi(h.f,h.l,h.e,h.i))}d.player=e;f=b.Rounds;d.availbeRounds=f;var l=[];f.forEach(function(c,e,f){l.push([]);l[c-1]=[];rp=[];for(e=0;e<b["R-"+c+":"].length;e++){var g=b["R-"+c+":"][e].p;f=g.b;var h=g.split(/-|=/),g=d.getPlayerById(h[0]),k=d.getPlayerById(h[1]),h=h[2];if(0>h||2<h)h=null;var v=new CB.V2vj(g,k,h);h&&l[c-1].push(v);v=h?(2-h)/2:null;g.opponents.push(new CB.V2vk(k,h?h/2:null,!0,c,f));k.opponents.push(new CB.V2vk(g,
v,!1,c,f))}}.bind(this));d.rounds=l;d.type=b.Tournaments[0].tt;return d};c.V2vl=function(b){return c.V2vm(JSON.parse(b))};c.V2vn=function(b){};return c}();
CB.V2vi=function(){var c=function(b,c,e,f,g){this.firstName=b;this.lastName=c;this.elo=e;this.id=f;this.team=g;this.valuation=new CB.V2vo;this.valuation.elo=this.elo;this.valuation.name=this.getPbServerUrl();this.valuation.info=$("<div>",{"class":"playerImageContainer"}).append($("<div>",{"class":"name"}).html(this.valuation.name));this.valuation.nation=$("<div>",{"class":"flag"}).append($("<img>",{"class":"flagImg",src:"http://pgn.chessbase.com/Common/Media/Flags/Flags64/United Nations.png"}));this.valuation.title=
$("<div>",{"class":"title"}).text("");this.opponents=[]};c.prototype.team=null;c.prototype.opponents=null;c.prototype.id=null;c.prototype.firstName=null;c.prototype.lastName=null;c.prototype.elo=null;c.prototype.valuation=null;c.prototype.getName=function(){return this.firstName?this.lastName+","+this.firstName:this.lastName};c.prototype.getDisplayeName=function(){return this.firstName&&this.firstName.length?this.lastName+","+this.firstName.substr(0,1):this.lastName};c.prototype.V2vp=function(b){return this.getAllOpponentEntriesForPlayer(b)[0]};
c.prototype.getAllOpponentEntriesForPlayer=function(b){var c=this.opponents.filter(function(c){return c.opponent===b});return c=c||[]};c.prototype.V2vq=function(){var b=[];this.opponents.forEach(function(c){0>b.indexOf(c.opponent)&&b.push(c.opponent)});return b.length};c.prototype.getPbServerUrl=function(){var b=this.getName(),c=this.getDisplayeName(),e=$("<a>");e.attr("href",String.formatEx("http://pbserver.chessbase.com/Player?name={0}",b));e.text(c);return e.prop("outerHTML")};return c}();
CB.V2vr=function(){var c=function(b,c){this.tiebreakInfosArr=b;this.top=c};c.prototype.tiebreakInfosArr=null;c.prototype.top=1E4;return c}();CB.V2vk=function(){var c=function(b,c,e,f,g){this.opponent=b;this.scoredPoints=c;this.isWhite=e;this.round=f;this.board=g};c.prototype.board=null;c.prototype.opponent=null;c.prototype.scoredPoints=null;c.prototype.isWhite=null;c.prototype.round=null;return c}();
CB.V2vj=function(){var c=function(b,c,e){this.white=b;this.black=c;this.result=e};c.prototype.white=null;c.prototype.black=null;c.prototype.result=null;return c}();CB.V2vs=function(){var c=function(b){};c.prototype.result=null;return c}();CB.V2vt=function(){var c=function(b,c){this.roundNr=b;this.pairingsArr=c};c.prototype.roundNr=null;c.prototype.pairingsArr=null;return c}();
CB.V2vu=function(){var c=function(b,c){this.propertyName=b;this.streichWertungen=c};c.prototype.propertyName=null;c.prototype.streichWertungen=null;c.V2vv={bhz:"Buchholz",dirEnc:"Direct encounter",snb:"Sonneborn-Berger",avgElo:"Average Elo",perf:"Performance",wins:"Wins",bl:"Games with black"};c.V2vw=function(b){if(!b)return[];var c=[],e=/[a-zA-Z]+/;b.split(",").forEach(function(b){var g=e.exec(b)[0];b=b.replace(g,"")||0;c.push(new CB.V2vu(g,b))});return c};return c}();
CB.V2vo=function(){var c=function(){};c.prototype.points=null;c.prototype.buchholz=null;c.prototype.sonnebornberger=null;c.prototype.wins=null;c.prototype.avgElo=null;c.prototype.V2vx=null;c.prototype.direkterVergleich=0;return c}();
CB.V2vy=function(){var c={V2vz:function(b,e,f,g,h){return c.V2w0[e](b,e,f||function(){return!0},g,h)},V2w1:function(b,c){var f=b.length-c,f=0>f?0:f;return b.sort(function(b,c){return c.opponent.valuation.points-b.opponent.valuation.points}).slice(0,f)},V2w2:function(c,e,f,g,h){e=c.opponents.filter(f).filter(function(b){return 0<b.opponent.valuation.elo});c=CB.V2vy.V2w3(e,function(b){return b.opponent.valuation.elo});e=Math.round(CB.V2vy.sum(e,function(b){return b.scoredPoints})/e.length*100);return c+
b.getDiff(e)},V2w4:function(b,c,f,g,h){return CB.V2vy.sum(b.opponents,function(b){return b.scoredPoints})},V2w5:function(b,e,f,g,h){b=CB.V2vy.V2w1(b.opponents,h);return c.sum(b,CB.V2vy.V2w6("points"))},V2w7:function(b,c,f,g,h){var k=0;CB.V2vy.V2w1(b.opponents,h).filter(f).forEach(function(b){k+=b.scoredPoints*b.opponent.valuation.points});return k},V2w8:function(b,c,f,g,h){return b.opponents.filter(function(b){return 1===b.scoredPoints}).filter(f).length},V2w9:function(b,c,f,g,h){return b.opponents.filter(function(b){return!b.isWhite}).length},
V2wa:function(b,e,f,g,h){b=c.V2w1(b.opponents,h);return c.V2w3(b,CB.V2vy.V2w6("elo"))},V2wb:function(b,c,f,g,h){var k=g.filter(function(c){return c.valuation.points==b.valuation.points});if(k.some(function(c){return c.opponents.map(function(b){return b.opponent}).filter(function(c){return c.valuation.points==b.valuation.points}).length!=k.length-1}))return 0;c=b.opponents.filter(function(c){return c.opponent.valuation.points==b.valuation.points});return CB.V2vy.sum(c,function(b){return b.scoredPoints})},
sum:function(b,c){var f=0;b.forEach(function(b){f+=c(b)});return f},V2w3:function(b,e){return c.sum(b,e)/b.length},V2w6:function(b){return function(c){return parseFloat(c.opponent.valuation[b])}},max:function(b,c){max=0;b.forEach(function(b){b=c(b);max=b>max?b:max});return max},min:function(b,c){min=0;b.forEach(function(b){b=c(b);min=b<min?b:min});return min}};c.V2w0={points:c.V2w4,buchholz:c.V2w5,sonnebornberger:c.V2w7,wins:c.V2w8,avgElo:c.V2wa,eloPerf:c.V2w2,direkterVergleich:c.V2wb,blacks:c.V2w9,
bl:c.V2w9,bhz:c.V2w5,snb:c.V2w7,perf:c.V2w2,dirEnc:c.V2wb};var b={100:800,99:677,98:589,97:538,96:501,95:470,94:444,93:422,92:401,91:383,90:366,89:351,88:336,87:322,86:309,85:296,84:284,83:273,82:262,81:251,80:240,79:230,78:220,77:211,76:202,75:193,74:184,73:175,72:166,71:158,70:149,69:141,68:133,67:125,66:117,65:110,64:102,63:95,62:87,61:80,60:72,59:65,58:57,57:50,56:43,55:36,54:29,53:21,52:14,51:7,50:0,getDiff:function(b){return 50<b?this[b]:-this[100-b]}};return c}();
CB.V2wc=function(){var c=function(){};c.convertToHtmlTable=function(b){var d=$("<table>"),e=$("<thead>"),f=$("<tbody>"),g=CB.V2vy.max(b,function(b){return b.length});theadRow=$("<tr>");var h=0;b[0].forEach(function(b,c,d){var e=$("<th>");b.colspan&&b.str?(e.html(b.str),e.attr("colspan",b.colspan),h+=b.colspan):(e.html(b),h++);c===d.length-1&&e.attr("colspan",g-h);theadRow.append(e)});e.append(theadRow);for(var k=1;k<b.length;k++){var l=b[k],m=$("<tr>");l.forEach(function(b,d,e){var f;c.isNumberField(b)&&
(f="tdNumber");f=$("<td>",{"class":f});f.html(b);d===e.length-1&&f.attr("colspan",g-d);m.append(f)});f.append(m)}d.append(e);d.append(f);return d};c.isNumberField=function(b){if(!b)return!1;if(b instanceof Number||"number"===typeof b||!isNaN(b)||b.charCodeAt&&189==b.charCodeAt(0)||b&&$(b).text&&(b=$(b).text(),b instanceof Number||"number"===typeof b||!isNaN(b)||189==b.charCodeAt(0)))return!0};return c}();CB.Comparer=CB.Comparer||{};
CB.Comparer.V2wd=function(){var c=function(b){this.V2we=_subComparer};c.prototype.V2we=null;c.prototype.compare=function(b,c){};return c}();CB.Comparer=CB.Comparer||{};CB.Comparer.V2wf=function(){var c=function(b,c){this.V2we=b;this.V3=c};c.prototype.V2we=null;c.prototype.V3=null;c.prototype.compare=function(b,c){return b.valuation[this.V3]===c.valuation[this.V3]?this.V2we?this.V2we.compare(b,c):0:c.valuation[this.V3]-b.valuation[this.V3]};return c}();CB.Comparer=CB.Comparer||{};
CB.Comparer.Comparer=function(){var c=function(){this.comparer=[]};c.prototype.comparer=null;c.prototype.V2wg=function(b){this.comparer.push(b)};c.prototype.V2wh=function(b){b=this.comparer.indexOf(b);return this.comparer.slice(b)};c.prototype.V2wi=function(b){return this.comparer.slice(b,1)};c.prototype.compare=function(b,c){var e,f=0,g=this.comparer.length;do e=this.comparer[f].compare(b,c),f++;while(0==e&&f<g);return e};c.fromTiebrakeInfos=function(b){var c=new CB.Comparer.Comparer;c.V2wg(new CB.Comparer.V2wf(null,
"points"));b.forEach(function(b){c.V2wg(new CB.Comparer.V2wf(null,b.propertyName))});return c};return c}();CB.V2wj=CB.V2wj||{};
CB.V2wj.V2wk=function(){var c=function(){};c.prototype.toHtml=function(b,c,e,f){c=f.width;e=b.players;f=b.tournament.rounds;var g=b.tournament.availbeRounds,h=$("<div>",{"class":"koContainer"}),k=$("<div>",{"class":"koHead"});k.append(this.V2wl(g,b));for(var l=$("<div>",{"class":"koContent"}),m=0;m<g.length;m++){var p=g[m],r=$("<div>",{"class":"koRound koRound-"+p});r.append(this.V2wm(f[m],p,e,b));l.append(r)}h.append(k);h.append($("<div>",{"class":"koContentContainer"}).append(l));520<=c?h.css("width",
500):h.css("width","100%");return h};c.prototype.V2wl=function(b,c){var e=$("<div>",{"class":"arrowContainer"}),f=$("<div>",{"class":"arrowLeftContainer arrowSideContainer"}),g=$("<img>",{src:"http://pgn.chessbase.com/Common/Media/Webimages/Arrow_left.png","class":"arrow arrowLeft"}),h=$("<div>",{"class":"arrowRightContainer arrowSideContainer"}),k=$("<img>",{src:"http://pgn.chessbase.com/Common/Media/Webimages/Arrow_right.png","class":"arrow arrowRight"}),l=$("<div>",{"class":"roundNrContainer"}),
m=$("<div>",{"class":"roundNr"});l.append(m);f.append(g);h.append(k);e.append(f);e.append(l);e.append(h);var p=function(b){document.getElementById("koRoundSheet"+b)||(b=$("<style>",{id:"koRoundSheet"+b}).html(".cbtable .koContainer .koRound-"+b+"{display:none}"),$(document.head).append(b))},r=function(b){document.head.removeChild(document.getElementById("koRoundSheet"+b))},u=function(b){f.next().children(".roundNr").text(b)};c.currentRoundIndex=c.currentRoundIndex||b.length-1;c.lastRoundIndex=c.lastRoundIndex||
0;for(var q=c.currentRoundIndex,t=c.lastRoundIndex,v=b.length-1,g=0;g<b.length-1;g++)p(b[g]);u(b[b.length-1]);f.on("click",function(){0!=q&&(t=q,q--,u(b[q]),p(b[t]),r(b[q]),0==q&&f.children(".arrow").addClass("inactive"),q+1==v&&h.children(".arrow").removeClass("inactive"))});h.on("click",function(){q!=v&&(t=q,q++,u(b[q]),p(b[t]),r(b[q]),0==q-1&&f.children(".arrow").removeClass("inactive"),q==v&&h.children(".arrow").addClass("inactive"))});q==v&&h.children(".arrow").addClass("inactive");0==q&&f.children(".arrow").addClass("inactive");
return e};c.prototype.V2wm=function(b,c,e,f){var g=$("<div>",{"class":"koRoundDiv"}),h=[],k=0;e.forEach(function(b){k=Math.max(b.opponents.filter(function(b){return b.round==c}).length,k)});for(e=0;e<b.length;e++){var l=b[e],m=l.white,p=l.black;if(!h.contains(m)&&!h.contains(p)){h.push(m);h.push(p);var l=$("<div>",{"class":"koMatch"}),r=this.V2wn(m,p,c,f,k),m=this.V2wn(p,m,c,f,k);l.append(r);l.append(m);g.append(l)}}return g};c.prototype.V2wn=function(b,c,e,f,g){c=$("<div>",{"class":"playerLine"});
c.append(this.V2wo(b));var h=[];b.opponents.filter(function(b){return b.round==e}).forEach(function(c){h.push(f.createGameLink(b,c))});for(var k=h.length;k<g;k++)h.push("-");g=f.getResultsForPlayer(b,e);c.append(this.V2wp(h,g));return c};c.prototype.V2wo=function(b){var c=$("<div>",{"class":"playerDiv"});c.append($("<div>",{"class":"title"}).html($(b.valuation.title.prop("outerHTML"))));c.append($(b.valuation.info.prop("outerHTML")));c.append($("<div>",{"class":"rating"}).html(b.valuation.elo));c.append($("<div>",
{"class":"nation"}).html(b.valuation.nation.prop("outerHTML")));return c};c.prototype.V2wq=function(b,c,e,f){var g=this.V2wr(b),h,k;e=b.tournament.rounds;f=[];for(var l,m=0;m<b.tournament.availbeRounds.length;m++){var p=[];k=0;l=m;roundNr=b.tournament.availbeRounds[m];c=Math.pow(2,roundNr-1)-1;h=2*c;k+=c;f.push(roundNr);e[roundNr-1].forEach(function(c,d,e){d=c.white;c=c.black;if(!(0<=p.indexOf(d))){p.push(d);p.push(c);var f=b.getResultsForPlayer(d,roundNr);e=b.getResultsForPlayer(c,roundNr);f=this.V2wp(f);
e=this.V2wp(e);g[k++][l]=d.getPbServerUrl();g[k++][l]=f;g[k++][l]=e;g[k++][l]=c.getPbServerUrl();k+=h}}.bind(this))}g.unshift(f);c=CB.V2wc.convertToHtmlTable(g);c.addClass("cbko");return c};c.prototype.V2wr=function(b){var c=2*b.tournament.player.length+4;b=b.tournament.rounds.length;for(var e=[],f=0;f<c;f++){for(var g=[],h=0;h<b;h++)g.push("");e.push(g)}return e};c.prototype.V2wq=function(b,c,e,f){f=b.players;var g=this.V2ws(b),h,k,l;c=b.tournament.rounds;e=[];f.forEach(function(b,c,d){b.kosortrank=
c});for(var m=0;m<b.tournament.availbeRounds.length;m++){var p=[];l=0;columnNr=m;h=b.tournament.availbeRounds[m];f=Math.pow(2,h)-2;k=2*f;l+=f;e.push(h);c[h-1].forEach(function(c,d,e){d=c.white;c=c.black;if(!(0<=p.indexOf(d))){p.push(d);p.push(c);var f=b.getResultsForPlayer(d,h);e=b.getResultsForPlayer(c,h);f=this.V2wp(f);e=this.V2wp(e);g[l++][columnNr]=d.getPbServerUrl();g[l++][columnNr]=f;g[l++][columnNr]=e;g[l++][columnNr]=c.getPbServerUrl();l+=k}}.bind(this))}g.shift(e);return CB.V2wc.convertToHtmlTable(g)};
c.prototype.V2wp=function(b,c){var e=$("<div>");e.addClass("resultsBox");b.forEach(function(b){var c=$("<div>");c.html(b);c.addClass("innerResultsBox");e.append(c)}.bind(this));var f=CB.V2vy.sum(c,this.V2wt),g=$("<div>");g.addClass("innerResultsBox");g.html(f);e.append(g);return $("<div>").append(e.clone()).html()};c.prototype.V2wu=function(b){return(b+"").split("0.5").join(".5").split(".5").join("&#189;")};c.prototype.V2wt=function(b){return b};c.prototype.V2ws=function(b){var c=2*Math.pow(2,b.tournament.rounds.length);
b=b.tournament.rounds.length;for(var e=[],f=0;f<c;f++){for(var g=[],h=0;h<b;h++)g.push("");e.push(g)}return e};return c}();CB.V2wj=CB.V2wj||{};
CB.V2wj.V2wv=function(){var c=function(){},b=function(b,c){var f=$("<tfoot>"),g=$("<tr>"),h=$("<td>",{"class":"tbTd",colspan:c});h.text(b);g.append(h);f.append(g);return f};c.prototype.toHtml=function(c,e,f,g){var h=g.width,k=[],l=[];e.forEach(function(b){l.push(b.headerName)});if(450<h)for(var m=1;m<=c.players.length;m++)l.push($("<div>",{"class":"crossResultHeader"}).html(m));0<f.tiebreakInfosArr.length&&l.push({str:"TB",colspan:1});l.push("Perf.");k.push(l);var p=1;c.players.forEach(function(b){var g=
[];e.forEach(function(c){g.push($("<div>",{"class":c.propertyName}).html(b.valuation[c.propertyName]).prop("outerHTML"))});450<h&&c.players.forEach(function(e){var f=$("<div>",{"class":"crossResult"}),h=b.getAllOpponentEntriesForPlayer(e);p=Math.max(p,h.filter(function(b){return b.scoredPoints}).length);if(e===b)g.push('<div class="samePlayer"></div>');else if(0<h.length){var k=[];h.forEach(function(e){e=c.createGameLink(b,e);k.push(e)});e=k.map(function(b){return b.prop("outerHTML")}).join(" ");
f.html(e);g.push(f.prop("outerHTML"))}else g.push("")});0<f.tiebreakInfosArr.length&&g.push($("<div>",{"class":"tb"}).text(b.valuation[f.tiebreakInfosArr[0].propertyName]));g.push($("<div>",{"class":"perf"}).text(b.valuation.perf));k.push(g)});m=CB.V2wc.convertToHtmlTable(k);if(g.caption){g=$("<caption>");var r=String.formatEx('<a href="http://live.chessbase.com/replay/{0}/0?anno=false">{1}</a>',c.tournament.arcKey,c.tournament.title);g.html(r);m.prepend(g)}g=CB.V2vy.max(k,function(b){return b.length});
r="TBs: "+f.tiebreakInfosArr.map(function(b){return CB.V2vu.V2vv[b.propertyName]}).join(", ");m.append(b(r,g));m.addClass("cbroundrobin");m.addClass("games-"+p);m.attr("cellpadding","0");return m};return c}();CB.V2wj=CB.V2wj||{};
CB.V2wj.V2ww=function(){var c=function(){};c.prototype.toHtml=function(b,c,e,f){e=this.V2wx(b);c=e[0];var g=e[1];e=function(b,c){return c.valuation.points-b.valuation.points};c.sort(e);g.sort(e);e=$("<table>",{"class":"shev"});var h=$("<tbody>"),k=$("<tr>");k.append($("<td>"));var l=0;g.forEach(function(b){var c=$("<td>",{"class":"shev-rotate"});this.V2wy(b);c.html(this.V2wy(b));b=b.getDisplayeName().length;l=Math.max(l,5*b+48);k.append(c)}.bind(this));h.append(k);c.forEach(function(c){var d=$("<tr>"),
e=$("<td>");d.append(e);e.append(this.V2wy(c));g.forEach(function(e){c.getAllOpponentEntriesForPlayer(e).forEach(function(e){var f=$("<td>");f.html(b.createGameLink(c,e));d.append(f)})});h.append(d)}.bind(this));e.append(h);e.css("margin-top",Math.sqrt(Math.pow(l,2)));return e};c.prototype.V2wy=function(b){var c=$("<div>",{"class":"outerPlayerDiv"}),e=$("<div>",{"class":"playerDiv"});e.append(b.valuation.nation);e.append(b.valuation.title);e.append(b.getPbServerUrl());e.append(b.valuation.elo);c.append(e);
return e};c.prototype.V2wx=function(b){var c=[],e=[],f=b.players[0];f.opponents.forEach(function(b){e.push(b.opponent)});c.push(f);for(var g=e,h=c,f=0;c.length+e.length<b.players.length&&5>f;)b.players.forEach(function(b){if(c.contains(b))g=c,h=e;else if(e.contains(b))g=e,h=c;else return;if(b.opponents.some(function(b){return g.contains(b.opponent)}))return!1;h.merge(b.opponents.map(function(b){return b.opponent}))}),f++;return[c,e]};return c}();CB.V2wj=CB.V2wj||{};
CB.V2wj.V2wz=function(){var c=function(){};c.prototype.toHtml=function(b,c,e,f){var g=e.top||1E4,g=Math.min(g,b.players.length),h=e.tiebreakInfosArr;e=b.players.slice(0,g);var k=[],l=[];c.forEach(function(b){l.push(b.headerName)});l.push({str:"TB",colspan:1});l.push("Perf.");k.push(l);e.forEach(function(b){var e=[];c.forEach(function(c){e.push($("<div>",{"class":c.propertyName}).html(b.valuation[c.propertyName]))});0<h.length&&e.push($("<div>",{"class":"tb"}).html(b.valuation[h[0]]));e.push($("<div>",
{"class":"perf"}).text(b.valuation.perf));k.push(e)});e=CB.V2wc.convertToHtmlTable(k);f.caption&&(b=String.formatEx('<a href="http://live.chessbase.com/replay/{0}/0?anno=false">{1}</a>',b.tournament.arcKey,b.tournament.title),f=$("<caption>"),f.html(b),e.prepend(f));var m=CB.V2vy.max(k,function(b){return b.length});b=$("<tfoot>");f=h.map(function(b){return CB.V2vu.V2vv[b.propertyName]}).join(", ");g=$("<tr>");m=$("<td>",{colspan:m});m.text("TBs: "+f);g.append(m);b.append(g);e.append(b);e.addClass("cbswiss");
return e};c.prototype.V2x0=function(b,c,e,f){var g=e.top||1E4,h=e.tiebreakInfosArr;e=b.players;var k=$("<table>",{"class":"simple_table"});f.caption&&(f=$("<caption>"),b=String.formatEx('<a href="http://live.chessbase.com/replay/{0}/0?anno=false">{0}</a>',b.tournament.title.split(" ").join("_")),f.html(b),k.append(f));b=$("<thead>");var l=$("<tbody>"),m=$("<tr>");c.forEach(function(b){var c=$("<th>");c.text(b.headerName);m.append(c)});f=$("<th>");f.text("Tiebrakers");f.attr("colspan",h.length);m.append(f);
f=$("<tfoot>");f.text("TBs");b.append(m);k.append(b);k.append(f);var p=function(b,c){return function(d){var e=$("<td>");(b.valuation[d.propertyName]instanceof Number||"number"===typeof b.valuation[d.propertyName])&&e.addClass("tdNumber");e.html(b.valuation[d.propertyName]);c.append(e)}};e.filter(function(b){return b.valuation.rank<=g}).forEach(function(b){var e=$("<tr>");b=p(b,e);c.forEach(b);h.forEach(b);l.append(e)});k.append(l);return k};return c}();CB.V2wj=CB.V2wj||{};
CB.V2wj.V2x1=function(){var c=function(){};c.prototype.toHtml=function(b,c,e,f){};return c}();CB.V2x2=function(){var c=function(b,c){this.propertyName=b;this.headerName=c};c.prototype.propertyName=null;c.prototype.headerName=null;return c}();CB.V2wj=CB.V2wj||{};
CB.V2wj.V2x3=function(){var c=function(){};c.prototype.toHtml=function(b,c,e,f){c=f.width||4E4;this.ranking=b;e=[];e.push([]);var g=b.players[0],h=b.players[1],k=g.valuation.nation||h.valuation.nation,l=g.valuation.title||h.valuation.title,m=g.valuation.elo||h.valuation.elo,p=f.withPic&&(g.valuation.picture||h.valuation.picture);e.push(this.V2x4(g,450<c,k,l,m,p));e.push(this.V2x4(h,450<c,k,l,m,p));c=CB.V2wc.convertToHtmlTable(e);f.caption&&(f=$("<caption>"),b=String.formatEx('<a href="http://live.chessbase.com/replay/{0}/0?anno=false">{1}</a>',
b.tournament.arcKey,b.tournament.title),f.html(b),c.prepend(f));c.addClass("cbmatch");return c};c.prototype.V2x4=function(b,c,e,f,g,h){var k=[];f&&k.push($("<div>",{"class":"title"}).html(b.valuation.title));k.push($("<div>",{"class":"name"}).html(b.getPbServerUrl()));h&&k.push($("<div>",{"class":"picture"}).html(b.valuation.picture));e&&k.push($("<div>",{"class":"nation"}).html(b.valuation.nation));g&&k.push($("<div>",{"class":"elo"}).html(b.valuation.elo));e=b.opponents.sort(function(b,c){return b.round-
c.round});c&&e.forEach(function(c){k.push($("<div>",{"class":"crossResult"}).html(this.ranking.createGameLink(b,c)).prop("outerHTML"))}.bind(this));c=CB.V2vy.sum(e,function(b){return b.scoredPoints});k.push($("<div>",{"class":"points"}).text(c).prop("outerHTML"));return k};return c}();Array.prototype.contains||(Array.prototype.contains=function(c){return 0<=this.indexOf(c)});Array.prototype.merge||(Array.prototype.merge=function(c){c.forEach(function(b){this.contains(b)||this.push(b)}.bind(this))});
CB.Ranking=function(){var c=function(b,c,e,f){this.tournament=b;this.round=c;this.rankingOptions=e;this.formatOptions=f;this.players=this.tournament.player;this.init()};c.prototype.tournament=null;c.prototype.round=null;c.prototype.rankingOptions=null;c.prototype.players=null;c.prototype.V2x5={swiss:new CB.V2wj.V2wz,tourn:new CB.V2wj.V2wv,rapid:new CB.V2wj.V2wz,ko:new CB.V2wj.V2wk,match:new CB.V2wj.V2x3,shev:new CB.V2wj.V2ww,getFormatter:function(b){return this[b]||this.swiss}};c.prototype.V2x5[CB.Tournament.V2vb.swiss]=
c.prototype.V2x5.swiss;c.prototype.V2x5[CB.Tournament.V2vb.V2vd]=c.prototype.V2x5.tourn;c.prototype.V2x5[CB.Tournament.V2vb.ko]=c.prototype.V2x5.ko;c.prototype.V2x5[CB.Tournament.V2vb.match]=c.prototype.V2x5.match;c.prototype.V2x5[CB.Tournament.V2vb.V2ve]=c.prototype.V2x5.shev;c.prototype.V2x5[CB.Tournament.V2vb.V2vc]=c.prototype.V2x5.ko;c.prototype.V2x5[CB.Tournament.V2vb.team]=c.prototype.V2x5.swiss;c.V2x6=!1;c.lobby=null;c.prototype.V2x7=function(b){var c=function(b,c){var d=[];$(".cbtable  tr,.cbpairing tr");
$(".cbtable tr,.cbpairing tr,.cbtable .playerDiv").each(function(c,e,g){$(e).find(".name a");$(e).find(".name a").each(function(c,g,k){$(g).text()==b.getDisplayeName()&&d.push({row:e,index:c})})});d.forEach(function(d,e){var h=d.row,p=d.index,r=(new CB.V5n(c.player.m_NewCBPlayer.m_HighData.m_aNation)).V5s(),r=String.formatEx("http://pgn.chessbase.com/Common/Media/Flags/Flags{1}/{0}.png",r,64);$(h).find(".flagImg");$($(h).find(".flagImg")[p]).attr("src",r);b.valuation.nation.find(".flagImg").attr("src",
r);h=d.row;p=d.index;if(c.pic){var r=$("<span>",{"class":"largeImageContainer "}),u=$("<img>",{"class":"playerPicLarge "}).attr("src",window.URL.createObjectURL(new Blob([new Uint8Array(c.pic)],{type:"img/png"})));r.append(u);$($(h).find(".playerImageContainer")[p]).append(r);b.valuation.info.append(r.prop("outerHTML"))}h=d.row;p=d.index;r=CB.V1et.Vds(c.player.m_NewCBPlayer.m_HighData.m_aTitle);$($(h).find(".title")[p]).text(r);b.valuation.title.text(r)})},e=[],e=b.length>this.rankingOptions.top?
b.slice(0,this.rankingOptions.top):b;e.forEach(function(b){V35p.playerLobby.V1ex(b.firstName,b.lastName,b.elo,(new Date).getFullYear(),function(e){c(b,e)},function(b){})})};c.prototype.V2x8=function(){return this.V2x9()?CB.Tournament.V2vb.ko:this.V2xa()?CB.Tournament.V2vb.match:this.V2xb()?CB.Tournament.V2vb.V2ve:this.V2xc()?CB.Tournament.V2vb.V2vd:CB.Tournament.V2vb.swiss};c.prototype.V2xd=function(){if(this.V2xa())return CB.Tournament.V2vb.match;if(this.V2x9())return CB.Tournament.V2vb.ko;if(this.V2xc())return CB.Tournament.V2vb.V2vd;
if(this.V2xe()||this.tournament.type==CB.Tournament.V2vb.V2vd&&20<this.tournament.player.length)return CB.Tournament.V2vb.team};c.prototype.V2xa=function(){return 2==this.players.length};c.prototype.V2x9=function(){for(var b=this.tournament.availbeRounds.length,c=this.tournament.V2vf(this.tournament.availbeRounds[0]),e=!1,f=1;f<b&&4<c;f++){var e=!0,g=this.tournament.V2vf(this.tournament.availbeRounds[f]),c=c/g;if(1.8>c||2.2<c)return!1;c=g}return e};c.prototype.V2xe=function(){return this.players.all(function(b){return b.team})};
c.prototype.V2xc=function(){var b=this.players.length;if(this.tournament.rounds.length+1===b||12>=b)return!0};c.prototype.V2xb=function(){if(3>this.tournament.rounds.length)return!1;var b=[],c=[],e=this.players[0];e.opponents.forEach(function(b){c.push(b.opponent)});b.push(e);for(var f=!0,g=c,h=b,f=!0,e=0;b.length+c.length<this.players.length&&5>e;)this.players.forEach(function(e){b.contains(e)?(g=b,h=c):c.contains(e)?(g=c,h=b):f=!1;e.opponents.some(function(b){return g.contains(b.opponent)})&&(f=
!1);h.merge(e.opponents.map(function(b){return b.opponent}))}.bind(this)),e++;return f&&b.length==c.length&&b.length<=this.players.length/2};c.prototype.init=function(){this.tournament.type=this.tournament.type?this.V2xd()||this.tournament.type:this.V2x8();var b;b=this.round?function(b){return b.round<=this.round}.bind(this):function(b){return!0};this.players.forEach(function(c){c.allOpponents=c.opponents;c.opponents=c.opponents.filter(b)});this.players.forEach(function(c){c.valuation.points=CB.V2vy.V2vz(c,
"points",b,this.players);c.valuation.points&&(c.valuation.points=c.valuation.points.toFixed(1));c.valuation.gCount=c.opponents.filter(function(b){return void 0!=b.scoredPoints}).length}.bind(this));this.rankingOptions.tiebreakInfosArr&&this.rankingOptions.tiebreakInfosArr.length||(this.tournament.type==CB.Tournament.V2vb.swiss?this.rankingOptions.tiebreakInfosArr=[{propertyName:"bhz",streichWertungen:0}]:this.tournament.type==CB.Tournament.V2vb.V2vd&&(this.rankingOptions.tiebreakInfosArr=[{propertyName:"snb",
streichWertungen:0}]));this.rankingOptions.tiebreakInfosArr.forEach(function(c){this.players.forEach(function(d){var e=CB.V2vy.V2vz(d,c.propertyName,b,this.players,c.streichWertungen),e=void 0!=e&&null!=e&&e.toFixed?e.toFixed(2):e;d.valuation[c.propertyName]=e}.bind(this))}.bind(this));this.players.forEach(function(b){b.valuation.perf=CB.V2vy.V2vz(b,"perf",function(){return!0},this.players,0).toFixed(0);b.valuation.perf=isNaN(b.valuation.perf)?0:b.valuation.perf}.bind(this));var c=CB.Comparer.Comparer.fromTiebrakeInfos(this.rankingOptions.tiebreakInfosArr);
this.players.sort(c.compare.bind(c));CB.V5t.V64()||this.V2x7(this.players);for(var e=this.players[0].valuation.rank=1;e<this.players.length;e++)0===c.compare(this.players[e],this.players[e-1])?this.players[e].valuation.rank=this.players[e-1].valuation.rank:this.players[e].valuation.rank=e+1};c.prototype.createGameLink=function(b,c){var e=$("<a>"),f,g;c.isWhite?(f=b.lastName,g=c.opponent.lastName):(g=b.lastName,f=c.opponent.lastName);f=String.formatEx("http://live.chessbase.com/replay/{2}/0/?w={0}&b={1}",
f,g,this.tournament.arcKey.split(" ").join("_"));e.attr("href",f);null!=c.scoredPoints&&(f=c.scoredPoints.toString().split("0.5").join(".5").split(".5").join("&#189;"),e.html(f));return e};c.prototype.getResultsForPlayer=function(b,c){return b.opponents.filter(function(b){return b.round==c}).sort(function(b,c){return b.board-c.board}).map(function(b){return b.scoredPoints})};c.prototype.toHtml=function(b){b||(b=1E5);var c=[];c.push(new CB.V2x2("rank","Rk."));CB.V5t.V64()||c.push(new CB.V2x2("title",
""));c.push(new CB.V2x2("info","Name"));c.push(new CB.V2x2("elo","Rtg."));CB.V5t.V64()||c.push(new CB.V2x2("nation","Nt."));c.push(new CB.V2x2("points","Pts."));c.push(new CB.V2x2("gCount","n"));this.formatOptions.width=b;return this.V2x5.getFormatter(this.tournament.type).toHtml(this,c,this.rankingOptions,this.formatOptions)};c.prototype.V2xf=function(b,c){return CB.V2vy.sum(b.allOpponents.filter(function(b){return!c||b.round<c}),function(b){return b.scoredPoints})};V34y.initForListeners(c);V34y.addEvent(c,
"Changed");return c}();
CB.V2xg=function(){var c=function(b){this.ranking=b;this.init()};c.prototype.ranking=null;c.prototype.init=function(){for(var b=function(b){return function(c,d){var e=c.white.valuation["points"+b]+c.black.valuation["points"+b]-(d.white.valuation["points"+b]+d.black.valuation["points"+b]);return 0!=e?-e:-(Math.max(c.white.valuation.elo,c.black.valuation.elo)-Math.max(d.white.valuation.elo,d.black.valuation.elo))}},c=this.ranking.tournament.rounds,e=[],f=0;f<c.length;f++)e.push(this.V2xh(c[f],this.ranking.tournament.availbeRounds[f])),
e[f].sort(b(this.ranking.tournament.availbeRounds[f]));this.pairings=e};c.prototype.V2xh=function(b,c){var e=[];b.forEach(function(b){b.white.valuation["points"+c]=this.ranking.V2xf(b.white,c);b.black.valuation["points"+c]=this.ranking.V2xf(b.black,c);e.push(b)}.bind(this));e.roundNr=c;return e};c.prototype.V2xi=function(b){var c=this.pairings[b-1],e=[];e.push(" Name Rtg. Nt. Pts.  Pts.  Name Rtg Nt.".split(" "));c.forEach(function(c){var d=[],h=c.white,k=c.black;d.push(h.valuation.title);d.push(h.valuation.info);
d.push(h.valuation.elo);d.push(h.valuation.nation);d.push($("<div>",{"class":"points"}).html(this.V2xj(h.valuation["points"+b])));d.push(this.V2xk(c,b));d.push($("<div>",{"class":"points"}).html(this.V2xj(k.valuation["points"+b])));d.push(k.valuation.title);d.push(k.valuation.info);d.push(k.valuation.elo);d.push(k.valuation.nation);e.push(d)}.bind(this));return CB.V2wc.convertToHtmlTable(e)};c.prototype.V2xk=function(b,c){var e=b.result/2,f=1-e,g=String.formatEx("http://live.chessbase.com/replay/{2}/{3}/?w={0}&b={1}",
b.white.lastName,b.black.lastName,this.ranking.tournament.arcKey.split(" ").join("_"),c);return $("<a>").attr("href",g).html($("<div>",{"class":"result"}).html(this.V2xj(e+"-"+f)))};c.prototype.V2xj=function(b){return b.toString().split("0.5").join(".5").split(".5").join("&#189;")};return c}();"use strict";
CB.V2xl=function(){var c=function(){CB.$(window).on("resize",this.resize.bind(this))};c.prototype.init=function(){this.V2xm=!1;this.V2xn=[];this.V2xo=-1;this.V2xp=this.V2xq=0;this.V2xr=!1};c.prototype.V2xs=function(){this.isVerti=1.15*window.innerWidth<window.innerHeight&&600>window.innerWidth};c.prototype.V1dr=function(b,c){var f=document.createElement("div");f.id=b+c;f.className=b;return f};c.prototype.V2xt=function(b,c,f){b=document.createElement(b);c&&(b.id=c+f,b.className=c);return b};c.prototype.V2xu=
function(b,c,f){var g=document.createElement("ul");b&&(g.id=b+c,g.className=b);f.forEach(function(b){var c=document.createElement("li");g.appendChild(c);$(c).text(b)});return g};c.prototype.V2xv=function(b,c,f,g,h,k){if(b){var l=0;f.forEach(function(b){b.length>l&&(l=b.length)});var m=this.V1dr(c,g),p=this.V2xt("ul","ul"+c,g),r=9;CB.V5t.V64()&&(r=12);if(f.length){for(var u=0;u<f.length;u++){var q=this.V2xt("li",c+"-item-"+u+"-",g);f[u]?$(q).html('<a href="#">'+f[u]+"</a>"):$(q).attr("type","separator");
p.appendChild(q)}m.appendChild(p);b.appendChild(m);u=$("#"+c+g);u.jqxMenu({autoOpenPopup:!1,mode:"popup",width:16+l*r,animationShowDuration:0,animationHideDuration:0,animationHideDelay:0,animationShowDelay:0,autoCloseInterval:0});u.on("itemclick",function(b){b=b.args.id.match(/[-][0-9]*[-]/);b=b[0].substring(1,b[0].length-1);h(b)});u.on("closed",function(){k&&k()})}u[0].dataset.itemcount=f.length;return u[0]}};c.prototype.V2xw=function(b,c,f){if(f)return $(b).jqxMenu("close"),!1;var g=b.dataset.itemcount;
f=$(window).scrollTop();var h=$(window).scrollLeft(),k=c.clientX-20;5>k&&(k=5);var l=0;CB.V5t.V64()&&(l=2);c=c.clientY-Math.max(60,30+(25+l)*g);$(b).jqxMenu("open",k+h,c+f);CB.V5t.V64()&&$(".jqx-item").css("font-size","18px");return!0};c.prototype.V2xx=function(b){var c=new CB.V1ds(b);c.setSize(b.offsetWidth,b.offsetHeight);c.setVisible(!0);return c};CB.V9=function(b,c,f){};var b=new CB.V35b;c.prototype.resize=function(){(10<Math.abs(window.innerWidth-this.V2xp)||150<Math.abs(window.innerHeight-this.V2xq)||
!CB.V5t.V64())&&b.exec(function(){0<=this.V2xy&&this.V2xz(this.V2xy);this.V2y0()||(this.V2y1(),this.V2xp=window.innerWidth,this.V2xq=window.innerHeight)}.bind(this),10)};c.prototype.V2y1=function(){var b=0;$(this.V2y2).each(function(c,f){this.resizePlugin($(f),b);b++}.bind(this))};c.prototype.V2y3=function(b,c,f,g){this.V2xn[b]&&this.V2xn[b].stop();this.V2xn[b]=new CB.Timer(function(){this.modules[b].boardArea&&this.V2y4(b,c,f)}.bind(this));this.V2xn[b].runOnce(g)};c.prototype.V2y4=function(b,c,f){this.V2xn[b]&&
this.V2xn[b].stop();this.modules[b].boardArea.setPosSize(0,0,c,f)};c.prototype.V2y5=function(b,c,f){if(this.modules[f].boardAreaW==b&&this.modules[f].boardAreaH==c)return!1;this.modules[f].boardAreaW=b;this.modules[f].boardAreaH=c;return!0};c.prototype.V2y6=function(){this.resizePlugin($($(this.V2y2)[this.V2xo]),this.V2xo)};c.prototype.V2y7=function(){return-1!=document.URL.search(/en.chessbase.com/i)||-1!=document.URL.search(/de.chessbase.com/i)||-1!=document.URL.search(/es.chessbase.com/i)};c.prototype.V2y8=
function(b,c,f,g,h,k){for(var l="",m=0;m<g.length;m++){if(g[m].title){var p=h;g[m].css&&(p+=" "+g[m].css);l+=String.f('<{6} title="{0}" id="{4}-btn{1}-{2}" class="{3}">{5}</{6}>',g[m].title,g[m].id,k,p,f,g[m].txt,b)}else l+='<span class="toolBarSep"/>';this.V2y9[k][g[m].id]=g[m].pic?g[m].pic:g[m].id}$(c).html(l);for(m=0;m<g.length;m++)g[m].id&&(b=$(String.f("#{2}-btn{0}-{1}",g[m].id,k,f)),c=function(b,c){return function(d){this.V2xo=c;g[b].handler(c,d);d.preventDefault()}}.call(this,m,k),function(b,
c){return function(b){this.V2xo=c;b.preventDefault()}}.call(this,m,k),b[0].onclick=c)};c.prototype.V2ya=function(b,c,f,g,h,k){if(c)for(var l='url( "'+CB.V5o()+'Media/Ribbons/{2}/{0}{1}.png" )',m=0;m<c.length;m++)if(c[m].id){var p=$(String.f("#{2}-btn{0}-{1}",c[m].id,h,b));p.css("background-image",String.f(l,this.V2y9[h][c[m].id],f,k));var r=g;c[m].css&&(r+=" "+c[m].css);p.attr("class",r)}};c.prototype.getKernel=function(){if("undefined"!=typeof this.V2xo){if(this.modules[this.V2xo]&&this.modules[this.V2xo].getKernel())return this.modules[this.V2xo].getKernel()}else if(this.modules[0])return this.modules[0].getKernel()};
c.prototype.V2v1=function(b,c){};c.prototype.showMessage=function(b){};c.prototype.V2yb=function(b){$("#boardArea"+b).empty();this.modules[b].boardArea=this.V2xx(this.modules[b].panels.boardParent);this.modules[b].boardArea.setVisible(!0);this.resize();this.V2y1()};c.prototype.V2yc=function(b){$("#boardArea"+b).empty();this.modules[b].boardArea=this.V2yd(this.modules[b].panels.boardParent,b);this.modules[b].boardArea.setVisible(!0);this.resize();this.V2y1()};c.prototype.V2yd=function(b,c){var f=new CB.V2ye(b,
"3d"),f=f.createCanvas(this.Vkj);this.board=new CB.BoardControl3D(f.canvas,100,100,"FritzBoard",this.Vkj.bind(this),c);this.modules[c].board3d=this.board;f.setPosSize(b.offsetLeft,b.offsetTop,b.offsetWidth,b.offsetHeight);f.setVisible(!0);return f};c.prototype.Vkj=function(b){this.modules[b].getKernel().setBoardWin(this.modules[b].board3d)};c.prototype.onControlReady=function(){};c.prototype.V2yf=function(b){CB.V1dm("Toggle3D");this.V2xm?this.V2yb(b):this.V2yc(b);this.V2xm=!this.V2xm};c.prototype.V22x=
function(){};c.prototype.V1dq=function(b){return new CB.Vrj};c.prototype.V147=function(){return!1};c.prototype.useMatBalanceDefault=function(){return!0};c.prototype.V2yg=function(){CB.V5t.V63()||CB.V5t.V64()?window.location="https://live.chessbase.com/LogonIos?returnurl="+encodeURIComponent(document.location):window.location="https://live.chessbase.com/Logon?returnurl="+encodeURIComponent(document.location)};c.prototype.log=function(b){};c.prototype.V1ql=function(b,c){6};return c}();"use strict";
CB.V1pb=function(){var c=function(b){if(!b)throw"Accountsmanager: App required";this.app=b||"playchess";this.V1qm=V35p.config.getAccountUris()[0]};c.prototype.V2yh=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")};c.prototype.pwLogin=function(b,c,f){if(b&&c){b=this.V2yi(b);var g=this.V2yj(b,"chk");this.V2yk({cmd:"chk",user:b,app:this.app,pass:this.V2yi(c),key:g},function(b){b&&f(b)})}else f({error:!0})};c.prototype.V2yl=function(b){};c.prototype.tokenLogin=
function(b,c,f){b=this.V2yi(b);var g=this.V2yj(b,"get");this.V2yk({cmd:"get",user:b,app:this.app,token:c,key:g},f)};c.prototype.V268=function(b,c,f,g,h){b=this.V2yi(b);var k=this.V2yj(b,"pw");this.V2yk({cmd:"pw",user:b,app:this.app,old:this.V2yi(c),"new":this.V2yi(f),token:g,key:k},h)};c.prototype.getFriends=function(b,c,f,g){b=this.V2yi(b);var h=this.V2yj(b,"getfr");this.V2yk({cmd:"getfr",user:b,token:c,friendtype:f,key:h},g)};c.prototype.setFriends=function(b,c,f,g,h){for(var k="",l=0;l<g.length;l++)k+=
g[l]+",";g=this.V2yi(k);b=this.V2yi(b);k=this.V2yj(b,"setfr");this.V2yk({cmd:"setfr",user:b,token:c,friendtype:f,friends:g,key:k},h)};var b;c.prototype.V2yk=function(c,e){var f=[],g;for(g in c)f.push(encodeURIComponent(g)+"="+encodeURIComponent(c[g]));var f=f.join("&"),h=this.V2yh();h.open("POST",this.V1qm);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.setRequestHeader("X-Requested-With","XMLHttpRequest");b=new CB.Timer(function(){h.abort();e({timeout:!0})});b.runOnce(3E3);
h.onload=function(){b.stop();if(4===h.readyState&&200===h.status){var c=h.responseText;e(c?JSON.parse(c):{})}else e({})};h.onerror=function(c){b.stop();e({error:!0})};h.send(f)};c.prototype.V2yj=function(b,c){0==b.Length&&(b="nameCoded");for(var f=c+b,g=b.split(""),h=c.split(""),f=f.split(""),k=0,l=0,m=0;m<f.length;m++)0!=(m&1)&&k<h.length?(f[m]=h[k],k++):l<g.length&&(f[m]=g[g.length-l-1],l++);return this.V2yi(f.join(""))};c.prototype.V2yi=function(b){b=CB.V47.V4l(b);return CB.V47.base64.encode(b)};
return c}();"use strict";"NOMINIFY=";CB.V1vg={V5k:-1,Vbe:0,WHITE:1,BLACK:2};CB.V1x3={V1x8:0,V1x7:1,V1x4:2};
CB.V2ym=function(){function c(b,c){b.push([CB.V47.V4a(c.title),c.nGames,c.cloudId,CB.V47.V4a(c.owner)])}var b={openCloudDatabase:function(){V35p.initCloudManager()},nMaxOnlineDBGames:2,selectCloudDatabase:function(b,d,g){if(!this.V27e()){for(var h=[],k=[],l=CB.V47.V48(b),m=0;m<d.size();m++)d.items[m].owner.toLowerCase()==l.toLowerCase()?c(h,d.items[m]):c(k,d.items[m]);d=[{name:"title",type:"string"},{name:"games",type:"int"},{name:"cloudId",type:"int"},{name:"owner",type:"string"}];var l=[{header:"Title",
dataIndex:"title",flex:2},{header:"Games",dataIndex:"games",flex:1},{header:"Owner",dataIndex:"owner",flex:2}],p=-1;CB.Vn8&&CB.Vn8.V2yn(b,h,k,d,l,function(b){b&&(p=b.cloudId);g(p)})}},blockLiveBookUpdates:function(b){this.getKernel().V354.blockLiveBookUpdate(b)},loadGame:function(b){this.getKernel().loadSearchResultGame(b)}},d=new CB.V35b;b.refreshOnlineDBGames=function(){this.dbGames&&this.dbGames.V94()&&(V35p.isLoggedIn()?(this.dbGames.Vtd("Searching..."),d.exec(function(){this.getKernel().V354.searchOnlineDB()}.bind(this),
300)):(this.dbGames.Vtd(lm.PLEASE_LOGIN_SHORT),this.dbGames.clear()))};b.useMatBalanceDefault=function(){return 800<window.innerHeight};b.execCommand=function(b){try{switch(b){case V35p.V358.ONLINEDB_SEARCH:this.getKernel().V354.search();break;case CB.Vlw.V22z:this.V22y()&&this.V22w().setGame(this.getKernel().game);break;case V35p.V358.OPEN_CLOUDDATABASE:this.openCloudDatabase();break;case V35p.V358.LOGIN:V35p.changeCloudLogin();break;case V35p.V358.SAVE_CLOUDDB:V35p.saveToCloud(this.getKernel().game,
0);break;case V35p.V358.REPLACE_CLOUDDB:V35p.replaceInCloud(this.getKernel().game,0);break;case V35p.V358.SAVE_WHITE_REPERTOIRE:V35p.saveToWhiteRepertoire(this.getKernel().game);break;case V35p.V358.SAVE_BLACK_REPERTOIRE:V35p.saveToBlackRepertoire(this.getKernel().game);break;case V35p.V358.CREATE_CLOUDDB:V35p.createCloudDB();break;case V35p.V358.DELETE_CLOUDDB:V35p.deleteCloudDB();break;case V35p.V358.EDIT_HEADER:V35p.editHeader(this.getKernel().game);break;case V35p.V358.LOAD_WHITE_MYMOVES:this.getKernel().boardWin.setBlackIsBottom(!1,
!0);V35p.loadMyMoves(CB.V1vg.WHITE,new CB.Game);break;case V35p.V358.LOAD_BLACK_MYMOVES:this.getKernel().boardWin.setBlackIsBottom(!0,!0);V35p.loadMyMoves(CB.V1vg.BLACK,new CB.Game);break;case V35p.V358.MARK_CURRENT_MOVE:V35p.markCurrentMove(this.getKernel(),!1);break;case V35p.V358.IMPORTANT_CURRENT_MOVE:V35p.markCurrentMove(this.getKernel(),!0);break;case V35p.V358.UNMARK_CURRENT_MOVE:V35p.unMarkCurrentMove(this.getKernel());break;case V35p.V358.UPLOAD_TO_MYMOVES:V35p.uploadToMyMoves(this.getKernel())}}catch(c){b=
V35p.V358.Vlu(b),CB.Vjg(b,c)}};b.execNotaContextMenu=function(b){if(Ext&&Ext.create&&V35p.cloudMgr){CB.V5p.V1xq("MyMove16");CB.V5p.V1xq("ImportantMove16");var c=[{text:lm.MARK_MOVE,handler:function(){V35p.markCurrentMove(V35p.panelMgr.getKernel(),!1)},iconCls:"MyMove16"},{text:lm.MARK_IMPORTANT,iconCls:"ImportantMove16",handler:function(){V35p.markCurrentMove(V35p.panelMgr.getKernel(),!0)}}];if(V35p.cloudMgr.V1xb())CB.V5p.V1xq("EraseMove16"),CB.V5p.V1xq("White16"),CB.V5p.V1xq("Black16"),CB.V5p.V1xq("Cutline16"),
c=c.concat([{text:lm.UNMARK_MOVE,iconCls:"Erase16",handler:function(){V35p.unMarkCurrentMove(V35p.panelMgr.getKernel())}},"-",{text:lm.REMOVE_TREE_FROM_HERE,iconCls:"Cutline16",handler:function(){CB.Vn8.V1wl(lm.DELETE_VARIATION_TREE,lm.REMOVE_ALL_MY_MOVES,function(b){"yes"!=b&&"ok"!=b||V35p.removeWholeTreeFromCurrentMove(V35p.panelMgr.getKernel())})}}]);else var d=V35p.V358,c=c.concat(this.getMarkEvalItems("Good16 Bad16 VeryGood16 VeryBad16 Interesting16 Dubious16 WhiteWins16 WhiteBetter16 WhiteSlightly16 Equal16 Unclear16 BlackSlightly16 BlackBetter16 BlackWins16 Compensation16".split(" "),
[d.MARK_GOOD,d.MARK_BAD,d.MARK_VERYGOOD,d.MARK_VERYBAD,d.MARK_INTERESTING,d.MARK_DUBIOUS,d.WHITE_WINS,d.WHITE_BETTER,d.WHITE_SLIGHTLY,d.EQUAL,d.UNCLEAR,d.BLACK_SLIGHTLY,d.BLACK_BETTER,d.BLACK_WINS,d.COMPENSATION],"Strong Move;Bad Move;Brilliant Move;Blunder;Interesting Move;Dubious Move;White Is Winning;White Is Better;White: Slight Advantage;Equal;Unclear;Black: Slight Advantage;Black Is Better;Black Is Winning;Compensation".split(";")));Ext.create("Ext.menu.Menu",{items:c}).showAt([b.clientX,b.clientY])}};
b.getMarkEvalItems=function(b,c,d){for(var h=[],k=0;k<b.length;k++)h.push({text:d[k],iconCls:b[k],handler:function(){var b=c[k];return function(){V35p.commands.V23g(b)}}()});return h};b.getNotaElement=function(){var b=Ext.ComponentManager.get("idNotaPanel");if(b)return b.nota};b.shakeMarkButton=function(){CB.$(".MyMove32").addClass("shakeAnimation");CB.$(".MyMove24").addClass("shakeAnimation");CB.$(".iconMarkHelp").addClass("shakeAnimation")};b.stopShakeMarkButton=function(){CB.$(".MyMove32").removeClass("shakeAnimation");
CB.$(".MyMove24").removeClass("shakeAnimation");CB.$(".iconMarkHelp").removeClass("shakeAnimation")};b.showMessage=function(b,c){this.getKernel()&&this.getKernel().boardWin&&(this.getKernel().boardWin.addMessage(b,!0),c&&(new CB.Timer(function(){this.getKernel().boardWin.destroyMessage()}.bind(this))).runOnce(c))};b.setLayoutMyMoves=function(b,c){this.V1e2&&(b?this.V1e2.notaHeaderElement.V1f9(lm.MY_MOVES_FOR+" "+(c?lm.BLACK:lm.WHITE),c?"/common/media/ribbons/Black32.png":"/common/media/ribbons/White32.png"):
this.V1e2.notaHeaderElement.V1f9(""))};b.getNotationToolBarItems=function(b){return[CB.V139.V2yo("PGN","Save16","Download Game Notation","downloadPgnId",function(){return V35p.panelMgr.getKernel().game}),"-",CB.V139.V238(lm.TEXT_AFTER,"Posttext16",b.ADD_POST_TEXT,lm.TEXT_AFTER_TIP),"-",CB.V139.V238(lm.DELETE_LINE,"DeleteLine16",b.DELETE_LINE,lm.DELETE_LINE_TIP),CB.V139.V238(lm.CUT_LINE,"CutLine16",b.CUT_LINE,lm.CUT_LINE_TIP),"-",CB.V139.V238("","MyMove16",b.MARK_CURRENT_MOVE,"Mark as 'My Move'"),
CB.V139.V238("","ImportantMove16",b.IMPORTANT_CURRENT_MOVE,"Mark as Important Move"),CB.V139.V238("","Erase16",b.UNMARK_CURRENT_MOVE,"Unmark current move"),"-",CB.V139.V238("","WhiteSlightly16",b.WHITE_SLIGHTLY,"White has a slight advantage"),CB.V139.V238("","Equal16",b.EQUAL,"The position is equal"),CB.V139.V238("","Unclear16",b.UNCLEAR,"The position ist unclear"),CB.V139.V238("","BlackSlightly16",b.BLACK_SLIGHTLY,"Black has a slight advantage"),CB.V139.V238("","WhiteBetter16",b.WHITE_BETTER,"White is better"),
CB.V139.V238("","BlackBetter16",b.BLACK_BETTER,"Black is better"),CB.V139.V238("","WhiteWins16",b.WHITE_WINS,"White is winning"),CB.V139.V238("","BlackWins16",b.BLACK_WINS,"Black is winning"),CB.V139.V238("","Compensation16",b.COMPENSATION,"Material compensation"),"-",CB.V139.V238("","InsertDiagram16",b.INSERT_DIAGRAM,lm.INSERT_DIAGRAM)]};return b}();
CB.V2yp=function(){function c(){CB.Vn8.V2ys("Name","New Database",function(b){b&&V35p.cloudMgr&&V35p.cloudMgr.V1wi(b)}.bind(this))}function b(){V35p.cloudMgr&&V35p.cloudMgr.logOff();V35p.aTBLobby&&V35p.aTBLobby.logOff();V35p.V26v();V35p.V26z();if(V35p.panelMgr.getKernel())V35p.panelMgr.getKernel().V354.onBeforeUnload();V35p.V25v();V35p.cloudMgr&&!V35p.cloudMgr.V1xb()&&V35p.V26p()}function d(){V35p.cloudMgr&&!CB.V5t.V6c()&&(CB.V5t.V64()&&(V35p.panelMgr.stopEngines&&V35p.panelMgr.stopEngines(),V35p.blurLogOffTimer=
new CB.Timer(function(){V35p.cloudMgr.logOff()}),V35p.blurLogOffTimer.runOnce(6E4)),V35p.cloudMgr.V1xb()||V35p.V26p())}function e(){V35p.blurLogOffTimer&&V35p.blurLogOffTimer.stop()}function f(){document.hidden?d():e()}return{initCloudManager:function(){if(void 0!==V35p.cloudMgr)V35p.cloudMgr.isLoggedIn()?V35p.cloudMgr.V1vk():this.loginToCloud();else{V35p.V34z.userName||(V35p.V34z.userName=CB.DOM.V1xh(!0));V35p.V34z.userName||(V35p.V34z.userName=CB.DOM.getCodedCookie("AccountBackName64",!0));V35p.V34z.loginMode=
CB.LoginMode.NORMAL;var b=CB.DOM.V1xg("AccountToken")||V35p.V34z.V1p3;b&&V35p.V34z.userName&&"guest"!=V35p.V34z.userName?(V35p.V34z.V1p3=b,this.createCloudManager(!0,null,b)):V35p.V34z.V1p9()?this.createCloudManager(!0):CB.Vn8&&CB.Vn8.V27q("ChessBase Game Cloud",V35p.V34z,function(b){this.createCloudManager(b)}.bind(this),function(){CB.V139.V13b()},{})}},createCloudManager:function(c,h,k){CB.DOM.V1pc(V35p.V34z.userName);V35p.config.V1vm||CB.V139.V13a(lm.CONNECTING);V35p.cloudMgr=new CB.Server.CloudManager;
V35p.cloudMgr.onServerDown=this.onServerDown.bind(this);V35p.cloudMgr.onInvalidPassword=this.changeCloudLogin.bind(this);var l=V35p.V34z.userName,m=CB.LoginMode.NORMAL;c||(l="Guest",m=CB.LoginMode.GUEST);V35p.cloudMgr.V1vi(this.config.getCloudServerUris(),l,V35p.V34z.password,m,k);window.addEventListener("beforeunload",b);V35p.V26n||window.addEventListener("unload",b);window.addEventListener("blur",d);window.addEventListener("focus",e);window.addEventListener("visibilitychange",f);V35p.cloudMgr.V1q8();
V35p.cloudMgr.V1wg(h);V35p.initCloudListeners(V35p.cloudMgr);V35p.panelMgr.getKernel()&&(V35p.panelMgr.getKernel().game.addOnResetGameListener(function(){V35p.cloudMgr&&V35p.cloudMgr.Vnu()}),V35p.panelMgr.getKernel().game.addOnNotaDoubleClickListener(function(){V35p.onNotaDoubleClick()}))},connectCloudManager:function(b,c,d){CB.DOM.V1pc(V35p.V34z.userName);V35p.config.V1vm||CB.V139.V13a(lm.CONNECTING);var e=V35p.V34z.userName,f=CB.LoginMode.NORMAL;b||(e="Guest",f=CB.LoginMode.GUEST);V35p.cloudMgr.V1q2(e,
V35p.V34z.password,f,d);V35p.cloudMgr.V1wg(c)},initCloudListeners:function(b){V35p.panelMgr.tbBook&&V35p.panelMgr.tbBook.initCloudListener(b);V35p.panelMgr.getKernel()&&V35p.panelMgr.getKernel().V354.initCloudListener&&V35p.panelMgr.getKernel().V354.initCloudListener(b)},onServerDown:function(){this.config.V1vm||alert("Sorry, cloud server is currently in maintenance, please wait a few minutes.")},onTokenLoginOk:function(){this.initCloudManager()},onInvalidPassword:function(){},shouldRequestCloudDBsOnLogin:function(){return!1},
loginToCloud:function(b){var c=CB.DOM.V1xg("AccountToken");if(c){var d=CB.DOM.V1xh(!0);d&&(V35p.V34z.userName=d);V35p.V34z.loginMode=CB.LoginMode.NORMAL;V35p.V34z.V1p3=c;void 0===V35p.cloudMgr?this.createCloudManager(!0,b,c):this.connectCloudManager(!0,b,c)}else this.changeCloudLogin(b)},changeCloudLogin:function(b){if(CB.Vn8){var c=CB.DOM.V1xh(!0);c||(c=CB.DOM.getCodedCookie("AccountBackName64",!0));c&&(V35p.V34z.userName=c);CB.Vn8.V27q("ChessBase Game Cloud",V35p.V34z,function(c){void 0===V35p.cloudMgr?
this.createCloudManager(c,b):this.connectCloudManager(c,b)}.bind(this),function(){CB.V139.V13b()},{guestBtn:!1,createBtn:!0,forgotBtn:!0})}},saveToCloud:function(b){var c=function(){CB.Vn8.V2yr(b.hdr,function(){b.fireOnHeaderChanged();V35p.cloudMgr.V1wr(b)}.bind(this))}.bind(this);void 0===V35p.cloudMgr||V35p.cloudMgr.V1qg()?V35p.loginToCloud(c):c()},replaceInCloud:function(b){var c=function(){CB.Vn8.V2yr(b.hdr,function(){b.fireOnHeaderChanged();V35p.cloudMgr.V1ws(b)}.bind(this))}.bind(this);void 0===
V35p.cloudMgr||V35p.cloudMgr.V1qg()?V35p.loginToCloud(c):c()},editHeader:function(b){CB.Vn8.V2yr(b.hdr,function(){b.fireOnHeaderChanged();V35p.cloudMgr.V1wt(b)&&V35p.cloudMgr.V1ws(b)})},saveToWhiteRepertoire:function(b){alert("NOTIMPL")},saveToBlackRepertoire:function(b){alert("NOTIMPL")},createCloudDB:function(){void 0===V35p.cloudMgr||V35p.cloudMgr.V1qg()?this.loginToCloud():c.bind(this)()},deleteCloudDB:function(){void 0===V35p.cloudMgr||V35p.cloudMgr.V1qg()?this.loginToCloud():V35p.cloudMgr.V1wj()},
setLoggedIn:function(b){b?this.V272()||(document.title=this.V25o+" - "+V35p.V34z.userName):(V35p.cloudMgr&&V35p.cloudMgr.isLoggedIn()&&(V35p.cloudMgr.V1xb()&&V35p.panelMgr.getKernel().newGame(),V35p.cloudMgr.logOff(),delete V35p.cloudMgr),this.panelMgr.V1wd&&this.panelMgr.V1wd(null),this.V272()||(document.title=this.V25o+" - not logged in"),this.V27r=!1);this.superClass.setLoggedIn.apply(this,arguments)},loadMyMoves:function(b,c){V35p.checkCloudLoggedIn()&&V35p.panelMgr.getKernel().V354.mayLoadGames()&&
(V35p.cloudMgr.V1xb()||(V35p.prevGame=new CB.Game,V35p.prevGame.assign(V35p.panelMgr.getKernel().game)),V35p.panelMgr.getKernel().V354.shouldRefreshOnlineDB=!0,V35p.cloudMgr.loadMyMoves(b,c),V35p.panelMgr.blockLiveBookUpdates(CB.V1x3.V1x8))},restorePrevGame:function(){V35p.prevGame&&V35p.panelMgr.getKernel().V354.getFnLoadSearchResult().call(V35p.panelMgr.getKernel(),V35p.prevGame)},removeWholeTreeFromCurrentMove:function(b,c){if(V35p.checkCloudLoggedIn()&&b.game.getMoveOffs()<=b.game.getCurLine().length){var d=
new CB.Game,e=b.game.getMoveOffs();c&&(e=b.game.getLineStartMoveNo());for(var f=0;f<e;f++)d.makeMove(b.game.getCurLine()[f]);if(e=b.game.getCurLine()[f])e=new CB.Veh(e.from,e.to,e.prom),V35p.cloudMgr.V1x1(d.getCurPos(),e,V35p.cloudMgr.V1vf),d.gotoPrev()}},markCurrentMove:function(b,c){V35p.panelMgr.stopShakeMarkButton();c=c||!1;if(V35p.checkCloudLoggedIn()&&b.game.getMoveOffs()<=b.game.getCurLine().length&&this.checkMyMovesLoadedForOtherSide(!b.getCurPos().getBTM())){b.game.deleteAnno(CB.AnnoType.Vgo);
c?b.addSymbol(CB.Vlk.Vuc):b.addSymbol(CB.Vlk.Vub);var d=this.cloneGameToCurPos(b.game);V35p.cloudMgr.V1wu(d,c?3:2);var d=new CB.Vib,e=b.game.getLastMove();if(e){var f=b.getCurPos().getMoveNum(),d=d.getMoveNota(e,f),e=d+" "+lm.MARKED;c&&(e=d+" "+lm.MARKED_IMPORANT);b.boardWin.addMessage(e,!0);(new CB.Timer(function(){b.boardWin.destroyMessage()})).runOnce(2E3);V35p.cloudMgr.V1wx(!b.getCurPos().getBTM())&&(d=this.cloneGameToCurPos(b.game,2),V35p.cloudMgr.loadMyMoves(V35p.cloudMgr.V1vf,d))}}},checkMyMovesLoadedForOtherSide:function(b){if(0==
this.panelMgr.getKernel().game.getMoveNo())V35p.panelMgr.showMessage(lm.ENTER_OR_CLICK_MOVE_AND_MARK,5E3);else{var c;switch(V35p.cloudMgr.V1vf){default:case CB.V1vg.Vbe:b=!0;break;case CB.V1vg.BLACK:c=lm.CAUTION_YOU_ARE_EDITING_MOVES_FOR+" "+lm.BLACK+".";break;case CB.V1vg.WHITE:b=!b,c=lm.CAUTION_YOU_ARE_EDITING_MOVES_FOR+" "+lm.WHITE+"."}b||V35p.panelMgr.showMessage(c);return b}},makeMainMoveOrder:function(b){if(V35p.checkCloudLoggedIn()&&b.game.getMoveOffs()<=b.game.getCurLine().length){for(var c=
new CB.Game,d=0;d<b.game.getMoveOffs();d++)c.makeMove(b.game.getCurLine()[d]);V35p.cloudMgr.makeMainMoveOrder(c);c=new CB.Vib;if(d=b.game.getLastMove()){var e=b.getCurPos().getMoveNum(),c=c.getMoveNota(d,e);b.boardWin.addMessage(c+" is main move order.",!0);(new CB.Timer(function(){b.boardWin.destroyMessage()})).runOnce(2E3);V35p.cloudMgr.V1wx(!b.getCurPos().getBTM())&&V35p.cloudMgr.V1x2()}}},unMarkCurrentMove:function(b){if(V35p.checkCloudLoggedIn()&&b.game.getMoveOffs()<=b.game.getCurLine().length&&
this.checkMyMovesLoadedForOtherSide(!b.getCurPos().getBTM())){var c=b.game.getLastMove();if(c){b.game.deleteAnno(CB.AnnoType.Vgo);var d=new CB.Position;b.game.enableEvents(!1);b.game.gotoPrev();d.V42(b.game.getCurPos());b.game.gotoNext();V35p.cloudMgr.V1x0(d,c);b.game.enableEvents(!0);var d=new CB.Vib,e=b.getCurPos().getMoveNum(),c=d.getMoveNota(c,e);b.boardWin.addMessage(c+" cleared.",!0);(new CB.Timer(function(){b.boardWin.destroyMessage()})).runOnce(2E3);V35p.cloudMgr.V1wx(!b.getCurPos().getBTM())&&
(c=this.cloneGameToCurPos(b.game,2),V35p.cloudMgr.loadMyMoves(V35p.cloudMgr.V1vf,c))}}},uploadToMyMoves:function(b){V35p.checkCloudLoggedIn()&&(b.boardWin.addMessage(lm.GAME_UPLOADED,!0),V35p.cloudMgr.uploadToMyMoves(b.game),(new CB.Timer(function(){b.boardWin.destroyMessage()})).runOnce(2E3),V35p.cloudMgr.V1x2())},isCloudLoggedIn:function(){return V35p.cloudMgr&&V35p.cloudMgr.isLoggedIn()},checkCloudLoggedIn:function(){if(V35p.cloudMgr){if(V35p.cloudMgr.isLoggedIn())return!0;if(V35p.cloudMgr.wasLoggedIn()&&
!V35p.cloudMgr.Vrb())return V35p.cloudMgr.V1q7(),!0}V35p.panelMgr.showMessage(lm.PLEASE_LOGIN_OPENINGS,3E3);return!1},cloneGameToCurPos:function(b,c){for(var d=new CB.Game,e=0;e<b.getMoveOffs()&&e<(c||999);e++){var f=b.getCurLine()[e];if(f)d.makeMove(new CB.Veh(f.from,f.to,f.prom));else{alert("game logic problem");break}}return d},onNotaDoubleClick:function(){var b=this.cloneGameToCurPos(V35p.panelMgr.getKernel().game,V35p.panelMgr.getKernel().game.getMoveOffs()-5);this.loadMyMoves(V35p.cloudMgr.V1vf,
b);V35p.panelMgr.refreshOnlineDBGames&&V35p.panelMgr.refreshOnlineDBGames()},notifyMyMovesChanged:function(){this.cloudMgr.V1vl(this.panelMgr.getKernel().game.getCurPos());this.cloudMgr.V1wx(this.panelMgr.getKernel().getCurPos().getBTM())&&this.cloudMgr.V1x2()}}}();
CB.V2yt=function(){var c={createGUIElements:function(b){this.superClass.createGUIElements.call(this,b);b.shouldAnimatePosChange=this.shouldAnimatePosChange.bind(this);this.setDefaultAnimSteps(b)},setDefaultAnimSteps:function(b){if(this.kernel)var c=b||this.kernel.boardWin;c&&(CB.V5t.V64()?c.animSteps={forMove:.3,forPosition:.3}:c.animSteps={forMove:.6,forPosition:.6})},shouldAnimatePosChange:function(){return this.V2yu},blockLiveBookUpdate:function(b){if(this.V2yv!=CB.V1x3.V1x4||b!=CB.V1x3.V1x8)this.V2yv=
b},onAnnotate:function(){return V35p.cloudMgr&&V35p.cloudMgr.V1xb()?(V35p.panelMgr.showMessage("Cannot annotate 'My Moves'",3E3),!1):this.canAnnotateLoadedGames()},onTextAnno:function(b,c){if(c){if(V35p.cloudMgr&&V35p.cloudMgr.V1xb()){var f=V35p.cloneGameToCurPos(this.kernel.game);V35p.cloudMgr.V1wy(f,b);return!0}}else V35p.cloudMgr&&V35p.cloudMgr.V1xb()&&V35p.panelMgr.showMessage("'My Moves' can only have text after a move.");if(this.canAnnotateLoadedGames())return!0;V35p.panelMgr.showMessage("You can only annotate your own moves");
return!1},onEval:function(b){if(V35p.cloudMgr&&V35p.cloudMgr.V1xb()){var c=this.kernel.game.getAnno(CB.AnnoType.Vgo);c&&c.hasExclusiveEval(b)&&(b=0);c=V35p.cloneGameToCurPos(this.kernel.game);V35p.cloudMgr.V1ww(c,b);return!0}if(this.canAnnotateLoadedGames())return!0;V35p.panelMgr.showMessage("You can only annotate your own moves");return!1},canAnnotateLoadedGames:function(){return!1},onPromoteLine:function(){return V35p.cloudMgr&&V35p.cloudMgr.V1xb()?(V35p.panelMgr.showMessage("Line ordering is automatic in 'My Moves'"),
!1):!0},onDeleteLine:function(){if(V35p.cloudMgr&&V35p.cloudMgr.V1xb())return CB.Vn8.V1wl(lm.DELETE_VARIATION_TREE,lm.REMOVE_ALL_MY_MOVES,function(b){"yes"!=b&&"ok"!=b||V35p.removeWholeTreeFromCurrentMove(this.kernel,!0)}.bind(this)),!1;if(this.canAnnotateLoadedGames())return!0;V35p.panelMgr.showMessage("You can only annotate your own moves");return!1},onCutLine:function(){if(V35p.cloudMgr&&V35p.cloudMgr.V1xb())return CB.Vn8.V1wl(lm.DELETE_VARIATION_TREE,lm.REMOVE_MOVES_FROM_HERE,function(b){"yes"!=
b&&"ok"!=b||V35p.removeWholeTreeFromCurrentMove(this.kernel)}.bind(this)),!1;if(this.canAnnotateLoadedGames())return!0;V35p.panelMgr.showMessage("You can only annotate your own moves");return!1},cloudOnEnteredMove:function(b){try{var c=V35p.panelMgr.getNotaElement();c&&c.focus();if(V35p.cloudMgr&&V35p.cloudMgr.V1wx(this.kernel.getCurPos().getBTM())){var f=V35p.cloneGameToCurPos(this.kernel.game);f.getCurPos().preCalcCtx(b);f.makeMove(b);V35p.cloudMgr.V1wu(f,b,1)}}catch(g){alert("CloudEnter: "+g)}},
newGame:function(){delete this.kernel.game.replaceGameNo;delete this.kernel.game.replaceDBId;V35p.cloudMgr&&V35p.cloudMgr.Vnu();V35p.panelMgr.setLayoutMyMoves(!1)},searchOnlineDB:function(){if(V35p.panelMgr.dbGames||V35p.panelMgr.V1iu&&V35p.panelMgr.V1iu()){var b=new CB.V1iv;b.setSearchBoard(this.kernel.game.getCurPos().board,this.kernel.game.getCurPos().getSideToMove());b.setUseBoard(!0);null!=V35p.onlineLobby&&V35p.onlineLobby.search(b,this.getOnlineDBMaxGames(),this.kernel.game.getMoveNo())}},
getOnlineDBMaxGames:function(){return this.nMaxOnlineDBGames},getFnLoadSearchResult:function(){return function(b){this.V354.beforeGameLoad();this.V354.V2yu=!1;V35p.panelMgr.setLayoutMyMoves.call(V35p.panelMgr,!1);var c=ObjUtil.clone(this.game),f=c.getCurPos();void 0!==this.boardWin.prepareFullRedraw&&this.boardWin.prepareFullRedraw();this.game.assign(b,!0);b=0;if(this.game.isNormalInit())for(;60>++b&&!this.game.V2yw(f,!0)&&0<c.getMoveOffs();)c.gotoPrev(!0),f=c.getCurPos();this.game.fireOnResetGame();
this.game.fireOnChanged();this.game.fireOnCurPosChanged();this.game.fireOnHeaderChanged();this.game.isNormalInit()||this.game.gotoFirst();this.V354.V2yu=!0;this.V354.Vr9()}}},b=new CB.V35b;c.updateCloudOnGamePos=function(){this.V2yv!=CB.V1x3.V1x7&&b.exec(function(){V35p.panelMgr.tbBook&&V35p.aTBLobby&&V35p.aTBLobby.Vte&&(this.V2yx||!this.Vt5||!this.Vt5.equals(this.kernel.game.getCurPos())||this.V2yv==CB.V1x3.V1x4)&&(this.V2yv=CB.V1x3.V1x8,this.Vt5=ObjUtil.clone(this.kernel.game.getCurPos()),V35p.panelMgr.tbBook.clear(),
(V35p.panelMgr.tbBook.V94()||this.checkCloudWithHiddenBook())&&V35p.aTBLobby.Vt6(this.kernel.game.getCurPos()),V35p.panelMgr.tbPanel&&(V35p.panelMgr.tbPanel.V94()||this.checkCloudWithHiddenBook())&&V35p.aTBLobby.Vtb(this.kernel.game.getCurPos()),this.lbInfo=null,this.V2yy=[],V35p.cloudMgr&&(V35p.panelMgr.tbBook&&V35p.panelMgr.tbBook.V94()||this.checkCloudWithHiddenBook())&&(this.V2yy=null,!V35p.cloudMgr.isLoggedIn()&&V35p.cloudMgr.wasLoggedIn()?V35p.cloudMgr.V1q7():V35p.cloudMgr.V1vl(this.kernel.game.getCurPos(),
this.V2yx,this.V2yz)),this.setDefaultAnimSteps())}.bind(this),200)};c.checkCloudWithHiddenBook=function(){return!1};c.initCloudListener=function(b){b.addOnMyMovesListener(this.myMovesListener.bind(this));V35p.addOnAccountTypeListener(this.V355Listener.bind(this))};c.myMovesListener=function(b){this.V2yy=b.moves};c.V355Listener=function(b){switch(b.type){default:case 1:this.nMaxOnlineDBGames=5;break;case 2:this.nMaxOnlineDBGames=30;break;case 3:this.nMaxOnlineDBGames=50}};return c}();
CB.V2z0={V2z1:function(c,b){return CB.V139.V25y(b,"Databases","Cloud",["Open Cloud Database","Login","Save Game"],["Cloud16","Login16","Save16"],[c.OPEN_CLOUDDATABASE,c.LOGIN_CLOUDDB,c.SAVE_CLOUDDB],c.OPEN_CLOUDDATABASE,"Open database and save games")},V2z2:function(c){return CB.V139.V25y(32,"Open","Open",["Open Cloud Database","Open PGN File"],["Cloud16","Open16"],[c.OPEN_CLOUDDATABASE,c.OPEN_PGN_DATABASE],c.OPEN_CLOUDDATABASE)},V2z3:function(c,b){return CB.V139.V25y(b,lm.DATABASES,"Cloud",[lm.OPEN_DATABASE,
lm.CREATE_DATABASE,lm.DELETE_DATABASE],["Cloud16","CreateCloudDB16","Delete16"],[c.OPEN_CLOUDDATABASE,c.CREATE_CLOUDDB,c.DELETE_CLOUDDB],void 0,lm.DATABASE_FUNCTIONS)},V2z4:function(c,b){return CB.V139.V2z5(b,lm.MARK_MOVE,"MyMove",c.MARK_CURRENT_MOVE,"Mark the current move as 'my move' to create a repertoire that you can drill.")},V2z6:function(c,b){return CB.V139.V2z5(b,lm.LOAD_WHITE,"White",c.LOAD_WHITE_MYMOVES,"Load your White repertoire (marked moves) from the current position.")},V2z7:function(c,
b){return CB.V139.V2z5(b,lm.LOAD_BLACK,"Black",c.LOAD_BLACK_MYMOVES,"Load your Black repertoire (marked moves) from the current position.")},V2z8:function(c,b,d,e){var f=[lm.MARK_MOVE,lm.MARK_IMPORTANT,lm.UNMARK_MOVE],g=["MyMove16","ImportantMove16","Erase16"],h=[c.MARK_CURRENT_MOVE,c.IMPORTANT_CURRENT_MOVE,c.UNMARK_CURRENT_MOVE];d&&(f=f.concat(["-",lm.LOAD_WHITE,lm.LOAD_BLACK]),g=g.concat(["","White16","Black16"]),h=h.concat([null,c.LOAD_WHITE_MYMOVES,c.LOAD_BLACK_MYMOVES]));e&&(f.push(lm.UPLOAD_GAME),
g.push("Upload16"),h.push(c.UPLOAD_TO_MYMOVES));return CB.V139.V25y(b,lm.MY_MOVES,"MyMove",f,g,h,void 0,lm.MY_MOVE_MENU_TTIP)},V2z9:function(c,b){return CB.V139.V2z5(b,"Cloud Databases","Cloud",c.OPEN_CLOUDDATABASE,"Open the list of your databases (cloud)")},V2za:function(c,b){return CB.V139.V2z5(b,"Save","Save",c.SAVE_CLOUDDB,"Append game to the current cloud database")},V2zb:function(c,b){return CB.V139.V25y(b,lm.SAVE,"Save",[lm.SAVE,lm.SAVE_AS_NEW,lm.EDIT_GAME],["Replace16","Save16","Edit16"],
[c.REPLACE_CLOUDDB,c.SAVE_CLOUDDB,c.EDIT_HEADER],void 0,lm.SAVE_AND_REPLACE_GAMES)},V2zc:function(c,b){return V35p.V260(b)}};
CB.V27k=function(){return{onLogin:function(){this.gameKernel&&this.gameKernel.game.fireOnChanged({forceUpdate:!0});this.setLoginHtml(V35p.isLoggedIn())},setLoginHtml:function(c){if(this.V27l){if(c)this.V27l.V1y4(450<window.innerHeight?28:20),Ext.apply(this.V27l,{overflowY:"auto"}),this.V27l.update('<div class="CBInfoLoggedIn">'+this.getLoggedInHtml()+"</div>"),this.V27l.V27m(this.getLoginInfoGradient()+";color:white;text-transform:uppercase");else{var b=window.innerHeight/3;this.V27n&&this.V27n.el&&
(b=this.V27n.V27o());CB.V5t.V64()&&900>window.innerHeight?this.V27l.V1y4(Math.min(b,120)):this.V27l.V1y4(Math.min(b,160));Ext.apply(this.V27l,{overflowY:"scroll"});this.V27l.update('<div class="CBInfoNotLoggedIn">'+this.getPleaseLoginHtml()+"</div>");this.V27l.V27m(CB.V5p.V1xn("rgba(254, 254,252,255)","rgba( 251, 251,247,255)")+";color:black;text-transform:none;")}this.V27l.V25n=c;V35p.V34z.V1oo()&&this.V27l.el&&this.V27l.setVisible(!1)}},getLoginInfoGradient:function(){return CB.V5p.V1xn("rgba(6, 216,19,255)",
"rgba(24, 147,23,255)")},getPleaseLoginHtml:function(c){c=CB.V5p.getHeader("h3",lm.LOGIN_PLEASE_LOGIN,"margin-top:4px");c+=this.getLoginInviteHeader()+"<br/>";if(!CB.V5t.V64()||900<window.innerHeight)c+=this.getFunctionalityText()+"<br/>",c+=lm.LOGIN_ACCOUNT_FREE+"<br/><br/>";return c+=this.genCreateAccountLink()},genCreateAccountLink:function(){return'<a href="'+V35p.config.createAccountWebUrl+'" style="color:#8B0A16">'+lm.LOGIN_CREATE_LINK+"</a>"},getLoggedInHtml:function(){return String.f(lm.LOGIN_WELCOME,
V35p.V34z.userName)},getLoginInviteHeader:function(){return String.f(lm.GENERAL_INVITE,V35p.V25o)},getFunctionalityText:function(){return lm.PLEASE_LOGIN},resizeInfoPanel:function(){var c=!1;if(this.V27l&&this.V27l.el)if(this.V27l.V25n){var b=22;450<window.innerHeight&&(b=650<window.innerHeight?30:26);this.V27l.V1y4(b);c=!0}else this.V27n&&(b=Math.min(220,Math.max(20,.3*this.V27n.V27o())),this.V27l.V1y4(b));return c}}}();
CB.V27p=function(){return{accountLogin:function(c){V35p.V34z.userName=CB.DOM.V1xh(!0)||V35p.V34z.userName;V35p.V34z.V1p3=CB.DOM.V1xg("AccountToken");if(!c&&V35p.V34z.V1p3&&V35p.V34z.userName&&"guest"!=V35p.V34z.userName)(new CB.V1pb(V35p.V26d)).tokenLogin(V35p.V34z.userName,V35p.V34z.V1p3,this.tokenLoginHandler.bind(this));else this.onRequestLogin()},onRequestLogin:function(){this.enterLoginForm()},enterLoginForm:function(c){var b=this.V25n;CB.Vn8?CB.Vn8.V27q(V35p.appName,V35p.V34z,function(){this.setLoggedIn(!1);
(new CB.V1pb(V35p.V26d)).pwLogin(V35p.V34z.userName,V35p.V34z.password,this.receiveTokenHandler.bind(this))}.bind(this),function(){CB.V139&&CB.V139.V13b();b||this.setLoggedIn(!1)}.bind(this),{infoMsg:c,guestBtn:!1,createBtn:!0,forgotBtn:!0}):b||this.setLoggedIn(!1)},tokenLoginHandler:function(c){c&&1!=c.ResultType&&!c.timeout?(this.setLoggedIn(!1),this.enterLoginForm()):c.timeout?(CB.DOM.V1p4("AccountToken"),this.setLoggedIn(!1)):(this.setLoggedIn(!0),this.onTokenLoginOk());this.V27r=!1},onTokenLoginOk:function(){},
receiveTokenHandler:function(c){if(c&&c.Token)c=unescape(c.Token),V35p.V34z.V1p3=c,V35p.V34z.V1p7(),CB.DOM.V1pc(V35p.V34z.userName),this.setLoggedIn(!0),CB.V139&&CB.V139.V13a("Logged in OK: "+V35p.V34z.userName),CB.Timer.V4s(function(){CB.V139&&CB.V139.V13b()},600),this.onTokenLoginOk();else{if(c&&1!=c.Result&&!c.timeout)this.onInvalidToken();c.timeout&&CB.DOM.V1p4("AccountToken","");this.setLoggedIn(!1);this.V27r=!1}},onInvalidToken:function(){this.enterLoginForm(String.formatEx(lm.PW_INVALID,V35p.V34z.userName))},
isLoggedIn:function(){return this.V25n||this.V27r},setLoggedIn:function(c){this.superClass.setLoggedIn.apply(this,arguments);c?document.title=this.V25o+" - "+V35p.V34z.userName:(document.title=this.V25o+" - not logged in",this.V27r=!1)}}}();"use strict";CB.ReaderMode={LIVE:1,REPLAY:2,DIAGRAM:3,TABLE:4,V2zd:5};
CB.V2ze=function(){function c(b){return new CB.Vsl(b,1,{hintTimeout:20,liveBookSilent:!0})}function b(b){return new CB.V2zt(b)}function d(b,c){"number"!==typeof b&&(b=0);"number"!==typeof c&&(c=0);return c-b}function e(b,c,d){if(c)for(var e=0;e<V35p.panelMgr.modules[b].kernel.length;e++)if(V35p.panelMgr.modules[b].kernel[e].idGame==c)return V35p.panelMgr.modules[b].kernel[e];return V35p.panelMgr.modules[b].getKernel(d)}var f=function(b){this.V2y2=".cbreplay,.cblive,.cbdiagram,.cbtable,.cbpairing";
f.superClass.call(this,b);this.init();TRACE(window.innerWidth+"/"+window.innerHeight+"/"+window.devicePixelRatio)};CB.inherit(f,CB.V2xl);f.prototype.init=function(){this.superClass.init.call(this);this.modules=[];this.V1bl=[];this.chat=[];this.book=[];this.V2xy=-1;this.V1im=this.engineOpen=!1;this.V2zf=[];this.V2zg=[];this.V2zh=[];this.V2y9=[];this.V2zi=[];this.V2zj=[];this.V2zk=[]};f.prototype.V2zl=function(){this.V2zm()};f.prototype.V16e=function(){V35p.lobby&&(V35p.lobby.V2ul(this.V2us),V35p.playerLobby&&
V35p.playerLobby.addOnConnectedListener(this.V2zn.bind(this)))};f.prototype.V2zm=function(){this.V2zo();V35p.addOnLoginListener(this.V2zp.bind(this));this.V2zq()};f.prototype.V2y0=function(){var b=this.V2zr();TRACE("Was Verti"+b);this.V2xs();TRACE("Is Verti"+this.isVerti);return b!=this.V2zr()?($(this.V2y2).each(function(b,c){if(this.isLive(b)){for(var d=0;d<this.modules[b].list.length;d++)V35p.lobby.setSessionToBackground(this.modules[b].ticket,this.modules[b].list[d].id);$(c).empty(".root");delete this.modules[b].boardArea}}.bind(this)),
this.init(),this.V2zo(),this.V2zs(V35p.isLoggedIn()),this.V2zq(),V35p.lobby&&null!=V35p.lobby.V2ul&&V35p.lobby.V2ul(this.V2us),!0):!1};var g=0;f.prototype.V2zo=function(){this.V2xs();var c=0,d=function(b,d,e,f,g,h){this.V2xr=!0;this.V2y9[b]={};this.V2zu(d);var k=$(d).text();k&&$(d).text("");e=this.V2zv(d,c,e);f(e,c,k);this.modules.push(e);e.addKernel(this);f=h(d,c,e.getKernel(),"100%");e.panels=f;e.nota=f.nota;e.undo=[];e.redo=[];e.onBoardReady=function(){V35p.V1ft.V1gi()};$(d).on("click",function(b){return function(c){this.V2xo!=
b&&0<=this.V2xo&&this.V2zw(this.V2xo);this.V2xo!=b&&this.V2zx(b);this.V2xo=b}.bind(this)}.call(this,c));f.boardParent&&(e.boardArea=this.V2xx(f.boardParent));e.engineOpen=!1;g(e,c,k);c++;e.mode==CB.ReaderMode.LIVE&&($("#listParent"+b).text(lm.CONNECTING),$("#listParent"+b).addClass("msgInListParent"))},e=this,f=1;$(this.V2y2).each(function(c,g){$(g).is(".cbreplay")?e.doCreateReplayPlugin(g,c,d):$(g).is(".cblive")?(e.doCreateLivePlugin(g,c,d,f),f++):$(g).is(".cbdiagram")?e.doCreateDiagramPlugin(g,
c,d):$(g).is(".cbtable")?e.doCreateTablePlugin(g,c,d):$(g).is(".cbpairing")&&d.call(this,c,g,b,function(b){b.mode=CB.ReaderMode.TABLE},function(b,c,d){b.getKernel().fnInitGame=function(){};this.V2zy(g,c)}.bind(this),function(b,c,d,e){return this.V2zz(b,c)}.bind(this))}.bind(this));V35p.isLive=0<$(".cblive").length;V35p.isAnyPlugin=0<$(this.V2y2).length;$(document.body).on("keydown",function(b){this.chat[this.V2xo]&&this.chat[this.V2xo].hasFocus()||this.V23j(b,this.V2xo||0)&&b.preventDefault()}.bind(this));
$(document.body).on("orientationchange",function(b){this.V300()}.bind(this));this.pluginCnt=c};f.prototype.doCreateReplayPlugin=function(c,d,e){e.call(this,d,c,b,function(b,c){b.mode=CB.ReaderMode.REPLAY},function(b,d,e){b.getKernel().fnInitGame=this.V301(c,d);this.V302(c,this.V303.bind(this),d,e);b.toPgn=function(b){if(b=this.modules[b].pgnDatabase)return b.toString()}.bind(this)}.bind(this),function(b,c,d,e){return this.V2zr()?this.V304(b,c,d,e):this.V305(b,c,d,e)}.bind(this))};f.prototype.doCreateLivePlugin=
function(b,d,e,f){e.call(this,d,b,c,function(b){b.mode=CB.ReaderMode.LIVE},function(c){c.requestData=this.V306(b,f,d,this,c.ticket);c.pgnTitle="LiveGames_"+c.requestData.event+".pgn";c.list=[];c.toPgn=this.V307.bind(this);this.resizePlugin($(b),d)}.bind(this),function(b,c,d,e){return this.V2zr()?this.V304(b,c,d,e):this.V305(b,c,d,e)}.bind(this))};f.prototype.doCreateDiagramPlugin=function(b,c,d){d.call(this,c,b,function(b){b=new CB.Vsl(b,1,{hintTimeout:20,liveBookSilent:!0});b.Vtg=function(){return CB.Vhr.Vhv};
b.onEntry=function(){this.Vt3.exec(function(){V35p.analysisEngine&&V35p.analysisEngine.Vt4(this.kernel)}.bind(this),100)};return b},function(b){b.mode=CB.ReaderMode.DIAGRAM},function(d,e,f){d.toPgn=function(b){b=this.modules[b].getKernel().game;return CB.V12k.V12l(b)}.bind(this);d.pgnTitle="Position.pgn";d.getKernel().fnInitGame=this.V308(b,c,this,f);this.V1dt($(b),c)}.bind(this),function(b,c,d,e){this.V309(b,c,d);return this.V30a(b,c,d)}.bind(this))};f.prototype.doCreateTablePlugin=function(c,d,
e){e.call(this,d,c,b,function(b){b.mode=CB.ReaderMode.TABLE},function(b,d,e){b.getKernel().fnInitGame=function(){};this.V30b(c,d)}.bind(this),function(b,c,d,e){return this.V2zz(b,c)}.bind(this))};f.prototype.V2zu=function(b){$(b).hasClass("cbtable")||$(b).hasClass("cbdiagram")||$(b).hasClass("cbpairing")||((CB.V5t.V64()||this.V2zr())&&$(b).css("min-width",220),this.V2zr()?CB.V5t.V72()&&(CB.V5t.V67()?b.style.height="100vh":b.style.height="92vh"):b.style.minHeight="400px",b.style.clear="both")};f.prototype.V30a=
function(b,c,d,e){(d=b.dataset.size)?$(b).width(d+"px"):$(b).width(400);return{nota:null,boardParent:this.V30c(b,c)}};f.prototype.V2zz=function(b,c){return{nota:null,boardParent:null}};f.prototype.V30d=function(b,c,d,e,f,g,h){if(d.Players){d=CB.Tournament.V2vh(d);g=CB.V2vu.V2vw(g);f=new CB.V2vr(g,f);var k=new CB.Ranking(d,e,f,h);this.modules[c].ranking=k;e=$(b).width();k.addListener("Changed",function(){$(b).width();this.V30e(b,c);k.resized||(k.resized=!0)}.bind(this));e=k.toHtml(e)[0];b.appendChild(e);
this.V30e(b,c)}};f.prototype.V30f=function(b,c,d,e,f){c=CB.Tournament.V2vh(d);f=new CB.Ranking(c,1E4,{tiebreakInfosArr:[]},f);e=(new CB.V2xg(f)).V2xi(e)[0];b.appendChild(e)};var h=new CB.V35b,k=new CB.V35b,l=new CB.V35b;f.prototype.V305=function(b,c,d,e){this.modules[c].noBook=null!=b.dataset.nobook;this.V30g(c)&&(e=this.V1dr("cbcaption",c),b.appendChild(e));var f=this.V1dr("rootParent",c);b.appendChild(f);e=this.V1dr("root",c);f.appendChild(e);var g=this.V1dr("west",c);e.appendChild(g);f=this.V1dr("westNest",
c);g.appendChild(f);var h=this.V1dr("westNorth",c);f.appendChild(h);g=this.V1dr("westSouth",c);f.appendChild(g);var k=this.V1dr("east",c);e.appendChild(k);var l=this.V1dr("eastNest",c);k.appendChild(l);var m=this.V1dr("eastLayer",c);l.appendChild(m);k=this.V1dr("eastUpDownNest",c);m.appendChild(k);d=this.V30h(k,c,d);this.V30i(c)&&this.V30j(k,c);this.V30k(c)&&this.V30l(l,c);h=this.V30m(h,c);this.V30n(g,c);m=this.V1dr("listParent",c);g.appendChild(m);this.V30o(b,c,e,f,l,k);return{nota:d,boardParent:h}};
f.prototype.V30h=function(b,c,d){var e=this.V1dr("notaNest",c);b.appendChild(e);b=this.V1dr("notaparent",c);var f=this.V1dr("notaEl",c);b.appendChild(f);e.appendChild(b);d=this.V30p(f,d,c);b=this.V1dr("belowNota",c);f=this.V1dr("notaButtons",c);b.appendChild(f);e.appendChild(b);this.V30q(f,c);return d};f.prototype.V30j=function(b,c){var d=this.V1dr("bookparent",c),e=this.V1dr("bookEl",c);d.appendChild(e);b.appendChild(d);this.book[c]=this.V30r(e,c)};f.prototype.V30l=function(b,c){var d=this.V1dr("chatparent",
c),e=this.V1dr("chatEl",c);d.appendChild(e);b.appendChild(d);this.chat[c]=this.V30s(e,c)};f.prototype.V30m=function(b,c){var d=this.V1dr("boardHolder",c);$(d).css("backgroundImage","url( "+CB.V5o()+"media/chess/OrangeBrighterSoftBacklightLessSatur.jpg )");b.appendChild(d);var e=this.V1dr("boardArea",c);d.appendChild(e);var d=this.V1dr("belowBoard",c),f=this.V1dr("buttons",c);d.appendChild(f);b.appendChild(d);this.V30t(f,c);return e};f.prototype.V30u=function(b,c){var d=this.V1dr("boardHolder",c);
$(d).css("backgroundImage","url( "+CB.V5o()+"media/chess/OrangeBrighterSoftBacklightLessSatur.jpg )");var e=this.V1dr("boardArea",c);d.appendChild(e);b.appendChild(d);var d=this.V1dr("belowBoard",c),f=this.V1dr("buttons",c);d.appendChild(f);b.appendChild(d);this.V30t(f,c);$("#boardHolder"+c)[0].style.height="calc( 92vh - 34px )";return e};f.prototype.V30n=function(b,c){var d=this.V1dr("engineParent",c),e=this.V1dr("engineEl",c),f=this.V1dr("engineButtons",c);d.appendChild(f);d.appendChild(e);b.appendChild(d);
this.V30v(f,c);$("#engineButtons"+c).hide()};f.prototype.V30o=function(b,c,d,e,f,g){var h=CB.V5t.V64()?8:1800<screen.width?7:6,k=65,l=50;$(b).is(".cblive")&&(880<$(b).width()&&1100>$(b).width()?(l=65,780>$(b).height()&&(k=60)):(k=76,l=65));CB.V5t.V64()&&500>window.innerWidth?l=k=65:$(b).width()<1.1*$(b).height()&&(l=65);this.V30w(c,d,h,l);this.V30x(c,e,h,k);this.V30y(c,f,h);this.V30z(c,g,h,$(b).height())};f.prototype.V30w=function(b,c,d,e){var f=this.V310("root",b);e=f&&f.size?f.size:e;$(c).jqxSplitter({width:"100%",
height:"100%",splitBarSize:d,panels:[{size:e+"%",collapsible:!1},{size:100-e+"%",collapsible:!1}]});$(c).on("resize",function(c){h.exec(function(){this.V311(b,!0)}.bind(this),100)}.bind(this))};f.prototype.V30x=function(b,c,d,e){var f=this.V310("westNest",b);e=f&&f.size?f.size:e;$(c).jqxSplitter({orientation:"horizontal",splitBarSize:d+1,panels:[{size:e+"%",collapsible:!1},{size:100-e+"%",collapsible:!1}]});$(c).on("resize",function(c){h.exec(function(){this.V311(b,!1)}.bind(this),100)}.bind(this))};
f.prototype.V30y=function(b,c,d){if(this.V30k(b)){var e;e=(e=this.V310("eastNest",b))&&e.size?e.size:72;$(c).jqxSplitter({orientation:"vertical",splitBarSize:d+2,panels:[{size:e+"%",collapsible:!1},{size:100-e+"%",collapsible:!1}]});$(c).on("resize",function(c){k.exec(function(){this.V312(b,!1)}.bind(this),50)}.bind(this))}};f.prototype.V30z=function(b,c,d,e){if(this.V30i(b)){var f=90;850<e&&(f=86);f=(e=this.V310("eastUpDownNest",b))&&e.size?e.size:f;$(c).jqxSplitter({orientation:"horizontal",width:"100%",
height:"100%",splitBarSize:d+2,panels:[{size:f+"%",collapsible:!1},{size:100-f+"%",collapsible:!1}]});$(c).on("resize",function(c){l.exec(function(){this.V313(b,!1)}.bind(this),50)}.bind(this))}};f.prototype.V304=function(b,c,d,e){e=this.V1dr("root",c);b.appendChild(e);var f=this.V1dr("ribbon",c);e.appendChild(f);b=this.V1dr("boardParent",c);e=this.V1dr("notaparent",c);var g=this.V1dr("listParent",c);f.appendChild(b);f.appendChild(e);f.appendChild(g);this.V2zi[c]=[b,e,g];var h=this.V1dr("tabNavButtons",
c);f.appendChild(h);this.V314(h,c);$(g).text("Just one game here...");g=this.V1dr("notaEl",c);h=this.V1dr("belowNota",c);f=this.V1dr("notaButtons",c);h.appendChild(f);e.appendChild(g);e.appendChild(h);d=this.V30p(g,d,c);$("#notaEl"+c)[0].style.height="100%";this.V315(f,c);b=this.V30u(b,c);this.V316(c);return{nota:d,boardParent:b}};f.prototype.V317=function(b,c,d,e){e=this.V1dr("root",c);b.appendChild(e);var f=this.V1dr("north",c);e.appendChild(f);var g=this.V1dr("southNest",c),k=this.V1dr("south",
c);k.appendChild(g);e.appendChild(k);var l=this.V1dr("southNorth",c);g.appendChild(l);k=this.V1dr("southSouth",c);g.appendChild(k);var m=this.V1dr("notaparent",c),p=this.V1dr("notaEl",c);m.appendChild(p);l.appendChild(m);d=this.V30p(p,d,c);$("#notaEl"+c)[0].style.height="100%";m=this.V1dr("boardHolder",c);$(m).css("backgroundImage","url( "+CB.V5o()+"media/chess/OrangeBrighterSoftBacklightLessSatur.jpg )");l=this.V1dr("boardArea",c);m.appendChild(l);f.appendChild(m);m=this.V1dr("belowBoard",c);p=this.V1dr("buttons",
c);m.appendChild(p);f.appendChild(m);this.V30t(p,c);f=this.V1dr("engineParent",c);m=this.V1dr("engineEl",c);p=this.V1dr("engineButtons",c);f.appendChild(p);f.appendChild(m);k.appendChild(f);this.V30v(p,c);$("#engineButtons"+c).hide();f=this.V1dr("listParent",c);k.appendChild(f);k=CB.V5t.V64()?10:5;f=50;CB.V5t.V64()&&500>window.innerWidth&&(f=50);$(e).jqxSplitter({width:"100%",height:"100%",orientation:"horizontal",splitBarSize:3,resizable:!1,panels:[{size:f+"%",min:90,max:window.innerWidth+30,collapsible:!1},
{size:100-f+"%",min:60}]});$(g).jqxSplitter({orientation:"horizontal",splitBarSize:k+1,panels:[{size:"60%",min:70,collapsible:!1},{size:"40%",min:40,collapsible:!1}]});$(g).on("resize",function(d){h.exec(function(){this.V318(c,b)}.bind(this),10)}.bind(this));return{nota:d,boardParent:l}};f.prototype.V2zr=function(){return this.isVerti};f.prototype.V30c=function(b,c){var d=b.dataset.title;if(d){var e=this.V1dr("aboveDiag",c);b.appendChild(e);var f=this.V1dr("diagTitle",c);e.appendChild(f);$(f).text(d)}d=
this.V1dr("diagarea",c);b.appendChild(d);var g;"0"!=b.dataset.buttons&&(g=this.V1dr("belowDiag",c),b.appendChild(g),e=this.V1dr("diagButtons",c),g.appendChild(e),this.V319(e,b,c));if(e=b.dataset.legend)g||(g=this.V1dr("belowDiag",c),b.appendChild(g)),f=this.V1dr("diagText",c),g.appendChild(f),$(f).text(e);return d};f.prototype.V30p=function(b,c,d){var e=ObjUtil.clone(CB.cbNotationDefaults);e.useMatBalance=!this.V2zr();b=CB.NotaElement.factory(b,null,e,d,this.modules[d].ticket);b.setGame(c.game);this.isVerti&&
b.addOnMoveTouchedListener(function(){this.V316(d)}.bind(this));return b};f.prototype.V30s=function(b,c){return CB.V1i3.factory(b,c,this.V31a.bind(this))};f.prototype.V30r=function(b,c){return CB.V1id.factory(b,c,function(){return this.modules[c].getKernel()}.bind(this),this.modules[c].ticket)};f.prototype.V1ri=function(b,c){this.chat[0]&&this.chat[0].add(b,c)};f.prototype.V31b=function(b){for(var c=0;c<this.modules.length;c++)if(this.modules[c].ticket==b)return c;return 0};f.prototype.V2uw=function(b,
c,d,e,f,g){var h=0;e&&e.ticket&&(h=this.V31b(e.ticket));this.chat[h]&&this.chat[h].addKibitzChat(b,c,d,e,f,g)};f.prototype.V31c=function(b,c){this.chat[b]&&this.chat[b].addKibitzChat(sender,null,c,gameTicket,!0,!0)};f.prototype.V2uy=function(b,c){var d=this.V31b(b);if(this.chat[d])for(d=0;d<c.length;d++)this.V2uw(c[d].sender,c[d].hdr,c[d].txt,{idGame:c[d].gameId,ticket:b,mvInx:c[d].mvInx},c[d].autoChat,d==c.length-1)};f.prototype.V31a=function(b,c){if(V35p.isLoggedIn()&&V35p.V34z.userName){var d=
this.modules[b].getKernel();if(d&&d.idGame)return V35p.lobby.V2uz(V35p.V34z.userName,d.idGame,c),d}else this.chat[b].inviteLogin()};f.prototype.V303=function(b,c,e){$("#boardHolder"+c).height();$($(".cbreplay")[c]).height();var f=this;$("#listParent"+c).jsGrid({width:"400px",height:"100%",heading:!1,filtering:!1,editing:!1,inserting:!1,updateOnResize:!1,sorting:!0,autoload:!1,rowClick:function(d){e(b.getGame(d.item.No),c,d.item.No);f.isVerti&&f.fnSelectNota(c)},controller:{loadData:function(c){c=
[];for(var d=1;d<=b.getGameCount();d++){var e=b.getHeaderJson(d),f=e.white,g=e.black,h=e.elow?e.elow:"-",k=e.elob?e.elob:"-",l=e.result,t=e.eco,v=e.event,m=e.date?e.date:" ",p=d,w="";e.round&&(w=e.round,e.subRound&&(w+="."+e.subRound));c.push({White:f,Black:g,EloW:h,EloB:k,Res:l,ECO:t,Event:v,Year:m,No:p,Rnd:w,Len:e.plyCount})}return c}},fields:this.V1il(this.V31d(c),!1)});this.V1im=!0;$("#listParent"+c).jsGrid("loadData");jsGrid.sortStrategies.number=d;this.resize();return this.V31e(b,c,e)?!0:(e(b.getGame(1),
c,1),!1)};f.prototype.createLiveListGrid=function(b,c,e){$("#listParent"+c).removeClass("msgInListParent");var f=this.V1il(this.V31d(c),!0),g=this;$("#listParent"+c).jsGrid({width:"400px",height:"100%",heading:!1,filtering:!1,editing:!1,inserting:!1,updateOnResize:!1,sorting:!0,loadMessage:"Retrieving games ...",loadShading:!0,autoload:!1,rowClick:function(b){e(b.item.id,c,!1);g.isVerti&&g.fnSelectNota(c)},controller:{loadData:function(c){c=[];for(var d=0;d<b.games.length;d++){var e=b.games[d],f=
e.white,h=e.black,k=e.eloWhite?e.eloWhite:"-",l=e.eloBlack?e.eloBlack:"-",t=g.getResIcon(e.result),v=e.eco?CB.Vgz.Vhf(e.eco):"",m=e.tourn,p=d+1,w=e.watchers,r="";e.round1&&(r=e.round1,e.round2&&(r+="."+e.round2));c.push({White:f,Black:h,EloW:k,EloB:l,Res:t,ECO:v,Event:m,No:p,NKib:w,Rnd:r,Len:Math.ceil(e.moveLen/2),id:e.id,Stat:e.stat})}return c}},fields:f});this.V1im=!0;$("#listParent"+c).jsGrid("loadData");jsGrid.sortStrategies.number=d;b.games.length&&(new CB.Timer(function(){e(b.games[0].id,c);
for(var d=1;d<b.games.length;d++)(b.games[d].shouldRequestImmediatelyInLive()||6>=d)&&14>=d&&e(b.games[d].id,c,!0);this.V31f(b.games,c,e)}.bind(this))).runOnce(500)};f.prototype.V31f=function(b,c,d){var e=decodeURIComponent(CB.V47.V4k(CB.V47.V4i("w"))),f=decodeURIComponent(CB.V47.V4k(CB.V47.V4i("b"))),g=CB.V47.V4k(CB.V47.V4i("r")),h=CB.V47.V4k(CB.V47.V4i("r2")),k=CB.V47.V4k(CB.V47.V4i("mv"));if(e.length&&f.length)for(var l=0;l<b.length;l++)if(0==b[l].white.indexOf(e)&&0==b[l].black.indexOf(f)){var m=
0==g.length||b[l].round1==parseInt(g);if(m=m&&0==h.length||b[l].round2==parseInt(h))return d(b[l].id,c,!1,k),this.V2xo=c,!0}};f.prototype.V31e=function(b,c,d){var e=decodeURIComponent(CB.V47.V4k(CB.V47.V4i("w"))),f=decodeURIComponent(CB.V47.V4k(CB.V47.V4i("b"))),g=CB.V47.V4k(CB.V47.V4i("r")),h=CB.V47.V4k(CB.V47.V4i("r2")),k=CB.V47.V4k(CB.V47.V4i("mv"));if(e.length&&f.length)for(var l=0;l<b.getGameCount()&&100>l;l++){var m=b.getHeaderJson(l+1);if(0==m.white.indexOf(e)&&0==m.black.indexOf(f)){var p=
0==g.length||m.round==parseInt(g);if(p=p&&0==h.length||m.subRound==parseInt(h))return b=b.getGame(l+1),d(b,c,l+1,!1,parseInt(k)),this.V2xo=c,!0}}return!1};f.prototype.getResIcon=function(b){switch(b){case 2:return"win";case 1:return"draw";case 0:return"loss"}};f.prototype.V31g=function(b){switch(b){case CB.Vlr.EQUAL:return"equal";case CB.Vlr.Vlt:return"blackslightly";case CB.Vlr.BLACK_BETTER:return"blackbetter";case CB.Vlr.BLACK_WINS:return"blackwins";case CB.Vlr.WHITE_WINS:return"whitewins";case CB.Vlr.WHITE_BETTER:return"whitebetter";
case CB.Vlr.Vls:return"whiteslightly"}};f.prototype.isLive=function(b){return this.modules[b].mode==CB.ReaderMode.LIVE};f.prototype.V31h=function(b){return this.modules[b].mode==CB.ReaderMode.DIAGRAM};f.prototype.V31i=function(b){return this.modules[b].mode==CB.ReaderMode.TABLE};f.prototype.V30k=function(b){return this.isVerti||CB.V5t.V64()&&!CB.V5t.V68()||700>window.innerHeight||1340>window.innerWidth||CB.V5t.V6c()?!1:this.modules[b].mode==CB.ReaderMode.LIVE};f.prototype.V30i=function(b){return 0<=
b&&this.modules[b].noBook||CB.V5t.V6c()||!CB.V5t.runsOnChessBaseDomain()?!1:!CB.V5t.V64()||800<window.innerHeight&&1500<window.innerWidth};f.prototype.V30g=function(b){return this.V31j()&&1E3<window.innerWidth&&700<window.innerHeight};f.prototype.V31k=function(b){return $("#cbcaption"+b).height()};f.prototype.V31l=function(b){return 0};f.prototype.V31m=function(b,c){$("#cbcaption"+c).text(b)};f.prototype.V31n=function(b,c){this.V31m(b.hdr.getStrPlayers(!1,99),c)};f.prototype.V1iu=function(){return this.V30i(this.V2xo)};
f.prototype.V1il=function(b,c){var e=function(b,c){return d(b,c)},f=[];420>b?f=[{name:"White",type:"text",width:Math.floor(.25*b)},{name:"EloW",type:"text",width:Math.floor(.11*b)},{name:"Black",type:"text",width:Math.floor(.25*b)},{name:"EloB",type:"text",width:Math.floor(.11*b)},{name:"Res",type:"text",width:Math.floor(.1*b)}]:580>b?(f=[{name:"White",type:"text",width:Math.floor(.23*b)},{name:"EloW",type:"number",width:Math.floor(.09*b)},{name:"Black",type:"text",width:Math.floor(.23*b)},{name:"EloB",
type:"number",width:Math.floor(.09*b)},{name:"Res",type:"text",width:Math.floor(.1*b)}],c||f.push({name:"ECO",type:"text",width:Math.floor(.05*b)})):(f=[{name:"White",type:"text",width:Math.floor(.1*b)},{name:"EloW",type:"number",width:Math.floor(.05*b)},{name:"Black",type:"text",width:Math.floor(.1*b)},{name:"EloB",type:"number",width:Math.floor(.05*b)},{name:"Res",type:"text",width:Math.floor(.04*b)}],c||(f.push({name:"Year",type:"number",width:Math.floor(.05*b)}),f.push({name:"ECO",type:"text",
width:Math.floor(.045*b)})),f.push({name:"Event",type:"text",width:Math.floor(.16*b)}));360<b&&((420<b||!c&&400<b)&&f.push({name:"Rnd",type:"number",width:Math.floor(.04*b),sorter:e}),600<b&&f.push({name:"Len",type:"number",width:Math.floor(.03*b)}),c&&(f=[{name:"Stat",type:"staticon",width:Math.min(30,Math.floor(.05*b))}].concat(f)));f.forEach(function(b){"White"==b.name||"Black"==b.name?b.css="jsg-player":"EloW"==b.name||"EloB"==b.name?(b.css="jsg-elo",b.align="center"):"ECO"==b.name?(b.css="jsg-eco",
b.align="center"):"Res"==b.name&&(b.css="jsg-result",b.align="center",c&&(b.type="resicon",b.css="jsg-icon"));"Event"==b.name&&(b.css="jsg-event")});return f};f.prototype.resizePlugin=function(b,c){this.V31h(c)?this.V1dt(b,c):this.V31i(c)?this.V30e(b,c):this.V2zr()?this.V31o(b,c):this.V31p(b,c);this.isLive(c)&&this.V31q(c)};f.prototype.V31p=function(b,c){if(b&&this.modules&&this.modules[c]){var d=this.V31k(c);d?(d+=this.V31l(c),$("#rootParent"+c).height("calc( 100% - "+d+"px )")):$("#rootParent"+
c).height("100%");var d=this.getGameCount(c),e=1<d;$(b).find(".cbmove").filter(":last");900<$(b).scrollTop()&&this.V2y7()&&this.V2xy!=c&&$(b).css("width","112%");this.V31r(c,e);CB.V5t.V68()?$("#b-btnSave-"+c).show():$("#b-btnSave-"+c).hide();var f=this.V31s().getLineHBoard(),g=b.width(),h=b.height(),k=this.V31t(c,$("#westSouth"+c).height(),e),l=e?.72*h-f-k:h-f-k;400>l&&(l=400);l>.5*g&&(l=.5*g,e||(k=h-f-l));l=g-(g-l);$("#east"+c)[0].style.height="100%";$("#west"+c)[0].style.height="100%";this.V31u(c);
this.chat[c]&&this.chat[c].resize();this.book[c]&&this.book[c].resize();$("#boardHolder"+c)[0].style.width="100%";$("#boardHolder"+c)[0].style.height="calc( 100% - "+f+"px )";$("#belowBoard"+c)[0].style.width="100%";$("#belowBoard"+c)[0].style.height=f+2+"px";$("#buttons"+c)[0].style.width="100%";$("#buttons"+c)[0].style.height="100%";var f=$("#boardHolder"+c).width(),m=$("#boardHolder"+c).height();if(this.modules[c].boardArea&&!this.modules[c].boardArea.canvas)if(this.isLive(c))this.V31v(c);else{var p=
{topDist:V35p.config.V174,bottomDist:V35p.config.V174,marginDistDivisor:26.5,shiftXPercent:-1.7,minWForCoordinates:240,boardShadow:!0};this.modules[c].boardArea.createCanvas(this.modules[c].getKernel(),p);this.modules[c].getKernel().boardWin.onReadyHandlers.add(this.modules[c].onBoardReady.bind(this.modules[c]))}this.V31w(c,f,m);this.V2y3(c,f,m,700);this.V31x(c,e,k,d,l);this.V31y(g,h,c);this.V2ya("b",this.V2zf[c],this.V31s().getBtnHBoard(),this.V31s().getCssBoard(),c,"Reader");this.V2ya("n",this.V31z,
this.V31s().btnHNota,this.V31s().getCssNota(),c,"Reader");this.V320(c);$("#eastUpDownNest"+c).jqxSplitter("refresh")}};f.prototype.V320=function(b){var c=CB.$("#notaparent"+b).single();this.modules[b].nota.setSize(c.offsetWidth,c.offsetHeight)};f.prototype.V31o=function(b,c){if(b&&this.modules&&this.modules[c]){$(b).css("width","100vw");CB.V5t.V72()?CB.V5t.V67()?$(b).css("height","100vh"):$(b).css("height","92vh"):$(b).css("height","100vh");$(b).css("min-width","300px");$(b).css("min-height","300px");
$(b).find(".cbmove").filter(":last");this.V2y7()&&$(b).css("height",.8*window.innerHeight+"px");$("#b-btnSave-"+c).hide();var d=this.getGameCount(c),e=1<d;e||this.V321(c,e);this.V31r(c,e);var f=this.V31s().getLineHBoard();this.V31s();var g=b.width(),h=b.height(),k=$("#tabNavButtons"+c).height();$("#tabNavButtons"+c).width();var l=h-k-f-1;this.V322(c)&&($("#boardHolder"+c)[0].style.width="100%",$("#boardHolder"+c)[0].style.height=l+"px",$("#belowBoard"+c)[0].style.width="100%",$("#belowBoard"+c)[0].style.height=
f+"px",$("#buttons"+c)[0].style.width="100%",$("#buttons"+c)[0].style.height="100%",this.modules[c].boardArea.canvas||this.modules[c].boardArea.createCanvas(this.modules[c].getKernel(),{topDist:2.3*V35p.config.V174,bottomDist:V35p.config.V174,marginDistDivisor:26.5,shiftXPercent:-1.7,minWForCoordinates:240,boardShadow:!0,addTitle:!0,noClock:!this.isLive(c)}),f=$("#boardHolder"+c).width(),l=$("#boardHolder"+c).height(),this.V2y3(c,f,l,800));this.V323(c)?this.V324(c,e,0,d,g-6,h-k):this.V2zj[c]=!1;this.V31y(g,
h,c);this.V2ya("b",this.V2zf[c],this.V31s().getBtnHBoard(),this.V31s().getCssBoard(),c,"Reader");this.V2ya("n",this.V31z,this.V31s().btnHNota,this.V31s().getCssNota(),c,"Reader");this.V325(c)?this.V326(b,c):this.V2zk[c]=!1}};f.prototype.V327=function(b,c){if(b&&this.modules&&this.modules[c]){var d=this.getGameCount(c),e=1<d;$(b).find(".cbmove").filter(":last");900<$(b).scrollTop()&&this.V2y7()&&this.V2xy!=c&&$(b).css("width","112%");$(b).css("height","240vw");$("#b-btnSave-"+c).hide();this.V31r(c,
e);e||$("#southNest"+c).jqxSplitter({showSplitBar:!1,panels:[{size:"100%"},{size:"0%"}]});var f=this.V31s().getLineHBoard();this.V31s();var g=b.width(),h=b.height();500>g&&($(b).css("width","100vw"),g=b.width(),$(b).css("min-width","100px"),$(b).css("max-width","1000px"));$("#south"+c)[0].style.width="100%";$("#north"+c)[0].style.width="100%";$("#southNorth"+c).height();$("#notaparent"+c)[0].style.height="100%";$("#notaEl"+c).css("font-size",this.V328()&&1E3<window.innerWidth?"1.1em":"0.8em");$("#boardHolder"+
c)[0].style.width="100%";$("#boardHolder"+c)[0].style.height="calc( 100% - "+f+"px )";$("#belowBoard"+c)[0].style.width="100%";$("#belowBoard"+c)[0].style.height=f+2+"px";$("#buttons"+c)[0].style.width="100%";$("#buttons"+c)[0].style.height="100%";this.modules[c].boardArea.canvas||this.modules[c].boardArea.createCanvas(this.modules[c].getKernel(),{topDist:V35p.config.V174,bottomDist:V35p.config.V174,marginDistDivisor:26.5,shiftXPercent:-1.7,minWForCoordinates:240,boardShadow:!0});var f=$("#boardHolder"+
c).width(),k=$("#boardHolder"+c).height();this.V2y3(c,f,k,1E3);this.V329(c,e,0,d,b.width());this.V31y(g,h,c);this.V2ya("b",this.V2zf[c],this.V31s().getBtnHBoard(),this.V31s().getCssBoard(),c,"Reader");this.V2ya("n",this.V31z,this.V31s().btnHNota,this.V31s().getCssNota(),c,"Reader");this.V320(c)}};f.prototype.V31r=function(b,c){var d=!1,e=$("#buttons"+b).width();(this.isLive(b)||c)&&(600<e||this.V2zr())?($("#b-btnLoadNext-"+b).show(),$("#b-btnLoadPrev-"+b).show(),$("#n-btnLoadNext-"+b).show(),$("#n-btnLoadPrev-"+
b).show(),d=!0):($("#b-btnLoadNext-"+b).hide(),$("#b-btnLoadPrev-"+b).hide(),$("#n-btnLoadNext-"+b).hide(),$("#n-btnLoadPrev-"+b).hide());550<e||this.V2zr()?$("#b-btnGoBegin-"+b).show():$("#b-btnGoBegin-"+b).hide();550<e||this.V2zr()&&!d?$("#b-btnGoEnd-"+b).show():$("#b-btnGoEnd-"+b).hide()};f.prototype.V321=function(b,c){c||$("#t-btnSelList-"+b).hide()};f.prototype.V2y4=function(b,c,d){this.V2xn[b]&&this.V2xn[b].stop();this.modules[b].boardArea.setSize(c,d);this.modules[b].multiBoard&&(this.V31w(b,
c,d),this.modules[b].multiBoard.resize(c,d))};f.prototype.V31w=function(b,c,d){if(this.modules[b].multiBoard&&!(100>d)){var e=1;c/=d;160<d&&1.25<c&&(e=1.9<c||800<d?2.3<c?3.3<c||600<d?9:7:2.3<c&&450<d||800<d?7:5:480<d&&(1.8<c||900<d)?5:3);d=this.modules[b].changeNKernels(e,this);if(e>d){c=0;for(var f=d;c<e-d&&f<this.modules[b].list.length;f++){var g=this.modules[b].list[f].id;this.V32a(b,g)||(u(g,b),c++)}}}};f.prototype.V32a=function(b,c){for(var d=0;d<this.modules[b].kernel.length;d++)if(this.modules[b].kernel[d].idGame==
c)return!0;return!1};f.prototype.V31v=function(b){var c=this.modules[b].boardArea.createCanvas({createControl:function(b,c,d){var e=this.V32b();e.suppressCalcGeometry=!0;b=new CB.V1hn(b,c,d,e);b.V1i0=this.V1i0.bind(this);b.V1hv=this.V32c.bind(this);return b}.bind(this),onControlReady:function(){V35p.V1ft.V1gi()}},this.V32b()),d=this.V32d(c,this.V32b());this.modules[b].getKernel().setBoardWin(d);this.modules[b].getKernel().V354.createGUIElements(d);this.modules[b].boardArea.setVisible(!0);c=c.control;
this.modules[b].multiBoard=c;c.addBoard(d,null)};f.prototype.V32b=function(){return{topDist:0,bottomDist:0,marginDistDivisor:30,shiftXPercent:-1.7,minWForCoordinates:260,splitLayout:!0,suppressCalcGeometry:!0}};f.prototype.V32d=function(b,c){var d=new CB.Vkg(b,100,100,"FirstB",c);d.animSteps={forMove:2,forPosition:2};CB.V5t.V64()&&(d.animSteps={forMove:.6,forPosition:.5});d.V1ab=!0;d.allowInput=!0;return d};f.prototype.V1i0=function(b,c){1==this.pluginCnt&&(this.V2xo=0);0<=this.V2xo&&this.V32e(this.V2xo);
this.changeSelectedGameKernel(b)};f.prototype.V32c=function(b,c){1==this.pluginCnt&&(this.V2xo=0);0<=this.V2xo&&this.trySwapWithBigBoard(b,this.V2xo,!0);c.preventDefault()};f.prototype.changeSelectedGameKernel=function(b){if(!(0>this.V2xo)){var c=this.modules[this.V2xo];try{c.getKernel().releaseCommandHandlers();c.selectKernelByIdGame(b);var d=c.getKernel();d.linkCommandHandlers();var e=d.game,f=this.modules[this.V2xo].nota;e&&f&&(f.setGame(e),d.forceTBUpdate=!0,d.boardWin&&(d.nextCurPosNoAnim=!1),
e.fireOnCurPosChanged(),e.fireOnNavigate());c.multiBoard&&c.multiBoard.markBoardByGameId&&c.multiBoard.markBoardByGameId(b);this.V32f(this.V2xo,b,"watch");d.boardWin&&(d.boardWin.markLastMove(!1,!0),V35p.aTBLobby.Vrb()&&(V35p.aTBLobby.V2bu(b,d.getCurPos(),this.V32g.bind(this)),d.boardWin.setEvaluationInvalid()))}catch(g){CB.Vjg("RWM:chngSelectedKernel",g)}}};f.prototype.V31y=function(b,c,d){b>.9*window.innerWidth&&c>.9*window.innerHeight&&this.V2xy!=d?$("#b-btnFullScreen-"+d).hide():$("#b-btnFullScreen-"+
d).show()};f.prototype.V31u=function(b){var c=this.V31s().lineHNota;$("#eastNest"+b)[0].style.height="100%";$("#eastLayer"+b)[0].style.height="100%";$("#eastUpDownNest"+b)[0].style.height="100%";$("#eastUpDownNest"+b)[0].style.width="100%";this.V30k(b)||($("#eastNest"+b)[0].style.width="100%");this.V30i(b)||($("#notaNest"+b)[0].style.height="100%");var d=$("#notaNest"+b).height()-c;$("#notaparent"+b)[0].style.height=d+"px";$("#notaEl"+b).css("font-size",this.V328()&&1E3<window.innerWidth?"1.3em":
"0.9em");$("#belowNota"+b)[0].style.width="calc( 100% + 1px )";$("#belowNota"+b)[0].style.height=c+"px";$("#belowNota"+b)[0].style.top=d+"px"};f.prototype.V31t=function(b,c,d){c=Math.max(Math.min(c,50),d?Math.min(.35*c,90):Math.min(.35*c,110));!this.modules[b].engineOpen&&d&&(c=0);return c};f.prototype.getGameCount=function(b){return this.modules[b].pgnDatabase?this.modules[b].pgnDatabase.getGameCount():this.modules[b].requestData&&this.modules[b].requestData.isList()?Math.max(2,this.modules[b].list.length):
0};f.prototype.V31x=function(b,c,d,e,f){c?$("#engineParent"+b)[0].style.height=d+"px":$("#engineParent"+b)[0].style.height="100%";$("#engineParent"+b)[0].style.width="100%";this.modules[b].engineOpen||!c?($("#engineParent"+b).show(),!c&&$("#replayinfo"+b)[0]&&($("#replayinfo"+b)[0].style.height="100%")):($("#engineParent"+b).hide(),d=0);$("#listParent"+b)[0].style.width="100%";$("#listParent"+b)[0].style.height="calc( 100% - "+d+"px )";c&&this.V1im&&($("#listParent"+b).jsGrid("option","height","calc( 100% - "+
d+"px )"),$("#listParent"+b).jsGrid("option","width","100%"),$("#listParent"+b).jsGrid("option","heading",!0),$("#listParent"+b).jsGrid("option","fields",this.V1il(this.V31d(b),this.isLive(b))))};f.prototype.V324=function(b,c,d,e,f,g){$("#engineParent"+b).hide();$("#listParent"+b)[0].style.height=g+"px";$("#listParent"+b)[0].style.width=f+"px";c&&this.V1im&&($("#listParent"+b).jsGrid("option","height",g+"px"),$("#listParent"+b).jsGrid("option","width",f+"px"),$("#listParent"+b).jsGrid("option","heading",
!0),$("#listParent"+b).jsGrid("option","fields",this.V1il(f,this.isLive(b))))};f.prototype.V329=function(b,c,d,e,f){$("#engineParent"+b).hide();$("#listParent"+b)[0].style.width="100%";$("#listParent"+b)[0].style.height="100%";c&&this.V1im&&($("#listParent"+b).jsGrid("option","height","100%"),$("#listParent"+b).jsGrid("option","width","100%"),$("#listParent"+b).jsGrid("option","heading",!0),$("#listParent"+b).jsGrid("option","fields",this.V1il(f,this.isLive(b))))};f.prototype.V326=function(b,c){var d=
$("#tabNavButtons"+c).height(),e=$("#tabNavButtons"+c).width(),d=$(b).height()-d,f=this.V31s().lineHNota;$("#notaparent"+c).css("height",d);$("#notaparent"+c).css("width",e+1);$("#belowNota"+c)[0].style.height=f+"px";$("#belowNota"+c)[0].style.top=d+"px";$("#notaEl"+c).css("height",d-f);$("#notaEl"+c).css("font-size",this.V328()&&1E3<window.innerWidth?"1.1em":"0.9em");this.modules[c].nota.setSize(e,d-f);this.modules[c].nota.scrollCurElemIntoView()};f.prototype.V31d=function(b){return $("#listParent"+
b).width()};f.prototype.V32h=function(b){return $("#boardHolder"+b).width()};f.prototype.V32i=function(b){this.V2zr()?this.V32j(b):this.V311(b)};f.prototype.V311=function(b){var c=$("#boardHolder"+b).width(),d=$("#boardHolder"+b).height();$("#belowBoard"+b).height();if(this.V2y5(c,d,b)){this.modules[b].boardArea&&this.V2y4(b,c,d);var d=1<this.getGameCount(b),e=$("#engineParent"+b).height();$("#listParent"+b)[0].style.height="calc( 100% - "+e+"px )";this.V31r(b,d);d&&this.V1im&&($("#listParent"+b).jsGrid("option",
"height","calc( 100% - "+e+"px )"),$("#listParent"+b).jsGrid("option","fields",this.V1il(c,this.isLive(b))));this.V320(b);this.chat[b]&&this.chat[b].resize();this.isLive(b)&&this.V31q(b);this.book[b]&&this.book[b].resize();this.V32k("root",b);this.V32k("westNest",b)}};f.prototype.V32l=function(b){this.V32m("root",b)};f.prototype.V32n=function(b){this.V32m("westNest",b)};f.prototype.V32o=function(b){this.V32m("eastNest",b)};f.prototype.V32p=function(b){this.V32m("eastUpDownNest",b)};f.prototype.V310=
function(b,c){var d=this.isLive(c)?"live":"",e=V35p.V34z.load(b+"size"+d);V35p.V34z.load(b+"coll"+d);return{size:parseFloat(e),coll:!1}};f.prototype.V32k=function(b,c){var d=$("#"+b+c);if(d.length){var e=this.isLive(c)?"live":"",d=$(d).jqxSplitter("panels");d[0]&&V35p.V34z.save(b+"size"+e,d[0].size)}};f.prototype.V32m=function(b,c){};f.prototype.V32j=function(b){var c=$("#boardHolder"+b).width(),d=$("#boardHolder"+b).height();$("#belowBoard"+b).height();this.V2y5(c,d,b)&&(this.modules[b].boardArea&&
this.V2y4(b,c,d),1<this.getGameCount(b)&&this.V1im&&$("#listParent"+b).jsGrid("option","fields",this.V1il(c,this.isLive(b))),this.modules[b].getKernel().game.fireOnChanged(),this.modules[b].getKernel().game.fireOnHeaderChanged({recalc:!0}))};f.prototype.V318=function(b,c){var d=$(c).width(),e=this.getGameCount(b),f=1<e,g=$("#engineParent"+b).height();f&&this.V1im&&$("#listParent"+b).jsGrid("option","fields",this.V1il(d,this.isLive(b)));this.V31x(b,f,g,e,d);this.modules[b].getKernel().game.fireOnChanged();
this.modules[b].getKernel().game.fireOnHeaderChanged({recalc:!0})};f.prototype.V312=function(b){this.V31u(b);this.chat[b]&&this.chat[b].resize();this.book[b]&&this.book[b].resize();this.V320(b);this.V32k("eastNest",b)};f.prototype.V313=function(b){this.V31u(b);this.book[b]&&this.book[b].resize();this.V32k("eastUpDownNest",b)};f.prototype.V31s=function(){function b(){return 100<window.innerHeight&&100<window.innerWidth}return CB.V5t.V64()?{getLineHBoard:function(){return b()?60:44},getBtnHBoard:function(){return b()?
48:32},getBtnHDiagram:function(c){return b()?32:24},lineHNota:42,btnHNota:32,getCssBoard:function(){return b()?"toolBtn toolBtn48":"toolBtn toolBtn32"}.bind(this),getCssDiagrams:function(c){return b()?"toolBtn toolBtn32":"toolBtn toolBtn24"}.bind(this),getCssNota:function(){return"toolBtn toolBtn32"}.bind(this),getCssEngine:function(){return"toolBtn toolBtnV16"}.bind(this),getCssTabNav:function(){return"tabNavBtn tabNavBtn32"}.bind(this)}:{getLineHBoard:function(){return 800<window.innerHeight?44:
34}.bind(this),getBtnHBoard:function(){return 800<window.innerHeight?32:24}.bind(this),getBtnHDiagram:function(b){return 300<b?24:16},lineHNota:34,btnHNota:24,getCssBoard:function(){return 800<window.innerHeight?"toolBtn toolBtn32":"toolBtn"}.bind(this),getCssDiagrams:function(b){return 300<b?"toolBtn toolBtn24":"toolBtn toolBtn16"}.bind(this),getCssNota:function(){return"toolBtn"}.bind(this),getCssTabNav:function(){return"tabNavBtn tabNavBtn16"}.bind(this),getCssEngine:function(){return"toolBtn toolBtnV16"}.bind(this)}};
f.prototype.V1dt=function(b,c){if(b){var d=b.width();d>.9*window.innerWidth&&(d=.9*window.innerWidth,$(b.width(d)));var e=d,d=.8*e;$("#diagarea"+c)[0].style.width=e+"px";$("#diagarea"+c)[0].style.height=d+"px";this.modules[c].boardArea.canvas||(this.modules[c].boardArea.createCanvas(this.modules[c].getKernel(),{topDist:0,bottomDist:0,marginDistDivisor:0,shiftXPercent:-1.65,minWForCoordinates:200,transparent:!0}),this.modules[c].getKernel().boardWin.onReadyHandlers.add(this.modules[c].onBoardReady.bind(this.modules[c])));
$("#diagarea"+c)[0]&&this.modules[c]&&this.modules[c].boardArea&&this.V2y4(c,e-1,d-1);this.V2ya("d",this.V2zg[c],this.V31s().getBtnHDiagram(d),this.V31s().getCssDiagrams(d),c,"Reader");d=$("#diagButtons"+c);e=$("#diagText"+c);d&&d.height();e&&e.height()}};f.prototype.V30e=function(b,c){var d=this.modules[c].ranking;if(d){b=$(b);var e=b.children()[0];b.html("");var f=b.width();b.append(e);d=d.toHtml(f);b.html("");b.append(d);$(b.children()[0]);750>f?b.css("font-size",1-(750-f)/1050+"em"):b.css("font-size",
"1em")}};f.prototype.V2y6=function(){this.resizePlugin($($(this.V2y2)[this.V2xo]),this.V2xo)};f.prototype.V30t=function(b,c){var d=[],d=d.concat([{title:lm.TAKE_BACK,id:"Retract",handler:this.V32q.bind(this)},{title:lm.MAKE_MOVE,id:"Exec",handler:this.V32r.bind(this)},{title:"Autoplay (Ctrl, Shift and/or Alt-key when clicking changes time)",id:"Autoplay",handler:this.V32s.bind(this)}]);400<window.innerWidth&&d.push({separator:!0});var e=$("#root0").width();if(this.V2zr()||880<e)380<=window.innerWidth&&
d.push({title:"Goto Begin",id:"GoBegin",handler:this.V32t.bind(this)}),380<window.innerWidth&&d.push({title:"Goto End",id:"GoEnd",handler:this.V32u.bind(this)}),500<window.innerWidth&&d.push({separator:!0}),450<=window.innerWidth&&d.push({title:"Load Prev",id:"LoadPrev",handler:this.V32v.bind(this)}),320<=window.innerWidth&&d.push({title:"Load Next",id:"LoadNext",handler:this.V32w.bind(this)}),500<window.innerWidth&&d.push({separator:!0});this.V2zr()||d.push({title:"Maximize",id:"FullScreen",handler:this.V2xz.bind(this)});
this.V2zr()||(CB.V5t.V64()||d.push({separator:!0}),d.push({title:lm.ANALYSIS_ENGINE,id:"Engine",handler:this.V32x.bind(this)}));500<e&&(d=d.concat([{}]),d.push({title:lm.FLIP_BOARD,id:"Rotate",handler:this.V32y.bind(this)}));CB.V5t.V64()||(d=d.concat([{}]),d.push({title:"Download PGN",id:"Save",handler:this.V32z.bind(this)}));1E3<window.innerWidth&&(d=d.concat([{}]),d.push({title:"Pieces",id:"Pieces",handler:this.V330.bind(this),css:"btnPieces"}));this.V2zf[c]=d;e=this.V31s().getCssBoard();this.V2y8("button",
b,"b",d,e,c)};f.prototype.V314=function(b,c){var d=[],d=d.concat([{title:"Board",id:"SelBoard",txt:lm.BOARD,handler:this.V316.bind(this)}]),d=d.concat([{title:"Notation",id:"SelNota",txt:lm.NOTATION,handler:this.fnSelectNota.bind(this)}]),d=d.concat([{title:"List",id:"SelList",txt:lm.GAMES,handler:this.V331.bind(this)}]);CB.V5t.V72()?d=d.concat([{title:"Index",id:"SelHome",txt:"Index",handler:this.V332.bind(this)}]):d.push({title:"Download PGN",txt:"Download",id:"Save",handler:this.V32z.bind(this)});
this.V2zh[c]=d;var e=this.V31s().getCssTabNav();this.V2y8("button",b,"t",d,e,c)};f.prototype.shakeFullWinBtn=function(b){$("#b-btnFullScreen-"+b).addClass("shakeShort")};f.prototype.V333=function(b){$("#b-btnFullScreen-"+b).removeClass("shakeShort")};f.prototype.V319=function(b,c,d){var e=[],e=e.concat([{title:lm.TAKE_BACK,id:"Retract",handler:this.V32q.bind(this)},{title:lm.MAKE_MOVE,id:"Exec",handler:this.V32r.bind(this)}]);360<=$(c).width()&&(e=e.concat([{},{}]),e.push({title:lm.FLIP_BOARD,id:"Rotate",
handler:this.V32y.bind(this)}));c.dataset.hint&&(e=e.concat([{}]),e.push({title:"Hint",id:"Hint",handler:function(b){this.V334(c.dataset.hint,b)}.bind(this)}));c.dataset.solution&&e.push({title:"Solution",id:"Solution",handler:function(b){this.V335(c.dataset.solution,b)}.bind(this)});e=e.concat([{},{}]);e.push({title:"Download FEN",id:"Save",handler:this.V336.bind(this)});this.V2zg[d]=e;var f=this.V31s().getCssDiagrams();this.V2y8("button",b,"d",e,f,d)};f.prototype.V337=function(b){this.V2yf(b)};
f.prototype.V338=function(b,c){var d=$(String.f("#b-btnAutoplay-{0}",c)),e='url( "'+CB.V5o()+'Media/Ribbons/Reader/{0}{1}.png" )';b?d.css("background-image",String.f(e,"Stop",this.V31s().getBtnHBoard())):d.css("background-image",String.f(e,"Autoplay",this.V31s().getBtnHBoard()))};f.prototype.V339=function(){return CB.Vs4.V21a||-1!=document.URL.search(/chessbase.com/i)||-1!=document.URL.search(/localhost/i)};f.prototype.V30q=function(b,c){var d=[];d.push({title:lm.DELETE_LINE+" (Del)",id:"DeleteLine",
handler:this.V33a.bind(this)});d.push({title:lm.PROMOTE_LINE+" (Alt-up)",id:"PromoteLine",handler:this.V33b.bind(this)});d.push({title:lm.CUT_LINE+" (})",id:"CutLine",handler:this.V33c.bind(this)});d.push({title:lm.UNANNOTATE+" (Ctrl-Shift-Y)",id:"Unannotate",handler:this.V33d.bind(this)});d.push({separator:!0});d.push({title:"Undo (Ctrl-Z)",id:"Undo",handler:this.V33e.bind(this)});d.push({title:"Redo (Ctrl-Y)",id:"Redo",handler:this.V33f.bind(this)});d.push({separator:!0});d.push({title:lm.SAVE+
" (Ctrl-S)",id:"Save",handler:this.V2yq.bind(this)});d.push({separator:!0});d.push({title:"Check Database",id:"OnlineDB",handler:this.V33g.bind(this)});1600<window.innerWidth&&(d.push({title:"-> MyGames",id:"MyGames",handler:this.V33h.bind(this)}),d.push({title:"-> Fritz",id:"FritzOnline",handler:this.V33i.bind(this)}));1200<window.innerWidth&&d.push({title:"Live Games Running Now",id:"LiveNew",handler:this.V33j.bind(this)});1300<window.innerWidth&&(0<document.URL.indexOf("live.chessbase")||0<document.URL.indexOf("localhost"))&&
d.push({title:"Tweet this game (the board will be downloaded as png)",id:"Tweet",handler:this.V33k.bind(this)});this.V31z=d;var e=this.V31s().getCssNota();this.V2y8("button",b,"n",d,e,c)};f.prototype.V315=function(b,c){var d=[];d.push({title:"Load Prev",id:"LoadPrev",handler:this.V32v.bind(this)});d.push({title:"Load Next",id:"LoadNext",handler:this.V32w.bind(this)});d.push({separator:!0});d.push({title:lm.UNANNOTATE+" (Ctrl-Shift-Y)",id:"Unannotate",handler:this.V33d.bind(this)});d.push({separator:!0});
d.push({title:"Undo (Ctrl-Z)",id:"Undo",handler:this.V33e.bind(this)});this.V31z=d;var e=this.V31s().getCssNota();this.V2y8("button",b,"n",d,e,c)};f.prototype.V30v=function(b,c){var d="",e=[];e.push({title:"More Lines",id:"More",handler:function(){this.V33l(c,1)}.bind(this)});e.push({title:"Less Lines",id:"Less",handler:function(){this.V33l(c,-1)}.bind(this)});e.push({title:"Threat",id:"Threat",handler:this.V33m.bind(this)});for(var f=this.V31s().getCssEngine(),g=0;g<e.length;g++)d+=String.f('<button title="{0}" id="e-btn{1}-{2}" class="{3}"></button>',
e[g].title,e[g].id,c,f);$(b).html(d);d='url( "'+CB.V5o()+'Media/Ribbons/Reader/{0}{1}.png" )';for(g=0;g<e.length;g++)f=$(String.f("#e-btn{0}-{1}",e[g].id,c)),e[g].handler&&(f[0].onclick=function(b,c){return function(d){e[b].handler(c,d)}}.call(this,g,c)),f.css("background-image",String.f(d,e[g].id,16))};f.prototype.V33n=function(b,c){this.V2y9[b].FullScreen=c?"FullScreen":"Restore"};f.prototype.V32z=function(b){this.V2yq(b,!1)};f.prototype.V2yq=function(b,c,d){var e="Download";if(c)b=this.modules[b].getKernel().game,
c=CB.V12k.V12l(b),0<b.hdr.getStrPlayers(!1,0).length&&(e=b.hdr.getStrPlayers(!1,0)+(d||".pgn")),d=b.requiresPremiumForDownload();else{c=this.modules[b].toPgn(b);if(!c)return;e=this.modules[b].pgnTitle;d=this.modules[b].getKernel().game.requiresPremiumForDownload()}b=CB.V5t.runsOnChessBaseCom()&&-1==document.URL.search(/view.chessbase.com/i)&&-1==document.URL.search(/cloudserver.chessbase.com/i);V35p.isLoggedIn()||!b?d&&!V35p.isPremium()&&b?window.location="https://live.chessbase.com/Premium?returnurl="+
encodeURIComponent(document.location):(window.Blob?(console.log("Blob DL: "+e),c=new Blob([c],{type:"text/plain;charset=utf-8"}),window.saveAs(c,e)):0<CB.V5t.V6m()&&window.clipboardData&&clipboardData.setData&&(alert("On Internet Explorer the game has been pasted to the clipboard ('Strg-V')"),clipboardData.setData("Text",c)),CB.V1dm("PGN")):window.location="https://live.chessbase.com/Logon?returnurl="+encodeURIComponent(document.location)};f.prototype.V31j=function(){return-1!=document.URL.search(/en.chessbase.com/i)||
-1!=document.URL.search(/de.chessbase.com/i)||-1!=document.URL.search(/es.chessbase.com/i)||-1!=document.URL.search(/localhost/i)};f.prototype.V336=function(b){this.V2yq(b,!1,".fen")};f.prototype.V307=function(b){return V35p.lobby.getPgn(this.modules[b].ticket)};f.prototype.V32t=function(b){this.V32e(b);this.modules[b].getKernel().game.gotoStart()};f.prototype.V32u=function(b){this.V32e(b);this.modules[b].getKernel().game.gotoEnd()};f.prototype.V32q=function(b){this.V32e(b);this.modules[b].getKernel().game.gotoPrev()};
f.prototype.V32r=function(b){if(!this.V32e(b)){var c=this.modules[b].getKernel().game.getAnno(CB.AnnoType.Vf5);c&&!c.solved||this.modules[b].getKernel().game.gotoNext()}};f.prototype.V32e=function(b){this.modules[b].runAutoplayTimer&&this.modules[b].runAutoplayTimer.stop();return this.modules[b].timerAutoplay?!this.V32s(b):!1};f.prototype.V32s=function(b,c,d){if(this.modules[b].timerAutoplay)return this.modules[b].timerAutoplay.stop(),delete this.modules[b].timerAutoplay,this.modules[b].getKernel().boardWin.prepareFullRedraw(),
this.modules[b].animSteps&&(this.modules[b].getKernel().boardWin.animSteps=this.modules[b].animSteps),this.modules[b].getKernel().V354.setIsAutoplay(!1),this.V338(!1,b),!1;this.modules[b].getKernel().boardWin&&this.modules[b].getKernel().boardWin.animSteps&&(this.modules[b].animSteps=this.modules[b].getKernel().boardWin.animSteps,CB.V5t.V64()?this.modules[b].getKernel().boardWin.animSteps.forMove=.3:this.modules[b].getKernel().boardWin.animSteps.forMove=3);this.modules[b].getKernel().game.getMoveNo()==
this.modules[b].getKernel().game.getMainLine().length&&this.V32t(b);this.V338(!0,b);var e=d||2500;CB.V5t.V64()&&(e=1600);c&&!d&&(c.ctrlKey?(e=1300,c.altKey&&(e=c.shiftKey?200:700)):c.shiftKey?(e=5E3,c.altKey&&(e=1E4)):c.altKey&&(e=1E3));this.modules[b].getKernel().boardWin&&this.modules[b].getKernel().boardWin.destroyMessage();this.modules[b].getKernel().V354.setIsAutoplay(!0);this.modules[b].getKernel().game.gotoNext();this.modules[b].timerAutoplay=new CB.Timer(function(){this.modules[b].getKernel().game.isOnLastMove()?
(this.modules[b].timerAutoplay.stop(),(new CB.Timer(function(){this.modules[b].timerAutoplay&&(this.V32w(b),this.modules[b].getKernel().game.gotoIndex(0),this.modules[b].timerAutoplay.runPeriodic(e))}.bind(this))).runOnce(4*e)):this.modules[b].getKernel().game.gotoNext()}.bind(this));this.modules[b].timerAutoplay.runPeriodic(e);return!0};f.prototype.V33o=function(b){this.modules[b].nota.handleCursorUp()};f.prototype.V33p=function(b){this.modules[b].nota.handleCursorDown()};f.prototype.V32x=function(b){this.V339()?
(this.V2xo=b,this.modules[b].getKernel().V354.toggleEngine()||this.V33q()):this.modules[this.V2xo].engineOpen?this.V33q():(CB.V1dm("Engine"),this.Vs7(),this.modules[this.V2xo].enginePanel.displayInfo("Sorry, you cannot run an engine in this browser yet. On Mac, please try Chrome. Thank you.","cbEngineWarnBrowser"))};var m=new CB.V35b;f.prototype.V33l=function(b,c){this.modules[b].getKernel().V354.incNMultiVars(c);m.exec(function(){this.modules[b].getKernel().V354.goAll()}.bind(this),300)};var p=new CB.V35b;
f.prototype.V33m=function(b){p.exec(function(){this.modules[b].getKernel().V354.toggleThreat()}.bind(this),300)};f.prototype.V32y=function(b){this.modules[b].getKernel().boardWin&&this.modules[b].getKernel().boardWin.flipBoard()};var r=0;f.prototype.V330=function(b){this.V32e(b);b=[CB.Vlw.V23r,CB.Vlw.V14h,CB.Vlw.V14f,CB.Vlw.V14b];r++;r>b.length-1&&(r=0);glSettings.changeBoardStyle(b[r])};f.prototype.V33k=function(b){if(window.Blob){b=this.modules[b].getKernel();var c=b.boardWin;if(c){var d=c.getOuterRect(),
c=c.cbcanvas.ctx.getImageData(d.left,d.top,d.w-1,d.h-1),e=b.game.hdr.getStrPlayers(!1,0)+".png";CB.V87.V8d(c,e,d.w,d.h);if(d=document.URL.split("?")[0])d+="?w="+b.game.hdr.white.last,d+="&b="+b.game.hdr.black.last,b.game.hdr.round&&(d+="&r="+b.game.hdr.round),b.game.hdr.subRound&&(d+="&r="+b.game.hdr.subRound),b.game.getMoveIndex()&&(d+="&mv="+b.game.getMoveIndex()),d=encodeURIComponent(d),c=b.game.hdr.getStrPlayers(!1,0),c+=", "+b.game.hdr.event.event+"\r\n",c=b.game.getCurPos().getBTM()?c+"Black to move.\r\n":
c+"White to move.\r\n",c=encodeURIComponent(c),window.open("https://twitter.com/intent/tweet?text="+c+("&url="+d))}}};f.prototype.V334=function(b,c){this.modules[c].getKernel().boardWin&&(this.modules[c].getKernel().boardWin.addMessage(b,!0),(new CB.Timer(function(){this.modules[c].getKernel().boardWin.destroyMessage()}.bind(this))).runOnce(4E3))};f.prototype.V335=function(b,c){if(this.modules[c].getKernel().boardWin&&4==b.length){var d=CB.Vbf.fromString(b.substring(0,2)),e=CB.Vbf.fromString(b.substring(2,
4));this.modules[c].getKernel().boardWin.drawArrow(d,e,"hsla( 120, 70%, 50%, 0.9 )")}};f.prototype.V32v=function(b){if(this.modules[b].pgnDatabase){var c=this.modules[b].getKernel().game.gameNo-1;if(!c||1>c)c=this.modules[b].pgnDatabase.getGameCount();var d=this.modules[b].pgnDatabase.getGame(c);this.loadGame(d,b,c,!0)}else if(c=this.modules[b].getKernel().idGame)if(d=this.modules[b].list,1<d.length){for(var e=!1,f=1;!e&&f<d.length;f++)d[f].id==c&&(c=d[f-1].id,u(c,b),e=!0);e||d[d.length-1].id==c||
u(d[d.length-1].id,b)}};f.prototype.V32w=function(b){if(this.modules[b].pgnDatabase){var c=this.modules[b].getKernel().game.gameNo+1;if(!c||c>this.modules[b].pgnDatabase.getGameCount())c=1;var d=this.modules[b].pgnDatabase.getGame(c);this.loadGame(d,b,c,!0)}else if(c=this.modules[b].getKernel().idGame){for(var d=this.modules[b].list,e=!1,f=0;!e&&f<d.length-1;f++)d[f].id==c&&(c=d[f+1].id,u(c,b),e=!0);e||d[0].id==c||u(d[0].id,b)}};f.prototype.V2xz=function(b){if(!this.V2zr()){this.V333(b);var c=$(this.V2y2);
if(c&&c[b]){var d=0,e=0;this.V2xy!=b&&0<=this.V2xy&&this.V2xz(this.V2xy);this.V2xy==b?(this.V33n(b,!0),this.V2xy=-1,$(c[b]).css("max-width",this.V33r),$(c[b]).css("max-height",this.V33s),$(c[b]).css("box-shadow",this.V33t),$(c[b]).width(this.V33u),$(c[b]).height(this.V33v),$(c[b]).offset({top:this.V33w.top,left:this.V33w.left}),$(c[b]).css("z-index","1"),d=this.V33u,e=this.V33v,$("#root"+b).jqxSplitter({panels:this.V33x})):(this.V33n(b,!1),this.V33u=$(c[b]).width(),this.V33v=$(c[b]).height(),this.V33w=
$(c[b]).offset(),this.V33r=$(c[b]).css("max-width"),this.V33t=$(c[b]).css("box-shadow"),$("#root"+b).jqxSplitter("panels"),this.V33x=$("#root"+b).jqxSplitter("panels"),this.V2xy=b,d=Math.min(1900,window.innerWidth-2*Math.min(30,Math.round(.05*window.innerWidth))),e=window.innerHeight-10,$(c[b]).css("max-width",d),$(c[b]).css("max-height",e),$(c[b]).css("box-shadow","1px 1px 12px 2px hsla( 0, 0%, 0%, 0.35 )"),$(c[b]).width(d),$(c[b]).height(e),$(c[b]).offset({top:window.pageYOffset+2,left:4+(window.innerWidth-
d)/2}),$(c[b]).css("z-index","100"),this.V2xo=b,this.V33y(b,d,e)&&($("#root"+b).jqxSplitter({panels:[{size:"68%",collapsible:!1},{size:"32%",collapsible:!1}]}),700>e&&$("#westNest"+b).jqxSplitter({panels:[{size:"60%",collapsible:!1},{size:"40%",collapsible:!1}]})),CB.V1dm("FullWin"));$("#root"+b).jqxSplitter({width:d+"px",height:e+"px"});this.resizePlugin($(c[b]),b);h.exec(function(){return function(){this.V32i(b,this.isLive(b))}.bind(this)}.call(this,b),300);$("#root"+b).jqxSplitter("refresh");this.V33z?
$("#southNest"+b).jqxSplitter("refresh"):$("#westNest"+b).jqxSplitter("refresh");$("#eastNest"+b).jqxSplitter("refresh");$("#eastUpDownNest"+b).jqxSplitter("refresh")}}};f.prototype.V33y=function(b,c,d){return!this.V2zr()&&this.isLive(b)&&1200<c&&700<d&&3<=this.modules[b].list.length};f.prototype.V322=function(b){return this.V340(b,0)};f.prototype.V325=function(b){return this.V340(b,1)};f.prototype.V323=function(b){return this.V340(b,2)};f.prototype.V340=function(b,c){return $(this.V2zi[b][c]).is(":visible")};
f.prototype.V316=function(b){this.V341(b,0)};f.prototype.fnSelectNota=function(b){this.V2zk[b]?(new CB.Timer(function(){this.modules[b].nota.scrollCurElemIntoView();this.modules[b].nota.blinkCurrElem()}.bind(this))).runOnce(0):(this.V2zk[b]=!0,(new CB.Timer(function(){var c=$(this.V2y2)[b];this.V326(c,b)}.bind(this))).runOnce(10));this.V341(b,1)};f.prototype.V331=function(b){this.V2zj[b]||(this.V2zj[b]=!0,(new CB.Timer(function(){var c=this.getGameCount(b),d=1<c,e=$(this.V2y2)[b],f=$(e).width(),e=
$(e).height(),g=$("#tabNavButtons"+b).height();this.V324(b,d,0,c,f,e-g)}.bind(this))).runOnce(10));this.V341(b,2)};f.prototype.V332=function(b){document.exitFullScreen&&document.exitFullScreen();document.location="https://live.chessbase.com"};f.prototype.V341=function(b,c){for(var d=0;d<this.V2zi[b].length;d++){var e=String.formatEx("#t-btn{0}-{1}",this.V2zh[b][d].id,b);d==c?($(this.V2zi[b][d]).css("display","block"),$(e).addClass("tabNavBtnSelected")):($(this.V2zi[b][d]).css("display","none"),$(e).removeClass("tabNavBtnSelected"))}};
f.prototype.V300=function(b){0<=this.V2xy&&this.V2xz(this.V2xy);this.V2y0()};f.prototype.V342=function(b){console.log("Nota Save");this.V2yq(b,!0)};f.prototype.V33g=function(b){var c=$(this.V2y2);c&&c[b]&&(V35p.V26p(),window.location="https://database.chessbase.com?ref=pgn")};f.prototype.V33h=function(b){this.modules[b].getKernel().V354.saveToCloud(!0)||5;var c=$(this.V2y2);c&&c[b]&&(V35p.V26p(),window.location="http://mygames.chessbase.com?ref=pgn")};f.prototype.V33i=function(b){var c=$(this.V2y2);
c&&c[b]&&V35p.V26o(this.modules[b].getKernel().game)};f.prototype.V33b=function(b){this.modules[b].undo.push(ObjUtil.clone(this.modules[b].getKernel().game));this.modules[b].getKernel().V354.onPromoteLine()&&this.modules[b].getKernel().game.promoteLine()};f.prototype.V343=function(b){this.modules[b].undo.push(ObjUtil.clone(this.modules[b].getKernel().game));this.modules[b].getKernel().V354.onDeletePrevious()&&this.modules[b].getKernel().game.deletePrevious()};f.prototype.V33c=function(b){this.modules[b].undo.push(ObjUtil.clone(this.modules[b].getKernel().game));
this.modules[b].getKernel().V354.onCutLine()&&this.modules[b].getKernel().game.deleteRemaining()};f.prototype.V33a=function(b){this.modules[b].undo.push(ObjUtil.clone(this.modules[b].getKernel().game));this.modules[b].getKernel().V354.onDeleteLine()&&this.modules[b].getKernel().game.deleteLine()};f.prototype.V33e=function(b){if(this.modules[b].undo.length){var c=this.modules[b].undo.pop();this.modules[b].redo.push(ObjUtil.clone(this.modules[b].getKernel().game));this.modules[b].getKernel().game.assign(c)}};
f.prototype.V33f=function(b){if(this.modules[b].redo.length){var c=this.modules[b].redo.pop();this.modules[b].undo.push(ObjUtil.clone(this.modules[b].getKernel().game));this.modules[b].getKernel().game.assign(c)}};f.prototype.V33d=function(b){this.modules[b].undo.push(ObjUtil.clone(this.modules[b].getKernel().game));this.modules[b].getKernel().V354.saved=!1;this.modules[b].getKernel().game.unAnnotate()};f.prototype.V344=function(b){this.isLive(b)?window.open("https://docu.chessbase.com/reader/cblive.html"):
window.open("https://docu.chessbase.com/reader/cbreplay.html")};f.prototype.V33j=function(b){window.open("http://live.playchess.com")};f.prototype.onNotaClickListener=function(){this.V32e(-1==this.V2xo?0:this.V2xo)};f.prototype.V23j=function(b,c){if(this.V2xr&&-1!=this.V2xo){var d=!0;switch(b.which){default:d=!1;break;case 13:this.V32s(c,b,1E3);break;case 27:this.V2xy==c&&this.V2xz(c);this.modules[c].timerAutoplay&&this.V32s(c,b);break;case 37:this.V32q(c);break;case 39:this.V32r(c);break;case 38:b.altKey?
this.V33b(c):this.V33o(c);break;case 40:this.V33p(c);break;case 46:this.V33a(c);break;case 56:this.V343(c);break;case 57:this.V33c(c);break;case 65:b.ctrlKey||(d=!1);break;case 66:b.ctrlKey?this.V32y(c):d=!1;break;case 83:b.ctrlKey?this.V2yq(c,!0):d=!1;break;case 89:b.ctrlKey?b.shiftKey?this.V33d(c):this.V33f(c):d=!1;break;case 90:b.ctrlKey?this.V33e(c):d=!1;break;case 113:b.altKey?this.V32x(c):d=!1;break;case 122:b.ctrlKey||b.shiftKey?this.V32v(c):this.V32w(c);break;case 187:this.V33l(c,1);break;
case 189:this.V33l(c,-1)}d&&b.preventDefault();return d}};f.prototype.V328=function(){return this.V2xy==this.V2xo};f.prototype.V301=function(b,c){return function(b){if(this.modules&&this.modules.length){var d=this.modules[c].pgnDatabase;d&&b.assign(d.getGame(1),!0)}}};f.prototype.V308=function(b,c,d,e){return function(f){f.reset();if(b){var g=b.dataset.fen;g?(g=new CB.Position(g),g=new CB.Game(g),d.addColoredAnnos(b,g),f.assign(g)):e&&(f=new CB.V13c(e),d.modules[c].pgnDatabase=e,g=f.getGame(1),d.modules[c].pgnTitle=
g.hdr.getStrPlayers(!1,0)+".pgn",d.modules[c].getKernel())}}};f.prototype.V309=function(b,c,d){if((b=b.dataset.solution)&&4==b.length){var e=CB.Vbf.fromString(b.substring(0,2)),f=CB.Vbf.fromString(b.substring(2,4)),g=new CB.Timer(function(){d.boardWin.destroyMessage()});d.V354.fnAcceptMove=function(b){if(0<d.game.getMoveIndex())return!0;g.runOnce(2E3);if(b.from!=e||b.to!=f)return d.boardWin.addMessage("Wrong Move, sorry",!0),!1;d.boardWin.addMessage("Correct!",!0);return!0}.bind(this)}};f.prototype.addColoredAnnos=
function(b,c){var d=b.dataset.arrows,e=b.dataset.squares;if(d){for(var f=d.split(","),d=new CB.ColArrowAnno,g=0;g<f.length;g++){var h=f[g];if(4==h.length){var k=CB.Vbf.fromString(h.substring(0,2)),h=CB.Vbf.fromString(h.substring(2,4)),k=new CB.ColArrow(k,h,CB.Vv9.GREEN);d.push(k)}}d.length&&c.setAnnoBeforeFirstMove(CB.AnnoType.ARROW_LIST,d,!0)}if(e){e=e.split(",");d=new CB.ColSqAnno;for(f=0;f<e.length;++f)g=e[f],2==g.length&&(g=CB.Vbf.fromString(g),g=new CB.ColSq(g,CB.Vv9.GREEN),d.push(g));d.length&&
c.setAnnoBeforeFirstMove(CB.AnnoType.SQUARE_LIST,d,!0)}};f.prototype.V302=function(b,c,d,e){if(b){var f=b.dataset.url;f?$.get(f,function(e){if(e){e=new CB.V13c(e);this.modules[d].pgnDatabase=e;this.modules[d].pgnTitle=f;var g=!1;1<e.getGameCount()?g=c(e,d,this.loadGame.bind(this)):this.resizePlugin($(b),d);g||("no"!=b.dataset.autoplay&&1<e.getGameCount()?(parseInt(b.dataset.autoplay),this.modules[d].getKernel().V354.loadGame(this.modules[d].pgnDatabase.getGame(1)),this.modules[d].getKernel().hasTraining()):
this.modules[d].getKernel().V354.loadGame(this.modules[d].pgnDatabase.getGame(1)));this.V31n(this.modules[d].getKernel().game,d)}}.bind(this)).fail(function(){this.resizePlugin($(b),d)}.bind(this)):e&&(e=new CB.V13c(e),this.modules[d].pgnDatabase=e,1<e.getGameCount()?c(e,d,this.loadGame.bind(this)):this.resizePlugin($(b),d),e=this.modules[d].pgnDatabase.getGame(1),this.modules[d].pgnTitle=e.hdr.getStrPlayers(!1,0)+".pgn",this.modules[d].getKernel().V354.loadGame(e),this.V31n(e,d),!this.modules[d].getKernel().hasTraining()&&
0<parseInt(b.dataset.autoplay)&&(this.modules[d].runAutoplayTimer=new CB.Timer(function(){this.V32s(d,null,b.dataset.autoplay)}.bind(this)),this.modules[d].runAutoplayTimer.runOnce(1E4)))}};f.prototype.V30b=function(b,c){if(b){var d=b.dataset.url,d=b.dataset.name,e=parseInt(b.dataset.top),f=b.dataset.round||100,g=b.dataset.tbs,h=b.dataset.caption,k=b.dataset.pic,d=String.f("{0}/results/{1}/all",V35p.config.getLiveResult(),d),l={caption:h,withPic:k};d&&$.get(d,function(d){d&&this.V30d(b,c,d,f,e,g,
l)}.bind(this))}};f.prototype.V2zy=function(b,c){if(b){var d=b.dataset.name;parseInt(b.dataset.top);var e=b.dataset.round||3E4;(d=String.f("{0}/results/{1}/all",V35p.config.getLiveResult(),d))&&$.get(d,function(d){d&&this.V30f(b,c,d,e,{tiebreakInfosArr:[]})}.bind(this))}};f.prototype.V345=function(b,c){if(this.modules[b].useFirstBoard)return this.modules[b].useFirstBoard=!1,this.modules[b].kernel[0].setIdGame(c),0;if(this.modules[b].kernel.length<this.modules[b].maxKernels){var d=this.modules[b].addKernel(this);
d.idGame=c;var e=this.modules[b].boardArea.canvas,f=this.V32d(e,this.V32b());f.animateBoard=!1;d.setBoardWin(f);d.V354.createGUIElements(f);e.control.addBoard(f,c);d=$("#boardHolder"+b).width();e=$("#boardHolder"+b).height();this.V2y3(b,d,e,300);return this.modules[b].kernel.length-1}return-1};var u=function(b,c,d,f){var g=V35p.panelMgr;V35p.panelMgr.modules[c].nGotoMoveIndex=f;if(g.trySwapWithBigBoard(b,c)){if(f){var h=V35p.panelMgr.modules[c].nCurrKernel;e(c,b,h).game.gotoIndex(f)}}else{for(var k=
0;k<g.modules[c].kernel.length;k++)if(g.modules[c].kernel[k].idGame==b){g.changeSelectedGameKernel(b);g.onWatch(c,b);f&&(h=V35p.panelMgr.modules[c].nCurrKernel,e(c,b,h).game.gotoIndex(f));return}h=V35p.panelMgr.V345(c,b);f=0;!d&&0>h&&(f=V35p.panelMgr.modules[c].getKernel().idGame,V35p.panelMgr.V32f(c,f,""),V35p.panelMgr.modules[c].getKernel().setIdGame(b),h=V35p.panelMgr.modules[c].nCurrKernel);V35p.lobby.V2un(b,V35p.panelMgr.modules[c].ticket,0<=h?function(b){return e(c,b,h)}:null,function(b,d){V35p.panelMgr.Vja(c,
b,d)},f,function(b){V35p.panelMgr.V346(c,b)},function(){V35p.panelMgr.modules[c].nGotoMoveIndex&&e(c,b,h)&&(e(c,b,h).game.gotoIndex(V35p.panelMgr.modules[c].nGotoMoveIndex),(new CB.Timer(function(){V35p.panelMgr.modules[c].nGotoMoveIndex=0})).runOnce(1E3));V35p.panelMgr.chat[c]&&!V35p.panelMgr.modules[c].chatRequested&&(V35p.panelMgr.modules[c].chatRequested=!0,V35p.lobby.V2up(c,b));V35p.panelMgr.V31m("Live: "+V35p.panelMgr.modules[c].getKernel().game.hdr.event.event,c)});if(0<=h)V35p.panelMgr.onWatch(c,
b)}};f.prototype.addGameById=function(b,c,d){u(c,b,!1,d)};f.prototype.trySwapWithBigBoard=function(b,c,d){c=this.modules[c];if(0==c.nCurrKernel||d)if(d=c.getKernelIndexOf(b),0<d){var e=ObjUtil.clone(c.kernel[0].game),f=c.kernel[0].idGame;c.kernel[0].game.assign(c.kernel[d].game);c.kernel[0].setIdGame(b);c.kernel[d].setIdGame(f);c.kernel[d].game.assign(e);this.changeSelectedGameKernel(b);V35p.lobby.notifySessionSwap(c.ticket,f,b);return!0}};f.prototype.V2zv=function(b,c,d){return{pluginDiv:b,ticket:++g,
kernel:[],nCurrKernel:0,useFirstBoard:!0,maxKernels:1,getKernel:function(b){return"undefined"!=typeof b?this.kernel[b]:this.kernel[this.nCurrKernel]},addKernel:function(b,c){var e=new CB.Vjy(b);e.ticket=this.ticket;e.setPlayingMode(d(e));e.pluginCnt=c;e.game.addOnClickInNotationListener(b.onNotaClickListener.bind(b));this.kernel.push(e);return e},selectKernelByIdGame:function(b){for(var c=0;c<this.kernel.length;c++)if(this.kernel[c].idGame==b){this.nCurrKernel=c;break}},getKernelIndexOf:function(b){for(var c=
0;c<this.kernel.length;c++)if(this.kernel[c].idGame==b)return c;return-1},getKernelOfIdGame:function(b){for(var c=0;c<this.kernel.length;c++)if(this.kernel[c].idGame==b)return this.kernel[c]},changeNKernels:function(b,c){var d=this.maxKernels;if(b<this.kernel.length){for(var e=b;e<this.kernel.length;e++){var f=this.multiBoard.V1i2(this.kernel[e].idGame);this.multiBoard.V15x(f);V35p.lobby.setSessionToBackground(this.ticket,this.kernel[e].idGame)}c.changeSelectedGameKernel(this.kernel[0].idGame);this.kernel.length=
b}this.maxKernels=b;return d}}};f.prototype.V306=function(b,c,d,e,f){f={};f.event=b.dataset.event;f.round=b.dataset.round;f.round2=b.dataset.round2;f.player=b.dataset.player;f.white=b.dataset.white;f.black=b.dataset.black;f.date=b.dataset.date;f.kibitzRank=c;"highest"==f.round||"max"==f.round?(f.round="",f.highestRoundOnly=!0):f.highestRoundOnly=!1;f.isList=function(){return!0};f.onList=function(c){e.modules[d].list=c.games;500<c.games.length&&c.games.splice(500);e.createLiveListGrid.call(e,c,d,u);
e.resizePlugin.call(e,$(b),d);e.shakeFullWinBtn(d);for(var f=0;f<c.games.length;f++)e.setResultStat(d,c.games[f].id,e.getResIcon(c.games[f].result))};return f};f.prototype.loadGame=function(b,c,d,e,f){e||this.V32e(c);this.modules[c].getKernel().V354.loadGame(b);f&&(new CB.Timer(function(){this.modules[c].getKernel().game.gotoIndex(f);this.modules[c].nota&&this.modules[c].nota.emphasizeMove()}.bind(this))).runOnce(50);this.modules[c].getKernel().game.gameNo=d;this.V31n(b,c)};f.prototype.onWatch=function(b,
c){this.V32f(b,c,"watch");this.modules[b].getKernel()&&this.V31m("Live: "+this.modules[b].getKernel().game.hdr.event.event,b)};f.prototype.Vja=function(b,c,d){d&&this.V32f(b,c,"move");var e=this.modules[b].getKernelOfIdGame(c);if(e){var f=e.game.hdr.result;2>=f?this.setResultStat(b,c,this.getResIcon(f)):(f=null,d&&d.gameAction.type==CB.Viy.Voj&&d.gameAction.anno&&(f=d.gameAction.anno[CB.AnnoType.Vgo]),!f&&e.game.getLastMove()&&(d=e.game.getLastMove().getAnno())&&(f=d[CB.AnnoType.Vgo]),f&&(d=f.getEval(),
this.setResultStat(b,c,this.V31g(d))))}};f.prototype.V346=function(b,c){this.V32f(b,c,"anno");TRACE("Anno:"+c)};f.prototype.V32f=function(b,c,d){if(b=this.modules[b].list)for(var e=0;e<b.length;e++)b[e].id==c&&(b[e].stat=d);this.V1im&&(c=$('*[data-statIcon="'+c+'"]'),d?c.html(this.V347(d)):c.html(""))};f.prototype.setResultStat=function(b,c,d){if(b=this.modules[b].list)for(var e=0;e<b.length;e++)b[e].id==c&&(b[e].res=d);this.V1im&&(c=$('*[data-resIcon="'+c+'"]'),d?c.html(this.V347(d)):c.html(""))};
f.prototype.V31q=function(b){var c=this.modules[b].list;if(c)for(var d=0;d<c.length;d++)this.modules[b].getKernelOfIdGame(c[d].id)?this.V32f(b,c[d].id,"watch"):"watch"!=c[d].stat&&this.V32f(b,c[d].id,c[d].stat),this.setResultStat(b,c[d].id,c[d].res)};f.prototype.V347=function(b){return'<img src="'+(CB.V5o()+"Media/Ribbons/Reader/Status/"+b+"16.png")+'" height="16px">'};f.prototype.Vs7=function(){if(!this.modules[this.V2xo].enginePanel){var b=document.getElementById("engineEl"+this.V2xo);if(b){$("#engineEl"+
this.V2xo).css("width","calc( 100% - 21px )");var c=new CB.EngineLinesElement(this.V2xo);c.V1bp(b,{scrollLines:!1});this.modules[this.V2xo].enginePanel=c}}this.modules[this.V2xo].engineOpen=!0;b=this.V2xo;$("#engineButtons"+b).show();var c=this.getGameCount(b),d=$("#west"+b).width(),e=$("#westSouth"+b).height(),e=this.V31t(b,e,1<c);this.V2zr()?this.V329(b,1<c,e,c,d):this.V31x(b,1<c,e,c,d);return this.modules[this.V2xo].enginePanel};f.prototype.V33q=function(){this.modules[this.V2xo].engineOpen=!1;
$("#engineEl"+this.V2xo).css("width","100%");this.V2y6();$("#engineButtons"+this.V2xo).hide()};f.prototype.V22x=function(){};f.prototype.V348=function(b){};f.prototype.useMatBalanceDefault=function(){return!0};f.prototype.V2zw=function(b){this.modules[b].getKernel().V354.onExit()};f.prototype.V2zx=function(b){this.modules[b].getKernel().V354.onEntry()};f.prototype.onBlur=function(){if(0<=this.V2xo)this.modules[this.V2xo].getKernel().V354.onExit()};f.prototype.V1qh=function(){this.onBlur()};f.prototype.V1dq=
function(b){b=new CB.V2zt(b);b.blockLiveBook=!0;return b};f.prototype.V2zq=function(){this.V349=[];this.V2us=[];for(var b=0;b<this.modules.length;b++)if(this.modules[b].mode==CB.ReaderMode.LIVE){var c=function(){var c=b,d=this;return function(){return d.modules[c].getKernel()}}.call(this),d={};d.requestData=this.modules[b].requestData;d.ticket=this.modules[b].ticket;d.fnGetKernel=c;this.V2us.push(d)}};f.prototype.V2zn=function(){for(var b=0;b<this.modules.length;b++)this.modules[b].nota&&this.modules[b].nota.notaHeaderElement.resetPlayerCache()};
f.prototype.V2zp=function(b){this.V2zs(b);if(b&&!this.wasLoggedIn){for(var c=0;c<this.chat.length;c++)this.chat[c]&&this.chat[c].outLoginOk(V35p.V34z.userName);this.wasLoggedIn=b}};f.prototype.V34a=function(){this.modules[0]&&this.modules[0].getKernel()&&this.modules[0].getKernel().V354.checkLiveBook();V35p.aTBLobby&&this.modules[0]&&this.isLive(0)&&(this.V34b=new CB.Timer(this.V34c.bind(this)),this.V34d=new CB.Timer(this.V34c.bind(this)),this.V34d.runOnce(2E3),this.V34b.runPeriodic(2E4))};f.prototype.V34c=
function(){if(V35p.aTBLobby)if(!V35p.aTBLobby.Vrb()&&!V35p.aTBLobby.V1nz()&&50>V35p.aTBLobby.V1pn)V35p.aTBLobby.V1q8(null,this),this.V34d.runOnce(5E3);else{var b=this.modules[0];b.mode==CB.ReaderMode.LIVE&&b.kernel.forEach(function(b){V35p.aTBLobby.V2bu(b.idGame,b.getCurPos(),this.V32g.bind(this))}.bind(this))}};f.prototype.V32g=function(b,c){var d=this.modules[0].getKernelOfIdGame(b);if(d&&0<c.move[0].m_aLine[0]){var e=CB.V2fz.V1it(c.pos.getPosition(),c.move[0],d).lineNota,f=c.move[0].m_nEval/100,
g=c.move[0].m_nDepth,f=CB.V1co.V1cp(c.move[0].m_nEval)+" ("+f+"/"+g+")",e={value:c.move[0].m_nEval,depth:c.move[0].m_nDepth,strLine:e,strEval:f};d.tbTableEvaluation=e;d.boardWin&&(d.boardWin.displayEvaluation(!0,e),d.game.hasTBEval=!0,d.game.fireOnEval(e.depth,e.value))}};f.prototype.V2zs=function(b){var c=0,d='<div class="cbreplayInfo" id="replayinfo{0}">';if(CB.V5t.V6m()&&11>CB.V5t.V6m())d+='<span class="browserWarning">Please update your browser. Thank you!</span>';else{switch(CB.V79.V7a().slice(0,
2)){default:b&&(d+='<div>Hello <span class="cbHelloUser">'+V35p.V34z.userName+"</span>,</div>");d+="<ul>";d+="<li>Use the four cursor keys and Enter to replay the game.</li>";d+='<li class="cbMaximizeHint">Try maximizing the board:<div class="cbImgFullScreen"></div></li>';d+="<li>Make moves to analyse yourself.</li>";CB.V5t.V64()||(d+="<li>Press Ctrl-B to rotate the board.</li>",d+="<li>Press F11 to load the next game of a database.</li>");d+="<li>Games viewed here will automatically be stored in your <a href='http://mygames.chessbase.com?ref=pgn'>cloud clipboard</a> (if you are logged in).</li>";
b||(d+="<li><a href='https://account.chessbase.com/en/create-account?ref=pgn'>Create an account</a> to access the games cloud.</li>");break;case "de":b&&(d+='<div>Hallo <span class="cbHelloUser">'+V35p.V34z.userName+"</span>,</div>");d+="<ul>";d+="<li>Spielen Sie die Partie mit den vier Pfeiltasten und Enter nach.</li>";d+='<li class="cbMaximizeHint">Maximieren Sie das Brett:<div class="cbImgFullScreen"></div></li>';d+="<li>Geben Sie selbst Z\u00fcge ein, um zu analysieren.</li>";CB.V5t.V64()||(d+=
"<li>Strg-B dreht das Brett.</li>",d+="<li>F11 l\u00e4dt die n\u00e4chste Partie einer Datenbank.</li>");d+="<li>Alle nachgespielten Partien werden im Clipboard von <a href='http://mygames.chessbase.com?ref=pgn'>MyGames</a> gespeichert (falls eingeloggt).</li>";b||(d+="<li><a href='https://account.chessbase.com/en/create-account?ref=pgn'>Registrieren Sie sich</a>, um MyGames zu benutzen.</li>");break;case "es":b&&(d+='<div>Hola <span class="cbHelloUser">'+V35p.V34z.userName+"</span>,</div>"),d+="<ul>",
d+="<li>Use las 4 teclas de flecha para reproducir la partida.</li>",d+='<li class="cbMaximizeHint">Pruebe a maximizar el tablero:<div class="cbImgFullScreen"></div></li>',d+="<li>Ejecute jugadas para analizar usted mismo.</li>",d+="<li>Haga clic en el indicador de turno de juego en la esquina inferior para darle la vuelta.</li>",d+="<li>Haga clic en el logo de 'MyGames' para guardar sus an\u00e1lisis.</li>",b||(d+="<li><a href='https://account.chessbase.com/en/create-account?ref=pgn'>Create an account</a> to use cloud functions</li>")}d+=
"</ul>";d+='<div class="cbTinyLog"></div>';d+="</div>"}$(this.V2y2).each(function(b,e){$("#engineEl"+c).html(String.f(d,b));$("#engineEl"+c).css("font-family","Roboto Condensed");$("#engineEl"+c).css("font-size","12px");c++})};return f}();"use strict";
CB.V2zt=function(){var c=function(b){CB.V2zt.superClass.call(this);this.kernel=b;this.Vsj=1;this.V34e=0;this.saved=this.V34f=!1;this.Vsv=0;this.Vso=new CB.Timer(this.Vsp.bind(this));this.Vst=this.checkLiveBook.bind(this)};CB.inherit(c,CB.Vrz);CB.Vsi&&CB.V0(c,CB.Vsi);c.prototype.createGUIElements=function(b){this.superClass.createGUIElements.call(this,b);b.shouldAnimatePosChange=this.shouldAnimatePosChange.bind(this);CB.V5t.V64()&&(b.animSteps={forMove:.1,forPosition:.1})};c.prototype.shouldAnimatePosChange=
function(){return CB.V5t.runsOnChessBaseDomain()||!CB.V5t.V6t()};var b=new CB.V35b;c.prototype.Vn5=function(){return this.kernel.game.isLineEnd()||!V35p.Vrp()?CB.Vhr.Vhx:CB.Vhr.Vhu};c.prototype.Vnu=function(){this.Vsv=0};c.prototype.Vn4=function(b){this.saved=!1;var c=this.kernel.game.getAnno(CB.AnnoType.Vf5);if(c){var f=this.kernel.game.getNextMove();f&&f.from==b.from&&f.to==b.to&&(c.solved=!0,this.kernel.game.fireOnChanged())}"undefined"!==typeof this.kernel.pluginCnt&&V35p.panelMgr.V32e(this.kernel.pluginCnt);
return!0};c.prototype.canAnnotateLoadedGames=function(){return!0};c.prototype.isAnalysis=function(){return!0};b=new CB.V35b;c.prototype.beforeGameLoad=function(){this.Vr8();this.saved=!1};c.prototype.Vr9=function(){this.kernel.Vo7()};c.prototype.Vr8=function(){16<this.V34e&&!this.V34f&&!this.Vrk&&(this.V34f=!0,CB.V274(this.kernel.game.hdr.getStrPlayers(!1,0),this.V34e));this.saveToCloud(!0);this.V34e=0;this.V34f=!1};c.prototype.onExit=function(){this.Vr8()};c.prototype.Vku=function(){this.Vrk||this.V34e++;
b.exec(function(){this.kernel.game.getCurPos().hasLegals()&&(this.goAll(),this.Vrk||this.Vst())}.bind(this),300)};c.prototype.checkLiveBook=function(){this.Vtc()?this.Vt5&&this.Vt5.equals(this.kernel.game.getCurPos())&&!this.kernel.forceTBUpdate||(this.Vt5=ObjUtil.clone(this.kernel.game.getCurPos()),V35p.aTBLobby.Vt6(this.kernel.game.getCurPos(),!1,!1,this.kernel.ticket),this.Vt7||(this.Vt7=V35p.aTBLobby.addOnLiveBookListener(this.Vt8.bind(this))),this.Vt9||(this.Vt9=V35p.aTBLobby.addOnTBDataListener(this.Vta.bind(this))),
this.Vso.runOnce(5E3),this.kernel.forceTBUpdate=!1):V35p.aTBLobby.fireOnLiveBookDisplay({ticket:this.kernel.ticket,moves:[]})};c.prototype.Vtc=function(){if(!this.blockLiveBook){var b=this.kernel.getCurPos();return 6<b.getPieces().length&&16>b.getPieces().length?!1:V35p.aTBLobby.isLoggedIn()&&(6>this.Vsv||10>this.kernel.game.getMoveNo())&&(60>this.kernel.game.getMoveNo()||6>=b.getPieces().length||2600<this.kernel.game.hdr.Vhb())}};c.prototype.Vt8=function(b){V35p.aTBLobby.fireOnLiveBookDisplay(b);
this.Vso.stop();this.Vsv=0};c.prototype.Vta=function(){};c.prototype.Vsp=function(){V35p.panelMgr.tbBook&&V35p.panelMgr.tbBook.Vtd(lm.FRESH_POSITION);this.Vsv++};c.prototype.saveToCloud=function(b){return V35p.cloudMgr&&V35p.cloudMgr.isLoggedIn()&&!this.saved&&(1<this.V34e||b)?(V35p.cloudMgr.Vrd(this.kernel.game),this.saved=!0):!1};return c}();CB.V34g={V1kr:4E3};
CB.V35m=function(){var c=function(b){this.V34z=new CB.V1o8("Reader");this.versionCode=new CB.V1jt(CB.V1jb.V1jr,15,14,0);this.appName="reader.chessbase.com";this.V27g="https://reader.chessbase.com";this.V26d="reader";this.V25o="ChessBase PGN Reader";this.gameKernel={};this.V270({pics:(-1==document.URL.search(/chessbase.com/i)||-1!=document.URL.search(/cloudserver/i))&&-1==document.URL.search(/localhost/i),engine:!0});this.V34h()};CB.inherit(c,CB.ChessApp);CB.V0(c,CB.V27p);CB.V0(c,CB.V2yp);c.prototype.V25p=
function(){this.superClass.V25p.call(this);this.panelMgr=new CB.V2ze;this.Vk9=this.commands.Vka(this);CB.V5t.V6c()||(window.addEventListener("blur",onBlur),window.addEventListener("focus",onFocus))};c.prototype.V34i=function(){V35p.lobby=new CB.Server.LiveManager;V35p.lobby.V1vi(V35p.config.getLiveUris(),"guest","",CB.LoginMode.GUEST);window.addEventListener("beforeunload",onBeforeUnload);window.addEventListener("unload",onBeforeUnload);window.addEventListener("blur",onBlur);window.addEventListener("focus",
onFocus);document.addEventListener("visibilitychange",onVisibilityChange);V35p.lobby.V1q8()};c.prototype.onLogin=function(b){this.setLoggedIn(1==b.ResultType)};c.prototype.V25v=function(){this.superClass.V25v.call(this)};c.prototype.V26n=function(){return!1};c.prototype.V15u=function(){return!1};c.prototype.V25t=function(){return CB.V34g};c.prototype.execCommand=function(b){return this.superClass.execCommand.apply(this,arguments)};c.prototype.V34h=function(){this.config.V34j=!0;this.config.V174=this.config.V173=
Math.min(16,Math.max(4,window.innerHeight/50));this.config.V1vm=!0;this.config.V1qv=!0;this.config.Vro=!CB.V5t.V64()};c.prototype.V261=function(){return[CB.V79.ENG,CB.V79.DEU,CB.V79.ESP]};c.prototype.V272=function(){return!0};c.prototype.V262=function(b){return this.superClass.V262.call(this,b)};return c}();var V35p;function onBeforeUnload(c){V35p.lobby&&(V35p.lobby.logOff(),CB.Timer.V4w(700));V35p.V25v()}
function onBlur(){V35p.V26p();V35p.lobby&&CB.V5t.V64()&&(V35p.blurLogOffTimer=new CB.Timer(function(){V35p.lobby&&V35p.lobby.logOff();V35p.V26v()}),V35p.blurLogOffTimer.runOnce(3E4))}function onFocus(){V35p.lobby&&(CB.V5t.V64()&&!V35p.lobby.Vrb()&&V35p.lobby.wasLoggedIn()&&(V35p.lobby.V1q7(),V35p.playerLobby&&!V35p.playerLobby.Vrb()&&V35p.playerLobby.wasLoggedIn()&&V35p.playerLobby.V1q7()),V35p.blurLogOffTimer&&V35p.blurLogOffTimer.stop())}
function onVisibilityChange(){V35p.lobby&&document.visibilityState&&("hidden"==document.visibilityState?onBlur():"visible"==document.visibilityState&&onFocus())}"use strict";
(function(c){function b(){V35p.V25v();V35p.V26v();V35p.V26x();V35p.V26z();V35p.panelMgr.V1qh();V35p.V26p()}function d(){V35p.panelMgr.onBlur();CB.V5t.V64();V35p.V26p()}function e(){document.hidden&&d()}$(function(){var c=document.getElementById("bodytext");c&&document.body.removeChild(c);V35p=new CB.V35m;V35p.V25p();V35p.V26w();V35p.V26y();V35p.panelMgr.V2zl();window.addEventListener("beforeunload",b);CB.$(window).on("beforeunload",b).on("blur",d).on("visibilitychange",e);V35p.isLive&&V35p.V34i();
V35p.V26u();V35p.V26r(V35p.tokenLoginHandler.bind(V35p))||V35p.setLoggedIn(!1);V35p.panelMgr.V16e();V35p.aTBLobby.V2l7=function(){V35p.panelMgr.V34a()};CB.V5t.V64()&&CB.V5t.V72()&&(window.scrollTo(0,0),CB.V5t.V66())})})(window);
